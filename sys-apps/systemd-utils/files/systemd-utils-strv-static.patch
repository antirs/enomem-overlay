diff '--color=auto' -Nurp a/NEWS b/NEWS
--- a/NEWS	2025-03-06 14:40:12.000000000 +0000
+++ b/NEWS	2025-06-30 18:35:42.000000000 +0000
@@ -3441,7 +3441,7 @@ CHANGES WITH 252 üéÉ:
         * libsystemd now exports sd_bus_error_setfv() (a convenience function
           for setting bus errors), sd_id128_string_equal (a convenience
           function for 128-bit ID string comparisons), and
-          sd_bus_message_read_strv_extend() (a function to incrementally read
+          sd_bus_message_read_sd_strv_extend() (a function to incrementally read
           string arrays).
 
         * libsystemd now exports sd_device_get_child_first()/_next() as a
diff '--color=auto' -Nurp a/coccinelle/isempty.cocci b/coccinelle/isempty.cocci
--- a/coccinelle/isempty.cocci	2025-03-06 14:40:12.000000000 +0000
+++ b/coccinelle/isempty.cocci	2025-06-30 18:37:25.000000000 +0000
@@ -5,17 +5,17 @@ position p : script:python() { p[0].file
 expression s;
 @@
 (
-- strv_length@p(s) == 0
-+ strv_isempty(s)
+- sd_strv_length@p(s) == 0
++ sd_strv_isempty(s)
 |
-- strv_length@p(s) <= 0
-+ strv_isempty(s)
+- sd_strv_length@p(s) <= 0
++ sd_strv_isempty(s)
 |
-- strv_length@p(s) > 0
-+ !strv_isempty(s)
+- sd_strv_length@p(s) > 0
++ !sd_strv_isempty(s)
 |
-- strv_length@p(s) != 0
-+ !strv_isempty(s)
+- sd_strv_length@p(s) != 0
++ !sd_strv_isempty(s)
 |
 - strlen@p(s) == 0
 + isempty(s)
diff '--color=auto' -Nurp a/coccinelle/strv_free.cocci b/coccinelle/strv_free.cocci
--- a/coccinelle/strv_free.cocci	2025-03-06 14:40:12.000000000 +0000
+++ b/coccinelle/strv_free.cocci	2025-06-30 18:33:49.000000000 +0000
@@ -2,27 +2,27 @@
 @@
 expression p;
 @@
-- strv_free(p);
+- sd_strv_free(p);
 - p = NULL;
-+ p = strv_free(p);
++ p = sd_strv_free(p);
 @@
 expression p;
 @@
 - if (p)
--         strv_free(p);
+-         sd_strv_free(p);
 - p = NULL;
-+ p = strv_free(p);
++ p = sd_strv_free(p);
 @@
 expression p;
 @@
 - if (p) {
--         strv_free(p);
+-         sd_strv_free(p);
 -         p = NULL;
 - }
-+ p = strv_free(p);
++ p = sd_strv_free(p);
 @@
 expression p;
 @@
 - if (p)
--         strv_free(p);
-+ strv_free(p);
+-         sd_strv_free(p);
++ sd_strv_free(p);
diff '--color=auto' -Nurp a/docs/CODING_STYLE.md b/docs/CODING_STYLE.md
--- a/docs/CODING_STYLE.md	2025-03-06 14:40:12.000000000 +0000
+++ b/docs/CODING_STYLE.md	2025-06-30 18:33:49.000000000 +0000
@@ -397,7 +397,7 @@ SPDX-License-Identifier: LGPL-2.1-or-lat
 
 - Name destructor functions that destroy an object in full freeing all its
   memory and associated resources (and thus invalidating the pointer to it)
-  `xyz_free()`. Example: `strv_free()`.
+  `xyz_free()`. Example: `sd_strv_free()`.
 
 - Name destructor functions that destroy only the referenced content of an
   object but leave the object itself allocated `xyz_done()`. If it resets all
diff '--color=auto' -Nurp a/man/rules/meson.build b/man/rules/meson.build
--- a/man/rules/meson.build	2025-03-06 14:40:12.000000000 +0000
+++ b/man/rules/meson.build	2025-06-30 18:35:42.000000000 +0000
@@ -375,7 +375,7 @@ manpages = [
   ''],
  ['sd_bus_message_read_array', '3', [], ''],
  ['sd_bus_message_read_basic', '3', [], ''],
- ['sd_bus_message_read_strv', '3', ['sd_bus_message_read_strv_extend'], ''],
+ ['sd_bus_message_read_strv', '3', ['sd_bus_message_read_sd_strv_extend'], ''],
  ['sd_bus_message_rewind', '3', [], ''],
  ['sd_bus_message_seal', '3', [], ''],
  ['sd_bus_message_sensitive', '3', [], ''],
diff '--color=auto' -Nurp a/man/sd_bus_message_read_strv.xml b/man/sd_bus_message_read_strv.xml
--- a/man/sd_bus_message_read_strv.xml	2025-03-06 14:40:12.000000000 +0000
+++ b/man/sd_bus_message_read_strv.xml	2025-06-30 18:35:42.000000000 +0000
@@ -17,7 +17,7 @@
 
   <refnamediv>
     <refname>sd_bus_message_read_strv</refname>
-    <refname>sd_bus_message_read_strv_extend</refname>
+    <refname>sd_bus_message_read_sd_strv_extend</refname>
 
     <refpurpose>Access an array of strings in a message</refpurpose>
   </refnamediv>
@@ -33,7 +33,7 @@
       </funcprototype>
 
       <funcprototype>
-        <funcdef>int <function>sd_bus_message_read_strv_extend</function></funcdef>
+        <funcdef>int <function>sd_bus_message_read_sd_strv_extend</function></funcdef>
         <paramdef>sd_bus_message *<parameter>m</parameter></paramdef>
         <paramdef>char ***<parameter>l</parameter></paramdef>
       </funcprototype>
@@ -51,7 +51,7 @@
     <parameter>l</parameter>. Note that ownership of this array is transferred to the caller. Hence, the
     caller is responsible for freeing this array and its contents.</para>
 
-    <para><function>sd_bus_message_read_strv_extend()</function> is similar, but the second parameter is an
+    <para><function>sd_bus_message_read_sd_strv_extend()</function> is similar, but the second parameter is an
     input-output parameter. If <parameter>*l</parameter> is <constant>NULL</constant>, if behaves identically
     to <function>sd_bus_message_read_strv()</function>. Otherwise, <parameter>*l</parameter> must point to a
     strv, which will be reallocated and extended with additional strings. This function is particularly
@@ -111,7 +111,7 @@
   <refsect1>
     <title>History</title>
     <para><function>sd_bus_message_read_strv()</function> was added in version 246.</para>
-    <para><function>sd_bus_message_read_strv_extend()</function> was added in version 252.</para>
+    <para><function>sd_bus_message_read_sd_strv_extend()</function> was added in version 252.</para>
   </refsect1>
 
   <refsect1>
diff '--color=auto' -Nurp a/src/analyze/analyze-architectures.c b/src/analyze/analyze-architectures.c
--- a/src/analyze/analyze-architectures.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-architectures.c	2025-06-30 18:37:25.000000000 +0000
@@ -47,7 +47,7 @@ int verb_architectures(int argc, char *a
 
         (void) table_hide_column_from_display(table, (size_t) 0);
 
-        if (strv_isempty(strv_skip(argv, 1)))
+        if (sd_strv_isempty(strv_skip(argv, 1)))
                 for (Architecture a = 0; a < _ARCHITECTURE_MAX; a++) {
                         r = add_arch(table, a);
                         if (r < 0)
diff '--color=auto' -Nurp a/src/analyze/analyze-capability.c b/src/analyze/analyze-capability.c
--- a/src/analyze/analyze-capability.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-capability.c	2025-06-30 18:37:25.000000000 +0000
@@ -20,7 +20,7 @@ int verb_capabilities(int argc, char *ar
         /* Determine the maximum of the last cap known by the kernel and by us */
         last_cap = MAX((unsigned) CAP_LAST_CAP, cap_last_cap());
 
-        if (strv_isempty(strv_skip(argv, 1)))
+        if (sd_strv_isempty(strv_skip(argv, 1)))
                 for (unsigned c = 0; c <= last_cap; c++) {
                         r = table_add_many(table,
                                            TABLE_STRING, capability_to_name(c) ?: "cap_???",
diff '--color=auto' -Nurp a/src/analyze/analyze-critical-chain.c b/src/analyze/analyze-critical-chain.c
--- a/src/analyze/analyze-critical-chain.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-critical-chain.c	2025-06-30 18:35:42.000000000 +0000
@@ -74,21 +74,21 @@ static bool times_in_range(const UnitTim
 }
 
 static int list_dependencies_one(sd_bus *bus, const char *name, unsigned level, char ***units, unsigned branches) {
-        _cleanup_strv_free_ char **deps = NULL;
+        _cleanup_sd_strv_free_ char **deps = NULL;
         int r;
         usec_t service_longest = 0;
         int to_print = 0;
         UnitTimes *times;
         BootTimes *boot;
 
-        if (strv_extend(units, name))
+        if (sd_strv_extend(units, name))
                 return log_oom();
 
         r = list_dependencies_get_dependencies(bus, name, &deps);
         if (r < 0)
                 return r;
 
-        typesafe_qsort(deps, strv_length(deps), list_dependencies_compare);
+        typesafe_qsort(deps, sd_strv_length(deps), list_dependencies_compare);
 
         r = acquire_boot_times(bus, /* require_finished = */ true, &boot);
         if (r < 0)
@@ -142,7 +142,7 @@ static int list_dependencies_one(sd_bus
 }
 
 static int list_dependencies(sd_bus *bus, const char *name) {
-        _cleanup_strv_free_ char **units = NULL;
+        _cleanup_sd_strv_free_ char **units = NULL;
         UnitTimes *times;
         int r;
         const char *id;
diff '--color=auto' -Nurp a/src/analyze/analyze-dot.c b/src/analyze/analyze-dot.c
--- a/src/analyze/analyze-dot.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-dot.c	2025-06-30 18:37:25.000000000 +0000
@@ -17,7 +17,7 @@ static int graph_one_property(
                 char **from_patterns,
                 char **to_patterns) {
 
-        _cleanup_strv_free_ char **units = NULL;
+        _cleanup_sd_strv_free_ char **units = NULL;
         bool match_patterns;
         int r;
 
@@ -28,7 +28,7 @@ static int graph_one_property(
 
         match_patterns = strv_fnmatch(patterns, u->id);
 
-        if (!strv_isempty(from_patterns) && !match_patterns && !strv_fnmatch(from_patterns, u->id))
+        if (!sd_strv_isempty(from_patterns) && !match_patterns && !strv_fnmatch(from_patterns, u->id))
                 return 0;
 
         r = bus_get_unit_property_strv(bus, u->unit_path, prop, &units);
@@ -40,10 +40,10 @@ static int graph_one_property(
 
                 match_patterns2 = strv_fnmatch(patterns, *unit);
 
-                if (!strv_isempty(to_patterns) && !match_patterns2 && !strv_fnmatch(to_patterns, *unit))
+                if (!sd_strv_isempty(to_patterns) && !match_patterns2 && !strv_fnmatch(to_patterns, *unit))
                         continue;
 
-                if (!strv_isempty(patterns) && !match_patterns && !match_patterns2)
+                if (!sd_strv_isempty(patterns) && !match_patterns && !match_patterns2)
                         continue;
 
                 printf("\t\"%s\"->\"%s\" [color=\"%s\"];\n", u->id, *unit, color);
@@ -96,7 +96,7 @@ static int graph_one(
 }
 
 static int expand_patterns(sd_bus *bus, char **patterns, char ***ret) {
-        _cleanup_strv_free_ char **expanded_patterns = NULL;
+        _cleanup_sd_strv_free_ char **expanded_patterns = NULL;
         int r;
 
         assert(bus);
@@ -106,7 +106,7 @@ static int expand_patterns(sd_bus *bus,
                 _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
                 _cleanup_free_ char *unit = NULL, *unit_id = NULL;
 
-                if (strv_extend(&expanded_patterns, *pattern) < 0)
+                if (sd_strv_extend(&expanded_patterns, *pattern) < 0)
                         return log_oom();
 
                 if (string_is_glob(*pattern))
@@ -128,7 +128,7 @@ static int expand_patterns(sd_bus *bus,
                         return log_error_errno(r, "Failed to get ID: %s", bus_error_message(&error, r));
 
                 if (!streq(*pattern, unit_id))
-                        if (strv_extend(&expanded_patterns, unit_id) < 0)
+                        if (sd_strv_extend(&expanded_patterns, unit_id) < 0)
                                 return log_oom();
         }
 
@@ -141,9 +141,9 @@ int verb_dot(int argc, char *argv[], voi
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **expanded_patterns = NULL;
-        _cleanup_strv_free_ char **expanded_from_patterns = NULL;
-        _cleanup_strv_free_ char **expanded_to_patterns = NULL;
+        _cleanup_sd_strv_free_ char **expanded_patterns = NULL;
+        _cleanup_sd_strv_free_ char **expanded_from_patterns = NULL;
+        _cleanup_sd_strv_free_ char **expanded_to_patterns = NULL;
         UnitInfo u;
         int r;
 
diff '--color=auto' -Nurp a/src/analyze/analyze-dump.c b/src/analyze/analyze-dump.c
--- a/src/analyze/analyze-dump.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-dump.c	2025-06-30 18:37:25.000000000 +0000
@@ -94,7 +94,7 @@ static int dump_patterns(sd_bus *bus, ch
 }
 
 static int mangle_patterns(char **args, char ***ret) {
-        _cleanup_strv_free_ char **mangled = NULL;
+        _cleanup_sd_strv_free_ char **mangled = NULL;
         int r;
 
         STRV_FOREACH(arg, args) {
@@ -104,13 +104,13 @@ static int mangle_patterns(char **args,
                 if (r < 0)
                         return log_error_errno(r, "Failed to mangle name '%s': %m", *arg);
 
-                r = strv_consume(&mangled, t);
+                r = sd_strv_consume(&mangled, t);
                 if (r < 0)
                         return log_oom();
         }
 
-        if (strv_isempty(mangled))
-                mangled = strv_free(mangled);
+        if (sd_strv_isempty(mangled))
+                mangled = sd_strv_free(mangled);
 
         *ret = TAKE_PTR(mangled);
         return 0;
@@ -118,7 +118,7 @@ static int mangle_patterns(char **args,
 
 int verb_dump(int argc, char *argv[], void *userdata) {
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **patterns = NULL;
+        _cleanup_sd_strv_free_ char **patterns = NULL;
         int r;
 
         r = acquire_bus(&bus, NULL);
diff '--color=auto' -Nurp a/src/analyze/analyze-exit-status.c b/src/analyze/analyze-exit-status.c
--- a/src/analyze/analyze-exit-status.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-exit-status.c	2025-06-30 18:37:25.000000000 +0000
@@ -17,7 +17,7 @@ int verb_exit_status(int argc, char *arg
         if (r < 0)
                 return log_error_errno(r, "Failed to right-align status: %m");
 
-        if (strv_isempty(strv_skip(argv, 1)))
+        if (sd_strv_isempty(strv_skip(argv, 1)))
                 for (size_t i = 0; i < ELEMENTSOF(exit_status_mappings); i++) {
                         if (!exit_status_mappings[i].name)
                                 continue;
diff '--color=auto' -Nurp a/src/analyze/analyze-filesystems.c b/src/analyze/analyze-filesystems.c
--- a/src/analyze/analyze-filesystems.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-filesystems.c	2025-06-30 18:37:25.000000000 +0000
@@ -114,7 +114,7 @@ int verb_filesystems(int argc, char *arg
 
         pager_open(arg_pager_flags);
 
-        if (strv_isempty(strv_skip(argv, 1))) {
+        if (sd_strv_isempty(strv_skip(argv, 1))) {
                 _cleanup_set_free_ Set *kernel = NULL, *known = NULL;
                 int k;
 
diff '--color=auto' -Nurp a/src/analyze/analyze-malloc.c b/src/analyze/analyze-malloc.c
--- a/src/analyze/analyze-malloc.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-malloc.c	2025-06-30 18:37:25.000000000 +0000
@@ -34,7 +34,7 @@ int verb_malloc(int argc, char *argv[],
         char **services = STRV_MAKE("org.freedesktop.systemd1");
         int r;
 
-        if (!strv_isempty(strv_skip(argv, 1))) {
+        if (!sd_strv_isempty(strv_skip(argv, 1))) {
                 services = strv_skip(argv, 1);
                 STRV_FOREACH(service, services)
                         if (!service_name_is_valid(*service))
diff '--color=auto' -Nurp a/src/analyze/analyze-pcrs.c b/src/analyze/analyze-pcrs.c
--- a/src/analyze/analyze-pcrs.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-pcrs.c	2025-06-30 18:37:25.000000000 +0000
@@ -114,7 +114,7 @@ int verb_pcrs(int argc, char *argv[], vo
         if (!alg) /* hide hash column if we couldn't acquire it */
                 (void) table_set_display(table, 0, 1);
 
-        if (strv_isempty(strv_skip(argv, 1)))
+        if (sd_strv_isempty(strv_skip(argv, 1)))
                 for (uint32_t pi = 0; pi < _TPM2_PCR_INDEX_MAX_DEFINED; pi++) {
                         r = add_pcr_to_table(table, alg, pi);
                         if (r < 0)
diff '--color=auto' -Nurp a/src/analyze/analyze-plot.c b/src/analyze/analyze-plot.c
--- a/src/analyze/analyze-plot.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-plot.c	2025-06-30 18:37:25.000000000 +0000
@@ -171,7 +171,7 @@ static void plot_tooltip(const UnitTimes
 
         UnitDependency i;
         FOREACH_ARGUMENT(i, UNIT_AFTER, UNIT_BEFORE, UNIT_REQUIRES, UNIT_REQUISITE, UNIT_WANTS, UNIT_CONFLICTS, UNIT_UPHOLDS)
-                if (!strv_isempty(ut->deps[i])) {
+                if (!sd_strv_isempty(ut->deps[i])) {
                         svg("\n%s:\n", unit_dependency_to_string(i));
                         STRV_FOREACH(s, ut->deps[i])
                                 svg("  %s\n", *s);
diff '--color=auto' -Nurp a/src/analyze/analyze-security.c b/src/analyze/analyze-security.c
--- a/src/analyze/analyze-security.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-security.c	2025-06-30 18:37:56.000000000 +0000
@@ -167,9 +167,9 @@ static SecurityInfo *security_info_free(
         free(i->notify_access);
 
         free(i->device_policy);
-        strv_free(i->device_allow);
+        sd_strv_free(i->device_allow);
 
-        strv_free(i->supplementary_groups);
+        sd_strv_free(i->supplementary_groups);
         set_free(i->system_call_architectures);
         set_free(i->system_call_filter);
 
@@ -498,7 +498,7 @@ static int assess_supplementary_groups(
         if (security_info_runs_privileged(info))
                 *ret_badness = UINT64_MAX;
         else
-                *ret_badness = !strv_isempty(info->supplementary_groups);
+                *ret_badness = !sd_strv_isempty(info->supplementary_groups);
 
         *ret_description = NULL;
         return 0;
@@ -705,10 +705,10 @@ static int assess_device_allow(
 
         if (STRPTR_IN_SET(info->device_policy, "strict", "closed")) {
 
-                if (!strv_isempty(info->device_allow)) {
+                if (!sd_strv_isempty(info->device_allow)) {
                         _cleanup_free_ char *join = NULL;
 
-                        join = strv_join(info->device_allow, " ");
+                        join = sd_strv_join(info->device_allow, " ");
                         if (!join)
                                 return log_oom();
 
@@ -2229,7 +2229,7 @@ static int property_read_ip_filters(
                 void *userdata) {
 
         SecurityInfo *info = userdata;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(bus);
@@ -2241,9 +2241,9 @@ static int property_read_ip_filters(
                 return r;
 
         if (streq(member, "IPIngressFilterPath"))
-                info->ip_filters_custom_ingress = !strv_isempty(l);
+                info->ip_filters_custom_ingress = !sd_strv_isempty(l);
         else if (streq(member, "IPEgressFilterPath"))
-                info->ip_filters_custom_egress = !strv_isempty(l);
+                info->ip_filters_custom_egress = !sd_strv_isempty(l);
 
         return 0;
 }
@@ -2275,7 +2275,7 @@ static int property_read_device_allow(
                 if (r == 0)
                         break;
 
-                r = strv_extendf(&info->device_allow, "%s:%s", name, policy);
+                r = sd_sd_strv_extendf(&info->device_allow, "%s:%s", name, policy);
                 if (r < 0)
                         return r;
         }
@@ -2484,7 +2484,7 @@ static int get_security_info(Unit *u, Ex
                                 return log_oom();
                 }
                 if (c->supplementary_groups) {
-                        info->supplementary_groups = strv_copy(c->supplementary_groups);
+                        info->supplementary_groups = sd_strv_copy(c->supplementary_groups);
                         if (!info->supplementary_groups)
                                 return log_oom();
                 }
@@ -2626,11 +2626,11 @@ static int get_security_info(Unit *u, Ex
                                 info->ip_address_allow_other = true;
                 }
 
-                info->ip_filters_custom_ingress = !strv_isempty(g->ip_filters_ingress);
-                info->ip_filters_custom_egress = !strv_isempty(g->ip_filters_egress);
+                info->ip_filters_custom_ingress = !sd_strv_isempty(g->ip_filters_ingress);
+                info->ip_filters_custom_egress = !sd_strv_isempty(g->ip_filters_egress);
 
                 LIST_FOREACH(device_allow, a, g->device_allow)
-                        if (strv_extendf(&info->device_allow,
+                        if (sd_sd_strv_extendf(&info->device_allow,
                                          "%s:%s",
                                          a->path,
                                          cgroup_device_permissions_to_string(a->permissions)) < 0)
@@ -2685,11 +2685,11 @@ static int offline_security_checks(
                 run_generators * MANAGER_TEST_RUN_GENERATORS;
 
         _cleanup_(manager_freep) Manager *m = NULL;
-        Unit *units[strv_length(filenames)];
+        Unit *units[sd_strv_length(filenames)];
         int r, k;
         size_t count = 0;
 
-        if (strv_isempty(filenames))
+        if (sd_strv_isempty(filenames))
                 return 0;
 
         r = verify_set_unit_path(filenames);
@@ -2708,7 +2708,7 @@ static int offline_security_checks(
 
         if (profile) {
                 /* Ensure the temporary directory is in the search path, so that we can add drop-ins. */
-                r = strv_extend(&m->lookup_paths.search_path, m->lookup_paths.temporary_dir);
+                r = sd_strv_extend(&m->lookup_paths.search_path, m->lookup_paths.temporary_dir);
                 if (r < 0)
                         return log_oom();
         }
@@ -2791,16 +2791,16 @@ static int analyze_security(sd_bus *bus,
         if (offline)
                 return offline_security_checks(units, policy, scope, check_man, run_generators, threshold, root, profile, pager_flags, json_format_flags);
 
-        if (strv_length(units) != 1) {
+        if (sd_strv_length(units) != 1) {
                 overview_table = table_new("unit", "exposure", "predicate", "happy");
                 if (!overview_table)
                         return log_oom();
         }
 
-        if (strv_isempty(units)) {
+        if (sd_strv_isempty(units)) {
                 _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
                 _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
-                _cleanup_strv_free_ char **list = NULL;
+                _cleanup_sd_strv_free_ char **list = NULL;
                 size_t n = 0;
 
                 r = bus_call_method(
diff '--color=auto' -Nurp a/src/analyze/analyze-syscall-filter.c b/src/analyze/analyze-syscall-filter.c
--- a/src/analyze/analyze-syscall-filter.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-syscall-filter.c	2025-06-30 18:37:25.000000000 +0000
@@ -108,7 +108,7 @@ int verb_syscall_filters(int argc, char
 
         pager_open(arg_pager_flags);
 
-        if (strv_isempty(strv_skip(argv, 1))) {
+        if (sd_strv_isempty(strv_skip(argv, 1))) {
                 _cleanup_set_free_ Set *kernel = NULL, *known = NULL;
                 int k = 0;  /* explicit initialization to appease gcc */
 
diff '--color=auto' -Nurp a/src/analyze/analyze-time-data.c b/src/analyze/analyze-time-data.c
--- a/src/analyze/analyze-time-data.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-time-data.c	2025-06-30 18:33:49.000000000 +0000
@@ -250,7 +250,7 @@ void unit_times_clear(UnitTimes *t) {
                 return;
 
         FOREACH_ELEMENT(d, t->deps)
-                *d = strv_free(*d);
+                *d = sd_strv_free(*d);
 
         t->name = mfree(t->name);
 }
diff '--color=auto' -Nurp a/src/analyze/analyze-unit-files.c b/src/analyze/analyze-unit-files.c
--- a/src/analyze/analyze-unit-files.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-unit-files.c	2025-06-30 18:37:56.000000000 +0000
@@ -42,7 +42,7 @@ int verb_unit_files(int argc, char *argv
                     !strv_fnmatch_strv_or_empty(patterns, v, FNM_NOESCAPE))
                         continue;
 
-                _cleanup_free_ char *j = strv_join(v, ", ");
+                _cleanup_free_ char *j = sd_strv_join(v, ", ");
                 printf("aliases: %s ‚Üê %s\n", k, j);
         }
 
diff '--color=auto' -Nurp a/src/analyze/analyze-verify-util.c b/src/analyze/analyze-verify-util.c
--- a/src/analyze/analyze-verify-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-verify-util.c	2025-06-30 18:37:56.000000000 +0000
@@ -121,7 +121,7 @@ static int find_unit_directory(const cha
 }
 
 int verify_set_unit_path(char **filenames) {
-        _cleanup_strv_free_ char **ans = NULL;
+        _cleanup_sd_strv_free_ char **ans = NULL;
         _cleanup_free_ char *joined = NULL;
         const char *old;
         int r;
@@ -135,15 +135,15 @@ int verify_set_unit_path(char **filename
                 if (r < 0)
                         continue;
 
-                r = strv_consume(&ans, TAKE_PTR(t));
+                r = sd_strv_consume(&ans, TAKE_PTR(t));
                 if (r < 0)
                         return r;
         }
 
-        if (strv_isempty(ans))
+        if (sd_strv_isempty(ans))
                 return 0;
 
-        joined = strv_join(strv_uniq(ans), ":");
+        joined = sd_strv_join(strv_uniq(ans), ":");
         if (!joined)
                 return -ENOMEM;
 
@@ -285,10 +285,10 @@ int verify_units(
         _cleanup_(manager_freep) Manager *m = NULL;
         _cleanup_(set_destroy_ignore_pointer_max) Set *s = NULL;
         _unused_ _cleanup_(clear_log_syntax_callback) dummy_t dummy;
-        Unit *units[strv_length(filenames)];
+        Unit *units[sd_strv_length(filenames)];
         int r, k, count = 0;
 
-        if (strv_isempty(filenames))
+        if (sd_strv_isempty(filenames))
                 return 0;
 
         /* Allow systemd-analyze to hook in a callback function so that it can get
diff '--color=auto' -Nurp a/src/analyze/analyze-verify.c b/src/analyze/analyze-verify.c
--- a/src/analyze/analyze-verify.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze-verify.c	2025-06-30 18:36:37.000000000 +0000
@@ -8,7 +8,7 @@
 #include "tmpfile-util.h"
 
 static int process_aliases(char *argv[], char *tempdir, char ***ret) {
-        _cleanup_strv_free_ char **filenames = NULL;
+        _cleanup_sd_strv_free_ char **filenames = NULL;
         int r;
 
         assert(argv);
@@ -25,7 +25,7 @@ static int process_aliases(char *argv[],
                         return r;
 
                 if (!parse_arg) {
-                        r = strv_consume(&filenames, TAKE_PTR(src));
+                        r = sd_strv_consume(&filenames, TAKE_PTR(src));
                         if (r < 0)
                                 return r;
 
@@ -44,7 +44,7 @@ static int process_aliases(char *argv[],
                 if (r < 0)
                         return r;
 
-                r = strv_consume(&filenames, TAKE_PTR(dst));
+                r = sd_strv_consume(&filenames, TAKE_PTR(dst));
                 if (r < 0)
                         return r;
         }
@@ -54,7 +54,7 @@ static int process_aliases(char *argv[],
 }
 
 int verb_verify(int argc, char *argv[], void *userdata) {
-        _cleanup_strv_free_ char **filenames = NULL;
+        _cleanup_sd_strv_free_ char **filenames = NULL;
         _cleanup_(rm_rf_physical_and_freep) char *tempdir = NULL;
         int r;
 
diff '--color=auto' -Nurp a/src/analyze/analyze.c b/src/analyze/analyze.c
--- a/src/analyze/analyze.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/analyze/analyze.c	2025-06-30 18:35:42.000000000 +0000
@@ -115,8 +115,8 @@ bool arg_legend = true;
 bool arg_table = false;
 ImagePolicy *arg_image_policy = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_dot_from_patterns, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_dot_to_patterns, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_dot_from_patterns, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_dot_to_patterns, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_security_policy, freep);
@@ -428,13 +428,13 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_DOT_FROM_PATTERN:
-                        if (strv_extend(&arg_dot_from_patterns, optarg) < 0)
+                        if (sd_strv_extend(&arg_dot_from_patterns, optarg) < 0)
                                 return log_oom();
 
                         break;
 
                 case ARG_DOT_TO_PATTERN:
-                        if (strv_extend(&arg_dot_to_patterns, optarg) < 0)
+                        if (sd_strv_extend(&arg_dot_to_patterns, optarg) < 0)
                                 return log_oom();
 
                         break;
diff '--color=auto' -Nurp a/src/ask-password/ask-password.c b/src/ask-password/ask-password.c
--- a/src/ask-password/ask-password.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/ask-password/ask-password.c	2025-06-30 18:37:56.000000000 +0000
@@ -205,7 +205,7 @@ static int parse_argv(int argc, char *ar
         }
 
         if (argc > optind) {
-                arg_message = strv_join(argv + optind, " ");
+                arg_message = sd_strv_join(argv + optind, " ");
                 if (!arg_message)
                         return log_oom();
         } else if (FLAGS_SET(arg_flags, ASK_PASSWORD_ECHO)) {
@@ -222,7 +222,7 @@ static int parse_argv(int argc, char *ar
 }
 
 static int run(int argc, char *argv[]) {
-        _cleanup_strv_free_erase_ char **l = NULL;
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         usec_t timeout;
         int r;
 
diff '--color=auto' -Nurp a/src/basic/cap-list.c b/src/basic/cap-list.c
--- a/src/basic/cap-list.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/cap-list.c	2025-06-30 18:35:42.000000000 +0000
@@ -135,7 +135,7 @@ int capability_set_to_string_negative(ui
 }
 
 int capability_set_to_strv(uint64_t set, char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(ret);
@@ -149,7 +149,7 @@ int capability_set_to_strv(uint64_t set,
                 p = CAPABILITY_TO_STRING(i);
                 assert(p);
 
-                r = strv_extend(&l, p);
+                r = sd_strv_extend(&l, p);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/basic/cgroup-util.c b/src/basic/cgroup-util.c
--- a/src/basic/cgroup-util.c	2025-06-30 18:55:45.255159937 +0000
+++ b/src/basic/cgroup-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -1815,7 +1815,7 @@ int cg_slice_to_path(const char *unit, c
 
 int cg_is_threaded(const char *path) {
         _cleanup_free_ char *fs = NULL, *contents = NULL;
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
         int r;
 
         r = cg_get_path(SYSTEMD_CGROUP_CONTROLLER, path, "cgroup.type", &fs);
@@ -1828,7 +1828,7 @@ int cg_is_threaded(const char *path) {
         if (r < 0)
                 return r;
 
-        v = strv_split(contents, NULL);
+        v = sd_strv_split(contents, NULL);
         if (!v)
                 return -ENOMEM;
 
@@ -1956,7 +1956,7 @@ int cg_get_keyed_attribute_full(
         if (r < 0)
                 return r;
 
-        n = strv_length(keys);
+        n = sd_strv_length(keys);
         if (n == 0) /* No keys to retrieve? That's easy, we are done then */
                 return 0;
 
diff '--color=auto' -Nurp a/src/basic/conf-files.c b/src/basic/conf-files.c
--- a/src/basic/conf-files.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/conf-files.c	2025-06-30 18:37:42.000000000 +0000
@@ -139,11 +139,11 @@ static int copy_and_sort_files_from_hash
                 return -ENOMEM;
 
         /* The entries in the array given by hashmap_get_strv() are still owned by the hashmap. */
-        files = strv_copy(sv);
+        files = sd_strv_copy(sv);
         if (!files)
                 return -ENOMEM;
 
-        typesafe_qsort(files, strv_length(files), base_cmp);
+        typesafe_qsort(files, sd_strv_length(files), base_cmp);
 
         *ret = files;
         return 0;
@@ -233,7 +233,7 @@ int conf_files_insert(char ***strv, cons
         char *t;
         int r;
 
-        n = strv_length(*strv);
+        n = sd_strv_length(*strv);
         for (i = 0; i < n; i++) {
                 int c;
 
@@ -295,11 +295,11 @@ int conf_files_list_at(char ***ret, cons
 }
 
 int conf_files_list_nulstr(char ***ret, const char *suffix, const char *root, unsigned flags, const char *dirs) {
-        _cleanup_strv_free_ char **d = NULL;
+        _cleanup_sd_strv_free_ char **d = NULL;
 
         assert(ret);
 
-        d = strv_split_nulstr(dirs);
+        d = sd_strv_split_nulstr(dirs);
         if (!d)
                 return -ENOMEM;
 
@@ -307,11 +307,11 @@ int conf_files_list_nulstr(char ***ret,
 }
 
 int conf_files_list_nulstr_at(char ***ret, const char *suffix, int rfd, unsigned flags, const char *dirs) {
-        _cleanup_strv_free_ char **d = NULL;
+        _cleanup_sd_strv_free_ char **d = NULL;
 
         assert(ret);
 
-        d = strv_split_nulstr(dirs);
+        d = sd_strv_split_nulstr(dirs);
         if (!d)
                 return -ENOMEM;
 
@@ -325,7 +325,7 @@ int conf_files_list_with_replacement(
                 char ***ret_files,
                 char **ret_replace_file) {
 
-        _cleanup_strv_free_ char **f = NULL;
+        _cleanup_sd_strv_free_ char **f = NULL;
         _cleanup_free_ char *p = NULL;
         int r;
 
@@ -360,7 +360,7 @@ int conf_files_list_dropins(
                 const char *root,
                 const char * const *dirs) {
 
-        _cleanup_strv_free_ char **dropin_dirs = NULL;
+        _cleanup_sd_strv_free_ char **dropin_dirs = NULL;
         const char *suffix;
         int r;
 
@@ -369,7 +369,7 @@ int conf_files_list_dropins(
         assert(dirs);
 
         suffix = strjoina("/", dropin_dirname);
-        r = strv_extend_strv_concat(&dropin_dirs, dirs, suffix);
+        r = sd_sd_strv_extend_strv_concat(&dropin_dirs, dirs, suffix);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/basic/env-file.c b/src/basic/env-file.c
--- a/src/basic/env-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/env-file.c	2025-06-30 18:36:23.000000000 +0000
@@ -443,7 +443,7 @@ static int load_env_file_push(
 }
 
 int load_env_file(FILE *f, const char *fname, char ***ret) {
-        _cleanup_strv_free_ char **m = NULL;
+        _cleanup_sd_strv_free_ char **m = NULL;
         int r;
 
         assert(f || fname);
@@ -480,18 +480,18 @@ static int load_env_file_push_pairs(
                                 return free_and_strdup(t+1, "");
                 }
 
-        r = strv_extend(m, key);
+        r = sd_strv_extend(m, key);
         if (r < 0)
                 return r;
 
         if (value)
-                return strv_push(m, value);
+                return sd_strv_push(m, value);
         else
-                return strv_extend(m, "");
+                return sd_strv_extend(m, "");
 }
 
 int load_env_file_pairs(FILE *f, const char *fname, char ***ret) {
-        _cleanup_strv_free_ char **m = NULL;
+        _cleanup_sd_strv_free_ char **m = NULL;
         int r;
 
         assert(f || fname);
diff '--color=auto' -Nurp a/src/basic/env-util.c b/src/basic/env-util.c
--- a/src/basic/env-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/env-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -181,13 +181,13 @@ static int env_append(char **e, char ***
 }
 
 char** _strv_env_merge(char **first, ...) {
-        _cleanup_strv_free_ char **merged = NULL;
+        _cleanup_sd_strv_free_ char **merged = NULL;
         char **k;
         va_list ap;
 
         /* Merges an arbitrary number of environment sets */
 
-        size_t n = strv_length(first);
+        size_t n = sd_strv_length(first);
 
         va_start(ap, first);
         for (;;) {
@@ -197,7 +197,7 @@ char** _strv_env_merge(char **first, ...
                 if (l == POINTER_MAX)
                         break;
 
-                n += strv_length(l);
+                n += sd_strv_length(l);
         }
         va_end(ap);
 
@@ -268,13 +268,13 @@ static bool env_entry_has_name(const cha
 
 char **strv_env_delete(char **x, size_t n_lists, ...) {
         size_t n, i = 0;
-        _cleanup_strv_free_ char **t = NULL;
+        _cleanup_sd_strv_free_ char **t = NULL;
         va_list ap;
 
         /* Deletes every entry from x that is mentioned in the other
          * string lists */
 
-        n = strv_length(x);
+        n = sd_strv_length(x);
 
         t = new(char*, n+1);
         if (!t)
@@ -394,7 +394,7 @@ int strv_env_replace_consume(char ***l,
                 }
 
         /* We didn't find a match, we need to append p or create a new strv */
-        r = strv_consume(l, p);
+        r = sd_strv_consume(l, p);
         if (r < 0)
                 return r;
 
@@ -599,14 +599,14 @@ char **strv_env_clean_with_callback(char
         return e;
 }
 
-static int strv_extend_with_length(char ***l, const char *s, size_t n) {
+static int sd_strv_extend_with_length(char ***l, const char *s, size_t n) {
         char *c;
 
         c = strndup(s, n);
         if (!c)
                 return -ENOMEM;
 
-        return strv_consume(l, c);
+        return sd_strv_consume(l, c);
 }
 
 static int strv_env_get_n_validated(
@@ -627,7 +627,7 @@ static int strv_env_get_n_validated(
         if (env_name_is_valid_n(name, l)) {
                 e = strv_env_get_n(env, name, l, flags);
                 if (!e && unset_variables) {
-                        r = strv_extend_with_length(unset_variables, name, l);
+                        r = sd_strv_extend_with_length(unset_variables, name, l);
                         if (r < 0)
                                 return r;
                 }
@@ -635,7 +635,7 @@ static int strv_env_get_n_validated(
                 e = NULL; /* Resolve invalid variable names the same way as unset ones */
 
                 if (bad_variables) {
-                        r = strv_extend_with_length(bad_variables, name, l);
+                        r = sd_strv_extend_with_length(bad_variables, name, l);
                         if (r < 0)
                                 return r;
                 }
@@ -664,7 +664,7 @@ int replace_env_full(
                 ALTERNATE_VALUE,
         } state = WORD;
 
-        _cleanup_strv_free_ char **unset_variables = NULL, **bad_variables = NULL;
+        _cleanup_sd_strv_free_ char **unset_variables = NULL, **bad_variables = NULL;
         const char *e, *word = format, *test_value = NULL; /* test_value is initialized to appease gcc */
         _cleanup_free_ char *s = NULL;
         char ***pu, ***pb, *k;
@@ -774,7 +774,7 @@ int replace_env_full(
 
                         nest--;
                         if (nest == 0) {
-                                _cleanup_strv_free_ char **u = NULL, **b = NULL;
+                                _cleanup_sd_strv_free_ char **u = NULL, **b = NULL;
                                 _cleanup_free_ char *v = NULL;
                                 char *t = NULL;
 
@@ -796,10 +796,10 @@ int replace_env_full(
                                         t = v;
                                 }
 
-                                r = strv_extend_strv(&unset_variables, u, /* filter_duplicates= */ true);
+                                r = sd_sd_strv_extend_strv(&unset_variables, u, /* filter_duplicates= */ true);
                                 if (r < 0)
                                         return r;
-                                r = strv_extend_strv(&bad_variables, b, /* filter_duplicates= */ true);
+                                r = sd_sd_strv_extend_strv(&bad_variables, b, /* filter_duplicates= */ true);
                                 if (r < 0)
                                         return r;
 
@@ -864,11 +864,11 @@ int replace_env_argv(
                 char ***ret_unset_variables,
                 char ***ret_bad_variables) {
 
-        _cleanup_strv_free_ char **n = NULL, **unset_variables = NULL, **bad_variables = NULL;
+        _cleanup_sd_strv_free_ char **n = NULL, **unset_variables = NULL, **bad_variables = NULL;
         size_t k = 0, l = 0;
         int r;
 
-        l = strv_length(argv);
+        l = sd_strv_length(argv);
 
         n = new(char*, l+1);
         if (!n)
@@ -879,7 +879,7 @@ int replace_env_argv(
 
                 /* If $FOO appears as single word, replace it by the split up variable */
                 if (word[0] == '$' && !IN_SET(word[1], '{', '$')) {
-                        _cleanup_strv_free_ char **m = NULL;
+                        _cleanup_sd_strv_free_ char **m = NULL;
                         const char *name = word + 1;
                         char *e, **w;
                         size_t q;
@@ -887,19 +887,19 @@ int replace_env_argv(
                         if (env_name_is_valid(name)) {
                                 e = strv_env_get(env, name);
                                 if (e)
-                                        r = strv_split_full(&m, e, WHITESPACE, EXTRACT_RELAX|EXTRACT_UNQUOTE);
+                                        r = sd_strv_split_full(&m, e, WHITESPACE, EXTRACT_RELAX|EXTRACT_UNQUOTE);
                                 else if (ret_unset_variables)
-                                        r = strv_extend(&unset_variables, name);
+                                        r = sd_strv_extend(&unset_variables, name);
                                 else
                                         r = 0;
                         } else if (ret_bad_variables)
-                                r = strv_extend(&bad_variables, name);
+                                r = sd_strv_extend(&bad_variables, name);
                         else
                                 r = 0;
                         if (r < 0)
                                 return r;
 
-                        q = strv_length(m);
+                        q = sd_strv_length(m);
                         l = l + q - 1;
 
                         w = reallocarray(n, l + 1, sizeof(char*));
@@ -916,7 +916,7 @@ int replace_env_argv(
                         continue;
                 }
 
-                _cleanup_strv_free_ char **u = NULL, **b = NULL;
+                _cleanup_sd_strv_free_ char **u = NULL, **b = NULL;
 
                 /* If ${FOO} appears as part of a word, replace it by the variable as-is */
                 r = replace_env_full(
@@ -931,11 +931,11 @@ int replace_env_argv(
                         return r;
                 n[++k] = NULL;
 
-                r = strv_extend_strv(&unset_variables, u, /* filter_duplicates= */ true);
+                r = sd_sd_strv_extend_strv(&unset_variables, u, /* filter_duplicates= */ true);
                 if (r < 0)
                         return r;
 
-                r = strv_extend_strv(&bad_variables, b, /*filter_duplicates= */ true);
+                r = sd_sd_strv_extend_strv(&bad_variables, b, /*filter_duplicates= */ true);
                 if (r < 0)
                         return r;
         }
@@ -1039,7 +1039,7 @@ int setenv_systemd_log_level(void) {
 }
 
 int getenv_path_list(const char *name, char ***ret_paths) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *e;
         int r;
 
@@ -1050,7 +1050,7 @@ int getenv_path_list(const char *name, c
         if (!e)
                 return -ENXIO;
 
-        r = strv_split_full(&l, e, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
+        r = sd_strv_split_full(&l, e, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
         if (r < 0)
                 return log_debug_errno(r, "Failed to parse $%s: %m", name);
 
@@ -1068,7 +1068,7 @@ int getenv_path_list(const char *name, c
                                                "Path '%s' is the root fs, refusing.", *p);
         }
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return log_debug_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "No paths specified, refusing.");
 
diff '--color=auto' -Nurp a/src/basic/fileio.c b/src/basic/fileio.c
--- a/src/basic/fileio.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/fileio.c	2025-06-30 18:37:42.000000000 +0000
@@ -1169,11 +1169,11 @@ int search_and_open(
                 int *ret_fd,
                 char **ret_path) {
 
-        _cleanup_strv_free_ char **copy = NULL;
+        _cleanup_sd_strv_free_ char **copy = NULL;
 
         assert(path);
 
-        copy = strv_copy((char**) search);
+        copy = sd_strv_copy((char**) search);
         if (!copy)
                 return -ENOMEM;
 
@@ -1227,12 +1227,12 @@ int search_and_fopen(
                 FILE **ret_file,
                 char **ret_path) {
 
-        _cleanup_strv_free_ char **copy = NULL;
+        _cleanup_sd_strv_free_ char **copy = NULL;
 
         assert(path);
         assert(mode || !ret_file);
 
-        copy = strv_copy((char**) search);
+        copy = sd_strv_copy((char**) search);
         if (!copy)
                 return -ENOMEM;
 
@@ -1247,12 +1247,12 @@ int search_and_fopen_nulstr(
                 FILE **ret_file,
                 char **ret_path) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(path);
         assert(mode || !ret_file);
 
-        l = strv_split_nulstr(search);
+        l = sd_strv_split_nulstr(search);
         if (!l)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/basic/fs-util.c b/src/basic/fs-util.c
--- a/src/basic/fs-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/fs-util.c	2025-06-30 18:33:49.000000000 +0000
@@ -536,7 +536,7 @@ int mkfifoat_atomic(int atfd, const char
 }
 
 int get_files_in_directory(const char *path, char ***list) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_closedir_ DIR *d = NULL;
         size_t n = 0;
 
diff '--color=auto' -Nurp a/src/basic/glob-util.c b/src/basic/glob-util.c
--- a/src/basic/glob-util.c	2025-06-30 18:55:45.131159940 +0000
+++ b/src/basic/glob-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -53,7 +53,7 @@ int safe_glob(const char *path, int flag
                 return -ENOMEM;
         if (k != 0)
                 return errno_or_else(EIO);
-        if (strv_isempty(pglob->gl_pathv))
+        if (sd_strv_isempty(pglob->gl_pathv))
                 return -ENOENT;
 
         return 0;
@@ -94,7 +94,7 @@ int glob_extend(char ***strv, const char
         if (k < 0)
                 return k;
 
-        return strv_extend_strv(strv, g.gl_pathv, false);
+        return sd_sd_strv_extend_strv(strv, g.gl_pathv, false);
 }
 
 int glob_non_glob_prefix(const char *path, char **ret) {
diff '--color=auto' -Nurp a/src/basic/hash-funcs.c b/src/basic/hash-funcs.c
--- a/src/basic/hash-funcs.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/hash-funcs.c	2025-06-30 18:33:49.000000000 +0000
@@ -16,9 +16,9 @@ DEFINE_HASH_OPS_WITH_KEY_DESTRUCTOR(stri
 DEFINE_HASH_OPS_FULL(string_hash_ops_free_free,
                      char, string_hash_func, string_compare_func, free,
                      void, free);
-DEFINE_HASH_OPS_FULL(string_hash_ops_free_strv_free,
+DEFINE_HASH_OPS_FULL(string_hash_ops_free_sd_strv_free,
                      char, string_hash_func, string_compare_func, free,
-                     char*, strv_free);
+                     char*, sd_strv_free);
 
 void path_hash_func(const char *q, struct siphash *state) {
         bool add_slash = false;
diff '--color=auto' -Nurp a/src/basic/hash-funcs.h b/src/basic/hash-funcs.h
--- a/src/basic/hash-funcs.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/hash-funcs.h	2025-06-30 18:33:49.000000000 +0000
@@ -78,7 +78,7 @@ void string_hash_func(const char *p, str
 extern const struct hash_ops string_hash_ops;
 extern const struct hash_ops string_hash_ops_free;
 extern const struct hash_ops string_hash_ops_free_free;
-extern const struct hash_ops string_hash_ops_free_strv_free;
+extern const struct hash_ops string_hash_ops_free_sd_strv_free;
 
 void path_hash_func(const char *p, struct siphash *state);
 extern const struct hash_ops path_hash_ops;
diff '--color=auto' -Nurp a/src/basic/locale-util.c b/src/basic/locale-util.c
--- a/src/basic/locale-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/locale-util.c	2025-06-30 18:33:49.000000000 +0000
@@ -189,7 +189,7 @@ static int add_locales_from_libdir(Set *
 
 int get_locales(char ***ret) {
         _cleanup_set_free_free_ Set *locales = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         locales = set_new(&string_hash_ops);
diff '--color=auto' -Nurp a/src/basic/log.c b/src/basic/log.c
--- a/src/basic/log.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/log.c	2025-06-30 18:36:37.000000000 +0000
@@ -1776,7 +1776,7 @@ bool log_context_enabled(void) {
 static LogContext* log_context_attach(LogContext *c) {
         assert(c);
 
-        _log_context_num_fields += strv_length(c->fields);
+        _log_context_num_fields += sd_strv_length(c->fields);
         _log_context_num_fields += c->n_input_iovec;
         _log_context_num_fields += !!c->key;
 
@@ -1787,8 +1787,8 @@ static LogContext* log_context_detach(Lo
         if (!c)
                 return NULL;
 
-        assert(_log_context_num_fields >= strv_length(c->fields) + c->n_input_iovec +!!c->key);
-        _log_context_num_fields -= strv_length(c->fields);
+        assert(_log_context_num_fields >= sd_strv_length(c->fields) + c->n_input_iovec +!!c->key);
+        _log_context_num_fields -= sd_strv_length(c->fields);
         _log_context_num_fields -= c->n_input_iovec;
         _log_context_num_fields -= !!c->key;
 
@@ -1872,7 +1872,7 @@ static LogContext* log_context_free(LogC
         log_context_detach(c);
 
         if (c->owned) {
-                strv_free(c->fields);
+                sd_strv_free(c->fields);
                 iovec_array_free(c->input_iovec, c->n_input_iovec);
                 free(c->key);
                 free(c->value);
@@ -1883,10 +1883,10 @@ static LogContext* log_context_free(LogC
 
 DEFINE_TRIVIAL_REF_UNREF_FUNC(LogContext, log_context, log_context_free);
 
-LogContext* log_context_new_strv_consume(char **fields) {
+LogContext* log_context_new_sd_strv_consume(char **fields) {
         LogContext *c = log_context_new_strv(fields, /*owned=*/ true);
         if (!c)
-                strv_free(fields);
+                sd_strv_free(fields);
 
         return c;
 }
diff '--color=auto' -Nurp a/src/basic/log.h b/src/basic/log.h
--- a/src/basic/log.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/log.h	2025-06-30 18:37:06.000000000 +0000
@@ -478,7 +478,7 @@ LogContext* log_context_new_strv(char **
 LogContext* log_context_new_iov(struct iovec *input_iovec, size_t n_input_iovec, bool owned);
 
 /* Same as log_context_new(), but frees the given fields strv/iovec on failure. */
-LogContext* log_context_new_strv_consume(char **fields);
+LogContext* log_context_new_sd_strv_consume(char **fields);
 LogContext* log_context_new_iov_consume(struct iovec *input_iovec, size_t n_input_iovec);
 
 LogContext *log_context_ref(LogContext *c);
@@ -530,16 +530,16 @@ static inline void _reset_log_level(int
  */
 
 #define _LOG_CONTEXT_CONSUME_STR(s, c, strv) \
-        _unused_ _cleanup_strv_free_ strv = strv_new(s);                                                \
+        _unused_ _cleanup_sd_strv_free_ strv = sd_strv_new(s);                                                \
         if (!strv)                                                                                      \
                 free(s);                                                                                \
-        _unused_ _cleanup_(log_context_unrefp) LogContext *c = log_context_new_strv_consume(TAKE_PTR(strv))
+        _unused_ _cleanup_(log_context_unrefp) LogContext *c = log_context_new_sd_strv_consume(TAKE_PTR(strv))
 
 #define LOG_CONTEXT_CONSUME_STR(s) \
         _LOG_CONTEXT_CONSUME_STR(s, UNIQ_T(c, UNIQ), UNIQ_T(sv, UNIQ))
 
 #define _LOG_CONTEXT_CONSUME_STRV(strv, c) \
-        _unused_ _cleanup_(log_context_unrefp) LogContext *c = log_context_new_strv_consume(strv);
+        _unused_ _cleanup_(log_context_unrefp) LogContext *c = log_context_new_sd_strv_consume(strv);
 
 #define LOG_CONTEXT_CONSUME_STRV(strv) \
         _LOG_CONTEXT_CONSUME_STRV(strv, UNIQ_T(c, UNIQ))
diff '--color=auto' -Nurp a/src/basic/macro.h b/src/basic/macro.h
--- a/src/basic/macro.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/macro.h	2025-06-30 18:35:42.000000000 +0000
@@ -81,7 +81,7 @@ static inline size_t GREEDY_ALLOC_ROUND_
 
         /* Round up allocation sizes a bit to some reasonable, likely larger value. This is supposed to be
          * used for cases which are likely called in an allocation loop of some form, i.e. that repetitively
-         * grow stuff, for example strv_extend() and suchlike.
+         * grow stuff, for example sd_strv_extend() and suchlike.
          *
          * Note the difference to GREEDY_REALLOC() here, as this helper operates on a single size value only,
          * and rounds up to next multiple of 2, needing no further counter.
diff '--color=auto' -Nurp a/src/basic/nulstr-util.c b/src/basic/nulstr-util.c
--- a/src/basic/nulstr-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/nulstr-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -16,7 +16,7 @@ const char* nulstr_get(const char *nulst
 }
 
 char** strv_parse_nulstr_full(const char *s, size_t l, bool drop_trailing_nuls) {
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
         size_t c = 0, i = 0;
 
         /* l is the length of the input data, which will be split at NULs into elements of the resulting
@@ -68,8 +68,8 @@ char** strv_parse_nulstr_full(const char
         return TAKE_PTR(v);
 }
 
-char** strv_split_nulstr(const char *s) {
-        _cleanup_strv_free_ char **l = NULL;
+char** sd_strv_split_nulstr(const char *s) {
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         /* This parses a nulstr, without specification of size, and stops at an empty string. This cannot
          * parse nulstrs with embedded empty strings hence, as an empty string is an end marker. Use
@@ -77,10 +77,10 @@ char** strv_split_nulstr(const char *s)
          * size to be specified) */
 
         NULSTR_FOREACH(i, s)
-                if (strv_extend(&l, i) < 0)
+                if (sd_strv_extend(&l, i) < 0)
                         return NULL;
 
-        return l ? TAKE_PTR(l) : strv_new(NULL);
+        return l ? TAKE_PTR(l) : sd_strv_new(NULL);
 }
 
 int strv_make_nulstr(char * const *l, char **ret, size_t *ret_size) {
@@ -89,11 +89,11 @@ int strv_make_nulstr(char * const *l, ch
 
         /* Builds a nulstr and returns it together with the size. An extra NUL byte will be appended (‚ö†Ô∏è but
          * not included in the size! ‚ö†Ô∏è). This is done so that the nulstr can be used both in
-         * strv_parse_nulstr() and in NULSTR_FOREACH()/strv_split_nulstr() contexts, i.e. with and without a
+         * strv_parse_nulstr() and in NULSTR_FOREACH()/sd_strv_split_nulstr() contexts, i.e. with and without a
          * size parameter. In the former case we can include empty strings, in the latter case we cannot (as
          * that is the end marker).
          *
-         * When NULSTR_FOREACH()/strv_split_nulstr() is used it is often assumed that the nulstr ends in two
+         * When NULSTR_FOREACH()/sd_strv_split_nulstr() is used it is often assumed that the nulstr ends in two
          * NUL bytes (which it will, if not empty). To ensure that this assumption *always* holds, we'll
          * return a buffer with two NUL bytes in that case, but return a size of zero. */
 
@@ -130,7 +130,7 @@ int strv_make_nulstr(char * const *l, ch
 }
 
 int set_make_nulstr(Set *s, char **ret, size_t *ret_size) {
-        /* Use _cleanup_free_ instead of _cleanup_strv_free_ because we need to clean the strv only, not
+        /* Use _cleanup_free_ instead of _cleanup_sd_strv_free_ because we need to clean the strv only, not
          * the strings owned by the set. */
         _cleanup_free_ char **strv = NULL;
 
diff '--color=auto' -Nurp a/src/basic/nulstr-util.h b/src/basic/nulstr-util.h
--- a/src/basic/nulstr-util.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/nulstr-util.h	2025-06-30 18:37:42.000000000 +0000
@@ -23,13 +23,13 @@ char** strv_parse_nulstr_full(const char
 static inline char** strv_parse_nulstr(const char *s, size_t l) {
         return strv_parse_nulstr_full(s, l, false);
 }
-char** strv_split_nulstr(const char *s);
+char** sd_strv_split_nulstr(const char *s);
 static inline int strv_from_nulstr(char ***ret, const char *nulstr) {
         char **t;
 
         assert(ret);
 
-        t = strv_split_nulstr(nulstr);
+        t = sd_strv_split_nulstr(nulstr);
         if (!t)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/basic/os-util.c b/src/basic/os-util.c
--- a/src/basic/os-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/os-util.c	2025-06-30 18:36:37.000000000 +0000
@@ -394,7 +394,7 @@ int parse_extension_release_sentinel(
 }
 
 int load_os_release_pairs_with_prefix(const char *root, const char *prefix, char ***ret) {
-        _cleanup_strv_free_ char **os_release_pairs = NULL, **os_release_pairs_prefixed = NULL;
+        _cleanup_sd_strv_free_ char **os_release_pairs = NULL, **os_release_pairs_prefixed = NULL;
         int r;
 
         r = load_os_release_pairs(root, &os_release_pairs);
@@ -412,7 +412,7 @@ int load_os_release_pairs_with_prefix(co
                 line = strjoin(prefix, *p, "=", *q);
                 if (!line)
                         return -ENOMEM;
-                r = strv_consume(&os_release_pairs_prefixed, line);
+                r = sd_strv_consume(&os_release_pairs_prefixed, line);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/basic/path-lookup.c b/src/basic/path-lookup.c
--- a/src/basic/path-lookup.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/path-lookup.c	2025-06-30 18:37:56.000000000 +0000
@@ -147,21 +147,21 @@ int xdg_user_dirs(char ***ret_config_dir
          * as data, and allow overriding as configuration.
          */
         const char *e;
-        _cleanup_strv_free_ char **config_dirs = NULL, **data_dirs = NULL;
+        _cleanup_sd_strv_free_ char **config_dirs = NULL, **data_dirs = NULL;
 
         e = getenv("XDG_CONFIG_DIRS");
         if (e)
-                config_dirs = strv_split(e, ":");
+                config_dirs = sd_strv_split(e, ":");
         else
-                config_dirs = strv_new("/etc/xdg");
+                config_dirs = sd_strv_new("/etc/xdg");
         if (!config_dirs)
                 return -ENOMEM;
 
         e = getenv("XDG_DATA_DIRS");
         if (e)
-                data_dirs = strv_split(e, ":");
+                data_dirs = sd_strv_split(e, ":");
         else
-                data_dirs = strv_new("/usr/local/share",
+                data_dirs = sd_strv_new("/usr/local/share",
                                      "/usr/share");
         if (!data_dirs)
                 return -ENOMEM;
@@ -184,9 +184,9 @@ static char** user_dirs(
                 const char *persistent_control,
                 const char *runtime_control) {
 
-        _cleanup_strv_free_ char **config_dirs = NULL, **data_dirs = NULL;
+        _cleanup_sd_strv_free_ char **config_dirs = NULL, **data_dirs = NULL;
         _cleanup_free_ char *data_home = NULL;
-        _cleanup_strv_free_ char **res = NULL;
+        _cleanup_sd_strv_free_ char **res = NULL;
         int r;
 
         r = xdg_user_dirs(&config_dirs, &data_dirs);
@@ -198,7 +198,7 @@ static char** user_dirs(
                 return NULL;
 
         /* Now merge everything we found. */
-        if (strv_extend_many(
+        if (sd_strv_extend_many(
                             &res,
                             persistent_control,
                             runtime_control,
@@ -207,17 +207,17 @@ static char** user_dirs(
                             persistent_config) < 0)
                 return NULL;
 
-        if (strv_extend_strv_concat(&res, (const char* const*) config_dirs, "/systemd/user") < 0)
+        if (sd_sd_strv_extend_strv_concat(&res, (const char* const*) config_dirs, "/systemd/user") < 0)
                 return NULL;
 
         /* global config has lower priority than the user config of the same type */
-        if (strv_extend(&res, global_persistent_config) < 0)
+        if (sd_strv_extend(&res, global_persistent_config) < 0)
                 return NULL;
 
-        if (strv_extend_strv(&res, (char**) user_config_unit_paths, false) < 0)
+        if (sd_sd_strv_extend_strv(&res, (char**) user_config_unit_paths, false) < 0)
                 return NULL;
 
-        if (strv_extend_many(
+        if (sd_strv_extend_many(
                             &res,
                             runtime_config,
                             global_runtime_config,
@@ -225,13 +225,13 @@ static char** user_dirs(
                             data_home) < 0)
                 return NULL;
 
-        if (strv_extend_strv_concat(&res, (const char* const*) data_dirs, "/systemd/user") < 0)
+        if (sd_sd_strv_extend_strv_concat(&res, (const char* const*) data_dirs, "/systemd/user") < 0)
                 return NULL;
 
-        if (strv_extend_strv(&res, (char**) user_data_unit_paths, false) < 0)
+        if (sd_sd_strv_extend_strv(&res, (char**) user_data_unit_paths, false) < 0)
                 return NULL;
 
-        if (strv_extend(&res, generator_late) < 0)
+        if (sd_strv_extend(&res, generator_late) < 0)
                 return NULL;
 
         if (path_strv_make_absolute_cwd(res) < 0)
@@ -544,7 +544,7 @@ int lookup_paths_init(
                 *persistent_control = NULL, *runtime_control = NULL,
                 *persistent_attached = NULL, *runtime_attached = NULL;
         bool append = false; /* Add items from SYSTEMD_UNIT_PATH before normal directories */
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         int r;
 
         assert(lp);
@@ -613,7 +613,7 @@ int lookup_paths_init(
         if (!paths || append) {
                 /* Let's figure something out. */
 
-                _cleanup_strv_free_ char **add = NULL;
+                _cleanup_sd_strv_free_ char **add = NULL;
 
                 /* For the user units we include share/ in the search
                  * path in order to comply with the XDG basedir spec.
@@ -624,7 +624,7 @@ int lookup_paths_init(
                 switch (scope) {
 
                 case RUNTIME_SCOPE_SYSTEM:
-                        add = strv_new(
+                        add = sd_strv_new(
                                         /* If you modify this you also want to modify
                                          * systemdsystemunitpath= in systemd.pc.in! */
                                         STRV_IFNOTNULL(persistent_control),
@@ -648,7 +648,7 @@ int lookup_paths_init(
                         break;
 
                 case RUNTIME_SCOPE_GLOBAL:
-                        add = strv_new(
+                        add = sd_strv_new(
                                         /* If you modify this you also want to modify
                                          * systemduserunitpath= in systemd.pc.in, and
                                          * the arrays in user_dirs() above! */
@@ -686,7 +686,7 @@ int lookup_paths_init(
                         return -ENOMEM;
 
                 if (paths) {
-                        r = strv_extend_strv(&paths, add, true);
+                        r = sd_sd_strv_extend_strv(&paths, add, true);
                         if (r < 0)
                                 return r;
                 } else
@@ -772,7 +772,7 @@ int lookup_paths_init_or_warn(LookupPath
 void lookup_paths_done(LookupPaths *lp) {
         assert(lp);
 
-        lp->search_path = strv_free(lp->search_path);
+        lp->search_path = sd_strv_free(lp->search_path);
 
         lp->persistent_config = mfree(lp->persistent_config);
         lp->runtime_config = mfree(lp->runtime_config);
@@ -796,20 +796,20 @@ void lookup_paths_done(LookupPaths *lp)
 void lookup_paths_log(LookupPaths *lp) {
         assert(lp);
 
-        if (strv_isempty(lp->search_path)) {
+        if (sd_strv_isempty(lp->search_path)) {
                 log_debug("Ignoring unit files.");
-                lp->search_path = strv_free(lp->search_path);
+                lp->search_path = sd_strv_free(lp->search_path);
         } else {
                 _cleanup_free_ char *t = NULL;
 
-                t = strv_join(lp->search_path, "\n\t");
+                t = sd_strv_join(lp->search_path, "\n\t");
                 log_debug("Looking for unit files in (higher priority first):\n\t%s", strna(t));
         }
 }
 
 char **generator_binary_paths(RuntimeScope scope) {
         bool append = false; /* Add items from SYSTEMD_GENERATOR_PATH before normal directories */
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         int r;
 
         /* First priority is whatever has been passed to us via env vars */
@@ -818,12 +818,12 @@ char **generator_binary_paths(RuntimeSco
                 return NULL;
 
         if (!paths || append) {
-                _cleanup_strv_free_ char **add = NULL;
+                _cleanup_sd_strv_free_ char **add = NULL;
 
                 switch (scope) {
 
                 case RUNTIME_SCOPE_SYSTEM:
-                        add = strv_new("/run/systemd/system-generators",
+                        add = sd_strv_new("/run/systemd/system-generators",
                                        "/etc/systemd/system-generators",
                                        "/usr/local/lib/systemd/system-generators",
                                        SYSTEM_GENERATOR_DIR);
@@ -831,7 +831,7 @@ char **generator_binary_paths(RuntimeSco
 
                 case RUNTIME_SCOPE_GLOBAL:
                 case RUNTIME_SCOPE_USER:
-                        add = strv_new("/run/systemd/user-generators",
+                        add = sd_strv_new("/run/systemd/user-generators",
                                        "/etc/systemd/user-generators",
                                        "/usr/local/lib/systemd/user-generators",
                                        USER_GENERATOR_DIR);
@@ -844,7 +844,7 @@ char **generator_binary_paths(RuntimeSco
                         return NULL;
 
                 if (paths) {
-                        r = strv_extend_strv(&paths, add, true);
+                        r = sd_sd_strv_extend_strv(&paths, add, true);
                         if (r < 0)
                                 return NULL;
                 } else
@@ -857,7 +857,7 @@ char **generator_binary_paths(RuntimeSco
 }
 
 char **env_generator_binary_paths(RuntimeScope runtime_scope) {
-        _cleanup_strv_free_ char **paths = NULL, **add = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL, **add = NULL;
         bool append = false; /* Add items from SYSTEMD_ENVIRONMENT_GENERATOR_PATH before normal directories */
         int r;
 
@@ -870,14 +870,14 @@ char **env_generator_binary_paths(Runtim
                 switch (runtime_scope) {
 
                 case RUNTIME_SCOPE_SYSTEM:
-                        add = strv_new("/run/systemd/system-environment-generators",
+                        add = sd_strv_new("/run/systemd/system-environment-generators",
                                         "/etc/systemd/system-environment-generators",
                                         "/usr/local/lib/systemd/system-environment-generators",
                                         SYSTEM_ENV_GENERATOR_DIR);
                         break;
 
                 case RUNTIME_SCOPE_USER:
-                        add = strv_new("/run/systemd/user-environment-generators",
+                        add = sd_strv_new("/run/systemd/user-environment-generators",
                                        "/etc/systemd/user-environment-generators",
                                        "/usr/local/lib/systemd/user-environment-generators",
                                        USER_ENV_GENERATOR_DIR);
@@ -891,7 +891,7 @@ char **env_generator_binary_paths(Runtim
         }
 
         if (paths) {
-                r = strv_extend_strv(&paths, add, true);
+                r = sd_sd_strv_extend_strv(&paths, add, true);
                 if (r < 0)
                         return NULL;
         } else
diff '--color=auto' -Nurp a/src/basic/path-util.c b/src/basic/path-util.c
--- a/src/basic/path-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/path-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -22,13 +22,13 @@
 #include "time-util.h"
 
 int path_split_and_make_absolute(const char *p, char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(p);
         assert(ret);
 
-        l = strv_split(p, ":");
+        l = sd_strv_split(p, ":");
         if (!l)
                 return -ENOMEM;
 
@@ -257,7 +257,7 @@ char** path_strv_resolve(char **l, const
         bool enomem = false;
         int r;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return l;
 
         /* Goes through every item in the string list and canonicalize
@@ -335,7 +335,7 @@ char** path_strv_resolve(char **l, const
 
 char** path_strv_resolve_uniq(char **l, const char *root) {
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return l;
 
         if (!path_strv_resolve(l, root))
diff '--color=auto' -Nurp a/src/basic/proc-cmdline.c b/src/basic/proc-cmdline.c
--- a/src/basic/proc-cmdline.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/proc-cmdline.c	2025-06-30 18:37:42.000000000 +0000
@@ -30,7 +30,7 @@ int proc_cmdline_filter_pid1_args(char *
         };
         static const char *short_options = SYSTEMD_GETOPT_SHORT_OPTIONS;
 
-        _cleanup_strv_free_ char **filtered = NULL;
+        _cleanup_sd_strv_free_ char **filtered = NULL;
         int state, r;
 
         assert(argv);
@@ -55,7 +55,7 @@ int proc_cmdline_filter_pid1_args(char *
 
                 if (a[0] != '-') {
                         /* Not an option, accepting the string. */
-                        r = strv_extend(&filtered, a);
+                        r = sd_strv_extend(&filtered, a);
                         if (r < 0)
                                 return r;
                         continue;
@@ -64,7 +64,7 @@ int proc_cmdline_filter_pid1_args(char *
                 if (a[1] == '-') {
                         if (a[2] == '\0') {
                                 /* "--" is specified, accepting remaining strings. */
-                                r = strv_extend_strv(&filtered, strv_skip(p, 1), /* filter_duplicates = */ false);
+                                r = sd_sd_strv_extend_strv(&filtered, strv_skip(p, 1), /* filter_duplicates = */ false);
                                 if (r < 0)
                                         return r;
                                 break;
@@ -134,10 +134,10 @@ static int proc_cmdline_strv_internal(ch
         /* For testing purposes it is sometimes useful to be able to override what we consider /proc/cmdline to be */
         e = secure_getenv("SYSTEMD_PROC_CMDLINE");
         if (e)
-                return strv_split_full(ret, e, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
+                return sd_strv_split_full(ret, e, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
 
         if (detect_container() > 0) {
-                _cleanup_strv_free_ char **args = NULL;
+                _cleanup_sd_strv_free_ char **args = NULL;
 
                 r = pid_get_cmdline_strv(1, /* flags = */ 0, &args);
                 if (r < 0)
@@ -156,7 +156,7 @@ static int proc_cmdline_strv_internal(ch
                 if (r < 0)
                         return r;
 
-                return strv_split_full(ret, s, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
+                return sd_strv_split_full(ret, s, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
         }
 }
 
@@ -209,7 +209,7 @@ static int proc_cmdline_parse_strv(char
 }
 
 int proc_cmdline_parse(proc_cmdline_parse_t parse_item, void *data, ProcCmdlineFlags flags) {
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         int r;
 
         assert(parse_item);
@@ -228,7 +228,7 @@ int proc_cmdline_parse(proc_cmdline_pars
                         if (r != -ENODATA)
                                 log_debug_errno(r, "Failed to get SystemdOptions EFI variable, ignoring: %m");
                 } else {
-                        r = strv_split_full(&args, line, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
+                        r = sd_strv_split_full(&args, line, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
                         if (r < 0)
                                 return r;
 
@@ -236,7 +236,7 @@ int proc_cmdline_parse(proc_cmdline_pars
                         if (r < 0)
                                 return r;
 
-                        args = strv_free(args);
+                        args = sd_strv_free(args);
                 }
         }
 
@@ -325,7 +325,7 @@ static int cmdline_get_key(char **args,
 }
 
 int proc_cmdline_get_key(const char *key, ProcCmdlineFlags flags, char **ret_value) {
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         _cleanup_free_ char *line = NULL, *v = NULL;
         int r;
 
@@ -379,8 +379,8 @@ int proc_cmdline_get_key(const char *key
         if (r < 0)
                 return r;
 
-        args = strv_free(args);
-        r = strv_split_full(&args, line, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
+        args = sd_strv_free(args);
+        r = sd_strv_split_full(&args, line, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
         if (r < 0)
                 return r;
 
@@ -447,7 +447,7 @@ static int cmdline_get_key_ap(ProcCmdlin
 }
 
 int proc_cmdline_get_key_many_internal(ProcCmdlineFlags flags, ...) {
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         int r, ret = 0;
         va_list ap;
 
@@ -464,7 +464,7 @@ int proc_cmdline_get_key_many_internal(P
                 if (r < 0 && r != -ENODATA)
                         log_debug_errno(r, "Failed to get SystemdOptions EFI variable, ignoring: %m");
                 if (r >= 0) {
-                        r = strv_split_full(&args, line, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
+                        r = sd_strv_split_full(&args, line, NULL, EXTRACT_UNQUOTE|EXTRACT_RELAX|EXTRACT_RETAIN_ESCAPE);
                         if (r < 0)
                                 return r;
 
@@ -475,7 +475,7 @@ int proc_cmdline_get_key_many_internal(P
                                 return r;
 
                         ret = r;
-                        args = strv_free(args);
+                        args = sd_strv_free(args);
                 }
         }
 
diff '--color=auto' -Nurp a/src/basic/process-util.c b/src/basic/process-util.c
--- a/src/basic/process-util.c	2025-06-30 18:55:45.203159938 +0000
+++ b/src/basic/process-util.c	2025-06-30 18:33:49.000000000 +0000
@@ -247,7 +247,7 @@ int pid_get_cmdline(pid_t pid, size_t ma
 
                 assert(!(flags & PROCESS_CMDLINE_USE_LOCALE));
 
-                _cleanup_strv_free_ char **args = NULL;
+                _cleanup_sd_strv_free_ char **args = NULL;
 
                 /* Drop trailing NULs, otherwise strv_parse_nulstr() adds additional empty strings at the end.
                  * See also issue #21186. */
@@ -323,7 +323,7 @@ int pid_get_cmdline_strv(pid_t pid, Proc
 }
 
 int pidref_get_cmdline_strv(const PidRef *pid, ProcessCmdlineFlags flags, char ***ret) {
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         int r;
 
         if (!pidref_is_set(pid))
diff '--color=auto' -Nurp a/src/basic/rlimit-util.c b/src/basic/rlimit-util.c
--- a/src/basic/rlimit-util.c	2025-06-30 18:55:45.163159939 +0000
+++ b/src/basic/rlimit-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -475,8 +475,8 @@ int pid_getrlimit(pid_t pid, int resourc
         if (r < 0)
                 return -EPERM; /* propagate original permission error if we can't access the limits file */
 
-        _cleanup_strv_free_ char **l = NULL;
-        l = strv_split(limits, "\n");
+        _cleanup_sd_strv_free_ char **l = NULL;
+        l = sd_strv_split(limits, "\n");
         if (!l)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/basic/strv.c b/src/basic/strv.c
--- a/src/basic/strv.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/strv.c	2025-06-30 18:38:15.000000000 +0000
@@ -74,34 +74,34 @@ char* strv_find_first_field(char * const
         return NULL;
 }
 
-char** strv_free(char **l) {
+char** sd_strv_free(char **l) {
         STRV_FOREACH(k, l)
                 free(*k);
 
         return mfree(l);
 }
 
-char** strv_free_erase(char **l) {
+char** sd_strv_free_erase(char **l) {
         STRV_FOREACH(i, l)
                 erase_and_freep(i);
 
         return mfree(l);
 }
 
-void strv_free_many(char ***strvs, size_t n) {
+void sd_strv_free_many(char ***strvs, size_t n) {
         assert(strvs || n == 0);
 
         FOREACH_ARRAY (i, strvs, n)
-                strv_free(*i);
+                sd_strv_free(*i);
 
         free(strvs);
 }
 
-char** strv_copy_n(char * const *l, size_t m) {
-        _cleanup_strv_free_ char **result = NULL;
+char** sd_strv_copy_n(char * const *l, size_t m) {
+        _cleanup_sd_strv_free_ char **result = NULL;
         char **k;
 
-        result = new(char*, MIN(strv_length(l), m) + 1);
+        result = new(char*, MIN(sd_strv_length(l), m) + 1);
         if (!result)
                 return NULL;
 
@@ -123,15 +123,15 @@ char** strv_copy_n(char * const *l, size
         return TAKE_PTR(result);
 }
 
-int strv_copy_unless_empty(char * const *l, char ***ret) {
+int sd_strv_copy_unless_empty(char * const *l, char ***ret) {
         assert(ret);
 
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 *ret = NULL;
                 return 0;
         }
 
-        char **copy = strv_copy(l);
+        char **copy = sd_strv_copy(l);
         if (!copy)
                 return -ENOMEM;
 
@@ -139,7 +139,7 @@ int strv_copy_unless_empty(char * const
         return 1;
 }
 
-size_t strv_length(char * const *l) {
+size_t sd_strv_length(char * const *l) {
         size_t n = 0;
 
         STRV_FOREACH(i, l)
@@ -148,8 +148,8 @@ size_t strv_length(char * const *l) {
         return n;
 }
 
-char** strv_new_ap(const char *x, va_list ap) {
-        _cleanup_strv_free_ char **a = NULL;
+char** sd_strv_new_ap(const char *x, va_list ap) {
+        _cleanup_sd_strv_free_ char **a = NULL;
         size_t n = 0, i = 0;
         va_list aq;
 
@@ -187,28 +187,28 @@ char** strv_new_ap(const char *x, va_lis
         return TAKE_PTR(a);
 }
 
-char** strv_new_internal(const char *x, ...) {
+char** sd_strv_new_internal(const char *x, ...) {
         char **r;
         va_list ap;
 
         va_start(ap, x);
-        r = strv_new_ap(x, ap);
+        r = sd_strv_new_ap(x, ap);
         va_end(ap);
 
         return r;
 }
 
-int strv_extend_strv(char ***a, char * const *b, bool filter_duplicates) {
+int sd_sd_strv_extend_strv(char ***a, char * const *b, bool filter_duplicates) {
         size_t p, q, i = 0;
         char **t;
 
         assert(a);
 
-        if (strv_isempty(b))
+        if (sd_strv_isempty(b))
                 return 0;
 
-        p = strv_length(*a);
-        q = strv_length(b);
+        p = sd_strv_length(*a);
+        q = sd_strv_length(b);
 
         if (p >= SIZE_MAX - q)
                 return -ENOMEM;
@@ -242,7 +242,7 @@ rollback:
         return -ENOMEM;
 }
 
-int strv_extend_strv_biconcat(char ***a, const char *prefix, const char* const *b, const char *suffix) {
+int sd_sd_strv_extend_strv_biconcat(char ***a, const char *prefix, const char* const *b, const char *suffix) {
         int r;
 
         STRV_FOREACH(s, b) {
@@ -252,7 +252,7 @@ int strv_extend_strv_biconcat(char ***a,
                 if (!v)
                         return -ENOMEM;
 
-                r = strv_consume(a, v);
+                r = sd_strv_consume(a, v);
                 if (r < 0)
                         return r;
         }
@@ -260,21 +260,21 @@ int strv_extend_strv_biconcat(char ***a,
         return 0;
 }
 
-int strv_split_newlines_full(char ***ret, const char *s, ExtractFlags flags) {
-        _cleanup_strv_free_ char **l = NULL;
+int sd_strv_split_newlines_full(char ***ret, const char *s, ExtractFlags flags) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         size_t n;
         int r;
 
         assert(s);
 
-        /* Special version of strv_split_full() that splits on newlines and
+        /* Special version of sd_strv_split_full() that splits on newlines and
          * suppresses an empty string at the end. */
 
-        r = strv_split_full(&l, s, NEWLINE, flags);
+        r = sd_strv_split_full(&l, s, NEWLINE, flags);
         if (r < 0)
                 return r;
 
-        n = strv_length(l);
+        n = sd_strv_length(l);
         if (n > 0 && isempty(l[n - 1])) {
                 l[n - 1] = mfree(l[n - 1]);
                 n--;
@@ -284,8 +284,8 @@ int strv_split_newlines_full(char ***ret
         return n;
 }
 
-int strv_split_full(char ***t, const char *s, const char *separators, ExtractFlags flags) {
-        _cleanup_strv_free_ char **l = NULL;
+int sd_strv_split_full(char ***t, const char *s, const char *separators, ExtractFlags flags) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         size_t n = 0;
         int r;
 
@@ -319,26 +319,26 @@ int strv_split_full(char ***t, const cha
         return (int) n;
 }
 
-int strv_split_and_extend_full(char ***t, const char *s, const char *separators, bool filter_duplicates, ExtractFlags flags) {
-        _cleanup_strv_free_ char **l = NULL;
+int sd_strv_split_and_extend_full(char ***t, const char *s, const char *separators, bool filter_duplicates, ExtractFlags flags) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(t);
         assert(s);
 
-        r = strv_split_full(&l, s, separators, flags);
+        r = sd_strv_split_full(&l, s, separators, flags);
         if (r < 0)
                 return r;
 
-        r = strv_extend_strv(t, l, filter_duplicates);
+        r = sd_sd_strv_extend_strv(t, l, filter_duplicates);
         if (r < 0)
                 return r;
 
-        return (int) strv_length(*t);
+        return (int) sd_strv_length(*t);
 }
 
-int strv_split_colon_pairs(char ***t, const char *s) {
-        _cleanup_strv_free_ char **l = NULL;
+int sd_strv_split_colon_pairs(char ***t, const char *s) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         size_t n = 0;
         int r;
 
@@ -389,7 +389,7 @@ int strv_split_colon_pairs(char ***t, co
         return (int) n;
 }
 
-char* strv_join_full(char * const *l, const char *separator, const char *prefix, bool escape_separator) {
+char* sd_strv_join_full(char * const *l, const char *separator, const char *prefix, bool escape_separator) {
         char *r, *e;
         size_t n, k, m;
 
@@ -441,9 +441,9 @@ char* strv_join_full(char * const *l, co
         return r;
 }
 
-int strv_push_with_size(char ***l, size_t *n, char *value) {
+int sd_strv_push_with_size(char ***l, size_t *n, char *value) {
         /* n is a pointer to a variable to store the size of l.
-         * If not given (i.e. n is NULL or *n is SIZE_MAX), size will be calculated using strv_length().
+         * If not given (i.e. n is NULL or *n is SIZE_MAX), size will be calculated using sd_strv_length().
          * If n is not NULL, the size after the push will be returned.
          * If value is empty, no action is taken and *n is not set. */
 
@@ -452,7 +452,7 @@ int strv_push_with_size(char ***l, size_
 
         size_t size = n ? *n : SIZE_MAX;
         if (size == SIZE_MAX)
-                size = strv_length(*l);
+                size = sd_strv_length(*l);
 
         /* Check for overflow */
         if (size > SIZE_MAX-2)
@@ -471,14 +471,14 @@ int strv_push_with_size(char ***l, size_
         return 0;
 }
 
-int strv_push_pair(char ***l, char *a, char *b) {
+int sd_strv_push_pair(char ***l, char *a, char *b) {
         char **c;
         size_t n;
 
         if (!a && !b)
                 return 0;
 
-        n = strv_length(*l);
+        n = sd_strv_length(*l);
 
         /* Check for overflow */
         if (n > SIZE_MAX-3)
@@ -508,7 +508,7 @@ int strv_insert(char ***l, size_t positi
         if (!value)
                 return 0;
 
-        n = strv_length(*l);
+        n = sd_strv_length(*l);
         position = MIN(position, n);
 
         /* check for overflow and increase*/
@@ -530,20 +530,20 @@ int strv_insert(char ***l, size_t positi
         return 0;
 }
 
-int strv_consume_with_size(char ***l, size_t *n, char *value) {
+int sd_strv_consume_with_size(char ***l, size_t *n, char *value) {
         int r;
 
-        r = strv_push_with_size(l, n, value);
+        r = sd_strv_push_with_size(l, n, value);
         if (r < 0)
                 free(value);
 
         return r;
 }
 
-int strv_consume_pair(char ***l, char *a, char *b) {
+int sd_strv_consume_pair(char ***l, char *a, char *b) {
         int r;
 
-        r = strv_push_pair(l, a, b);
+        r = sd_strv_push_pair(l, a, b);
         if (r < 0) {
                 free(a);
                 free(b);
@@ -552,10 +552,10 @@ int strv_consume_pair(char ***l, char *a
         return r;
 }
 
-int strv_consume_prepend(char ***l, char *value) {
+int sd_strv_consume_prepend(char ***l, char *value) {
         int r;
 
-        r = strv_push_prepend(l, value);
+        r = sd_strv_push_prepend(l, value);
         if (r < 0)
                 free(value);
 
@@ -572,10 +572,10 @@ int strv_prepend(char ***l, const char *
         if (!v)
                 return -ENOMEM;
 
-        return strv_consume_prepend(l, v);
+        return sd_strv_consume_prepend(l, v);
 }
 
-int strv_extend_with_size(char ***l, size_t *n, const char *value) {
+int sd_strv_extend_with_size(char ***l, size_t *n, const char *value) {
         char *v;
 
         if (!value)
@@ -585,17 +585,17 @@ int strv_extend_with_size(char ***l, siz
         if (!v)
                 return -ENOMEM;
 
-        return strv_consume_with_size(l, n, v);
+        return sd_strv_consume_with_size(l, n, v);
 }
 
-int strv_extend_many_internal(char ***l, const char *value, ...) {
+int sd_strv_extend_many_internal(char ***l, const char *value, ...) {
         va_list ap;
         size_t n, m;
         int r;
 
         assert(l);
 
-        m = n = strv_length(*l);
+        m = n = sd_strv_length(*l);
 
         r = 0;
         va_start(ap, value);
@@ -653,7 +653,7 @@ char** strv_uniq(char **l) {
          * kept, the others dropped */
 
         STRV_FOREACH(i, l)
-                strv_remove(i+1, *i);
+                sd_strv_remove(i+1, *i);
 
         return l;
 }
@@ -666,7 +666,7 @@ bool strv_is_uniq(char * const *l) {
         return true;
 }
 
-char** strv_remove(char **l, const char *s) {
+char** sd_strv_remove(char **l, const char *s) {
         char **f, **t;
 
         if (!l)
@@ -700,21 +700,21 @@ static int str_compare(char * const *a,
 }
 
 char** strv_sort(char **l) {
-        typesafe_qsort(l, strv_length(l), str_compare);
+        typesafe_qsort(l, sd_strv_length(l), str_compare);
         return l;
 }
 
 int strv_compare(char * const *a, char * const *b) {
         int r;
 
-        if (strv_isempty(a)) {
-                if (strv_isempty(b))
+        if (sd_strv_isempty(a)) {
+                if (sd_strv_isempty(b))
                         return 0;
                 else
                         return -1;
         }
 
-        if (strv_isempty(b))
+        if (sd_strv_isempty(b))
                 return 1;
 
         for ( ; *a || *b; ++a, ++b) {
@@ -731,7 +731,7 @@ void strv_print_full(char * const *l, co
                 printf("%s%s\n", strempty(prefix), *s);
 }
 
-int strv_extendf(char ***l, const char *format, ...) {
+int sd_sd_strv_extendf(char ***l, const char *format, ...) {
         va_list ap;
         char *x;
         int r;
@@ -743,7 +743,7 @@ int strv_extendf(char ***l, const char *
         if (r < 0)
                 return -ENOMEM;
 
-        return strv_consume(l, x);
+        return sd_strv_consume(l, x);
 }
 
 char* startswith_strv(const char *s, char * const *l) {
@@ -766,10 +766,10 @@ char* endswith_strv(const char *s, char
         return NULL;
 }
 
-char** strv_reverse(char **l) {
+char** sd_strv_reverse(char **l) {
         size_t n;
 
-        n = strv_length(l);
+        n = sd_strv_length(l);
         if (n <= 1)
                 return l;
 
@@ -823,7 +823,7 @@ bool strv_fnmatch_full(
 char** strv_skip(char **l, size_t n) {
 
         while (n > 0) {
-                if (strv_isempty(l))
+                if (sd_strv_isempty(l))
                         return l;
 
                 l++, n--;
@@ -832,7 +832,7 @@ char** strv_skip(char **l, size_t n) {
         return l;
 }
 
-int strv_extend_n(char ***l, const char *value, size_t n) {
+int sd_strv_extend_n(char ***l, const char *value, size_t n) {
         size_t i, k;
         char **nl;
 
@@ -845,7 +845,7 @@ int strv_extend_n(char ***l, const char
 
         /* Adds the value n times to l */
 
-        k = strv_length(*l);
+        k = sd_strv_length(*l);
         if (n >= SIZE_MAX - k)
                 return -ENOMEM;
 
@@ -872,7 +872,7 @@ rollback:
         return -ENOMEM;
 }
 
-int strv_extend_assignment(char ***l, const char *lhs, const char *rhs) {
+int sd_strv_extend_assignment(char ***l, const char *lhs, const char *rhs) {
         char *j;
 
         assert(l);
@@ -885,7 +885,7 @@ int strv_extend_assignment(char ***l, co
         if (!j)
                 return -ENOMEM;
 
-        return strv_consume(l, j);
+        return sd_strv_consume(l, j);
 }
 
 int fputstrv(FILE *f, char * const *l, const char *separator, bool *space) {
@@ -918,21 +918,21 @@ static int string_strv_hashmap_put_inter
                 if (strv_contains(l, value))
                         return 0;
 
-                r = strv_extend(&l, value);
+                r = sd_strv_extend(&l, value);
                 if (r < 0)
                         return r;
 
                 assert_se(hashmap_update(h, key, l) >= 0);
         } else {
                 /* No list for this key exists yet, create one */
-                _cleanup_strv_free_ char **l2 = NULL;
+                _cleanup_sd_strv_free_ char **l2 = NULL;
                 _cleanup_free_ char *t = NULL;
 
                 t = strdup(key);
                 if (!t)
                         return -ENOMEM;
 
-                r = strv_extend(&l2, value);
+                r = sd_strv_extend(&l2, value);
                 if (r < 0)
                         return r;
 
@@ -966,4 +966,4 @@ int _string_strv_ordered_hashmap_put(Ord
         return string_strv_hashmap_put_internal(PLAIN_HASHMAP(*h), key, value);
 }
 
-DEFINE_HASH_OPS_FULL(string_strv_hash_ops, char, string_hash_func, string_compare_func, free, char*, strv_free);
+DEFINE_HASH_OPS_FULL(string_strv_hash_ops, char, string_hash_func, string_compare_func, free, char*, sd_strv_free);
diff '--color=auto' -Nurp a/src/basic/strv.h b/src/basic/strv.h
--- a/src/basic/strv.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/strv.h	2025-06-30 18:38:15.000000000 +0000
@@ -24,28 +24,28 @@ char* strv_find_first_field(char * const
 #define strv_contains(l, s) (!!strv_find((l), (s)))
 #define strv_contains_case(l, s) (!!strv_find_case((l), (s)))
 
-char** strv_free(char **l);
-DEFINE_TRIVIAL_CLEANUP_FUNC(char**, strv_free);
-#define _cleanup_strv_free_ _cleanup_(strv_freep)
+char** sd_strv_free(char **l);
+DEFINE_TRIVIAL_CLEANUP_FUNC(char**, sd_strv_free);
+#define _cleanup_sd_strv_free_ _cleanup_(sd_strv_freep)
 
-char** strv_free_erase(char **l);
-DEFINE_TRIVIAL_CLEANUP_FUNC(char**, strv_free_erase);
-#define _cleanup_strv_free_erase_ _cleanup_(strv_free_erasep)
+char** sd_strv_free_erase(char **l);
+DEFINE_TRIVIAL_CLEANUP_FUNC(char**, sd_strv_free_erase);
+#define _cleanup_sd_strv_free_erase_ _cleanup_(sd_strv_free_erasep)
 
-void strv_free_many(char ***strvs, size_t n);
+void sd_strv_free_many(char ***strvs, size_t n);
 
-char** strv_copy_n(char * const *l, size_t n);
-static inline char** strv_copy(char * const *l) {
-        return strv_copy_n(l, SIZE_MAX);
+char** sd_strv_copy_n(char * const *l, size_t n);
+static inline char** sd_strv_copy(char * const *l) {
+        return sd_strv_copy_n(l, SIZE_MAX);
 }
-int strv_copy_unless_empty(char * const *l, char ***ret);
+int sd_strv_copy_unless_empty(char * const *l, char ***ret);
 
-size_t strv_length(char * const *l) _pure_;
+size_t sd_strv_length(char * const *l) _pure_;
 
-int strv_extend_strv(char ***a, char * const *b, bool filter_duplicates);
-int strv_extend_strv_biconcat(char ***a, const char *prefix, const char* const *b, const char *suffix);
-static inline int strv_extend_strv_concat(char ***a, const char* const *b, const char *suffix) {
-        return strv_extend_strv_biconcat(a, NULL, b, suffix);
+int sd_sd_strv_extend_strv(char ***a, char * const *b, bool filter_duplicates);
+int sd_sd_strv_extend_strv_biconcat(char ***a, const char *prefix, const char* const *b, const char *suffix);
+static inline int sd_sd_strv_extend_strv_concat(char ***a, const char* const *b, const char *suffix) {
+        return sd_sd_strv_extend_strv_biconcat(a, NULL, b, suffix);
 }
 int strv_prepend(char ***l, const char *value);
 
@@ -53,37 +53,37 @@ int strv_prepend(char ***l, const char *
  * which allows us to skip iterating over the strv to find the end, which saves
  * a bit of time and reduces the complexity of appending from O(n¬≤) to O(n). */
 
-int strv_extend_with_size(char ***l, size_t *n, const char *value);
-static inline int strv_extend(char ***l, const char *value) {
-        return strv_extend_with_size(l, NULL, value);
+int sd_strv_extend_with_size(char ***l, size_t *n, const char *value);
+static inline int sd_strv_extend(char ***l, const char *value) {
+        return sd_strv_extend_with_size(l, NULL, value);
 }
 
-int strv_extend_many_internal(char ***l, const char *value, ...);
-#define strv_extend_many(l, ...) strv_extend_many_internal(l, __VA_ARGS__, POINTER_MAX)
+int sd_strv_extend_many_internal(char ***l, const char *value, ...);
+#define sd_strv_extend_many(l, ...) sd_strv_extend_many_internal(l, __VA_ARGS__, POINTER_MAX)
 
-int strv_extendf(char ***l, const char *format, ...) _printf_(2,3);
+int sd_sd_strv_extendf(char ***l, const char *format, ...) _printf_(2,3);
 
-int strv_push_with_size(char ***l, size_t *n, char *value);
-static inline int strv_push(char ***l, char *value) {
-        return strv_push_with_size(l, NULL, value);
+int sd_strv_push_with_size(char ***l, size_t *n, char *value);
+static inline int sd_strv_push(char ***l, char *value) {
+        return sd_strv_push_with_size(l, NULL, value);
 }
-int strv_push_pair(char ***l, char *a, char *b);
+int sd_strv_push_pair(char ***l, char *a, char *b);
 
 int strv_insert(char ***l, size_t position, char *value);
 
-static inline int strv_push_prepend(char ***l, char *value) {
+static inline int sd_strv_push_prepend(char ***l, char *value) {
         return strv_insert(l, 0, value);
 }
 
-int strv_consume_with_size(char ***l, size_t *n, char *value);
-static inline int strv_consume(char ***l, char *value) {
-        return strv_consume_with_size(l, NULL, value);
+int sd_strv_consume_with_size(char ***l, size_t *n, char *value);
+static inline int sd_strv_consume(char ***l, char *value) {
+        return sd_strv_consume_with_size(l, NULL, value);
 }
 
-int strv_consume_pair(char ***l, char *a, char *b);
-int strv_consume_prepend(char ***l, char *value);
+int sd_strv_consume_pair(char ***l, char *a, char *b);
+int sd_strv_consume_prepend(char ***l, char *value);
 
-char** strv_remove(char **l, const char *s);
+char** sd_strv_remove(char **l, const char *s);
 char** strv_uniq(char **l);
 bool strv_is_uniq(char * const *l);
 
@@ -92,9 +92,9 @@ static inline bool strv_equal(char * con
         return strv_compare(a, b) == 0;
 }
 
-char** strv_new_internal(const char *x, ...) _sentinel_;
-char** strv_new_ap(const char *x, va_list ap);
-#define strv_new(...) strv_new_internal(__VA_ARGS__, NULL)
+char** sd_strv_new_internal(const char *x, ...) _sentinel_;
+char** sd_strv_new_ap(const char *x, va_list ap);
+#define sd_strv_new(...) sd_strv_new_internal(__VA_ARGS__, NULL)
 
 #define STRV_IGNORE ((const char *) POINTER_MAX)
 
@@ -102,28 +102,28 @@ static inline const char* STRV_IFNOTNULL
         return x ?: STRV_IGNORE;
 }
 
-static inline bool strv_isempty(char * const *l) {
+static inline bool sd_strv_isempty(char * const *l) {
         return !l || !*l;
 }
 
-int strv_split_full(char ***t, const char *s, const char *separators, ExtractFlags flags);
-static inline char** strv_split(const char *s, const char *separators) {
+int sd_strv_split_full(char ***t, const char *s, const char *separators, ExtractFlags flags);
+static inline char** sd_strv_split(const char *s, const char *separators) {
         char **ret;
 
-        if (strv_split_full(&ret, s, separators, EXTRACT_RETAIN_ESCAPE) < 0)
+        if (sd_strv_split_full(&ret, s, separators, EXTRACT_RETAIN_ESCAPE) < 0)
                 return NULL;
 
         return ret;
 }
 
-int strv_split_and_extend_full(char ***t, const char *s, const char *separators, bool filter_duplicates, ExtractFlags flags);
-#define strv_split_and_extend(t, s, sep, dup) strv_split_and_extend_full(t, s, sep, dup, 0)
+int sd_strv_split_and_extend_full(char ***t, const char *s, const char *separators, bool filter_duplicates, ExtractFlags flags);
+#define sd_strv_split_and_extend(t, s, sep, dup) sd_strv_split_and_extend_full(t, s, sep, dup, 0)
 
-int strv_split_newlines_full(char ***ret, const char *s, ExtractFlags flags);
-static inline char** strv_split_newlines(const char *s) {
+int sd_strv_split_newlines_full(char ***ret, const char *s, ExtractFlags flags);
+static inline char** sd_strv_split_newlines(const char *s) {
         char **ret;
 
-        if (strv_split_newlines_full(&ret, s, 0) < 0)
+        if (sd_strv_split_newlines_full(&ret, s, 0) < 0)
                 return NULL;
 
         return ret;
@@ -132,18 +132,18 @@ static inline char** strv_split_newlines
 /* Given a string containing white-space separated tuples of words themselves separated by ':',
  * returns a vector of strings. If the second element in a tuple is missing, the corresponding
  * string in the vector is an empty string. */
-int strv_split_colon_pairs(char ***t, const char *s);
+int sd_strv_split_colon_pairs(char ***t, const char *s);
 
-char* strv_join_full(char * const *l, const char *separator, const char *prefix, bool escape_separator);
-static inline char *strv_join(char * const *l, const char *separator) {
-        return strv_join_full(l, separator, NULL, false);
+char* sd_strv_join_full(char * const *l, const char *separator, const char *prefix, bool escape_separator);
+static inline char *sd_strv_join(char * const *l, const char *separator) {
+        return sd_strv_join_full(l, separator, NULL, false);
 }
 
 bool strv_overlap(char * const *a, char * const *b) _pure_;
 
 #define _STRV_FOREACH_BACKWARDS(s, l, h, i)                             \
         for (typeof(*(l)) *s, *h = (l), *i = ({                         \
-                                size_t _len = strv_length(h);           \
+                                size_t _len = sd_strv_length(h);           \
                                 _len > 0 ? h + _len - 1 : NULL;         \
                         });                                             \
              (s = i);                                                   \
@@ -227,7 +227,7 @@ char* endswith_strv(const char *s, char
 #define FOREACH_STRING(x, y, ...)                       \
         _FOREACH_STRING(UNIQ, x, y, ##__VA_ARGS__)
 
-char** strv_reverse(char **l);
+char** sd_strv_reverse(char **l);
 char** strv_shell_escape(char **l, const char *bad);
 
 bool strv_fnmatch_full(char* const* patterns, const char *s, int flags, size_t *ret_matched_pos);
@@ -237,20 +237,20 @@ static inline bool strv_fnmatch(char* co
 
 static inline bool strv_fnmatch_or_empty(char* const* patterns, const char *s, int flags) {
         assert(s);
-        return strv_isempty(patterns) ||
+        return sd_strv_isempty(patterns) ||
                strv_fnmatch_full(patterns, s, flags, NULL);
 }
 
 char** strv_skip(char **l, size_t n);
 
-int strv_extend_n(char ***l, const char *value, size_t n);
+int sd_strv_extend_n(char ***l, const char *value, size_t n);
 
-int strv_extend_assignment(char ***l, const char *lhs, const char *rhs);
+int sd_strv_extend_assignment(char ***l, const char *lhs, const char *rhs);
 
 int fputstrv(FILE *f, char * const *l, const char *separator, bool *space);
 
-#define strv_free_and_replace(a, b)             \
-        free_and_replace_full(a, b, strv_free)
+#define sd_strv_free_and_replace(a, b)             \
+        free_and_replace_full(a, b, sd_strv_free)
 
 extern const struct hash_ops string_strv_hash_ops;
 int _string_strv_hashmap_put(Hashmap **h, const char *key, const char *value  HASHMAP_DEBUG_PARAMS);
diff '--color=auto' -Nurp a/src/basic/terminal-util.c b/src/basic/terminal-util.c
--- a/src/basic/terminal-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/terminal-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -708,7 +708,7 @@ int vtnr_from_tty(const char *tty) {
 }
 
 int get_kernel_consoles(char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_free_ char *line = NULL;
         const char *p;
         int r;
@@ -750,12 +750,12 @@ int get_kernel_consoles(char ***ret) {
                         continue;
                 }
 
-                r = strv_consume(&l, TAKE_PTR(path));
+                r = sd_strv_consume(&l, TAKE_PTR(path));
                 if (r < 0)
                         return r;
         }
 
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 log_debug("No devices found for system console");
                 goto fallback;
         }
@@ -765,7 +765,7 @@ int get_kernel_consoles(char ***ret) {
         return 0;
 
 fallback:
-        r = strv_extend(&l, "/dev/console");
+        r = sd_strv_extend(&l, "/dev/console");
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/basic/time-util.c b/src/basic/time-util.c
--- a/src/basic/time-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/time-util.c	2025-06-30 18:35:42.000000000 +0000
@@ -1419,7 +1419,7 @@ int parse_nsec(const char *t, nsec_t *re
 
 static int get_timezones_from_zone1970_tab(char ***ret) {
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
         int r;
 
         assert(ret);
@@ -1449,7 +1449,7 @@ static int get_timezones_from_zone1970_t
                 if (*cc == '#')
                         continue;
 
-                r = strv_extend(&zones, tz);
+                r = sd_strv_extend(&zones, tz);
                 if (r < 0)
                         return r;
         }
@@ -1460,7 +1460,7 @@ static int get_timezones_from_zone1970_t
 
 static int get_timezones_from_tzdata_zi(char ***ret) {
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
         int r;
 
         assert(ret);
@@ -1501,7 +1501,7 @@ static int get_timezones_from_tzdata_zi(
                         /* Not a line we care about. */
                         continue;
 
-                r = strv_extend(&zones, tz);
+                r = sd_strv_extend(&zones, tz);
                 if (r < 0)
                         return r;
         }
@@ -1511,7 +1511,7 @@ static int get_timezones_from_tzdata_zi(
 }
 
 int get_timezones(char ***ret) {
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
         int r;
 
         assert(ret);
@@ -1527,7 +1527,7 @@ int get_timezones(char ***ret) {
                 return r;
 
         /* Always include UTC */
-        r = strv_extend(&zones, "UTC");
+        r = sd_strv_extend(&zones, "UTC");
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/basic/unit-file.c b/src/basic/unit-file.c
--- a/src/basic/unit-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/basic/unit-file.c	2025-06-30 18:36:37.000000000 +0000
@@ -396,7 +396,7 @@ int unit_file_build_name_map(
 
         _cleanup_hashmap_free_ Hashmap *ids = NULL, *names = NULL;
         _cleanup_set_free_free_ Set *paths = NULL;
-        _cleanup_strv_free_ char **expanded_search_path = NULL;
+        _cleanup_sd_strv_free_ char **expanded_search_path = NULL;
         uint64_t timestamp_hash;
         int r;
 
@@ -435,7 +435,7 @@ int unit_file_build_name_map(
         STRV_FOREACH(dir, lp->search_path) {
                 _cleanup_free_ char *resolved_dir = NULL;
 
-                r = strv_extend(&expanded_search_path, *dir);
+                r = sd_strv_extend(&expanded_search_path, *dir);
                 if (r < 0)
                         return log_oom();
 
@@ -449,7 +449,7 @@ int unit_file_build_name_map(
                 if (strv_contains(expanded_search_path, resolved_dir))
                         continue;
 
-                if (strv_consume(&expanded_search_path, TAKE_PTR(resolved_dir)) < 0)
+                if (sd_strv_consume(&expanded_search_path, TAKE_PTR(resolved_dir)) < 0)
                         return log_oom();
         }
 
diff '--color=auto' -Nurp a/src/binfmt/binfmt.c b/src/binfmt/binfmt.c
--- a/src/binfmt/binfmt.c	2025-06-30 18:55:45.259159937 +0000
+++ b/src/binfmt/binfmt.c	2025-06-30 18:33:49.000000000 +0000
@@ -234,7 +234,7 @@ static int run(int argc, char *argv[]) {
                         RET_GATHER(r, apply_file(argv[i], false));
 
         } else {
-                _cleanup_strv_free_ char **files = NULL;
+                _cleanup_sd_strv_free_ char **files = NULL;
 
                 r = conf_files_list_strv(&files, ".conf", NULL, 0, (const char**) CONF_PATHS_STRV("binfmt.d"));
                 if (r < 0)
diff '--color=auto' -Nurp a/src/boot/bless-boot.c b/src/boot/bless-boot.c
--- a/src/boot/bless-boot.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/bless-boot.c	2025-06-30 18:37:56.000000000 +0000
@@ -25,7 +25,7 @@
 
 static char **arg_path = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_path, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_path, sd_strv_freep);
 
 static int help(int argc, char *argv[], void *userdata) {
         _cleanup_free_ char *link = NULL;
@@ -84,7 +84,7 @@ static int parse_argv(int argc, char *ar
                         return version();
 
                 case ARG_PATH:
-                        r = strv_extend(&arg_path, optarg);
+                        r = sd_strv_extend(&arg_path, optarg);
                         if (r < 0)
                                 return log_oom();
                         break;
@@ -105,7 +105,7 @@ static int acquire_path(void) {
         char **a;
         int r;
 
-        if (!strv_isempty(arg_path))
+        if (!sd_strv_isempty(arg_path))
                 return 0;
 
         r = find_esp_and_warn(NULL, NULL, /* unprivileged_mode= */ false, &esp_path, NULL, NULL, NULL, NULL, &esp_devid);
@@ -122,20 +122,20 @@ static int acquire_path(void) {
                                        "Alternatively, use --path= to specify path to mount point.");
 
         if (esp_path && xbootldr_path && !devnum_set_and_equal(esp_devid, xbootldr_devid)) /* in case the two paths refer to the same inode, suppress one */
-                a = strv_new(esp_path, xbootldr_path);
+                a = sd_strv_new(esp_path, xbootldr_path);
         else if (esp_path)
-                a = strv_new(esp_path);
+                a = sd_strv_new(esp_path);
         else
-                a = strv_new(xbootldr_path);
+                a = sd_strv_new(xbootldr_path);
         if (!a)
                 return log_oom();
 
-        strv_free_and_replace(arg_path, a);
+        sd_strv_free_and_replace(arg_path, a);
 
         if (DEBUG_LOGGING) {
                 _cleanup_free_ char *j = NULL;
 
-                j = strv_join(arg_path, ":");
+                j = sd_strv_join(arg_path, ":");
                 log_debug("Using %s as boot loader drop-in search path.", strna(j));
         }
 
diff '--color=auto' -Nurp a/src/boot/bootctl-status.c b/src/boot/bootctl-status.c
--- a/src/boot/bootctl-status.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/bootctl-status.c	2025-06-30 18:33:49.000000000 +0000
@@ -40,7 +40,7 @@ static int boot_config_load_and_select(
                 return r;
 
         if (!arg_root) {
-                _cleanup_strv_free_ char **efi_entries = NULL;
+                _cleanup_sd_strv_free_ char **efi_entries = NULL;
 
                 r = efi_loader_get_entries(&efi_entries);
                 if (r == -ENOENT || ERRNO_IS_NEG_NOT_SUPPORTED(r))
diff '--color=auto' -Nurp a/src/boot/efi/boot.c b/src/boot/efi/boot.c
--- a/src/boot/efi/boot.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/efi/boot.c	2025-06-30 18:33:49.000000000 +0000
@@ -666,7 +666,7 @@ static bool menu_run(
         bool new_mode = true, clear = true;
         bool refresh = true, highlight = false;
         size_t x_start = 0, y_start = 0, y_status = 0, x_max, y_max;
-        _cleanup_(strv_freep) char16_t **lines = NULL;
+        _cleanup_(sd_strv_freep) char16_t **lines = NULL;
         _cleanup_free_ char16_t *clearline = NULL, *separator = NULL, *status = NULL;
         uint64_t timeout_efivar_saved = config->timeout_sec_efivar;
         uint32_t timeout_remain = config->timeout_sec == TIMEOUT_MENU_FORCE ? 0 : config->timeout_sec;
@@ -734,7 +734,7 @@ static bool menu_run(
                         /* Put status line after the entry list, but give it some breathing room. */
                         y_status = MIN(y_start + MIN(visible_max, config->n_entries) + 1, y_max - 1);
 
-                        lines = strv_free(lines);
+                        lines = sd_strv_free(lines);
                         clearline = mfree(clearline);
                         separator = mfree(separator);
 
@@ -1184,7 +1184,7 @@ static BootEntry* boot_entry_free(BootEn
         free(entry->loader);
         free(entry->devicetree);
         free(entry->options);
-        strv_free(entry->initrd);
+        sd_strv_free(entry->initrd);
         free(entry->path);
         free(entry->current_name);
         free(entry->next_name);
diff '--color=auto' -Nurp a/src/boot/efi/cpio.c b/src/boot/efi/cpio.c
--- a/src/boot/efi/cpio.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/efi/cpio.c	2025-06-30 18:33:49.000000000 +0000
@@ -319,7 +319,7 @@ EFI_STATUS pack_cpio(
         size_t dirent_size = 0, buffer_size = 0, n_items = 0, n_allocated = 0;
         _cleanup_free_ char16_t *rel_dropin_dir = NULL;
         _cleanup_free_ EFI_FILE_INFO *dirent = NULL;
-        _cleanup_(strv_freep) char16_t **items = NULL;
+        _cleanup_(sd_strv_freep) char16_t **items = NULL;
         _cleanup_free_ void *buffer = NULL;
         uint32_t inode = 1; /* inode counter, so that each item gets a new inode */
         EFI_STATUS err;
@@ -388,7 +388,7 @@ EFI_STATUS pack_cpio(
                 }
 
                 items[n_items++] = TAKE_PTR(d);
-                items[n_items] = NULL; /* Let's always NUL terminate, to make freeing via strv_free() easy */
+                items[n_items] = NULL; /* Let's always NUL terminate, to make freeing via sd_strv_free() easy */
         }
 
         if (n_items == 0)
diff '--color=auto' -Nurp a/src/boot/efi/stub.c b/src/boot/efi/stub.c
--- a/src/boot/efi/stub.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/efi/stub.c	2025-06-30 18:33:49.000000000 +0000
@@ -251,7 +251,7 @@ static EFI_STATUS load_addons_from_dir(
                 }
 
                 (*items)[(*n_items)++] = TAKE_PTR(d);
-                (*items)[*n_items] = NULL; /* Let's always NUL terminate, to make freeing via strv_free() easy */
+                (*items)[*n_items] = NULL; /* Let's always NUL terminate, to make freeing via sd_strv_free() easy */
         }
 
         return EFI_SUCCESS;
@@ -362,7 +362,7 @@ static EFI_STATUS load_addons(
                 size_t *ret_n_dt) {
 
         _cleanup_free_ size_t *dt_sizes = NULL;
-        _cleanup_(strv_freep) char16_t **items = NULL;
+        _cleanup_(sd_strv_freep) char16_t **items = NULL;
         _cleanup_(file_closep) EFI_FILE *root = NULL;
         _cleanup_free_ char16_t *cmdline = NULL;
         size_t n_items = 0, n_allocated = 0, n_dt = 0;
diff '--color=auto' -Nurp a/src/boot/efi/util.c b/src/boot/efi/util.c
--- a/src/boot/efi/util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/efi/util.c	2025-06-30 18:33:49.000000000 +0000
@@ -506,7 +506,7 @@ bool is_ascii(const char16_t *f) {
         return true;
 }
 
-char16_t **strv_free(char16_t **v) {
+char16_t **sd_strv_free(char16_t **v) {
         if (!v)
                 return NULL;
 
diff '--color=auto' -Nurp a/src/boot/efi/util.h b/src/boot/efi/util.h
--- a/src/boot/efi/util.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/efi/util.h	2025-06-30 18:33:49.000000000 +0000
@@ -140,10 +140,10 @@ EFI_STATUS readdir(EFI_FILE *handle, EFI
 
 bool is_ascii(const char16_t *f);
 
-char16_t **strv_free(char16_t **l);
+char16_t **sd_strv_free(char16_t **l);
 
-static inline void strv_freep(char16_t ***p) {
-        strv_free(*p);
+static inline void sd_strv_freep(char16_t ***p) {
+        sd_strv_free(*p);
 }
 
 EFI_STATUS open_directory(EFI_FILE *root_dir, const char16_t *path, EFI_FILE **ret);
diff '--color=auto' -Nurp a/src/boot/measure.c b/src/boot/measure.c
--- a/src/boot/measure.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/boot/measure.c	2025-06-30 18:37:56.000000000 +0000
@@ -40,13 +40,13 @@ static bool arg_current = false;
 static char **arg_phase = NULL;
 static char *arg_append = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_banks, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_banks, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_tpm2_device, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_private_key, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_private_key_source, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_public_key, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_certificate, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_phase, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_phase, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_append, freep);
 
 static void free_sections(char*(*sections)[_UNIFIED_SECTION_MAX]) {
@@ -111,18 +111,18 @@ static int help(int argc, char *argv[],
 }
 
 static char *normalize_phase(const char *s) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         /* Let's normalize phase expressions. We split the series of colon-separated words up, then remove
          * all empty ones, and glue them back together again. In other words we remove duplicate ":", as well
          * as leading and trailing ones. */
 
-        l = strv_split(s, ":"); /* Split series of words */
+        l = sd_strv_split(s, ":"); /* Split series of words */
         if (!l)
                 return NULL;
 
         /* Remove all empty words and glue things back together */
-        return strv_join(strv_remove(l, ""), ":");
+        return sd_strv_join(sd_strv_remove(l, ""), ":");
 }
 
 static int parse_argv(int argc, char *argv[]) {
@@ -222,7 +222,7 @@ static int parse_argv(int argc, char *ar
                         if (!implementation)
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Unknown bank '%s', refusing.", optarg);
 
-                        if (strv_extend(&arg_banks, EVP_MD_name(implementation)) < 0)
+                        if (sd_strv_extend(&arg_banks, EVP_MD_name(implementation)) < 0)
                                 return log_oom();
 
                         break;
@@ -293,7 +293,7 @@ static int parse_argv(int argc, char *ar
                         if (!n)
                                 return log_oom();
 
-                        r = strv_consume(&arg_phase, TAKE_PTR(n));
+                        r = sd_strv_consume(&arg_phase, TAKE_PTR(n));
                         if (r < 0)
                                 return r;
 
@@ -320,9 +320,9 @@ static int parse_argv(int argc, char *ar
         if (arg_private_key_source && !arg_certificate)
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "When using --private-key-source=, --certificate= must be specified.");
 
-        if (strv_isempty(arg_banks)) {
+        if (sd_strv_isempty(arg_banks)) {
                 /* If no banks are specifically selected, pick all known banks */
-                arg_banks = strv_new("SHA1", "SHA256", "SHA384", "SHA512");
+                arg_banks = sd_strv_new("SHA1", "SHA256", "SHA384", "SHA512");
                 if (!arg_banks)
                         return log_oom();
         }
@@ -336,10 +336,10 @@ static int parse_argv(int argc, char *ar
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                        "The --current switch cannot be used in combination with --linux= and related switches.");
 
-        if (strv_isempty(arg_phase)) {
+        if (sd_strv_isempty(arg_phase)) {
                 /* If no phases are specifically selected, pick everything from the beginning of the initrd
                  * to the beginning of shutdown. */
-                if (strv_extend_many(&arg_phase,
+                if (sd_strv_extend_many(&arg_phase,
                                      "enter-initrd",
                                      "enter-initrd:leave-initrd",
                                      "enter-initrd:leave-initrd:sysinit",
@@ -351,7 +351,7 @@ static int parse_argv(int argc, char *ar
         }
 
         _cleanup_free_ char *j = NULL;
-        j = strv_join(arg_phase, ", ");
+        j = sd_strv_join(arg_phase, ", ");
         if (!j)
                 return log_oom();
 
@@ -554,7 +554,7 @@ static int measure_kernel(PcrState *pcr_
 }
 
 static int measure_phase(PcrState *pcr_states, size_t n, const char *phase) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(pcr_states);
@@ -564,7 +564,7 @@ static int measure_phase(PcrState *pcr_s
          * virtually extends each specified word into PCR 11, to model how during boot we measure a series of
          * words into PCR 11, one for each phase. */
 
-        l = strv_split(phase, ":");
+        l = sd_strv_split(phase, ":");
         if (!l)
                 return log_oom();
 
@@ -605,7 +605,7 @@ static int pcr_states_allocate(PcrState
         _cleanup_(pcr_state_free_all) PcrState *pcr_states = NULL;
         size_t n = 0;
 
-        pcr_states = new0(PcrState, strv_length(arg_banks) + 1);
+        pcr_states = new0(PcrState, sd_strv_length(arg_banks) + 1);
         if (!pcr_states)
                 return log_oom();
 
@@ -687,8 +687,8 @@ static int verb_calculate(int argc, char
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "The --append= switch is only supported for 'sign', not 'calculate'.");
 
-        assert(!strv_isempty(arg_banks));
-        assert(!strv_isempty(arg_phase));
+        assert(!sd_strv_isempty(arg_banks));
+        assert(!sd_strv_isempty(arg_phase));
 
         r = pcr_states_allocate(&pcr_states);
         if (r < 0)
@@ -782,8 +782,8 @@ static int verb_sign(int argc, char *arg
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "No private key specified, use --private-key=.");
 
-        assert(!strv_isempty(arg_banks));
-        assert(!strv_isempty(arg_phase));
+        assert(!sd_strv_isempty(arg_banks));
+        assert(!sd_strv_isempty(arg_phase));
 
         if (arg_append) {
                 r = json_parse_file(NULL, arg_append, 0, &v, NULL, NULL);
diff '--color=auto' -Nurp a/src/busctl/busctl.c b/src/busctl/busctl.c
--- a/src/busctl/busctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/busctl/busctl.c	2025-06-30 18:37:25.000000000 +0000
@@ -64,7 +64,7 @@ static bool arg_watch_bind = false;
 static usec_t arg_timeout = 0;
 static const char *arg_destination = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_matches, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_matches, sd_strv_freep);
 
 #define NAME_IS_ACQUIRED INT_TO_PTR(1)
 #define NAME_IS_ACTIVATABLE INT_TO_PTR(2)
@@ -160,7 +160,7 @@ static int acquire_bus(bool set_monitor,
 }
 
 static int list_bus_names(int argc, char **argv, void *userdata) {
-        _cleanup_strv_free_ char **acquired = NULL, **activatable = NULL;
+        _cleanup_sd_strv_free_ char **acquired = NULL, **activatable = NULL;
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
         _cleanup_hashmap_free_ Hashmap *names = NULL;
         _cleanup_(table_unrefp) Table *table = NULL;
@@ -426,7 +426,7 @@ static void print_subtree(const char *pr
 static void print_tree(char **l) {
         if (arg_list)
                 strv_print(l);
-        else if (strv_isempty(l))
+        else if (sd_strv_isempty(l))
                 printf("No objects discovered.\n");
         else if (streq(l[0], "/") && !l[1])
                 printf("Only root object discovered.\n");
@@ -536,7 +536,7 @@ static int tree(int argc, char **argv, v
                 return r;
 
         if (argc <= 1) {
-                _cleanup_strv_free_ char **names = NULL;
+                _cleanup_sd_strv_free_ char **names = NULL;
                 bool not_first = false;
 
                 r = sd_bus_list_names(bus, &names, NULL);
@@ -2463,7 +2463,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_MATCH:
-                        if (strv_extend(&arg_matches, optarg) < 0)
+                        if (sd_strv_extend(&arg_matches, optarg) < 0)
                                 return log_oom();
                         break;
 
diff '--color=auto' -Nurp a/src/busctl/test-busctl-introspect.c b/src/busctl/test-busctl-introspect.c
--- a/src/busctl/test-busctl-introspect.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/busctl/test-busctl-introspect.c	2025-06-30 18:36:07.000000000 +0000
@@ -317,7 +317,7 @@ TEST(introspect_on_path) {
         static const XMLIntrospectOps ops = {
                 .on_path = on_path,
         };
-        _cleanup_strv_free_ char **expected = NULL;
+        _cleanup_sd_strv_free_ char **expected = NULL;
         _cleanup_set_free_ Set *paths = NULL;
         _cleanup_free_ char **l = NULL;
 
@@ -346,15 +346,15 @@ TEST(introspect_on_path) {
         assert_se(l = set_get_strv(paths));
         strv_sort(l);
 
-        assert_se(strv_extend(&expected, "/") >= 0);
-        assert_se(strv_extend(&expected, "/org") >= 0);
-        assert_se(strv_extend(&expected, "/org/freedesktop") >= 0);
-        assert_se(strv_extend(&expected, "/org/freedesktop/LogControl1") >= 0);
-        assert_se(strv_extend(&expected, "/org/freedesktop/network1") >= 0);
-        assert_se(strv_extend(&expected, "/org/freedesktop/network1/network") >= 0);
+        assert_se(sd_strv_extend(&expected, "/") >= 0);
+        assert_se(sd_strv_extend(&expected, "/org") >= 0);
+        assert_se(sd_strv_extend(&expected, "/org/freedesktop") >= 0);
+        assert_se(sd_strv_extend(&expected, "/org/freedesktop/LogControl1") >= 0);
+        assert_se(sd_strv_extend(&expected, "/org/freedesktop/network1") >= 0);
+        assert_se(sd_strv_extend(&expected, "/org/freedesktop/network1/network") >= 0);
         for (unsigned i = 0; i <= 20; i++) {
-                assert_se(strv_extendf(&expected, "/org/freedesktop/network1/network/%u", i) >= 0);
-                assert_se(strv_extendf(&expected, "/org/freedesktop/network1/network/%u/hoge", i) >= 0);
+                assert_se(sd_sd_strv_extendf(&expected, "/org/freedesktop/network1/network/%u", i) >= 0);
+                assert_se(sd_sd_strv_extendf(&expected, "/org/freedesktop/network1/network/%u/hoge", i) >= 0);
         }
 
         strv_sort(expected);
diff '--color=auto' -Nurp a/src/cgls/cgls.c b/src/cgls/cgls.c
--- a/src/cgls/cgls.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/cgls/cgls.c	2025-06-30 18:36:23.000000000 +0000
@@ -116,19 +116,19 @@ static int parse_argv(int argc, char *ar
 
                 case 'u':
                         arg_show_unit = SHOW_UNIT_SYSTEM;
-                        if (strv_push(&arg_names, optarg) < 0) /* push optarg if not empty */
+                        if (sd_strv_push(&arg_names, optarg) < 0) /* push optarg if not empty */
                                 return log_oom();
                         break;
 
                 case ARG_USER_UNIT:
                         arg_show_unit = SHOW_UNIT_USER;
-                        if (strv_push(&arg_names, optarg) < 0) /* push optarg if not empty */
+                        if (sd_strv_push(&arg_names, optarg) < 0) /* push optarg if not empty */
                                 return log_oom();
                         break;
 
                 case 1:
                         /* positional argument */
-                        if (strv_push(&arg_names, optarg) < 0)
+                        if (sd_strv_push(&arg_names, optarg) < 0)
                                 return log_oom();
                         break;
 
diff '--color=auto' -Nurp a/src/core/cgroup.c b/src/core/cgroup.c
--- a/src/core/cgroup.c	2025-06-30 18:55:45.259159937 +0000
+++ b/src/core/cgroup.c	2025-06-30 18:37:25.000000000 +0000
@@ -443,14 +443,14 @@ int cgroup_context_copy(CGroupContext *d
         dst->ip_address_allow_reduced = src->ip_address_allow_reduced;
         dst->ip_address_deny_reduced = src->ip_address_deny_reduced;
 
-        if (!strv_isempty(src->ip_filters_ingress)) {
-                dst->ip_filters_ingress = strv_copy(src->ip_filters_ingress);
+        if (!sd_strv_isempty(src->ip_filters_ingress)) {
+                dst->ip_filters_ingress = sd_strv_copy(src->ip_filters_ingress);
                 if (!dst->ip_filters_ingress)
                         return -ENOMEM;
         }
 
-        if (!strv_isempty(src->ip_filters_egress)) {
-                dst->ip_filters_egress = strv_copy(src->ip_filters_egress);
+        if (!sd_strv_isempty(src->ip_filters_egress)) {
+                dst->ip_filters_egress = sd_strv_copy(src->ip_filters_egress);
                 if (!dst->ip_filters_egress)
                         return -ENOMEM;
         }
@@ -609,8 +609,8 @@ void cgroup_context_done(CGroupContext *
         c->ip_address_allow = set_free(c->ip_address_allow);
         c->ip_address_deny = set_free(c->ip_address_deny);
 
-        c->ip_filters_ingress = strv_free(c->ip_filters_ingress);
-        c->ip_filters_egress = strv_free(c->ip_filters_egress);
+        c->ip_filters_ingress = sd_strv_free(c->ip_filters_ingress);
+        c->ip_filters_egress = sd_strv_free(c->ip_filters_egress);
 
         while (c->bpf_foreign_programs)
                 cgroup_context_remove_bpf_foreign_program(c, c->bpf_foreign_programs);
diff '--color=auto' -Nurp a/src/core/dbus-cgroup.c b/src/core/dbus-cgroup.c
--- a/src/core/dbus-cgroup.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-cgroup.c	2025-06-30 18:37:56.000000000 +0000
@@ -659,7 +659,7 @@ static int bus_cgroup_set_transient_prop
                                 return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS, "%s= expects a normalized absolute path.", name);
 
                         if (!UNIT_WRITE_FLAGS_NOOP(flags) && !strv_contains(*filters, path)) {
-                                r = strv_extend(filters, path);
+                                r = sd_strv_extend(filters, path);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -675,7 +675,7 @@ static int bus_cgroup_set_transient_prop
                         FILE *f;
 
                         if (n == 0)
-                                *filters = strv_free(*filters);
+                                *filters = sd_strv_free(*filters);
 
                         unit_invalidate_cgroup_bpf(u);
 
@@ -2163,7 +2163,7 @@ int bus_cgroup_set_property(
         }
         if (streq(name, "RestrictNetworkInterfaces")) {
                 int is_allow_list;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_enter_container(message, 'r', "bas");
                 if (r < 0)
@@ -2184,7 +2184,7 @@ int bus_cgroup_set_property(
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
                         _cleanup_free_ char *joined = NULL;
 
-                        if (strv_isempty(l)) {
+                        if (sd_strv_isempty(l)) {
                                 c->restrict_network_interfaces_is_allow_list = false;
                                 c->restrict_network_interfaces = set_free_free(c->restrict_network_interfaces);
 
@@ -2209,7 +2209,7 @@ int bus_cgroup_set_property(
                                 }
                         }
 
-                        joined = strv_join(l, " ");
+                        joined = sd_strv_join(l, " ");
                         if (!joined)
                                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/core/dbus-execute.c b/src/core/dbus-execute.c
--- a/src/core/dbus-execute.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-execute.c	2025-06-30 18:48:33.000000000 +0000
@@ -179,7 +179,7 @@ static int property_get_syscall_filter(
                 sd_bus_error *error) {
 
         ExecContext *c = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(bus);
@@ -214,7 +214,7 @@ static int property_get_syscall_log(
                 sd_bus_error *error) {
 
         ExecContext *c = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(bus);
@@ -249,7 +249,7 @@ static int property_get_syscall_archs(
                 sd_bus_error *error) {
 
         ExecContext *c = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(bus);
@@ -327,7 +327,7 @@ static int property_get_address_families
                 sd_bus_error *error) {
 
         ExecContext *c = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(bus);
@@ -1166,7 +1166,7 @@ static int append_exec_command(sd_bus_me
 }
 
 static int append_exec_ex_command(sd_bus_message *reply, ExecCommand *c) {
-        _cleanup_strv_free_ char **ex_opts = NULL;
+        _cleanup_sd_strv_free_ char **ex_opts = NULL;
         int r;
 
         assert(reply);
@@ -1324,7 +1324,7 @@ int bus_set_transient_exec_command(
                 return r;
 
         while ((r = sd_bus_message_enter_container(message, 'r', ex_prop ? "sasas" : "sasb")) > 0) {
-                _cleanup_strv_free_ char **argv = NULL, **ex_opts = NULL;
+                _cleanup_sd_strv_free_ char **argv = NULL, **ex_opts = NULL;
                 const char *path;
                 int b;
 
@@ -1341,7 +1341,7 @@ int bus_set_transient_exec_command(
                 if (r < 0)
                         return r;
 
-                if (strv_isempty(argv))
+                if (sd_strv_isempty(argv))
                         return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS,
                                                  "\"%s\" argv cannot be empty", name);
 
@@ -1651,7 +1651,7 @@ int bus_exec_context_set_transient_prope
                 return bus_set_transient_unsigned(u, name, &c->log_ratelimit_burst, message, flags, error);
 
         if (streq(name, "LogFilterPatterns")) {
-                /* Use _cleanup_free_, not _cleanup_strv_free_, as we don't want the content of the strv
+                /* Use _cleanup_free_, not _cleanup_sd_strv_free_, as we don't want the content of the strv
                  * to be freed. */
                 _cleanup_free_ char **allow_list = NULL, **deny_list = NULL;
                 const char *pattern;
@@ -1671,7 +1671,7 @@ int bus_exec_context_set_transient_prope
                         if (r < 0)
                                 return r;
 
-                        r = strv_push(is_allowlist ? &allow_list : &deny_list, (char *)pattern);
+                        r = sd_strv_push(is_allowlist ? &allow_list : &deny_list, (char *)pattern);
                         if (r < 0)
                                 return r;
                 }
@@ -1683,7 +1683,7 @@ int bus_exec_context_set_transient_prope
                         return r;
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(allow_list) && strv_isempty(deny_list)) {
+                        if (sd_strv_isempty(allow_list) && sd_strv_isempty(deny_list)) {
                                 c->log_filter_allowed_patterns = set_free_free(c->log_filter_allowed_patterns);
                                 c->log_filter_denied_patterns = set_free_free(c->log_filter_denied_patterns);
                                 unit_write_settingf(u, flags, name, "%s=", name);
@@ -1872,7 +1872,7 @@ int bus_exec_context_set_transient_prope
 
         if (streq(name, "RestrictFileSystems")) {
                 int allow_list;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_enter_container(message, 'r', "bas");
                 if (r < 0)
@@ -1894,7 +1894,7 @@ int bus_exec_context_set_transient_prope
                         _cleanup_free_ char *joined = NULL;
                         FilesystemParseFlags invert_flag = allow_list ? 0 : FILESYSTEM_PARSE_INVERT;
 
-                        if (strv_isempty(l)) {
+                        if (sd_strv_isempty(l)) {
                                 c->restrict_filesystems_allow_list = false;
                                 c->restrict_filesystems = set_free_free(c->restrict_filesystems);
 
@@ -1917,7 +1917,7 @@ int bus_exec_context_set_transient_prope
                                         return r;
                         }
 
-                        joined = strv_join(l, " ");
+                        joined = sd_strv_join(l, " ");
                         if (!joined)
                                 return -ENOMEM;
 
@@ -1937,7 +1937,7 @@ int bus_exec_context_set_transient_prope
                 return bus_set_transient_path(u, name, &c->ipc_namespace_path, message, flags, error);
 
         if (streq(name, "SupplementaryGroups")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -1949,17 +1949,17 @@ int bus_exec_context_set_transient_prope
                                                          "Invalid supplementary group names");
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                c->supplementary_groups = strv_free(c->supplementary_groups);
+                        if (sd_strv_isempty(l)) {
+                                c->supplementary_groups = sd_strv_free(c->supplementary_groups);
                                 unit_write_settingf(u, flags, name, "%s=", name);
                         } else {
                                 _cleanup_free_ char *joined = NULL;
 
-                                r = strv_extend_strv(&c->supplementary_groups, l, true);
+                                r = sd_sd_strv_extend_strv(&c->supplementary_groups, l, true);
                                 if (r < 0)
                                         return r;
 
-                                joined = strv_join(c->supplementary_groups, " ");
+                                joined = sd_strv_join(c->supplementary_groups, " ");
                                 if (!joined)
                                         return -ENOMEM;
 
@@ -2294,7 +2294,7 @@ int bus_exec_context_set_transient_prope
 
         if (streq(name, "SystemCallFilter")) {
                 int allow_list;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_enter_container(message, 'r', "bas");
                 if (r < 0)
@@ -2316,7 +2316,7 @@ int bus_exec_context_set_transient_prope
                         _cleanup_free_ char *joined = NULL;
                         SeccompParseFlags invert_flag = allow_list ? 0 : SECCOMP_PARSE_INVERT;
 
-                        if (strv_isempty(l)) {
+                        if (sd_strv_isempty(l)) {
                                 c->syscall_allow_list = false;
                                 c->syscall_filter = hashmap_free(c->syscall_filter);
 
@@ -2367,7 +2367,7 @@ int bus_exec_context_set_transient_prope
                                         return r;
                         }
 
-                        joined = strv_join(l, " ");
+                        joined = sd_strv_join(l, " ");
                         if (!joined)
                                 return -ENOMEM;
 
@@ -2378,7 +2378,7 @@ int bus_exec_context_set_transient_prope
 
         } else if (streq(name, "SystemCallLog")) {
                 int allow_list;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_enter_container(message, 'r', "bas");
                 if (r < 0)
@@ -2400,7 +2400,7 @@ int bus_exec_context_set_transient_prope
                         _cleanup_free_ char *joined = NULL;
                         SeccompParseFlags invert_flag = allow_list ? 0 : SECCOMP_PARSE_INVERT;
 
-                        if (strv_isempty(l)) {
+                        if (sd_strv_isempty(l)) {
                                 c->syscall_log_allow_list = false;
                                 c->syscall_log = hashmap_free(c->syscall_log);
 
@@ -2429,7 +2429,7 @@ int bus_exec_context_set_transient_prope
                                         return r;
                         }
 
-                        joined = strv_join(l, " ");
+                        joined = sd_strv_join(l, " ");
                         if (!joined)
                                 return -ENOMEM;
 
@@ -2439,7 +2439,7 @@ int bus_exec_context_set_transient_prope
                 return 1;
 
         } else if (streq(name, "SystemCallArchitectures")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -2448,7 +2448,7 @@ int bus_exec_context_set_transient_prope
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
                         _cleanup_free_ char *joined = NULL;
 
-                        if (strv_isempty(l))
+                        if (sd_strv_isempty(l))
                                 c->syscall_archs = set_free(c->syscall_archs);
                         else
                                 STRV_FOREACH(s, l) {
@@ -2463,7 +2463,7 @@ int bus_exec_context_set_transient_prope
                                                 return r;
                                 }
 
-                        joined = strv_join(l, " ");
+                        joined = sd_strv_join(l, " ");
                         if (!joined)
                                 return -ENOMEM;
 
@@ -2473,7 +2473,7 @@ int bus_exec_context_set_transient_prope
                 return 1;
 
         } else if (streq(name, "RestrictAddressFamilies")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 int allow_list;
 
                 r = sd_bus_message_enter_container(message, 'r', "bas");
@@ -2495,7 +2495,7 @@ int bus_exec_context_set_transient_prope
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
                         _cleanup_free_ char *joined = NULL;
 
-                        if (strv_isempty(l)) {
+                        if (sd_strv_isempty(l)) {
                                 c->address_families_allow_list = allow_list;
                                 c->address_families = set_free(c->address_families);
 
@@ -2527,7 +2527,7 @@ int bus_exec_context_set_transient_prope
                                         set_remove(c->address_families, INT_TO_PTR(af));
                         }
 
-                        joined = strv_join(l, " ");
+                        joined = sd_strv_join(l, " ");
                         if (!joined)
                                 return -ENOMEM;
 
@@ -2913,7 +2913,7 @@ int bus_exec_context_set_transient_prope
 
         } else if (streq(name, "Environment")) {
 
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -2923,8 +2923,8 @@ int bus_exec_context_set_transient_prope
                         return sd_bus_error_set(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid environment block.");
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                c->environment = strv_free(c->environment);
+                        if (sd_strv_isempty(l)) {
+                                c->environment = sd_strv_free(c->environment);
                                 unit_write_setting(u, flags, name, "Environment=");
                         } else {
                                 _cleanup_free_ char *joined = NULL;
@@ -2938,7 +2938,7 @@ int bus_exec_context_set_transient_prope
                                 if (!e)
                                         return -ENOMEM;
 
-                                strv_free_and_replace(c->environment, e);
+                                sd_strv_free_and_replace(c->environment, e);
                                 unit_write_settingf(u, flags, name, "Environment=%s", joined);
                         }
                 }
@@ -2947,7 +2947,7 @@ int bus_exec_context_set_transient_prope
 
         } else if (streq(name, "UnsetEnvironment")) {
 
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -2957,8 +2957,8 @@ int bus_exec_context_set_transient_prope
                         return sd_bus_error_set(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid UnsetEnvironment= list.");
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                c->unset_environment = strv_free(c->unset_environment);
+                        if (sd_strv_isempty(l)) {
+                                c->unset_environment = sd_strv_free(c->unset_environment);
                                 unit_write_setting(u, flags, name, "UnsetEnvironment=");
                         } else {
                                 _cleanup_free_ char *joined = NULL;
@@ -2972,7 +2972,7 @@ int bus_exec_context_set_transient_prope
                                 if (!e)
                                         return -ENOMEM;
 
-                                strv_free_and_replace(c->unset_environment, e);
+                                sd_strv_free_and_replace(c->unset_environment, e);
                                 unit_write_settingf(u, flags, name, "UnsetEnvironment=%s", joined);
                         }
                 }
@@ -3015,7 +3015,7 @@ int bus_exec_context_set_transient_prope
         } else if (streq(name, "EnvironmentFiles")) {
                 _cleanup_(memstream_done) MemStream m = {};
                 _cleanup_free_ char *joined = NULL;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 FILE *f;
 
                 r = sd_bus_message_enter_container(message, 'a', "(sb)");
@@ -3066,7 +3066,7 @@ int bus_exec_context_set_transient_prope
 
                                 fprintf(f, "EnvironmentFile=%s\n", q);
 
-                                r = strv_consume(&l, TAKE_PTR(buf));
+                                r = sd_strv_consume(&l, TAKE_PTR(buf));
                                 if (r < 0)
                                         return r;
                         }
@@ -3083,11 +3083,11 @@ int bus_exec_context_set_transient_prope
                         return r;
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                c->environment_files = strv_free(c->environment_files);
+                        if (sd_strv_isempty(l)) {
+                                c->environment_files = sd_strv_free(c->environment_files);
                                 unit_write_setting(u, flags, name, "EnvironmentFile=");
                         } else {
-                                r = strv_extend_strv(&c->environment_files, l, true);
+                                r = sd_sd_strv_extend_strv(&c->environment_files, l, true);
                                 if (r < 0)
                                         return r;
 
@@ -3099,7 +3099,7 @@ int bus_exec_context_set_transient_prope
 
         } else if (streq(name, "PassEnvironment")) {
 
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -3109,13 +3109,13 @@ int bus_exec_context_set_transient_prope
                         return sd_bus_error_set(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid PassEnvironment= block.");
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                c->pass_environment = strv_free(c->pass_environment);
+                        if (sd_strv_isempty(l)) {
+                                c->pass_environment = sd_strv_free(c->pass_environment);
                                 unit_write_setting(u, flags, name, "PassEnvironment=");
                         } else {
                                 _cleanup_free_ char *joined = NULL;
 
-                                r = strv_extend_strv(&c->pass_environment, l, true);
+                                r = sd_sd_strv_extend_strv(&c->pass_environment, l, true);
                                 if (r < 0)
                                         return r;
 
@@ -3133,7 +3133,7 @@ int bus_exec_context_set_transient_prope
         } else if (STR_IN_SET(name, "ReadWriteDirectories", "ReadOnlyDirectories", "InaccessibleDirectories",
                               "ReadWritePaths", "ReadOnlyPaths", "InaccessiblePaths", "ExecPaths", "NoExecPaths",
                               "ExtensionDirectories")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 char ***dirs;
 
                 r = sd_bus_message_read_strv(message, &l);
@@ -3166,8 +3166,8 @@ int bus_exec_context_set_transient_prope
                         else /* "InaccessiblePaths" */
                                 dirs = &c->inaccessible_paths;
 
-                        if (strv_isempty(l)) {
-                                *dirs = strv_free(*dirs);
+                        if (sd_strv_isempty(l)) {
+                                *dirs = sd_strv_free(*dirs);
                                 unit_write_settingf(u, flags, name, "%s=", name);
                         } else {
                                 _cleanup_free_ char *joined = NULL;
@@ -3176,7 +3176,7 @@ int bus_exec_context_set_transient_prope
                                 if (!joined)
                                         return -ENOMEM;
 
-                                r = strv_extend_strv(dirs, l, true);
+                                r = sd_sd_strv_extend_strv(dirs, l, true);
                                 if (r < 0)
                                         return r;
 
@@ -3187,7 +3187,7 @@ int bus_exec_context_set_transient_prope
                 return 1;
 
         } else if (streq(name, "ExecSearchPath")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -3198,15 +3198,15 @@ int bus_exec_context_set_transient_prope
                                 return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid %s", name);
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                c->exec_search_path = strv_free(c->exec_search_path);
+                        if (sd_strv_isempty(l)) {
+                                c->exec_search_path = sd_strv_free(c->exec_search_path);
                                 unit_write_settingf(u, flags|UNIT_ESCAPE_SPECIFIERS, name, "ExecSearchPath=");
                         } else {
                                 _cleanup_free_ char *joined = NULL;
-                                r = strv_extend_strv(&c->exec_search_path, l, true);
+                                r = sd_sd_strv_extend_strv(&c->exec_search_path, l, true);
                                 if (r < 0)
                                         return r;
-                                joined = strv_join(c->exec_search_path, ":");
+                                joined = sd_strv_join(c->exec_search_path, ":");
                                 if (!joined)
                                         return log_oom();
                                 unit_write_settingf(u, flags|UNIT_ESCAPE_SPECIFIERS, name, "ExecSearchPath=%s", joined);
@@ -3216,7 +3216,7 @@ int bus_exec_context_set_transient_prope
                 return 1;
 
         } else if (STR_IN_SET(name, "RuntimeDirectory", "StateDirectory", "CacheDirectory", "LogsDirectory", "ConfigurationDirectory")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -3240,7 +3240,7 @@ int bus_exec_context_set_transient_prope
                         assert_se((i = exec_directory_type_from_string(name)) >= 0);
                         d = c->directories + i;
 
-                        if (strv_isempty(l)) {
+                        if (sd_strv_isempty(l)) {
                                 exec_directory_done(d);
                                 unit_write_settingf(u, flags, name, "%s=", name);
                         } else {
diff '--color=auto' -Nurp a/src/core/dbus-job.c b/src/core/dbus-job.c
--- a/src/core/dbus-job.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-job.c	2025-06-30 18:37:25.000000000 +0000
@@ -159,7 +159,7 @@ static int bus_job_find(sd_bus *bus, con
 }
 
 static int bus_job_enumerate(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = userdata;
         unsigned k = 0;
         Job *j;
@@ -336,14 +336,14 @@ static int bus_job_allocate_bus_track(Jo
 }
 
 int bus_job_coldplug_bus_track(Job *j) {
-        _cleanup_strv_free_ char **deserialized_clients = NULL;
+        _cleanup_sd_strv_free_ char **deserialized_clients = NULL;
         int r;
 
         assert(j);
 
         deserialized_clients = TAKE_PTR(j->deserialized_clients);
 
-        if (strv_isempty(deserialized_clients))
+        if (sd_strv_isempty(deserialized_clients))
                 return 0;
 
         if (!j->manager->api_bus)
diff '--color=auto' -Nurp a/src/core/dbus-manager.c b/src/core/dbus-manager.c
--- a/src/core/dbus-manager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-manager.c	2025-06-30 18:37:25.000000000 +0000
@@ -216,7 +216,7 @@ static int property_get_environment(
                 void *userdata,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = ASSERT_PTR(userdata);
         int r;
 
@@ -909,7 +909,7 @@ static int method_list_units_by_names(sd
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         Manager *m = ASSERT_PTR(userdata);
         int r;
-        _cleanup_strv_free_ char **units = NULL;
+        _cleanup_sd_strv_free_ char **units = NULL;
 
         assert(message);
 
@@ -1218,13 +1218,13 @@ static int list_units_filtered(sd_bus_me
                 if (k != u->id)
                         continue;
 
-                if (!strv_isempty(states) &&
+                if (!sd_strv_isempty(states) &&
                     !strv_contains(states, unit_load_state_to_string(u->load_state)) &&
                     !strv_contains(states, unit_active_state_to_string(unit_active_state(u))) &&
                     !strv_contains(states, unit_sub_state_to_string(u)))
                         continue;
 
-                if (!strv_isempty(patterns) &&
+                if (!sd_strv_isempty(patterns) &&
                     !strv_fnmatch_or_empty(patterns, u->id, FNM_NOESCAPE))
                         continue;
 
@@ -1245,7 +1245,7 @@ static int method_list_units(sd_bus_mess
 }
 
 static int method_list_units_filtered(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **states = NULL;
+        _cleanup_sd_strv_free_ char **states = NULL;
         int r;
 
         r = sd_bus_message_read_strv(message, &states);
@@ -1256,8 +1256,8 @@ static int method_list_units_filtered(sd
 }
 
 static int method_list_units_by_patterns(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **states = NULL;
-        _cleanup_strv_free_ char **patterns = NULL;
+        _cleanup_sd_strv_free_ char **states = NULL;
+        _cleanup_sd_strv_free_ char **patterns = NULL;
         int r;
 
         r = sd_bus_message_read_strv(message, &states);
@@ -1462,7 +1462,7 @@ static int dump_units_matching_patterns(
                 void *userdata,
                 sd_bus_error *error,
                 int (*reply)(sd_bus_message *, char *)) {
-        _cleanup_strv_free_ char **patterns = NULL;
+        _cleanup_sd_strv_free_ char **patterns = NULL;
         int r;
 
         r = sd_bus_message_read_strv(message, &patterns);
@@ -1911,7 +1911,7 @@ static int method_switch_root(sd_bus_mes
 }
 
 static int method_set_environment(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **plus = NULL;
+        _cleanup_sd_strv_free_ char **plus = NULL;
         Manager *m = ASSERT_PTR(userdata);
         int r;
 
@@ -1941,7 +1941,7 @@ static int method_set_environment(sd_bus
 }
 
 static int method_unset_environment(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **minus = NULL;
+        _cleanup_sd_strv_free_ char **minus = NULL;
         Manager *m = ASSERT_PTR(userdata);
         int r;
 
@@ -1973,7 +1973,7 @@ static int method_unset_environment(sd_b
 }
 
 static int method_unset_and_set_environment(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **minus = NULL, **plus = NULL;
+        _cleanup_sd_strv_free_ char **minus = NULL, **plus = NULL;
         Manager *m = ASSERT_PTR(userdata);
         int r;
 
@@ -2252,8 +2252,8 @@ static int method_list_unit_files(sd_bus
 }
 
 static int method_list_unit_files_by_patterns(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **states = NULL;
-        _cleanup_strv_free_ char **patterns = NULL;
+        _cleanup_sd_strv_free_ char **states = NULL;
+        _cleanup_sd_strv_free_ char **patterns = NULL;
         int r;
 
         r = sd_bus_message_read_strv(message, &states);
@@ -2445,7 +2445,7 @@ static int method_enable_unit_files_gene
                 bool carries_install_info,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         InstallChange *changes = NULL;
         size_t n_changes = 0;
         UnitFileFlags flags;
@@ -2520,7 +2520,7 @@ static int method_mask_unit_files(sd_bus
 
 static int method_preset_unit_files_with_mode(sd_bus_message *message, void *userdata, sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         InstallChange *changes = NULL;
         size_t n_changes = 0;
         Manager *m = ASSERT_PTR(userdata);
@@ -2570,7 +2570,7 @@ static int method_disable_unit_files_gen
                 bool carries_install_info,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         InstallChange *changes = NULL;
         UnitFileFlags flags;
         size_t n_changes = 0;
@@ -2634,7 +2634,7 @@ static int method_unmask_unit_files(sd_b
 }
 
 static int method_revert_unit_files(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         InstallChange *changes = NULL;
         size_t n_changes = 0;
         Manager *m = ASSERT_PTR(userdata);
@@ -2735,7 +2735,7 @@ static int method_preset_all_unit_files(
 }
 
 static int method_add_dependency_unit_files(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = ASSERT_PTR(userdata);
         InstallChange *changes = NULL;
         size_t n_changes = 0;
diff '--color=auto' -Nurp a/src/core/dbus-socket.c b/src/core/dbus-socket.c
--- a/src/core/dbus-socket.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-socket.c	2025-06-30 18:37:56.000000000 +0000
@@ -318,7 +318,7 @@ static int bus_socket_set_transient_prop
                                                       message, flags, error);
 
         if (streq(name, "Symlinks")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -329,17 +329,17 @@ static int bus_socket_set_transient_prop
                                 return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS, "Symlink path is not absolute: %s", *p);
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                s->symlinks = strv_free(s->symlinks);
+                        if (sd_strv_isempty(l)) {
+                                s->symlinks = sd_strv_free(s->symlinks);
                                 unit_write_settingf(u, flags|UNIT_ESCAPE_SPECIFIERS, name, "%s=", name);
                         } else {
                                 _cleanup_free_ char *joined = NULL;
 
-                                r = strv_extend_strv(&s->symlinks, l, true);
+                                r = sd_sd_strv_extend_strv(&s->symlinks, l, true);
                                 if (r < 0)
                                         return -ENOMEM;
 
-                                joined = strv_join(l, " ");
+                                joined = sd_strv_join(l, " ");
                                 if (!joined)
                                         return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/core/dbus-unit.c b/src/core/dbus-unit.c
--- a/src/core/dbus-unit.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-unit.c	2025-06-30 18:37:25.000000000 +0000
@@ -2272,7 +2272,7 @@ static int bus_unit_set_transient_proper
                 return bus_set_transient_conditions(u, name, &u->asserts, false, message, flags, error);
 
         if (streq(name, "Documentation")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
@@ -2283,11 +2283,11 @@ static int bus_unit_set_transient_proper
                                 return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid URL in %s: %s", name, *p);
 
                 if (!UNIT_WRITE_FLAGS_NOOP(flags)) {
-                        if (strv_isempty(l)) {
-                                u->documentation = strv_free(u->documentation);
+                        if (sd_strv_isempty(l)) {
+                                u->documentation = sd_strv_free(u->documentation);
                                 unit_write_settingf(u, flags, name, "%s=", name);
                         } else {
-                                r = strv_extend_strv(&u->documentation, l, /* filter_duplicates= */ false);
+                                r = sd_sd_strv_extend_strv(&u->documentation, l, /* filter_duplicates= */ false);
                                 if (r < 0)
                                         return r;
 
@@ -2337,7 +2337,7 @@ static int bus_unit_set_transient_proper
                 return 1;
 
         } else if (STR_IN_SET(name, "RequiresMountsFor", "WantsMountsFor")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 r = sd_bus_message_read_strv(message, &l);
                 if (r < 0)
diff '--color=auto' -Nurp a/src/core/dbus-util.c b/src/core/dbus-util.c
--- a/src/core/dbus-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus-util.c	2025-06-30 18:33:49.000000000 +0000
@@ -260,7 +260,7 @@ int bus_property_get_activation_details(
                 sd_bus_error *error) {
 
         ActivationDetails **details = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **pairs = NULL;
+        _cleanup_sd_strv_free_ char **pairs = NULL;
         int r;
 
         assert(reply);
diff '--color=auto' -Nurp a/src/core/dbus.c b/src/core/dbus.c
--- a/src/core/dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/dbus.c	2025-06-30 18:37:25.000000000 +0000
@@ -444,7 +444,7 @@ static int bus_kill_context_find(sd_bus
 }
 
 static int bus_unit_enumerate(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = userdata;
         unsigned k = 0;
         Unit *u;
@@ -1070,7 +1070,7 @@ void bus_done(Manager *m) {
 
         assert(!m->subscribed);
 
-        m->deserialized_subscribed = strv_free(m->deserialized_subscribed);
+        m->deserialized_subscribed = sd_strv_free(m->deserialized_subscribed);
         m->polkit_registry = hashmap_free(m->polkit_registry);
 }
 
@@ -1165,7 +1165,7 @@ int bus_track_coldplug(Manager *m, sd_bu
         assert(m);
         assert(t);
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return 0;
 
         if (!m->api_bus)
diff '--color=auto' -Nurp a/src/core/device.c b/src/core/device.c
--- a/src/core/device.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/device.c	2025-06-30 18:37:42.000000000 +0000
@@ -140,7 +140,7 @@ static void device_done(Unit *u) {
 
         device_unset_sysfs(d);
         d->deserialized_sysfs = mfree(d->deserialized_sysfs);
-        d->wants_property = strv_free(d->wants_property);
+        d->wants_property = sd_strv_free(d->wants_property);
         d->path = mfree(d->path);
 }
 
@@ -530,7 +530,7 @@ static int device_update_description(Uni
 
 static int device_add_udev_wants(Unit *u, sd_device *dev) {
         Device *d = ASSERT_PTR(DEVICE(u));
-        _cleanup_strv_free_ char **added = NULL;
+        _cleanup_sd_strv_free_ char **added = NULL;
         const char *wants, *property;
         int r;
 
@@ -578,7 +578,7 @@ static int device_add_udev_wants(Unit *u
                 if (r < 0)
                         return log_unit_error_errno(u, r, "Failed to add Wants= dependency: %m");
 
-                r = strv_consume(&added, TAKE_PTR(k));
+                r = sd_strv_consume(&added, TAKE_PTR(k));
                 if (r < 0)
                         return log_oom();
         }
@@ -611,7 +611,7 @@ static int device_add_udev_wants(Unit *u
                                                     "Failed to enqueue %s job, ignoring: %s", property, bus_error_message(&error, r));
                 }
 
-        return strv_free_and_replace(d->wants_property, added);
+        return sd_strv_free_and_replace(d->wants_property, added);
 }
 
 static bool device_is_bound_by_mounts(Device *d, sd_device *dev) {
@@ -791,7 +791,7 @@ static int device_setup_devlink_unit_one
 }
 
 static int device_setup_extra_units(Manager *m, sd_device *dev, Set **ready_units, Set **not_ready_units) {
-        _cleanup_strv_free_ char **aliases = NULL;
+        _cleanup_sd_strv_free_ char **aliases = NULL;
         const char *syspath, *devname = NULL;
         Device *l;
         int r;
@@ -824,7 +824,7 @@ static int device_setup_extra_units(Mana
                 if (r < 0 && r != -ENOENT)
                         log_device_warning_errno(dev, r, "Failed to get SYSTEMD_ALIAS property, ignoring: %m");
                 if (r >= 0) {
-                        r = strv_split_full(&aliases, s, NULL, EXTRACT_UNQUOTE);
+                        r = sd_strv_split_full(&aliases, s, NULL, EXTRACT_UNQUOTE);
                         if (r < 0)
                                 log_device_warning_errno(dev, r, "Failed to parse SYSTEMD_ALIAS property, ignoring: %m");
                 }
diff '--color=auto' -Nurp a/src/core/exec-credential.c b/src/core/exec-credential.c
--- a/src/core/exec-credential.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/exec-credential.c	2025-06-30 18:37:56.000000000 +0000
@@ -234,7 +234,7 @@ typedef enum CredentialSearchPath {
 } CredentialSearchPath;
 
 static char **credential_search_path(const ExecParameters *params, CredentialSearchPath path) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(params);
         assert(path >= 0 && path < _CREDENTIAL_SEARCH_PATH_MAX);
@@ -244,23 +244,23 @@ static char **credential_search_path(con
          * credentials, we'll look in /etc/credstore.encrypted/ (and similar dirs). */
 
         if (IN_SET(path, CREDENTIAL_SEARCH_PATH_ENCRYPTED, CREDENTIAL_SEARCH_PATH_ALL)) {
-                if (strv_extend(&l, params->received_encrypted_credentials_directory) < 0)
+                if (sd_strv_extend(&l, params->received_encrypted_credentials_directory) < 0)
                         return NULL;
 
-                if (strv_extend_strv(&l, CONF_PATHS_STRV("credstore.encrypted"), /* filter_duplicates= */ true) < 0)
+                if (sd_sd_strv_extend_strv(&l, CONF_PATHS_STRV("credstore.encrypted"), /* filter_duplicates= */ true) < 0)
                         return NULL;
         }
 
         if (IN_SET(path, CREDENTIAL_SEARCH_PATH_TRUSTED, CREDENTIAL_SEARCH_PATH_ALL)) {
-                if (strv_extend(&l, params->received_credentials_directory) < 0)
+                if (sd_strv_extend(&l, params->received_credentials_directory) < 0)
                         return NULL;
 
-                if (strv_extend_strv(&l, CONF_PATHS_STRV("credstore"), /* filter_duplicates= */ true) < 0)
+                if (sd_sd_strv_extend_strv(&l, CONF_PATHS_STRV("credstore"), /* filter_duplicates= */ true) < 0)
                         return NULL;
         }
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *t = strv_join(l, ":");
+                _cleanup_free_ char *t = sd_strv_join(l, ":");
 
                 log_debug("Credential search path is: %s", strempty(t));
         }
@@ -408,7 +408,7 @@ static int load_credential(
                 uint64_t *left) {
 
         ReadFullFileFlags flags = READ_FULL_FILE_SECURE|READ_FULL_FILE_FAIL_WHEN_LARGER;
-        _cleanup_strv_free_ char **search_path = NULL;
+        _cleanup_sd_strv_free_ char **search_path = NULL;
         _cleanup_(erase_and_freep) char *data = NULL;
         _cleanup_free_ char *bindname = NULL;
         const char *source = NULL;
@@ -692,7 +692,7 @@ static int acquire_credentials(
                 if (r < 0)
                         return r;
 
-                search_path = strv_free(search_path);
+                search_path = sd_strv_free(search_path);
                 search_path = credential_search_path(params, CREDENTIAL_SEARCH_PATH_ENCRYPTED);
                 if (!search_path)
                         return -ENOMEM;
diff '--color=auto' -Nurp a/src/core/exec-invoke.c b/src/core/exec-invoke.c
--- a/src/core/exec-invoke.c	2025-06-30 18:55:45.427159933 +0000
+++ b/src/core/exec-invoke.c	2025-06-30 18:37:56.000000000 +0000
@@ -914,7 +914,7 @@ static int get_supplementary_groups(cons
                 keep_groups = true;
         }
 
-        if (strv_isempty(c->supplementary_groups))
+        if (sd_strv_isempty(c->supplementary_groups))
                 return 0;
 
         /*
@@ -1097,7 +1097,7 @@ static int setup_pam(
         };
 
         _cleanup_(barrier_destroy) Barrier barrier = BARRIER_NULL;
-        _cleanup_strv_free_ char **e = NULL;
+        _cleanup_sd_strv_free_ char **e = NULL;
         pam_handle_t *handle = NULL;
         sigset_t old_ss;
         int pam_code = PAM_SUCCESS, r;
@@ -1263,7 +1263,7 @@ static int setup_pam(
         if (!barrier_place_and_sync(&barrier))
                 log_error("PAM initialization failed");
 
-        return strv_free_and_replace(*env, e);
+        return sd_strv_free_and_replace(*env, e);
 
 fail:
         if (pam_code != PAM_SUCCESS) {
@@ -1800,7 +1800,7 @@ static int build_environment(
                 const char *memory_pressure_path,
                 char ***ret) {
 
-        _cleanup_strv_free_ char **our_env = NULL;
+        _cleanup_sd_strv_free_ char **our_env = NULL;
         size_t n_env = 0;
         char *x;
         int r;
@@ -1825,7 +1825,7 @@ static int build_environment(
                         return -ENOMEM;
                 our_env[n_env++] = x;
 
-                joined = strv_join(p->fd_names, ":");
+                joined = sd_strv_join(p->fd_names, ":");
                 if (!joined)
                         return -ENOMEM;
 
@@ -2055,7 +2055,7 @@ static int build_environment(
 }
 
 static int build_pass_environment(const ExecContext *c, char ***ret) {
-        _cleanup_strv_free_ char **pass_env = NULL;
+        _cleanup_sd_strv_free_ char **pass_env = NULL;
         size_t n_env = 0;
 
         STRV_FOREACH(i, c->pass_environment) {
@@ -2613,7 +2613,7 @@ static int compile_bind_mounts(
                 size_t *ret_n_bind_mounts,
                 char ***ret_empty_directories) {
 
-        _cleanup_strv_free_ char **empty_directories = NULL;
+        _cleanup_sd_strv_free_ char **empty_directories = NULL;
         BindMount *bind_mounts = NULL;
         size_t n, h = 0;
         int r;
@@ -2685,7 +2685,7 @@ static int compile_bind_mounts(
                         if (!private_root)
                                 return -ENOMEM;
 
-                        r = strv_consume(&empty_directories, private_root);
+                        r = sd_strv_consume(&empty_directories, private_root);
                         if (r < 0)
                                 return r;
                 }
@@ -2743,7 +2743,7 @@ static int compile_symlinks(
                 bool setup_os_release_symlink,
                 char ***ret_symlinks) {
 
-        _cleanup_strv_free_ char **symlinks = NULL;
+        _cleanup_sd_strv_free_ char **symlinks = NULL;
         int r;
 
         assert(context);
@@ -2762,7 +2762,7 @@ static int compile_symlinks(
                                 if (!src_abs || !dst_abs)
                                         return -ENOMEM;
 
-                                r = strv_consume_pair(&symlinks, TAKE_PTR(src_abs), TAKE_PTR(dst_abs));
+                                r = sd_strv_consume_pair(&symlinks, TAKE_PTR(src_abs), TAKE_PTR(dst_abs));
                                 if (r < 0)
                                         return r;
                         }
@@ -2780,7 +2780,7 @@ static int compile_symlinks(
                         if (!path)
                                 return -ENOMEM;
 
-                        r = strv_consume_pair(&symlinks, TAKE_PTR(private_path), TAKE_PTR(path));
+                        r = sd_strv_consume_pair(&symlinks, TAKE_PTR(private_path), TAKE_PTR(path));
                         if (r < 0)
                                 return r;
                 }
@@ -2790,7 +2790,7 @@ static int compile_symlinks(
          * absolute, when they are processed in namespace.c they will be made relative automatically, i.e.:
          * 'os-release -> .os-release-stage/os-release' is what will be created. */
         if (setup_os_release_symlink) {
-                r = strv_extend_many(
+                r = sd_strv_extend_many(
                                 &symlinks,
                                 "/run/host/.os-release-stage/os-release",
                                 "/run/host/os-release");
@@ -2829,7 +2829,7 @@ static bool insist_on_sandboxing(
         if (context->dynamic_user)
                 return true;
 
-        if (context->n_extension_images > 0 || !strv_isempty(context->extension_directories))
+        if (context->n_extension_images > 0 || !sd_strv_isempty(context->extension_directories))
                 return true;
 
         /* If there are any bind mounts set that don't map back onto themselves, fs namespacing becomes
@@ -3061,7 +3061,7 @@ static int apply_mount_namespace(
                 char **error_path) {
 
         _cleanup_(verity_settings_done) VeritySettings verity = VERITY_SETTINGS_DEFAULT;
-        _cleanup_strv_free_ char **empty_directories = NULL, **symlinks = NULL,
+        _cleanup_sd_strv_free_ char **empty_directories = NULL, **symlinks = NULL,
                         **read_write_paths_cleanup = NULL;
         _cleanup_free_ char *creds_path = NULL, *incoming_dir = NULL, *propagate_dir = NULL,
                 *extension_dir = NULL, *host_os_release_stage = NULL, *root_image = NULL, *root_dir = NULL;
@@ -3101,11 +3101,11 @@ static int apply_mount_namespace(
         /* We need to make the pressure path writable even if /sys/fs/cgroups is made read-only, as the
          * service will need to write to it in order to start the notifications. */
         if (context->protect_control_groups && memory_pressure_path && !streq(memory_pressure_path, "/dev/null")) {
-                read_write_paths_cleanup = strv_copy(context->read_write_paths);
+                read_write_paths_cleanup = sd_strv_copy(context->read_write_paths);
                 if (!read_write_paths_cleanup)
                         return -ENOMEM;
 
-                r = strv_extend(&read_write_paths_cleanup, memory_pressure_path);
+                r = sd_strv_extend(&read_write_paths_cleanup, memory_pressure_path);
                 if (r < 0)
                         return r;
 
@@ -3612,7 +3612,7 @@ static int acquire_home(const ExecContex
 }
 
 static int compile_suggested_paths(const ExecContext *c, const ExecParameters *p, char ***ret) {
-        _cleanup_strv_free_ char ** list = NULL;
+        _cleanup_sd_strv_free_ char ** list = NULL;
         int r;
 
         assert(c);
@@ -3642,7 +3642,7 @@ static int compile_suggested_paths(const
                         if (!e)
                                 return -ENOMEM;
 
-                        r = strv_consume(&list, e);
+                        r = sd_strv_consume(&list, e);
                         if (r < 0)
                                 return r;
                 }
@@ -3810,7 +3810,7 @@ static int collect_open_file_fds(const E
                 if (!GREEDY_REALLOC(p->fds, *n_fds + 1))
                         return -ENOMEM;
 
-                r = strv_extend(&p->fd_names, of->fdname);
+                r = sd_strv_extend(&p->fd_names, of->fdname);
                 if (r < 0)
                         return r;
 
@@ -3868,7 +3868,7 @@ static bool exec_context_need_unprivileg
                context->n_bind_mounts > 0 ||
                context->n_temporary_filesystems > 0 ||
                context->root_directory ||
-               !strv_isempty(context->extension_directories) ||
+               !sd_strv_isempty(context->extension_directories) ||
                context->protect_system != PROTECT_SYSTEM_NO ||
                context->protect_home != PROTECT_HOME_NO ||
                context->protect_kernel_tunables ||
@@ -3877,11 +3877,11 @@ static bool exec_context_need_unprivileg
                context->protect_control_groups ||
                context->protect_clock ||
                context->protect_hostname ||
-               !strv_isempty(context->read_write_paths) ||
-               !strv_isempty(context->read_only_paths) ||
-               !strv_isempty(context->inaccessible_paths) ||
-               !strv_isempty(context->exec_paths) ||
-               !strv_isempty(context->no_exec_paths);
+               !sd_strv_isempty(context->read_write_paths) ||
+               !sd_strv_isempty(context->read_only_paths) ||
+               !sd_strv_isempty(context->inaccessible_paths) ||
+               !sd_strv_isempty(context->exec_paths) ||
+               !sd_strv_isempty(context->no_exec_paths);
 }
 
 static bool exec_context_shall_confirm_spawn(const ExecContext *context) {
@@ -4028,7 +4028,7 @@ int exec_invoke(
                 const CGroupContext *cgroup_context,
                 int *exit_status) {
 
-        _cleanup_strv_free_ char **our_env = NULL, **pass_env = NULL, **joined_exec_search_path = NULL, **accum_env = NULL, **replaced_argv = NULL;
+        _cleanup_sd_strv_free_ char **our_env = NULL, **pass_env = NULL, **joined_exec_search_path = NULL, **accum_env = NULL, **replaced_argv = NULL;
         int r, ngids = 0;
         _cleanup_free_ gid_t *supplementary_gids = NULL;
         const char *username = NULL, *groupname = NULL;
@@ -4080,7 +4080,7 @@ int exec_invoke(
                 log_set_max_level(context->log_level_max);
 
         /* Explicitly test for CVE-2021-4034 inspired invocations */
-        if (!command->path || strv_isempty(command->argv)) {
+        if (!command->path || sd_strv_isempty(command->argv)) {
                 *exit_status = EXIT_EXEC;
                 return log_exec_error_errno(
                                 context,
@@ -4223,7 +4223,7 @@ int exec_invoke(
         }
 
         if (context->dynamic_user && runtime && runtime->dynamic_creds) {
-                _cleanup_strv_free_ char **suggested_paths = NULL;
+                _cleanup_sd_strv_free_ char **suggested_paths = NULL;
 
                 /* On top of that, make sure we bypass our own NSS module nss-systemd comprehensively for any NSS
                  * checks, if DynamicUser=1 is used, as we shouldn't create a feedback loop with ourselves here. */
@@ -4607,10 +4607,10 @@ int exec_invoke(
         /* The $PATH variable is set to the default path in params->environment. However, this is overridden
          * if user-specified fields have $PATH set. The intention is to also override $PATH if the unit does
          * not specify PATH but the unit has ExecSearchPath. */
-        if (!strv_isempty(context->exec_search_path)) {
+        if (!sd_strv_isempty(context->exec_search_path)) {
                 _cleanup_free_ char *joined = NULL;
 
-                joined = strv_join(context->exec_search_path, ":");
+                joined = sd_strv_join(context->exec_search_path, ":");
                 if (!joined) {
                         *exit_status = EXIT_MEMORY;
                         return log_oom();
@@ -5290,7 +5290,7 @@ int exec_invoke(
 
         }
 
-        if (!strv_isempty(context->unset_environment)) {
+        if (!sd_strv_isempty(context->unset_environment)) {
                 char **ee = NULL;
 
                 ee = strv_env_delete(accum_env, 1, context->unset_environment);
@@ -5299,11 +5299,11 @@ int exec_invoke(
                         return log_oom();
                 }
 
-                strv_free_and_replace(accum_env, ee);
+                sd_strv_free_and_replace(accum_env, ee);
         }
 
         if (!FLAGS_SET(command->flags, EXEC_COMMAND_NO_ENV_EXPAND)) {
-                _cleanup_strv_free_ char **unset_variables = NULL, **bad_variables = NULL;
+                _cleanup_sd_strv_free_ char **unset_variables = NULL, **bad_variables = NULL;
 
                 r = replace_env_argv(command->argv, accum_env, &replaced_argv, &unset_variables, &bad_variables);
                 if (r < 0) {
@@ -5315,16 +5315,16 @@ int exec_invoke(
                 }
                 final_argv = replaced_argv;
 
-                if (!strv_isempty(unset_variables)) {
-                        _cleanup_free_ char *ju = strv_join(unset_variables, ", ");
+                if (!sd_strv_isempty(unset_variables)) {
+                        _cleanup_free_ char *ju = sd_strv_join(unset_variables, ", ");
                         log_exec_warning(context,
                                          params,
                                          "Referenced but unset environment variable evaluates to an empty string: %s",
                                          strna(ju));
                 }
 
-                if (!strv_isempty(bad_variables)) {
-                        _cleanup_free_ char *jb = strv_join(bad_variables, ", ");
+                if (!sd_strv_isempty(bad_variables)) {
+                        _cleanup_free_ char *jb = sd_strv_join(bad_variables, ", ");
                         log_exec_warning(context,
                                          params,
                                          "Invalid environment variable name evaluates to an empty string: %s",
diff '--color=auto' -Nurp a/src/core/execute-serialize.c b/src/core/execute-serialize.c
--- a/src/core/execute-serialize.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/execute-serialize.c	2025-06-30 18:48:33.000000000 +0000
@@ -2902,7 +2902,7 @@ static int exec_context_deserialize(Exec
                                         if (r == 0)
                                                 break;
 
-                                        r = strv_consume(&c->directories[dt].items[c->directories[dt].n_items - 1].symlinks, TAKE_PTR(link));
+                                        r = sd_strv_consume(&c->directories[dt].items[c->directories[dt].n_items - 1].symlinks, TAKE_PTR(link));
                                         if (r < 0)
                                                 return r;
                                 }
diff '--color=auto' -Nurp a/src/core/execute.c b/src/core/execute.c
--- a/src/core/execute.c	2025-06-30 18:55:45.163159939 +0000
+++ b/src/core/execute.c	2025-06-30 18:37:25.000000000 +0000
@@ -206,11 +206,11 @@ bool exec_needs_mount_namespace(
         if (context->root_image)
                 return true;
 
-        if (!strv_isempty(context->read_write_paths) ||
-            !strv_isempty(context->read_only_paths) ||
-            !strv_isempty(context->inaccessible_paths) ||
-            !strv_isempty(context->exec_paths) ||
-            !strv_isempty(context->no_exec_paths))
+        if (!sd_strv_isempty(context->read_write_paths) ||
+            !sd_strv_isempty(context->read_only_paths) ||
+            !sd_strv_isempty(context->inaccessible_paths) ||
+            !sd_strv_isempty(context->exec_paths) ||
+            !sd_strv_isempty(context->no_exec_paths))
                 return true;
 
         if (context->n_bind_mounts > 0)
@@ -225,7 +225,7 @@ bool exec_needs_mount_namespace(
         if (context->n_extension_images > 0)
                 return true;
 
-        if (!strv_isempty(context->extension_directories))
+        if (!sd_strv_isempty(context->extension_directories))
                 return true;
 
         if (!IN_SET(context->mount_propagation_flag, 0, MS_SHARED))
@@ -528,10 +528,10 @@ void exec_context_init(ExecContext *c) {
 void exec_context_done(ExecContext *c) {
         assert(c);
 
-        c->environment = strv_free(c->environment);
-        c->environment_files = strv_free(c->environment_files);
-        c->pass_environment = strv_free(c->pass_environment);
-        c->unset_environment = strv_free(c->unset_environment);
+        c->environment = sd_strv_free(c->environment);
+        c->environment_files = sd_strv_free(c->environment_files);
+        c->pass_environment = sd_strv_free(c->pass_environment);
+        c->unset_environment = sd_strv_free(c->unset_environment);
 
         rlimit_free_all(c->rlimit);
 
@@ -552,22 +552,22 @@ void exec_context_done(ExecContext *c) {
         c->root_hash_sig_path = mfree(c->root_hash_sig_path);
         c->root_verity = mfree(c->root_verity);
         c->extension_images = mount_image_free_many(c->extension_images, &c->n_extension_images);
-        c->extension_directories = strv_free(c->extension_directories);
+        c->extension_directories = sd_strv_free(c->extension_directories);
         c->tty_path = mfree(c->tty_path);
         c->syslog_identifier = mfree(c->syslog_identifier);
         c->user = mfree(c->user);
         c->group = mfree(c->group);
 
-        c->supplementary_groups = strv_free(c->supplementary_groups);
+        c->supplementary_groups = sd_strv_free(c->supplementary_groups);
 
         c->pam_name = mfree(c->pam_name);
 
-        c->read_only_paths = strv_free(c->read_only_paths);
-        c->read_write_paths = strv_free(c->read_write_paths);
-        c->inaccessible_paths = strv_free(c->inaccessible_paths);
-        c->exec_paths = strv_free(c->exec_paths);
-        c->no_exec_paths = strv_free(c->no_exec_paths);
-        c->exec_search_path = strv_free(c->exec_search_path);
+        c->read_only_paths = sd_strv_free(c->read_only_paths);
+        c->read_write_paths = sd_strv_free(c->read_write_paths);
+        c->inaccessible_paths = sd_strv_free(c->inaccessible_paths);
+        c->exec_paths = sd_strv_free(c->exec_paths);
+        c->no_exec_paths = sd_strv_free(c->no_exec_paths);
+        c->exec_search_path = sd_strv_free(c->exec_search_path);
 
         bind_mount_free_many(c->bind_mounts, c->n_bind_mounts);
         c->bind_mounts = NULL;
@@ -679,7 +679,7 @@ void exec_command_done(ExecCommand *c) {
         assert(c);
 
         c->path = mfree(c->path);
-        c->argv = strv_free(c->argv);
+        c->argv = sd_strv_free(c->argv);
 }
 
 void exec_command_done_array(ExecCommand *c, size_t n) {
@@ -760,7 +760,7 @@ const char* exec_context_fdname(const Ex
 }
 
 static int exec_context_load_environment(const Unit *unit, const ExecContext *c, char ***ret) {
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
         int r;
 
         assert(c);
@@ -794,7 +794,7 @@ static int exec_context_load_environment
                 assert(pglob.gl_pathc > 0);
 
                 FOREACH_ARRAY(path, pglob.gl_pathv, pglob.gl_pathc) {
-                        _cleanup_strv_free_ char **p = NULL;
+                        _cleanup_sd_strv_free_ char **p = NULL;
 
                         r = load_env_file(NULL, *path, &p);
                         if (r < 0) {
@@ -820,7 +820,7 @@ static int exec_context_load_environment
                                 if (!m)
                                         return -ENOMEM;
 
-                                strv_free_and_replace(v, m);
+                                sd_strv_free_and_replace(v, m);
                         }
                 }
         }
@@ -878,7 +878,7 @@ static void strv_dump(FILE* f, const cha
         assert(prefix);
         assert(name);
 
-        if (!strv_isempty(strv)) {
+        if (!sd_strv_isempty(strv)) {
                 fprintf(f, "%s%s:", prefix, name);
                 strv_fprintf(f, strv);
                 fputs("\n", f);
@@ -1519,7 +1519,7 @@ int exec_context_get_clean_directories(
                 ExecCleanMask mask,
                 char ***ret) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(c);
@@ -1540,7 +1540,7 @@ int exec_context_get_clean_directories(
                         if (!j)
                                 return -ENOMEM;
 
-                        r = strv_consume(&l, j);
+                        r = sd_strv_consume(&l, j);
                         if (r < 0)
                                 return r;
 
@@ -1550,7 +1550,7 @@ int exec_context_get_clean_directories(
                                 if (!j)
                                         return -ENOMEM;
 
-                                r = strv_consume(&l, j);
+                                r = sd_strv_consume(&l, j);
                                 if (r < 0)
                                         return r;
                         }
@@ -1560,7 +1560,7 @@ int exec_context_get_clean_directories(
                                 if (!j)
                                         return -ENOMEM;
 
-                                r = strv_consume(&l, j);
+                                r = sd_strv_consume(&l, j);
                                 if (r < 0)
                                         return r;
                         }
@@ -1696,7 +1696,7 @@ bool exec_context_get_set_login_environm
 }
 
 char** exec_context_get_syscall_filter(const ExecContext *c) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(c);
 
@@ -1729,18 +1729,18 @@ char** exec_context_get_syscall_filter(c
                 } else
                         s = TAKE_PTR(name);
 
-                if (strv_consume(&l, s) < 0)
+                if (sd_strv_consume(&l, s) < 0)
                         return NULL;
         }
 
         strv_sort(l);
 #endif
 
-        return l ? TAKE_PTR(l) : strv_new(NULL);
+        return l ? TAKE_PTR(l) : sd_strv_new(NULL);
 }
 
 char** exec_context_get_syscall_archs(const ExecContext *c) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(c);
 
@@ -1753,18 +1753,18 @@ char** exec_context_get_syscall_archs(co
                 if (!name)
                         continue;
 
-                if (strv_extend(&l, name) < 0)
+                if (sd_strv_extend(&l, name) < 0)
                         return NULL;
         }
 
         strv_sort(l);
 #endif
 
-        return l ? TAKE_PTR(l) : strv_new(NULL);
+        return l ? TAKE_PTR(l) : sd_strv_new(NULL);
 }
 
 char** exec_context_get_syscall_log(const ExecContext *c) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(c);
 
@@ -1777,18 +1777,18 @@ char** exec_context_get_syscall_log(cons
                 if (!name)
                         continue;
 
-                if (strv_consume(&l, name) < 0)
+                if (sd_strv_consume(&l, name) < 0)
                         return NULL;
         }
 
         strv_sort(l);
 #endif
 
-        return l ? TAKE_PTR(l) : strv_new(NULL);
+        return l ? TAKE_PTR(l) : sd_strv_new(NULL);
 }
 
 char** exec_context_get_address_families(const ExecContext *c) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         void *af;
 
         assert(c);
@@ -1800,17 +1800,17 @@ char** exec_context_get_address_families
                 if (!name)
                         continue;
 
-                if (strv_extend(&l, name) < 0)
+                if (sd_strv_extend(&l, name) < 0)
                         return NULL;
         }
 
         strv_sort(l);
 
-        return l ? TAKE_PTR(l) : strv_new(NULL);
+        return l ? TAKE_PTR(l) : sd_strv_new(NULL);
 }
 
 char** exec_context_get_restrict_filesystems(const ExecContext *c) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(c);
 
@@ -1822,7 +1822,7 @@ char** exec_context_get_restrict_filesys
         strv_sort(l);
 #endif
 
-        return l ? TAKE_PTR(l) : strv_new(NULL);
+        return l ? TAKE_PTR(l) : sd_strv_new(NULL);
 }
 
 void exec_status_start(ExecStatus *s, pid_t pid, const dual_timestamp *ts) {
@@ -1978,7 +1978,7 @@ int exec_command_set(ExecCommand *c, con
         assert(path);
 
         va_start(ap, path);
-        l = strv_new_ap(path, ap);
+        l = sd_strv_new_ap(path, ap);
         va_end(ap);
 
         if (!l)
@@ -1986,17 +1986,17 @@ int exec_command_set(ExecCommand *c, con
 
         p = strdup(path);
         if (!p) {
-                strv_free(l);
+                sd_strv_free(l);
                 return -ENOMEM;
         }
 
         free_and_replace(c->path, p);
 
-        return strv_free_and_replace(c->argv, l);
+        return sd_strv_free_and_replace(c->argv, l);
 }
 
 int exec_command_append(ExecCommand *c, const char *path, ...) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         va_list ap;
         int r;
 
@@ -2004,13 +2004,13 @@ int exec_command_append(ExecCommand *c,
         assert(path);
 
         va_start(ap, path);
-        l = strv_new_ap(path, ap);
+        l = sd_strv_new_ap(path, ap);
         va_end(ap);
 
         if (!l)
                 return -ENOMEM;
 
-        r = strv_extend_strv(&c->argv, l, false);
+        r = sd_sd_strv_extend_strv(&c->argv, l, false);
         if (r < 0)
                 return r;
 
@@ -2561,9 +2561,9 @@ void exec_params_shallow_clear(ExecParam
         /* This is called on the PID1 side, as many of the struct's FDs are only borrowed, and actually
          * owned by the manager or other objects, and reused across multiple units. */
 
-        p->environment = strv_free(p->environment);
-        p->fd_names = strv_free(p->fd_names);
-        p->files_env = strv_free(p->files_env);
+        p->environment = sd_strv_free(p->environment);
+        p->fd_names = sd_strv_free(p->fd_names);
+        p->files_env = sd_strv_free(p->files_env);
         p->fds = mfree(p->fds);
         p->exec_fd = safe_close(p->exec_fd);
         p->user_lookup_fd = -EBADF;
@@ -2618,7 +2618,7 @@ void exec_directory_done(ExecDirectory *
 
         FOREACH_ARRAY(i, d->items, d->n_items) {
                 free(i->path);
-                strv_free(i->symlinks);
+                sd_strv_free(i->symlinks);
         }
 
         d->items = mfree(d->items);
@@ -2638,7 +2638,7 @@ static ExecDirectoryItem *exec_directory
 }
 
 int exec_directory_add(ExecDirectory *d, const char *path, const char *symlink) {
-        _cleanup_strv_free_ char **s = NULL;
+        _cleanup_sd_strv_free_ char **s = NULL;
         _cleanup_free_ char *p = NULL;
         ExecDirectoryItem *existing;
         int r;
@@ -2648,7 +2648,7 @@ int exec_directory_add(ExecDirectory *d,
 
         existing = exec_directory_find(d, path);
         if (existing) {
-                r = strv_extend(&existing->symlinks, symlink);
+                r = sd_strv_extend(&existing->symlinks, symlink);
                 if (r < 0)
                         return r;
 
@@ -2660,7 +2660,7 @@ int exec_directory_add(ExecDirectory *d,
                 return -ENOMEM;
 
         if (symlink) {
-                s = strv_new(symlink);
+                s = sd_strv_new(symlink);
                 if (!s)
                         return -ENOMEM;
         }
diff '--color=auto' -Nurp a/src/core/job.c b/src/core/job.c
--- a/src/core/job.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/job.c	2025-06-30 18:35:42.000000000 +0000
@@ -124,7 +124,7 @@ Job* job_free(Job *j) {
         job_unlink(j);
 
         sd_bus_track_unref(j->bus_track);
-        strv_free(j->deserialized_clients);
+        sd_strv_free(j->deserialized_clients);
 
         activation_details_unref(j->activation_details);
 
@@ -1315,7 +1315,7 @@ int job_deserialize(Job *j, FILE *f) {
                         (void) deserialize_usec(v, &j->begin_running_usec);
 
                 else if (streq(l, "subscribed")) {
-                        if (strv_extend(&j->deserialized_clients, v) < 0)
+                        if (sd_strv_extend(&j->deserialized_clients, v) < 0)
                                 return log_oom();
 
                 } else if (startswith(l, "activation-details")) {
diff '--color=auto' -Nurp a/src/core/load-dropin.c b/src/core/load-dropin.c
--- a/src/core/load-dropin.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/load-dropin.c	2025-06-30 18:35:42.000000000 +0000
@@ -12,7 +12,7 @@
 #include "unit.h"
 
 static int process_deps(Unit *u, UnitDependency dependency, const char *dir_suffix) {
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         int r;
 
         r = unit_file_find_dropin_paths(NULL,
@@ -83,7 +83,7 @@ static int process_deps(Unit *u, UnitDep
 }
 
 int unit_load_dropin(Unit *u) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(u);
@@ -109,7 +109,7 @@ int unit_load_dropin(Unit *u) {
         if (!u->dropin_paths)
                 u->dropin_paths = TAKE_PTR(l);
         else {
-                r = strv_extend_strv(&u->dropin_paths, l, true);
+                r = sd_sd_strv_extend_strv(&u->dropin_paths, l, true);
                 if (r < 0)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/core/load-fragment.c b/src/core/load-fragment.c
--- a/src/core/load-fragment.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/load-fragment.c	2025-06-30 18:48:33.000000000 +0000
@@ -480,7 +480,7 @@ int config_parse_colon_separated_paths(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *sv = strv_free(*sv);
+                *sv = sd_strv_free(*sv);
                 return 0;
         }
 
@@ -508,7 +508,7 @@ int config_parse_colon_separated_paths(
                 if (r < 0)
                         return 0;
 
-                r = strv_consume(sv, TAKE_PTR(k));
+                r = sd_strv_consume(sv, TAKE_PTR(k));
                 if (r < 0)
                         return log_oom();
         }
@@ -537,7 +537,7 @@ int config_parse_unit_path_strv_printf(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *x = strv_free(*x);
+                *x = sd_strv_free(*x);
                 return 0;
         }
 
@@ -566,7 +566,7 @@ int config_parse_unit_path_strv_printf(
                 if (r < 0)
                         return 0;
 
-                r = strv_consume(x, TAKE_PTR(k));
+                r = sd_strv_consume(x, TAKE_PTR(k));
                 if (r < 0)
                         return log_oom();
         }
@@ -1002,10 +1002,10 @@ int config_parse_exec(
                         return ignore ? 0 : -ENOEXEC;
                 }
 
-                _cleanup_strv_free_ char **args = NULL;
+                _cleanup_sd_strv_free_ char **args = NULL;
 
                 if (!separate_argv0)
-                        if (strv_extend(&args, path) < 0)
+                        if (sd_strv_extend(&args, path) < 0)
                                 return log_oom();
 
                 while (!isempty(p)) {
@@ -1025,7 +1025,7 @@ int config_parse_exec(
                                 p += 2;
                                 p = skip_leading_chars(p, /* bad = */ NULL);
 
-                                if (strv_extend(&args, ";") < 0)
+                                if (sd_strv_extend(&args, ";") < 0)
                                         return log_oom();
 
                                 continue;
@@ -1045,11 +1045,11 @@ int config_parse_exec(
                                 return ignore ? 0 : -ENOEXEC;
                         }
 
-                        if (strv_consume(&args, TAKE_PTR(resolved)) < 0)
+                        if (sd_strv_consume(&args, TAKE_PTR(resolved)) < 0)
                                 return log_oom();
                 }
 
-                if (strv_isempty(args)) {
+                if (sd_strv_isempty(args)) {
                         log_syntax(unit, ignore ? LOG_WARNING : LOG_ERR, filename, line, 0,
                                    "Empty executable name or zeroeth argument%s: %s",
                                    ignore ? ", ignoring" : "", rvalue);
@@ -1616,7 +1616,7 @@ int config_parse_root_image_options(
                 void *userdata) {
 
         _cleanup_(mount_options_free_allp) MountOptions *options = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         ExecContext *c = ASSERT_PTR(data);
         const Unit *u = userdata;
         int r;
@@ -1630,7 +1630,7 @@ int config_parse_root_image_options(
                 return 0;
         }
 
-        r = strv_split_colon_pairs(&l, rvalue);
+        r = sd_strv_split_colon_pairs(&l, rvalue);
         if (r == -ENOMEM)
                 return log_oom();
         if (r < 0) {
@@ -2554,7 +2554,7 @@ int config_parse_user_group_strv_compat(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *users = strv_free(*users);
+                *users = sd_strv_free(*users);
                 return 0;
         }
 
@@ -2582,7 +2582,7 @@ int config_parse_user_group_strv_compat(
                         return -ENOEXEC;
                 }
 
-                r = strv_push(users, k);
+                r = sd_strv_push(users, k);
                 if (r < 0)
                         return log_oom();
 
@@ -2673,7 +2673,7 @@ int config_parse_unit_env_file(const cha
 
         if (isempty(rvalue)) {
                 /* Empty assignment frees the list */
-                *env = strv_free(*env);
+                *env = sd_strv_free(*env);
                 return 0;
         }
 
@@ -2687,7 +2687,7 @@ int config_parse_unit_env_file(const cha
         if (r < 0)
                 return 0;
 
-        r = strv_push(env, n);
+        r = sd_strv_push(env, n);
         if (r < 0)
                 return log_oom();
 
@@ -2718,7 +2718,7 @@ int config_parse_environ(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *env = strv_free(*env);
+                *env = sd_strv_free(*env);
                 return 0;
         }
 
@@ -2781,7 +2781,7 @@ int config_parse_pass_environ(
                 void *data,
                 void *userdata) {
 
-        _cleanup_strv_free_ char **n = NULL;
+        _cleanup_sd_strv_free_ char **n = NULL;
         const Unit *u = userdata;
         char*** passenv = ASSERT_PTR(data);
         size_t nlen = 0;
@@ -2793,7 +2793,7 @@ int config_parse_pass_environ(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *passenv = strv_free(*passenv);
+                *passenv = sd_strv_free(*passenv);
                 return 0;
         }
 
@@ -2835,7 +2835,7 @@ int config_parse_pass_environ(
         }
 
         if (n) {
-                r = strv_extend_strv(passenv, n, true);
+                r = sd_sd_strv_extend_strv(passenv, n, true);
                 if (r < 0)
                         return log_oom();
         }
@@ -2855,7 +2855,7 @@ int config_parse_unset_environ(
                 void *data,
                 void *userdata) {
 
-        _cleanup_strv_free_ char **n = NULL;
+        _cleanup_sd_strv_free_ char **n = NULL;
         char*** unsetenv = ASSERT_PTR(data);
         const Unit *u = userdata;
         size_t nlen = 0;
@@ -2867,7 +2867,7 @@ int config_parse_unset_environ(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *unsetenv = strv_free(*unsetenv);
+                *unsetenv = sd_strv_free(*unsetenv);
                 return 0;
         }
 
@@ -2909,7 +2909,7 @@ int config_parse_unset_environ(
         }
 
         if (n) {
-                r = strv_extend_strv(unsetenv, n, true);
+                r = sd_sd_strv_extend_strv(unsetenv, n, true);
                 if (r < 0)
                         return log_oom();
         }
@@ -3208,7 +3208,7 @@ int config_parse_documentation(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                u->documentation = strv_free(u->documentation);
+                u->documentation = sd_strv_free(u->documentation);
                 return 0;
         }
 
@@ -5081,7 +5081,7 @@ int config_parse_namespace_path_strv(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *sv = strv_free(*sv);
+                *sv = sd_strv_free(*sv);
                 return 0;
         }
 
@@ -5124,7 +5124,7 @@ int config_parse_namespace_path_strv(
                                  shall_prefix ? "+" : "",
                                  resolved);
 
-                r = strv_push(sv, joined);
+                r = sd_strv_push(sv, joined);
                 if (r < 0)
                         return log_oom();
 
@@ -5885,7 +5885,7 @@ int config_parse_ip_filter_bpf_progs(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *paths = strv_free(*paths);
+                *paths = sd_strv_free(*paths);
                 return 0;
         }
 
@@ -5902,7 +5902,7 @@ int config_parse_ip_filter_bpf_progs(
         if (strv_contains(*paths, resolved))
                 return 0;
 
-        r = strv_extend(paths, resolved);
+        r = sd_strv_extend(paths, resolved);
         if (r < 0)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/core/main.c b/src/core/main.c
--- a/src/core/main.c	2025-06-30 18:55:45.263159937 +0000
+++ b/src/core/main.c	2025-06-30 18:50:47.000000000 +0000
@@ -1,3 +1,4 @@
+
 /* SPDX-License-Identifier: LGPL-2.1-or-later */
 
 #include <errno.h>
@@ -174,26 +175,26 @@ static DEFINE_CONFIG_PARSE_ENUM_WITH_DEF
 
 static int manager_find_user_config_paths(char ***ret_files, char ***ret_dirs) {
         _cleanup_free_ char *base = NULL;
-        _cleanup_strv_free_ char **files = NULL, **dirs = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL, **dirs = NULL;
         int r;
 
         r = xdg_user_config_dir(&base, "/systemd");
         if (r < 0)
                 return r;
 
-        r = strv_extendf(&files, "%s/user.conf", base);
+        r = sd_sd_strv_extendf(&files, "%s/user.conf", base);
         if (r < 0)
                 return r;
 
-        r = strv_extend(&files, PKGSYSCONFDIR "/user.conf");
+        r = sd_strv_extend(&files, PKGSYSCONFDIR "/user.conf");
         if (r < 0)
                 return r;
 
-        r = strv_consume(&dirs, TAKE_PTR(base));
+        r = sd_strv_consume(&dirs, TAKE_PTR(base));
         if (r < 0)
                 return r;
 
-        r = strv_extend_strv(&dirs, CONF_PATHS_STRV("systemd"), false);
+        r = sd_sd_strv_extend_strv(&dirs, CONF_PATHS_STRV("systemd"), false);
         if (r < 0)
                 return r;
 
@@ -800,7 +801,7 @@ static int parse_config_file(void) {
                                 CONFIG_PARSE_WARN,
                                 /* userdata= */ NULL);
         else {
-                _cleanup_strv_free_ char **files = NULL, **dirs = NULL;
+                _cleanup_sd_strv_free_ char **files = NULL, **dirs = NULL;
                 int r;
 
                 assert(arg_runtime_scope == RUNTIME_SCOPE_USER);
@@ -1576,7 +1577,7 @@ static int become_shutdown(int objective
         char timeout[STRLEN("--timeout=") + DECIMAL_STR_MAX(usec_t) + STRLEN("us")],
              exit_code[STRLEN("--exit-code=") + DECIMAL_STR_MAX(uint8_t)];
 
-        _cleanup_strv_free_ char **env_block = NULL;
+        _cleanup_sd_strv_free_ char **env_block = NULL;
         _cleanup_free_ char *max_log_levels = NULL;
         usec_t watchdog_timer = 0;
         int r;
@@ -1653,18 +1654,18 @@ static int become_shutdown(int objective
 
         /* The environment block: */
 
-        env_block = strv_copy(environ);
+        env_block = sd_strv_copy(environ);
 
         /* Tell the binary how often to ping, ignore failure */
-        (void) strv_extendf(&env_block, "WATCHDOG_USEC="USEC_FMT, watchdog_timer);
+        (void) sd_sd_strv_extendf(&env_block, "WATCHDOG_USEC="USEC_FMT, watchdog_timer);
 
         /* Make sure that tools that look for $WATCHDOG_USEC (and might get started by the exitrd) don't get
          * confused by the variable, because the sd_watchdog_enabled() protocol uses the same variable for
          * the same purposes. */
-        (void) strv_extendf(&env_block, "WATCHDOG_PID=" PID_FMT, getpid_cached());
+        (void) sd_sd_strv_extendf(&env_block, "WATCHDOG_PID=" PID_FMT, getpid_cached());
 
         if (arg_watchdog_device)
-                (void) strv_extendf(&env_block, "WATCHDOG_DEVICE=%s", arg_watchdog_device);
+                (void) sd_sd_strv_extendf(&env_block, "WATCHDOG_DEVICE=%s", arg_watchdog_device);
 
         /* Avoid the creation of new processes forked by the kernel; at this
          * point, we will not listen to the signals anyway */
@@ -2675,8 +2676,8 @@ static void reset_arguments(void) {
         arg_watchdog_device = mfree(arg_watchdog_device);
         arg_watchdog_pretimeout_governor = mfree(arg_watchdog_pretimeout_governor);
 
-        arg_default_environment = strv_free(arg_default_environment);
-        arg_manager_environment = strv_free(arg_manager_environment);
+        arg_default_environment = sd_strv_free(arg_default_environment);
+        arg_manager_environment = sd_strv_free(arg_manager_environment);
 
         arg_capability_bounding_set = CAP_MASK_UNSET;
         arg_no_new_privs = false;
@@ -2931,11 +2932,11 @@ static bool early_skip_setup_check(int a
 static int save_env(void) {
         char **l;
 
-        l = strv_copy(environ);
+        l = sd_strv_copy(environ);
         if (!l)
                 return -ENOMEM;
 
-        strv_free_and_replace(saved_env, l);
+        sd_strv_free_and_replace(saved_env, l);
         return 0;
 }
 
@@ -3324,7 +3325,7 @@ finish:
         arg_serialization = safe_fclose(arg_serialization);
         fds = fdset_free(fds);
 
-        saved_env = strv_free(saved_env);
+        saved_env = sd_strv_free(saved_env);
 
 #if HAVE_VALGRIND_VALGRIND_H
         /* If we are PID 1 and running under valgrind, then let's exit
diff '--color=auto' -Nurp a/src/core/manager-serialize.c b/src/core/manager-serialize.c
--- a/src/core/manager-serialize.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/manager-serialize.c	2025-06-30 18:35:42.000000000 +0000
@@ -501,7 +501,7 @@ int manager_deserialize(Manager *m, FILE
                         (void) exec_shared_runtime_deserialize_one(m, val, fds);
                 else if ((val = startswith(l, "subscribed="))) {
 
-                        r = strv_extend(&m->deserialized_subscribed, val);
+                        r = sd_strv_extend(&m->deserialized_subscribed, val);
                         if (r < 0)
                                 return r;
                 } else if ((val = startswith(l, "varlink-server-socket-address="))) {
diff '--color=auto' -Nurp a/src/core/manager.c b/src/core/manager.c
--- a/src/core/manager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/manager.c	2025-06-30 18:37:56.000000000 +0000
@@ -662,7 +662,7 @@ static char** sanitize_environment(char
 int manager_default_environment(Manager *m) {
         assert(m);
 
-        m->transient_environment = strv_free(m->transient_environment);
+        m->transient_environment = sd_strv_free(m->transient_environment);
 
         if (MANAGER_IS_SYSTEM(m)) {
                 /* The system manager always starts with a clean environment for its children. It does not
@@ -674,7 +674,7 @@ int manager_default_environment(Manager
                 if (!path)
                         return log_oom();
 
-                if (strv_consume(&m->transient_environment, path) < 0)
+                if (sd_strv_consume(&m->transient_environment, path) < 0)
                         return log_oom();
 
                 /* Import locale variables LC_*= from configuration */
@@ -683,7 +683,7 @@ int manager_default_environment(Manager
                 /* The user manager passes its own environment along to its children, except for $PATH and
                  * session envs. */
 
-                m->transient_environment = strv_copy(environ);
+                m->transient_environment = sd_strv_copy(environ);
                 if (!m->transient_environment)
                         return log_oom();
 
@@ -1731,8 +1731,8 @@ Manager* manager_free(Manager *m) {
         free(m->notify_socket);
 
         lookup_paths_done(&m->lookup_paths);
-        strv_free(m->transient_environment);
-        strv_free(m->client_environment);
+        sd_strv_free(m->transient_environment);
+        sd_strv_free(m->client_environment);
 
         hashmap_free(m->cgroup_unit);
         manager_free_unit_name_maps(m);
@@ -2073,7 +2073,7 @@ int manager_startup(Manager *m, FILE *se
                 r = bus_track_coldplug(m, &m->subscribed, false, m->deserialized_subscribed);
                 if (r < 0)
                         log_warning_errno(r, "Failed to deserialized tracked clients, ignoring: %m");
-                m->deserialized_subscribed = strv_free(m->deserialized_subscribed);
+                m->deserialized_subscribed = sd_strv_free(m->deserialized_subscribed);
 
                 r = manager_varlink_init(m);
                 if (r < 0)
@@ -2626,7 +2626,7 @@ static bool manager_process_barrier_fd(c
 
         /* nothing else must be sent when using BARRIER=1 */
         if (strv_contains(tags, "BARRIER=1")) {
-                if (strv_length(tags) != 1)
+                if (sd_strv_length(tags) != 1)
                         log_warning("Extra notification messages sent with BARRIER=1, ignoring everything.");
                 else if (fdset_size(fds) != 1)
                         log_warning("Got incorrect number of fds with BARRIER=1, closing them.");
@@ -2658,7 +2658,7 @@ static void manager_invoke_notify_messag
                 UNIT_VTABLE(u)->notify_message(u, ucred, tags, fds);
 
         else if (DEBUG_LOGGING) {
-                _cleanup_free_ char *joined = strv_join(tags, ", ");
+                _cleanup_free_ char *joined = sd_strv_join(tags, ", ");
                 char buf[CELLESCAPE_DEFAULT_LENGTH];
 
                 log_unit_debug(u, "Got notification message from unexpected unit type, ignoring: %s",
@@ -2738,7 +2738,7 @@ static int manager_dispatch_notify_fd(sd
 
         struct cmsghdr *cmsg;
         struct ucred *ucred = NULL;
-        _cleanup_strv_free_ char **tags = NULL;
+        _cleanup_sd_strv_free_ char **tags = NULL;
         int r, *fd_array = NULL;
         size_t n_fds = 0;
         ssize_t n;
@@ -2809,7 +2809,7 @@ static int manager_dispatch_notify_fd(sd
 
         /* Make sure it's NUL-terminated, then parse it to obtain the tags list. */
         buf[n] = 0;
-        tags = strv_split_newlines(buf);
+        tags = sd_strv_split_newlines(buf);
         if (!tags) {
                 log_oom();
                 return 0;
@@ -3719,7 +3719,7 @@ int manager_reload(Manager *m) {
         manager_vacuum(m);
 
         /* Clean up deserialized tracked clients */
-        m->deserialized_subscribed = strv_free(m->deserialized_subscribed);
+        m->deserialized_subscribed = sd_strv_free(m->deserialized_subscribed);
 
         /* Consider the reload process complete now. */
         assert(m->n_reloading > 0);
@@ -3998,7 +3998,7 @@ static bool generator_path_any(const cha
 
 static int manager_run_environment_generators(Manager *m) {
         char **tmp = NULL; /* this is only used in the forked process, no cleanup here */
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         void* args[] = {
                 [STDOUT_GENERATE] = &tmp,
                 [STDOUT_COLLECT]  = &tmp,
@@ -4024,7 +4024,7 @@ static int manager_run_environment_gener
 }
 
 static int build_generator_environment(Manager *m, char ***ret) {
-        _cleanup_strv_free_ char **nl = NULL;
+        _cleanup_sd_strv_free_ char **nl = NULL;
         Virtualization v;
         ConfidentialVirtualization cv;
         int r;
@@ -4036,7 +4036,7 @@ static int build_generator_environment(M
          * adjust generated units to that. Let's pass down some bits of information that are easy for us to
          * determine (but a bit harder for generator scripts to determine), as environment variables. */
 
-        nl = strv_copy(m->transient_environment);
+        nl = sd_strv_copy(m->transient_environment);
         if (!nl)
                 return -ENOMEM;
 
@@ -4093,7 +4093,7 @@ static int build_generator_environment(M
 }
 
 static int manager_execute_generators(Manager *m, char **paths, bool remount_ro) {
-        _cleanup_strv_free_ char **ge = NULL;
+        _cleanup_sd_strv_free_ char **ge = NULL;
         const char *argv[] = {
                 NULL, /* Leave this empty, execute_directory() will fill something in */
                 m->lookup_paths.generator,
@@ -4131,7 +4131,7 @@ static int manager_execute_generators(Ma
 
 static int manager_run_generators(Manager *m) {
         ForkFlags flags = FORK_RESET_SIGNALS | FORK_WAIT | FORK_NEW_MOUNTNS | FORK_MOUNTNS_SLAVE;
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         int r;
 
         assert(m);
@@ -4202,7 +4202,7 @@ int manager_transient_environment_add(Ma
 
         assert(m);
 
-        if (strv_isempty(plus))
+        if (sd_strv_isempty(plus))
                 return 0;
 
         a = strv_env_merge(m->transient_environment, plus);
@@ -4211,7 +4211,7 @@ int manager_transient_environment_add(Ma
 
         sanitize_environment(a);
 
-        return strv_free_and_replace(m->transient_environment, a);
+        return sd_strv_free_and_replace(m->transient_environment, a);
 }
 
 int manager_client_environment_modify(
@@ -4223,12 +4223,12 @@ int manager_client_environment_modify(
 
         assert(m);
 
-        if (strv_isempty(minus) && strv_isempty(plus))
+        if (sd_strv_isempty(minus) && sd_strv_isempty(plus))
                 return 0;
 
         l = m->client_environment;
 
-        if (!strv_isempty(minus)) {
+        if (!sd_strv_isempty(minus)) {
                 a = strv_env_delete(l, 1, minus);
                 if (!a)
                         return -ENOMEM;
@@ -4236,10 +4236,10 @@ int manager_client_environment_modify(
                 l = a;
         }
 
-        if (!strv_isempty(plus)) {
+        if (!sd_strv_isempty(plus)) {
                 b = strv_env_merge(l, plus);
                 if (!b) {
-                        strv_free(a);
+                        sd_strv_free(a);
                         return -ENOMEM;
                 }
 
@@ -4247,12 +4247,12 @@ int manager_client_environment_modify(
         }
 
         if (m->client_environment != l)
-                strv_free(m->client_environment);
+                sd_strv_free(m->client_environment);
 
         if (a != l)
-                strv_free(a);
+                sd_strv_free(a);
         if (b != l)
-                strv_free(b);
+                sd_strv_free(b);
 
         m->client_environment = sanitize_environment(l);
         return 0;
diff '--color=auto' -Nurp a/src/core/mount.c b/src/core/mount.c
--- a/src/core/mount.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/mount.c	2025-06-30 18:37:25.000000000 +0000
@@ -1152,7 +1152,7 @@ static void mount_enter_mounting(Mount *
 
         /* If we are asked to create an OverlayFS, create the upper/work directories if they are missing */
         if (p && streq_ptr(p->fstype, "overlay")) {
-                _cleanup_strv_free_ char **dirs = NULL;
+                _cleanup_sd_strv_free_ char **dirs = NULL;
 
                 r = fstab_filter_options(
                                 p->options,
@@ -2284,7 +2284,7 @@ static PidRef* mount_control_pid(Unit *u
 }
 
 static int mount_clean(Unit *u, ExecCleanMask mask) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Mount *m = MOUNT(u);
         int r;
 
@@ -2298,7 +2298,7 @@ static int mount_clean(Unit *u, ExecClea
         if (r < 0)
                 return r;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return -EUNATCH;
 
         mount_unwatch_control_pid(m);
diff '--color=auto' -Nurp a/src/core/namespace.c b/src/core/namespace.c
--- a/src/core/namespace.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/namespace.c	2025-06-30 18:37:25.000000000 +0000
@@ -338,7 +338,7 @@ static void mount_entry_done(MountEntry
         p->unprefixed_path_malloc = mfree(p->unprefixed_path_malloc);
         p->source_malloc = mfree(p->source_malloc);
         p->options_malloc = mfree(p->options_malloc);
-        p->overlay_layers = strv_free(p->overlay_layers);
+        p->overlay_layers = sd_strv_free(p->overlay_layers);
 }
 
 static void mount_list_done(MountList *ml) {
@@ -479,12 +479,12 @@ static int append_extensions(
 
         assert(ml);
 
-        if (n == 0 && strv_isempty(extension_directories))
+        if (n == 0 && sd_strv_isempty(extension_directories))
                 return 0;
 
         assert(extension_dir);
 
-        n_overlays = strv_length(hierarchies);
+        n_overlays = sd_strv_length(hierarchies);
         if (n_overlays == 0)
                 return 0;
 
@@ -496,7 +496,7 @@ static int append_extensions(
         if (!overlays)
                 return -ENOMEM;
 
-        CLEANUP_ARRAY(overlays, n_overlays, strv_free_many);
+        CLEANUP_ARRAY(overlays, n_overlays, sd_strv_free_many);
 
         /* First, prepare a mount for each image, but these won't be visible to the unit, instead
          * they will be mounted in our propagate directory, and used as a source for the overlay. */
@@ -533,7 +533,7 @@ static int append_extensions(
                         if (!prefixed_hierarchy)
                                 return -ENOMEM;
 
-                        r = strv_consume(&overlays[j], TAKE_PTR(prefixed_hierarchy));
+                        r = sd_strv_consume(&overlays[j], TAKE_PTR(prefixed_hierarchy));
                         if (r < 0)
                                 return r;
                 }
@@ -598,7 +598,7 @@ static int append_extensions(
                         if (!prefixed_hierarchy)
                                 return -ENOMEM;
 
-                        r = strv_consume(&overlays[j], TAKE_PTR(prefixed_hierarchy));
+                        r = sd_strv_consume(&overlays[j], TAKE_PTR(prefixed_hierarchy));
                         if (r < 0)
                                 return r;
                 }
@@ -1574,7 +1574,7 @@ static int apply_one_mount(
         case MOUNT_EXTENSION_DIRECTORY: {
                 _cleanup_free_ char *host_os_release_id = NULL, *host_os_release_version_id = NULL,
                                 *host_os_release_level = NULL, *extension_name = NULL;
-                _cleanup_strv_free_ char **extension_release = NULL;
+                _cleanup_sd_strv_free_ char **extension_release = NULL;
                 ImageClass class = IMAGE_SYSEXT;
 
                 r = path_extract_filename(mount_entry_source(m), &extension_name);
@@ -2116,7 +2116,7 @@ int setup_namespace(const NamespaceParam
 
         _cleanup_(loop_device_unrefp) LoopDevice *loop_device = NULL;
         _cleanup_(dissected_image_unrefp) DissectedImage *dissected_image = NULL;
-        _cleanup_strv_free_ char **hierarchies = NULL;
+        _cleanup_sd_strv_free_ char **hierarchies = NULL;
         _cleanup_(mount_list_done) MountList ml = {};
         _cleanup_close_ int userns_fd = -EBADF;
         bool require_prefix = false;
@@ -2150,7 +2150,7 @@ int setup_namespace(const NamespaceParam
                     home_read_only(p->read_only_paths, p->inaccessible_paths, p->empty_directories,
                                    p->bind_mounts, p->n_bind_mounts, p->temporary_filesystems, p->n_temporary_filesystems,
                                    p->protect_home) &&
-                    strv_isempty(p->read_write_paths))
+                    sd_strv_isempty(p->read_write_paths))
                         dissect_image_flags |= DISSECT_IMAGE_READ_ONLY;
 
                 SET_FLAG(dissect_image_flags, DISSECT_IMAGE_NO_PARTITION_TABLE, p->verity && p->verity->data_path);
@@ -2228,7 +2228,7 @@ int setup_namespace(const NamespaceParam
                 require_prefix = true;
         }
 
-        if (p->n_extension_images > 0 || !strv_isempty(p->extension_directories)) {
+        if (p->n_extension_images > 0 || !sd_strv_isempty(p->extension_directories)) {
                 /* Hierarchy population needs to be done for sysext and confext extension images */
                 r = parse_env_extension_hierarchies(&hierarchies, "SYSTEMD_SYSEXT_AND_CONFEXT_HIERARCHIES");
                 if (r < 0)
@@ -2552,7 +2552,7 @@ int setup_namespace(const NamespaceParam
         if (setup_propagate)
                 (void) mkdir_p(p->propagate_dir, 0600);
 
-        if (p->n_extension_images > 0 || !strv_isempty(p->extension_directories))
+        if (p->n_extension_images > 0 || !sd_strv_isempty(p->extension_directories))
                 /* ExtensionImages/Directories mountpoint directories will be created while parsing the
                  * mounts to create, so have the parent ready */
                 (void) mkdir_p(p->extension_dir, 0600);
diff '--color=auto' -Nurp a/src/core/path.c b/src/core/path.c
--- a/src/core/path.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/path.c	2025-06-30 18:36:37.000000000 +0000
@@ -963,7 +963,7 @@ static int activation_details_path_appen
         if (!s)
                 return -ENOMEM;
 
-        r = strv_consume(strv, TAKE_PTR(s));
+        r = sd_strv_consume(strv, TAKE_PTR(s));
         if (r < 0)
                 return r;
 
@@ -979,7 +979,7 @@ static int activation_details_path_appen
         if (isempty(p->trigger_path_filename))
                 return 0;
 
-        r = strv_extend_many(strv, "trigger_path", p->trigger_path_filename);
+        r = sd_strv_extend_many(strv, "trigger_path", p->trigger_path_filename);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/core/scope.c b/src/core/scope.c
--- a/src/core/scope.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/scope.c	2025-06-30 18:35:42.000000000 +0000
@@ -155,7 +155,7 @@ static int scope_load_init_scope(Unit *u
         if (!u->description)
                 u->description = strdup("System and Service Manager");
         if (!u->documentation)
-                (void) strv_extend(&u->documentation, "man:systemd(1)");
+                (void) sd_strv_extend(&u->documentation, "man:systemd(1)");
 
         return 1;
 }
diff '--color=auto' -Nurp a/src/core/selinux-access.c b/src/core/selinux-access.c
--- a/src/core/selinux-access.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/selinux-access.c	2025-06-30 18:37:56.000000000 +0000
@@ -248,7 +248,7 @@ int mac_selinux_access_check_internal(
         }
 
         (void) sd_bus_creds_get_cmdline(creds, &cmdline);
-        cl = strv_join(cmdline, " ");
+        cl = sd_strv_join(cmdline, " ");
 
         struct audit_info audit_info = {
                 .creds = creds,
diff '--color=auto' -Nurp a/src/core/service.c b/src/core/service.c
--- a/src/core/service.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/service.c	2025-06-30 18:37:56.000000000 +0000
@@ -640,7 +640,7 @@ static int service_verify(Service *s) {
                                                             "Service %s= binary path \"%s\" is neither a valid executable name nor an absolute path. Refusing.",
                                                             command->path,
                                                             service_exec_command_to_string(c));
-                        if (strv_isempty(command->argv))
+                        if (sd_strv_isempty(command->argv))
                                 return log_unit_error_errno(UNIT(s), SYNTHETIC_ERRNO(ENOEXEC),
                                                             "Service has an empty argv in %s=. Refusing.",
                                                             service_exec_command_to_string(c));
@@ -1375,7 +1375,7 @@ static int service_collect_fds(
                 size_t *n_socket_fds,
                 size_t *n_storage_fds) {
 
-        _cleanup_strv_free_ char **rfd_names = NULL;
+        _cleanup_sd_strv_free_ char **rfd_names = NULL;
         _cleanup_free_ int *rfds = NULL;
         size_t rn_socket_fds = 0, rn_storage_fds = 0;
         int r;
@@ -1394,7 +1394,7 @@ static int service_collect_fds(
                 if (!rfds)
                         return -ENOMEM;
 
-                rfd_names = strv_new("connection");
+                rfd_names = sd_strv_new("connection");
                 if (!rfd_names)
                         return -ENOMEM;
 
@@ -1426,7 +1426,7 @@ static int service_collect_fds(
                         } else if (!GREEDY_REALLOC_APPEND(rfds, rn_socket_fds, cfds, cn_fds))
                                 return -ENOMEM;
 
-                        r = strv_extend_n(&rfd_names, socket_fdname(sock), cn_fds);
+                        r = sd_strv_extend_n(&rfd_names, socket_fdname(sock), cn_fds);
                         if (r < 0)
                                 return r;
                 }
@@ -1630,7 +1630,7 @@ static int service_spawn_internal(
 
         _cleanup_(exec_params_shallow_clear) ExecParameters exec_params = EXEC_PARAMETERS_INIT(flags);
         _cleanup_(sd_event_source_unrefp) sd_event_source *exec_fd_source = NULL;
-        _cleanup_strv_free_ char **final_env = NULL, **our_env = NULL;
+        _cleanup_sd_strv_free_ char **final_env = NULL, **our_env = NULL;
         _cleanup_(pidref_done) PidRef pidref = PIDREF_NULL;
         size_t n_env = 0;
         int r;
@@ -1807,7 +1807,7 @@ static int service_spawn_internal(
         SET_FLAG(exec_params.flags, EXEC_NSS_DYNAMIC_BYPASS,
                  MANAGER_IS_SYSTEM(UNIT(s)->manager) && unit_has_name(UNIT(s), SPECIAL_DBUS_SERVICE));
 
-        strv_free_and_replace(exec_params.environment, final_env);
+        sd_strv_free_and_replace(exec_params.environment, final_env);
         exec_params.watchdog_usec = service_get_watchdog_usec(s);
         exec_params.selinux_context_net = s->socket_fd_selinux_context_net;
         if (s->type == SERVICE_IDLE)
@@ -3042,7 +3042,7 @@ int service_deserialize_exec_command(
         ExecCommand *command = NULL;
         ServiceExecCommand id = _SERVICE_EXEC_COMMAND_INVALID;
         _cleanup_free_ char *path = NULL;
-        _cleanup_strv_free_ char **argv = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL;
         unsigned idx = 0, i;
         bool control, found = false, last = false;
         int r;
@@ -3098,7 +3098,7 @@ int service_deserialize_exec_command(
                         state = STATE_EXEC_COMMAND_ARGS;
                         break;
                 case STATE_EXEC_COMMAND_ARGS:
-                        r = strv_extend(&argv, arg);
+                        r = sd_strv_extend(&argv, arg);
                         if (r < 0)
                                 return r;
                         break;
@@ -3109,7 +3109,7 @@ int service_deserialize_exec_command(
 
         if (state != STATE_EXEC_COMMAND_ARGS)
                 return -EINVAL;
-        if (strv_isempty(argv))
+        if (sd_strv_isempty(argv))
                 return -EINVAL; /* At least argv[0] must be always present. */
 
         /* Let's check whether exec command on given offset matches data that we just deserialized */
@@ -4345,7 +4345,7 @@ static void service_notify_message(
                 return;
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *cc = strv_join(tags, ", ");
+                _cleanup_free_ char *cc = sd_strv_join(tags, ", ");
                 log_unit_debug(u, "Got notification message from PID "PID_FMT" (%s)", ucred->pid, empty_to_na(cc));
         }
 
@@ -4864,7 +4864,7 @@ static const char* service_status_text(U
 
 static int service_clean(Unit *u, ExecCleanMask mask) {
         Service *s = ASSERT_PTR(SERVICE(u));
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         bool may_clean_fdstore = false;
         int r;
 
@@ -4881,7 +4881,7 @@ static int service_clean(Unit *u, ExecCl
         if (mask & EXEC_CLEAN_FDSTORE)
                 may_clean_fdstore = s->n_fd_store > 0 || s->n_fd_store_max > 0;
 
-        if (strv_isempty(l) && !may_clean_fdstore)
+        if (sd_strv_isempty(l) && !may_clean_fdstore)
                 return -EUNATCH; /* Nothing to potentially clean */
 
         /* Let's clean the stuff we can clean quickly */
@@ -4889,7 +4889,7 @@ static int service_clean(Unit *u, ExecCl
                 service_release_fd_store(s);
 
         /* If we are done, leave quickly */
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 if (s->state == SERVICE_DEAD_RESOURCES_PINNED && !s->fd_store)
                         service_set_state(s, SERVICE_DEAD);
                 return 0;
@@ -5007,7 +5007,7 @@ int service_determine_exec_selinux_label
 
         if (s->exec_context.root_image ||
             s->exec_context.n_extension_images > 0 ||
-            !strv_isempty(s->exec_context.extension_directories)) /* We cannot chase paths through images */
+            !sd_strv_isempty(s->exec_context.extension_directories)) /* We cannot chase paths through images */
                 return log_unit_debug_errno(UNIT(s), SYNTHETIC_ERRNO(ENODATA), "Service with RootImage=, ExtensionImages= or ExtensionDirectories= set, cannot determine socket SELinux label before activation, ignoring.");
 
         ExecCommand *c = s->exec_command[SERVICE_EXEC_START];
diff '--color=auto' -Nurp a/src/core/slice.c b/src/core/slice.c
--- a/src/core/slice.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/slice.c	2025-06-30 18:37:06.000000000 +0000
@@ -119,7 +119,7 @@ static int slice_load_root_slice(Unit *u
         if (!u->description)
                 u->description = strdup("Root Slice");
         if (!u->documentation)
-                u->documentation = strv_new("man:systemd.special(7)");
+                u->documentation = sd_strv_new("man:systemd.special(7)");
 
         return 1;
 }
@@ -142,7 +142,7 @@ static int slice_load_system_slice(Unit
         if (!u->description)
                 u->description = strdup("System Slice");
         if (!u->documentation)
-                u->documentation = strv_new("man:systemd.special(7)");
+                u->documentation = sd_strv_new("man:systemd.special(7)");
 
         return 1;
 }
diff '--color=auto' -Nurp a/src/core/socket.c b/src/core/socket.c
--- a/src/core/socket.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/socket.c	2025-06-30 18:37:25.000000000 +0000
@@ -180,7 +180,7 @@ static void socket_done(Unit *u) {
         s->smack_ip_in = mfree(s->smack_ip_in);
         s->smack_ip_out = mfree(s->smack_ip_out);
 
-        strv_free(s->symlinks);
+        sd_strv_free(s->symlinks);
 
         s->user = mfree(s->user);
         s->group = mfree(s->group);
@@ -405,7 +405,7 @@ static int socket_verify(Socket *s) {
         if (s->exec_context.pam_name && s->kill_context.kill_mode != KILL_CONTROL_GROUP)
                 return log_unit_error_errno(UNIT(s), SYNTHETIC_ERRNO(ENOEXEC), "Unit has PAM enabled. Kill mode must be set to 'control-group'. Refusing.");
 
-        if (!strv_isempty(s->symlinks) && !socket_find_symlink_target(s))
+        if (!sd_strv_isempty(s->symlinks) && !socket_find_symlink_target(s))
                 return log_unit_error_errno(UNIT(s), SYNTHETIC_ERRNO(ENOEXEC), "Unit has symlinks set but none or more than one node in the file system. Refusing.");
 
         return 0;
@@ -786,7 +786,7 @@ static void socket_dump(Unit *u, FILE *f
         if (str)
                 fprintf(f, "%sSocketProtocol: %s\n", prefix, str);
 
-        if (!strv_isempty(s->symlinks)) {
+        if (!sd_strv_isempty(s->symlinks)) {
                 fprintf(f, "%sSymlinks:", prefix);
                 STRV_FOREACH(q, s->symlinks)
                         fprintf(f, " %s", *q);
@@ -1925,7 +1925,7 @@ static int socket_spawn(Socket *s, ExecC
 
         /* Note that ExecStartPre= command doesn't inherit any FDs. It runs before we open listen FDs. */
         if (s->pass_fds_to_exec) {
-                _cleanup_strv_free_ char **fd_names = NULL;
+                _cleanup_sd_strv_free_ char **fd_names = NULL;
                 _cleanup_free_ int *fds = NULL;
                 int n_fds;
 
@@ -1933,7 +1933,7 @@ static int socket_spawn(Socket *s, ExecC
                 if (n_fds < 0)
                         return n_fds;
 
-                r = strv_extend_n(&fd_names, socket_fdname(s), n_fds);
+                r = sd_strv_extend_n(&fd_names, socket_fdname(s), n_fds);
                 if (r < 0)
                         return r;
 
@@ -3428,7 +3428,7 @@ static PidRef *socket_control_pid(Unit *
 
 static int socket_clean(Unit *u, ExecCleanMask mask) {
         Socket *s = ASSERT_PTR(SOCKET(u));
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(mask != 0);
@@ -3440,7 +3440,7 @@ static int socket_clean(Unit *u, ExecCle
         if (r < 0)
                 return r;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return -EUNATCH;
 
         socket_unwatch_control_pid(s);
diff '--color=auto' -Nurp a/src/core/swap.c b/src/core/swap.c
--- a/src/core/swap.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/swap.c	2025-06-30 18:37:25.000000000 +0000
@@ -1480,7 +1480,7 @@ static PidRef* swap_control_pid(Unit *u)
 
 static int swap_clean(Unit *u, ExecCleanMask mask) {
         Swap *s = ASSERT_PTR(SWAP(u));
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(mask != 0);
@@ -1492,7 +1492,7 @@ static int swap_clean(Unit *u, ExecClean
         if (r < 0)
                 return r;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return -EUNATCH;
 
         swap_unwatch_control_pid(s);
diff '--color=auto' -Nurp a/src/core/taint.c b/src/core/taint.c
--- a/src/core/taint.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/taint.c	2025-06-30 18:37:56.000000000 +0000
@@ -81,5 +81,5 @@ char* taint_string(void) {
 
         assert(n < ELEMENTSOF(stage) - 1);  /* One extra for NULL terminator */
 
-        return strv_join((char**) stage, ":");
+        return sd_strv_join((char**) stage, ":");
 }
diff '--color=auto' -Nurp a/src/core/timer.c b/src/core/timer.c
--- a/src/core/timer.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/timer.c	2025-06-30 18:36:07.000000000 +0000
@@ -940,11 +940,11 @@ static int activation_details_timer_appe
         if (!dual_timestamp_is_set(&t->last_trigger))
                 return 0;
 
-        r = strv_extendf(strv, "TRIGGER_TIMER_REALTIME_USEC=" USEC_FMT, t->last_trigger.realtime);
+        r = sd_sd_strv_extendf(strv, "TRIGGER_TIMER_REALTIME_USEC=" USEC_FMT, t->last_trigger.realtime);
         if (r < 0)
                 return r;
 
-        r = strv_extendf(strv, "TRIGGER_TIMER_MONOTONIC_USEC=" USEC_FMT, t->last_trigger.monotonic);
+        r = sd_sd_strv_extendf(strv, "TRIGGER_TIMER_MONOTONIC_USEC=" USEC_FMT, t->last_trigger.monotonic);
         if (r < 0)
                 return r;
 
@@ -961,19 +961,19 @@ static int activation_details_timer_appe
         if (!dual_timestamp_is_set(&t->last_trigger))
                 return 0;
 
-        r = strv_extend(strv, "trigger_timer_realtime_usec");
+        r = sd_strv_extend(strv, "trigger_timer_realtime_usec");
         if (r < 0)
                 return r;
 
-        r = strv_extendf(strv, USEC_FMT, t->last_trigger.realtime);
+        r = sd_sd_strv_extendf(strv, USEC_FMT, t->last_trigger.realtime);
         if (r < 0)
                 return r;
 
-        r = strv_extend(strv, "trigger_timer_monotonic_usec");
+        r = sd_strv_extend(strv, "trigger_timer_monotonic_usec");
         if (r < 0)
                 return r;
 
-        r = strv_extendf(strv, USEC_FMT, t->last_trigger.monotonic);
+        r = sd_sd_strv_extendf(strv, USEC_FMT, t->last_trigger.monotonic);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/core/transaction.c b/src/core/transaction.c
--- a/src/core/transaction.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/transaction.c	2025-06-30 18:36:23.000000000 +0000
@@ -379,7 +379,7 @@ static int transaction_verify_order_one(
                 for (k = from; k; k = ((k->generation == generation && k->marker != k) ? k->marker : NULL)) {
 
                         /* For logging below */
-                        if (strv_push_pair(&array, k->unit->id, (char*) job_type_to_string(k->type)) < 0)
+                        if (sd_strv_push_pair(&array, k->unit->id, (char*) job_type_to_string(k->type)) < 0)
                                 log_oom();
 
                         if (!delete && hashmap_contains(tr->jobs, k->unit) && !job_matters_to_anchor(k))
diff '--color=auto' -Nurp a/src/core/unit-serialize.c b/src/core/unit-serialize.c
--- a/src/core/unit-serialize.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/unit-serialize.c	2025-06-30 18:35:42.000000000 +0000
@@ -302,7 +302,7 @@ int unit_deserialize_state(Unit *u, FILE
                         continue;
 
                 } else if (streq(l, "ref")) {
-                        r = strv_extend(&u->deserialized_refs, v);
+                        r = sd_strv_extend(&u->deserialized_refs, v);
                         if (r < 0)
                                 return log_oom();
                         continue;
diff '--color=auto' -Nurp a/src/core/unit.c b/src/core/unit.c
--- a/src/core/unit.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/core/unit.c	2025-06-30 18:36:37.000000000 +0000
@@ -752,7 +752,7 @@ Unit* unit_free(Unit *u) {
 
         u->match_bus_slot = sd_bus_slot_unref(u->match_bus_slot);
         u->bus_track = sd_bus_track_unref(u->bus_track);
-        u->deserialized_refs = strv_free(u->deserialized_refs);
+        u->deserialized_refs = sd_strv_free(u->deserialized_refs);
         u->pending_freezer_invocation = sd_bus_message_unref(u->pending_freezer_invocation);
 
         unit_free_mounts_for(u);
@@ -847,10 +847,10 @@ Unit* unit_free(Unit *u) {
         condition_free_list(u->asserts);
 
         free(u->description);
-        strv_free(u->documentation);
+        sd_strv_free(u->documentation);
         free(u->fragment_path);
         free(u->source_path);
-        strv_free(u->dropin_paths);
+        sd_strv_free(u->dropin_paths);
         free(u->instance);
 
         free(u->job_timeout_reboot_arg);
@@ -1746,7 +1746,7 @@ static int log_unit_internal(void *userd
 }
 
 static bool unit_test_condition(Unit *u) {
-        _cleanup_strv_free_ char **env = NULL;
+        _cleanup_sd_strv_free_ char **env = NULL;
         int r;
 
         assert(u);
@@ -1770,7 +1770,7 @@ static bool unit_test_condition(Unit *u)
 }
 
 static bool unit_test_assert(Unit *u) {
-        _cleanup_strv_free_ char **env = NULL;
+        _cleanup_sd_strv_free_ char **env = NULL;
         int r;
 
         assert(u);
@@ -3764,7 +3764,7 @@ int unit_coldplug(Unit *u) {
         STRV_FOREACH(i, u->deserialized_refs)
                 RET_GATHER(r, bus_unit_track_add_name(u, *i));
 
-        u->deserialized_refs = strv_free(u->deserialized_refs);
+        u->deserialized_refs = sd_strv_free(u->deserialized_refs);
 
         if (UNIT_VTABLE(u)->coldplug)
                 RET_GATHER(r, UNIT_VTABLE(u)->coldplug(u));
@@ -3829,7 +3829,7 @@ bool unit_need_daemon_reload(Unit *u) {
                 return true;
 
         if (u->load_state == UNIT_LOADED) {
-                _cleanup_strv_free_ char **dropins = NULL;
+                _cleanup_sd_strv_free_ char **dropins = NULL;
 
                 (void) unit_find_dropin_paths(u, /* use_unit_path_cache = */ false, &dropins);
 
@@ -4624,7 +4624,7 @@ int unit_write_setting(Unit *u, UnitWrit
         if (r < 0)
                 return r;
 
-        r = strv_push(&u->dropin_paths, q);
+        r = sd_strv_push(&u->dropin_paths, q);
         if (r < 0)
                 return r;
         q = NULL;
@@ -4688,7 +4688,7 @@ int unit_make_transient(Unit *u) {
         free_and_replace(u->fragment_path, path);
 
         u->source_path = mfree(u->source_path);
-        u->dropin_paths = strv_free(u->dropin_paths);
+        u->dropin_paths = sd_strv_free(u->dropin_paths);
         u->fragment_mtime = u->source_mtime = u->dropin_mtime = 0;
 
         u->load_state = UNIT_STUB;
@@ -6602,7 +6602,7 @@ int activation_details_append_env(Activa
                 if (!s)
                         return -ENOMEM;
 
-                r = strv_consume(strv, TAKE_PTR(s));
+                r = sd_strv_consume(strv, TAKE_PTR(s));
                 if (r < 0)
                         return r;
         }
@@ -6625,7 +6625,7 @@ int activation_details_append_pair(Activ
                 return 0;
 
         if (!isempty(details->trigger_unit_name)) {
-                r = strv_extend_many(strv, "trigger_unit", details->trigger_unit_name);
+                r = sd_strv_extend_many(strv, "trigger_unit", details->trigger_unit_name);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/coredump/coredumpctl.c b/src/coredump/coredumpctl.c
--- a/src/coredump/coredumpctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/coredump/coredumpctl.c	2025-06-30 18:37:42.000000000 +0000
@@ -66,10 +66,10 @@ static bool arg_quiet = false;
 static bool arg_all = false;
 static ImagePolicy *arg_image_policy = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_debugger_args, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_debugger_args, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_file, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_file, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
 
 static int add_match(sd_journal *j, const char *match) {
@@ -279,11 +279,11 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case 'A': {
-                        _cleanup_strv_free_ char **l = NULL;
-                        r = strv_split_full(&l, optarg, WHITESPACE, EXTRACT_UNQUOTE);
+                        _cleanup_sd_strv_free_ char **l = NULL;
+                        r = sd_strv_split_full(&l, optarg, WHITESPACE, EXTRACT_UNQUOTE);
                         if (r < 0)
                                 return log_error_errno(r, "Failed to parse debugger arguments '%s': %m", optarg);
-                        strv_free_and_replace(arg_debugger_args, l);
+                        sd_strv_free_and_replace(arg_debugger_args, l);
                         break;
                 }
 
@@ -1170,7 +1170,7 @@ static void sigterm_handler(int signal,
 static int run_debug(int argc, char **argv, void *userdata) {
         _cleanup_(sd_journal_closep) sd_journal *j = NULL;
         _cleanup_free_ char *exe = NULL, *path = NULL;
-        _cleanup_strv_free_ char **debugger_call = NULL;
+        _cleanup_sd_strv_free_ char **debugger_call = NULL;
         struct sigaction sa = {
                 .sa_sigaction = sigterm_handler,
                 .sa_flags = SA_SIGINFO,
@@ -1191,11 +1191,11 @@ static int run_debug(int argc, char **ar
                         arg_debugger = "gdb";
         }
 
-        r = strv_extend(&debugger_call, arg_debugger);
+        r = sd_strv_extend(&debugger_call, arg_debugger);
         if (r < 0)
                 return log_oom();
 
-        r = strv_extend_strv(&debugger_call, arg_debugger_args, false);
+        r = sd_sd_strv_extend_strv(&debugger_call, arg_debugger_args, false);
         if (r < 0)
                 return log_oom();
 
@@ -1244,7 +1244,7 @@ static int run_debug(int argc, char **ar
         if (r < 0)
                 return r;
 
-        r = strv_extend_many(&debugger_call, exe, "-c", path);
+        r = sd_strv_extend_many(&debugger_call, exe, "-c", path);
         if (r < 0)
                 return log_oom();
 
@@ -1253,14 +1253,14 @@ static int run_debug(int argc, char **ar
                         const char *sysroot_cmd;
                         sysroot_cmd = strjoina("set sysroot ", arg_root);
 
-                        r = strv_extend_many(&debugger_call, "-iex", sysroot_cmd);
+                        r = sd_strv_extend_many(&debugger_call, "-iex", sysroot_cmd);
                         if (r < 0)
                                 return log_oom();
                 } else if (streq(arg_debugger, "lldb")) {
                         const char *sysroot_cmd;
                         sysroot_cmd = strjoina("platform select --sysroot ", arg_root, " host");
 
-                        r = strv_extend_many(&debugger_call, "-O", sysroot_cmd);
+                        r = sd_strv_extend_many(&debugger_call, "-O", sysroot_cmd);
                         if (r < 0)
                                 return log_oom();
                 }
diff '--color=auto' -Nurp a/src/cryptenroll/cryptenroll-password.c b/src/cryptenroll/cryptenroll-password.c
--- a/src/cryptenroll/cryptenroll-password.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/cryptenroll/cryptenroll-password.c	2025-06-30 18:35:00.000000000 +0000
@@ -62,7 +62,7 @@ int load_volume_key_password(
                 };
 
                 for (;;) {
-                        _cleanup_strv_free_erase_ char **passwords = NULL;
+                        _cleanup_sd_strv_free_erase_ char **passwords = NULL;
 
                         if (--i == 0)
                                 return log_error_errno(SYNTHETIC_ERRNO(ENOKEY),
@@ -134,7 +134,7 @@ int enroll_password(
                 };
 
                 for (;;) {
-                        _cleanup_strv_free_erase_ char **passwords = NULL, **passwords2 = NULL;
+                        _cleanup_sd_strv_free_erase_ char **passwords = NULL, **passwords2 = NULL;
                         _cleanup_free_ char *question = NULL;
 
                         if (--i == 0)
@@ -151,7 +151,7 @@ int enroll_password(
                         if (r < 0)
                                 return log_error_errno(r, "Failed to query password: %m");
 
-                        assert(strv_length(passwords) == 1);
+                        assert(sd_strv_length(passwords) == 1);
 
                         free(question);
                         question = strjoin("Please enter new passphrase for disk ", node, " (repeat):");
@@ -164,7 +164,7 @@ int enroll_password(
                         if (r < 0)
                                 return log_error_errno(r, "Failed to query password: %m");
 
-                        assert(strv_length(passwords2) == 1);
+                        assert(sd_strv_length(passwords2) == 1);
 
                         if (strv_equal(passwords, passwords2)) {
                                 new_password = passwords2[0];
diff '--color=auto' -Nurp a/src/cryptenroll/cryptenroll-tpm2.c b/src/cryptenroll/cryptenroll-tpm2.c
--- a/src/cryptenroll/cryptenroll-tpm2.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/cryptenroll/cryptenroll-tpm2.c	2025-06-30 18:35:00.000000000 +0000
@@ -81,7 +81,7 @@ static int get_pin(char **ret_pin_str, T
                 flags |= TPM2_FLAGS_USE_PIN;
         else {
                 for (size_t i = 5;; i--) {
-                        _cleanup_strv_free_erase_ char **pin = NULL, **pin2 = NULL;
+                        _cleanup_sd_strv_free_erase_ char **pin = NULL, **pin2 = NULL;
 
                         if (i <= 0)
                                 return log_error_errno(
@@ -94,7 +94,7 @@ static int get_pin(char **ret_pin_str, T
                                 .credential = "cryptenroll.new-tpm2-pin",
                         };
 
-                        pin = strv_free_erase(pin);
+                        pin = sd_strv_free_erase(pin);
                         r = ask_password_auto(
                                         &req,
                                         /* until= */ USEC_INFINITY,
@@ -102,7 +102,7 @@ static int get_pin(char **ret_pin_str, T
                                         &pin);
                         if (r < 0)
                                 return log_error_errno(r, "Failed to ask for user pin: %m");
-                        assert(strv_length(pin) == 1);
+                        assert(sd_strv_length(pin) == 1);
 
                         req.message = "Please enter TPM2 PIN (repeat):";
 
@@ -113,7 +113,7 @@ static int get_pin(char **ret_pin_str, T
                                         &pin2);
                         if (r < 0)
                                 return log_error_errno(r, "Failed to ask for user pin: %m");
-                        assert(strv_length(pin) == 1);
+                        assert(sd_strv_length(pin) == 1);
 
                         if (strv_equal(pin, pin2)) {
                                 pin_str = strdup(*pin);
diff '--color=auto' -Nurp a/src/cryptsetup/cryptsetup-keyfile.c b/src/cryptsetup/cryptsetup-keyfile.c
--- a/src/cryptsetup/cryptsetup-keyfile.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/cryptsetup/cryptsetup-keyfile.c	2025-06-30 18:37:25.000000000 +0000
@@ -18,7 +18,7 @@ int find_key_file(
         assert(ret_key);
         assert(ret_key_size);
 
-        if (strv_isempty(search_path) || path_is_absolute(key_file)) {
+        if (sd_strv_isempty(search_path) || path_is_absolute(key_file)) {
 
                 r = read_full_file_full(
                                 AT_FDCWD, key_file, UINT64_MAX, SIZE_MAX,
diff '--color=auto' -Nurp a/src/cryptsetup/cryptsetup-tokens/luks2-fido2.c b/src/cryptsetup/cryptsetup-tokens/luks2-fido2.c
--- a/src/cryptsetup/cryptsetup-tokens/luks2-fido2.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/cryptsetup/cryptsetup-tokens/luks2-fido2.c	2025-06-30 18:37:25.000000000 +0000
@@ -24,7 +24,7 @@ int acquire_luks2_key(
         _cleanup_free_ char *rp_id = NULL;
         _cleanup_(erase_and_freep) void *decrypted_key = NULL;
         _cleanup_(erase_and_freep) char *base64_encoded = NULL;
-        _cleanup_strv_free_erase_ char **pins = NULL;
+        _cleanup_sd_strv_free_erase_ char **pins = NULL;
         ssize_t base64_encoded_size;
 
         assert(ret_keyslot_passphrase);
@@ -35,13 +35,13 @@ int acquire_luks2_key(
                 return r;
 
         if (pin) {
-                pins = strv_new(pin);
+                pins = sd_strv_new(pin);
                 if (!pins)
                         return crypt_log_oom(cd);
         }
 
         /* configured to use pin but none was provided */
-        if ((required & FIDO2ENROLL_PIN) && strv_isempty(pins))
+        if ((required & FIDO2ENROLL_PIN) && sd_strv_isempty(pins))
                 return -ENOANO;
 
         r = fido2_use_hmac_hash(
diff '--color=auto' -Nurp a/src/cryptsetup/cryptsetup.c b/src/cryptsetup/cryptsetup.c
--- a/src/cryptsetup/cryptsetup.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/cryptsetup/cryptsetup.c	2025-06-30 18:37:56.000000000 +0000
@@ -111,14 +111,14 @@ static char *arg_link_key_description =
 STATIC_DESTRUCTOR_REGISTER(arg_cipher, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_hash, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_header, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_tcrypt_keyfiles, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_tcrypt_keyfiles, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_pkcs11_uri, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_fido2_device, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_fido2_cid, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_fido2_rp_id, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_tpm2_device, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_tpm2_signature, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_tpm2_measure_banks, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_tpm2_measure_banks, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_tpm2_pcrlock, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_link_keyring, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_link_key_type, freep);
@@ -206,7 +206,7 @@ static int parse_one_option(const char *
 
                 arg_type = CRYPT_TCRYPT;
                 if (path_is_absolute(val)) {
-                        if (strv_extend(&arg_tcrypt_keyfiles, val) < 0)
+                        if (sd_strv_extend(&arg_tcrypt_keyfiles, val) < 0)
                                 return log_oom();
                 } else
                         log_warning("Key file path \"%s\" is not absolute, ignoring.", val);
@@ -463,9 +463,9 @@ static int parse_one_option(const char *
         } else if ((val = startswith(option, "tpm2-measure-bank="))) {
 
 #if HAVE_OPENSSL
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
-                l = strv_split(optarg, ":");
+                l = sd_strv_split(optarg, ":");
                 if (!l)
                         return log_oom();
 
@@ -476,7 +476,7 @@ static int parse_one_option(const char *
                         if (!implementation)
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Unknown bank '%s', refusing.", val);
 
-                        if (strv_extend(&arg_tpm2_measure_banks, EVP_MD_name(implementation)) < 0)
+                        if (sd_strv_extend(&arg_tpm2_measure_banks, EVP_MD_name(implementation)) < 0)
                                 return log_oom();
                 }
 #else
@@ -798,7 +798,7 @@ static int get_password(
                 char ***ret) {
 
         _cleanup_free_ char *friendly = NULL, *text = NULL, *disk_path = NULL, *id = NULL;
-        _cleanup_strv_free_erase_ char **passwords = NULL;
+        _cleanup_sd_strv_free_erase_ char **passwords = NULL;
         AskPasswordFlags flags = arg_ask_password_flags | ASK_PASSWORD_PUSH_CACHE;
         int r;
 
@@ -841,9 +841,9 @@ static int get_password(
                 return log_error_errno(r, "Failed to query password: %m");
 
         if (arg_verify) {
-                _cleanup_strv_free_erase_ char **passwords2 = NULL;
+                _cleanup_sd_strv_free_erase_ char **passwords2 = NULL;
 
-                assert(strv_length(passwords) == 1);
+                assert(sd_strv_length(passwords) == 1);
 
                 text = mfree(text);
                 if (asprintf(&text, "Please enter %s for disk %s (verification):", passphrase_type_to_string(passphrase_type), friendly) < 0)
@@ -861,7 +861,7 @@ static int get_password(
                 if (r < 0)
                         return log_error_errno(r, "Failed to query verification password: %m");
 
-                assert(strv_length(passwords2) == 1);
+                assert(sd_strv_length(passwords2) == 1);
 
                 if (!streq(passwords[0], passwords2[0]))
                         return log_warning_errno(SYNTHETIC_ERRNO(EAGAIN),
@@ -923,14 +923,14 @@ static int measure_volume_key(
         if (r < 0)
                 return r;
 
-        _cleanup_strv_free_ char **l = NULL;
-        if (strv_isempty(arg_tpm2_measure_banks)) {
+        _cleanup_sd_strv_free_ char **l = NULL;
+        if (sd_strv_isempty(arg_tpm2_measure_banks)) {
                 r = tpm2_get_good_pcr_banks_strv(c, UINT32_C(1) << arg_tpm2_measure_pcr, &l);
                 if (r < 0)
                         return log_error_errno(r, "Could not verify pcr banks: %m");
         }
 
-        _cleanup_free_ char *joined = strv_join(l ?: arg_tpm2_measure_banks, ", ");
+        _cleanup_free_ char *joined = sd_strv_join(l ?: arg_tpm2_measure_banks, ", ");
         if (!joined)
                 return log_oom();
 
@@ -1052,12 +1052,12 @@ static int attach_tcrypt(
         struct crypt_params_tcrypt params = {
                 .flags = CRYPT_TCRYPT_LEGACY_MODES,
                 .keyfiles = (const char **)arg_tcrypt_keyfiles,
-                .keyfiles_count = strv_length(arg_tcrypt_keyfiles)
+                .keyfiles_count = sd_strv_length(arg_tcrypt_keyfiles)
         };
 
         assert(cd);
         assert(name);
-        assert(key_file || key_data || !strv_isempty(passwords));
+        assert(key_file || key_data || !sd_strv_isempty(passwords));
 
         if (arg_pkcs11_uri || arg_pkcs11_uri_auto || arg_fido2_device || arg_fido2_device_auto || arg_tpm2_device || arg_tpm2_device_auto)
                 /* Ask for a regular password */
@@ -1240,7 +1240,7 @@ static bool libcryptsetup_plugins_suppor
 #if HAVE_LIBCRYPTSETUP_PLUGINS
 static int acquire_pins_from_env_variable(char ***ret_pins) {
         _cleanup_(erase_and_freep) char *envpin = NULL;
-        _cleanup_strv_free_erase_ char **pins = NULL;
+        _cleanup_sd_strv_free_erase_ char **pins = NULL;
         int r;
 
         assert(ret_pins);
@@ -1249,7 +1249,7 @@ static int acquire_pins_from_env_variabl
         if (r < 0)
                 return log_error_errno(r, "Failed to acquire PIN from environment: %m");
         if (r > 0) {
-                pins = strv_new(envpin);
+                pins = sd_strv_new(envpin);
                 if (!pins)
                         return log_oom();
         }
@@ -1273,7 +1273,7 @@ static int crypt_activate_by_token_pin_a
 
 #if HAVE_LIBCRYPTSETUP_PLUGINS
         AskPasswordFlags flags = arg_ask_password_flags | ASK_PASSWORD_PUSH_CACHE | ASK_PASSWORD_ACCEPT_CACHED;
-        _cleanup_strv_free_erase_ char **pins = NULL;
+        _cleanup_sd_strv_free_erase_ char **pins = NULL;
         int r;
 
         r = crypt_activate_by_token_pin(cd, name, type, CRYPT_ANY_TOKEN, /* pin=*/ NULL, /* pin_size= */ 0, userdata, activation_flags);
@@ -1298,7 +1298,7 @@ static int crypt_activate_by_token_pin_a
                 return log_error_errno(SYNTHETIC_ERRNO(ENOPKG), "PIN querying disabled via 'headless' option. Use the '$PIN' environment variable.");
 
         for (;;) {
-                pins = strv_free_erase(pins);
+                pins = sd_strv_free_erase(pins);
 
                 AskPasswordRequest req = {
                         .message = message,
@@ -2417,7 +2417,7 @@ static int run(int argc, char *argv[]) {
 #endif
 
                 bool use_cached_passphrase = true;
-                _cleanup_strv_free_erase_ char **passwords = NULL;
+                _cleanup_sd_strv_free_erase_ char **passwords = NULL;
                 for (tries = 0; arg_tries == 0 || tries < arg_tries; tries++) {
                         log_debug("Beginning attempt %u to unlock.", tries);
 
@@ -2503,7 +2503,7 @@ static int run(int argc, char *argv[]) {
                         }
 
                         if (passwords) {
-                                passwords = strv_free_erase(passwords);
+                                passwords = sd_strv_free_erase(passwords);
                                 continue;
                         }
 
diff '--color=auto' -Nurp a/src/debug-generator/debug-generator.c b/src/debug-generator/debug-generator.c
--- a/src/debug-generator/debug-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/debug-generator/debug-generator.c	2025-06-30 18:36:37.000000000 +0000
@@ -29,8 +29,8 @@ static char *arg_debug_tty = NULL;
 static char *arg_default_debug_tty = NULL;
 
 STATIC_DESTRUCTOR_REGISTER(arg_default_unit, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_mask, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_wants, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_mask, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_wants, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_debug_tty, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_default_debug_tty, freep);
 
@@ -49,7 +49,7 @@ static int parse_proc_cmdline_item(const
                 if (r < 0)
                         return log_error_errno(r, "Failed to glob unit name: %m");
 
-                if (strv_consume(&arg_mask, n) < 0)
+                if (sd_strv_consume(&arg_mask, n) < 0)
                         return log_oom();
 
         } else if (streq(key, "systemd.wants")) {
@@ -62,7 +62,7 @@ static int parse_proc_cmdline_item(const
                 if (r < 0)
                         return log_error_errno(r, "Failed to glob unit name: %m");
 
-                if (strv_consume(&arg_wants, n) < 0)
+                if (sd_strv_consume(&arg_wants, n) < 0)
                         return log_oom();
 
         } else if (proc_cmdline_key_streq(key, "systemd.debug_shell")) {
@@ -263,7 +263,7 @@ static int run(const char *dest, const c
                 log_warning_errno(r, "Failed to parse kernel command line, ignoring: %m");
 
         if (arg_debug_shell) {
-                if (strv_extend(&arg_wants, "debug-shell.service") < 0)
+                if (sd_strv_extend(&arg_wants, "debug-shell.service") < 0)
                         return log_oom();
 
                 RET_GATHER(r, install_debug_shell_dropin());
diff '--color=auto' -Nurp a/src/delta/delta.c b/src/delta/delta.c
--- a/src/delta/delta.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/delta/delta.c	2025-06-30 18:33:49.000000000 +0000
@@ -192,7 +192,7 @@ static int enumerate_dir_d(
 
         _cleanup_free_ char *unit = NULL;
         _cleanup_free_ char *path = NULL;
-        _cleanup_strv_free_ char **list = NULL;
+        _cleanup_sd_strv_free_ char **list = NULL;
         char *c;
         int r;
 
@@ -287,7 +287,7 @@ static int enumerate_dir(
                 const char *path, bool dropins) {
 
         _cleanup_closedir_ DIR *d = NULL;
-        _cleanup_strv_free_ char **files = NULL, **dirs = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL, **dirs = NULL;
         size_t n_files = 0, n_dirs = 0;
         int r;
 
diff '--color=auto' -Nurp a/src/dissect/dissect.c b/src/dissect/dissect.c
--- a/src/dissect/dissect.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/dissect/dissect.c	2025-06-30 18:37:42.000000000 +0000
@@ -99,7 +99,7 @@ STATIC_DESTRUCTOR_REGISTER(arg_image, fr
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_path, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_verity_settings, verity_settings_done);
-STATIC_DESTRUCTOR_REGISTER(arg_argv, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_argv, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_loop_ref, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
 
@@ -309,7 +309,7 @@ static int parse_argv(int argc, char *ar
                 {}
         };
 
-        _cleanup_free_ char **buf = NULL; /* we use free(), not strv_free() here, as we don't copy the strings here */
+        _cleanup_free_ char **buf = NULL; /* we use free(), not sd_strv_free() here, as we don't copy the strings here */
         int c, r;
 
         assert(argc >= 0);
@@ -677,7 +677,7 @@ static int parse_argv(int argc, char *ar
                         return r;
 
                 if (argc > optind + 1) {
-                        arg_argv = strv_copy(argv + optind + 1);
+                        arg_argv = sd_strv_copy(argv + optind + 1);
                         if (!arg_argv)
                                 return log_oom();
                 }
@@ -812,7 +812,7 @@ static void strv_pair_print(char **l, co
 }
 
 static int get_extension_scopes(DissectedImage *m, ImageClass class, char ***ret_scopes) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *e, *field_name;
         char **release_data;
 
@@ -846,9 +846,9 @@ static int get_extension_scopes(Dissecte
 
         e = strv_env_pairs_get(release_data, field_name);
         if (e)
-                l = strv_split(e, WHITESPACE);
+                l = sd_strv_split(e, WHITESPACE);
         else
-                l = strv_new("system", "portable");
+                l = sd_strv_new("system", "portable");
         if (!l)
                 return -ENOMEM;
 
@@ -933,11 +933,11 @@ static int action_dissect(
 
                 if (m->hostname ||
                     !sd_id128_is_null(m->machine_id) ||
-                    !strv_isempty(m->machine_info) ||
-                    !strv_isempty(m->os_release) ||
-                    !strv_isempty(m->initrd_release) ||
-                    !strv_isempty(m->sysext_release) ||
-                    !strv_isempty(m->confext_release))
+                    !sd_strv_isempty(m->machine_info) ||
+                    !sd_strv_isempty(m->os_release) ||
+                    !sd_strv_isempty(m->initrd_release) ||
+                    !sd_strv_isempty(m->sysext_release) ||
+                    !sd_strv_isempty(m->confext_release))
                         putc('\n', stdout);
 
                 printf("    Use As: %s bootable system for UEFI\n",
@@ -951,7 +951,7 @@ static int action_dissect(
 
                 for (ImageClass c = _IMAGE_CLASS_EXTENSION_FIRST; c <= _IMAGE_CLASS_EXTENSION_LAST; c++) {
                         const char *string_class = image_class_to_string(c);
-                        _cleanup_strv_free_ char **extension_scopes = NULL;
+                        _cleanup_sd_strv_free_ char **extension_scopes = NULL;
 
                         r = get_extension_scopes(m, c, &extension_scopes);
                         if (r < 0)
@@ -967,7 +967,7 @@ static int action_dissect(
 
                 putc('\n', stdout);
         } else {
-                _cleanup_strv_free_ char **sysext_scopes = NULL, **confext_scopes = NULL;
+                _cleanup_sd_strv_free_ char **sysext_scopes = NULL, **confext_scopes = NULL;
 
                 r = get_extension_scopes(m, IMAGE_SYSEXT, &sysext_scopes);
                 if (r < 0)
@@ -987,11 +987,11 @@ static int action_dissect(
                                                JSON_BUILD_PAIR_CONDITION(!sd_id128_is_null(m->image_uuid), "imageUuid", JSON_BUILD_UUID(m->image_uuid)),
                                                JSON_BUILD_PAIR_CONDITION(m->hostname, "hostname", JSON_BUILD_STRING(m->hostname)),
                                                JSON_BUILD_PAIR_CONDITION(!sd_id128_is_null(m->machine_id), "machineId", JSON_BUILD_ID128(m->machine_id)),
-                                               JSON_BUILD_PAIR_CONDITION(!strv_isempty(m->machine_info), "machineInfo", JSON_BUILD_STRV_ENV_PAIR(m->machine_info)),
-                                               JSON_BUILD_PAIR_CONDITION(!strv_isempty(m->os_release), "osRelease", JSON_BUILD_STRV_ENV_PAIR(m->os_release)),
-                                               JSON_BUILD_PAIR_CONDITION(!strv_isempty(m->initrd_release), "initrdRelease", JSON_BUILD_STRV_ENV_PAIR(m->initrd_release)),
-                                               JSON_BUILD_PAIR_CONDITION(!strv_isempty(m->sysext_release), "sysextRelease", JSON_BUILD_STRV_ENV_PAIR(m->sysext_release)),
-                                               JSON_BUILD_PAIR_CONDITION(!strv_isempty(m->confext_release), "confextRelease", JSON_BUILD_STRV_ENV_PAIR(m->confext_release)),
+                                               JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(m->machine_info), "machineInfo", JSON_BUILD_STRV_ENV_PAIR(m->machine_info)),
+                                               JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(m->os_release), "osRelease", JSON_BUILD_STRV_ENV_PAIR(m->os_release)),
+                                               JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(m->initrd_release), "initrdRelease", JSON_BUILD_STRV_ENV_PAIR(m->initrd_release)),
+                                               JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(m->sysext_release), "sysextRelease", JSON_BUILD_STRV_ENV_PAIR(m->sysext_release)),
+                                               JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(m->confext_release), "confextRelease", JSON_BUILD_STRV_ENV_PAIR(m->confext_release)),
                                                JSON_BUILD_PAIR("useBootableUefi", JSON_BUILD_BOOLEAN(dissected_image_is_bootable_uefi(m))),
                                                JSON_BUILD_PAIR("useBootableContainer", JSON_BUILD_BOOLEAN(dissected_image_is_bootable_os(m))),
                                                JSON_BUILD_PAIR("useInitrd", JSON_BUILD_BOOLEAN(dissected_image_is_initrd(m))),
@@ -1796,7 +1796,7 @@ static int action_with(DissectedImage *m
                         _exit(EXIT_FAILURE);
                 }
 
-                if (strv_isempty(arg_argv)) {
+                if (sd_strv_isempty(arg_argv)) {
                         const char *sh;
 
                         sh = secure_getenv("SHELL");
diff '--color=auto' -Nurp a/src/environment-d-generator/environment-d-generator.c b/src/environment-d-generator/environment-d-generator.c
--- a/src/environment-d-generator/environment-d-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/environment-d-generator/environment-d-generator.c	2025-06-30 18:37:56.000000000 +0000
@@ -13,11 +13,11 @@
 #include "strv.h"
 
 static int environment_dirs(char ***ret) {
-        _cleanup_strv_free_ char **dirs = NULL;
+        _cleanup_sd_strv_free_ char **dirs = NULL;
         _cleanup_free_ char *c = NULL;
         int r;
 
-        dirs = strv_new(CONF_PATHS("environment.d"));
+        dirs = sd_strv_new(CONF_PATHS("environment.d"));
         if (!dirs)
                 return -ENOMEM;
 
@@ -26,14 +26,14 @@ static int environment_dirs(char ***ret)
         if (r < 0)
                 return r;
 
-        r = strv_consume_prepend(&dirs, TAKE_PTR(c));
+        r = sd_strv_consume_prepend(&dirs, TAKE_PTR(c));
         if (r < 0)
                 return r;
 
         if (DEBUG_LOGGING) {
                 _cleanup_free_ char *t = NULL;
 
-                t = strv_join(dirs, "\n\t");
+                t = sd_strv_join(dirs, "\n\t");
                 log_debug("Looking for environment.d files in (higher priority first):\n\t%s", strna(t));
         }
 
@@ -42,7 +42,7 @@ static int environment_dirs(char ***ret)
 }
 
 static int load_and_print(void) {
-        _cleanup_strv_free_ char **dirs = NULL, **files = NULL, **env = NULL;
+        _cleanup_sd_strv_free_ char **dirs = NULL, **files = NULL, **env = NULL;
         int r;
 
         r = environment_dirs(&dirs);
diff '--color=auto' -Nurp a/src/firstboot/firstboot.c b/src/firstboot/firstboot.c
--- a/src/firstboot/firstboot.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/firstboot/firstboot.c	2025-06-30 18:37:25.000000000 +0000
@@ -153,7 +153,7 @@ static int show_menu(char **x, unsigned
 
         assert(n_columns > 0);
 
-        n = strv_length(x);
+        n = sd_strv_length(x);
         per_column = DIV_ROUND_UP(n, n_columns);
 
         break_lines = lines();
@@ -225,7 +225,7 @@ static int prompt_loop(const char *text,
 
                 r = safe_atou(p, &u);
                 if (r >= 0) {
-                        if (u <= 0 || u > strv_length(l)) {
+                        if (u <= 0 || u > sd_strv_length(l)) {
                                 log_error("Specified entry number out of range.");
                                 continue;
                         }
@@ -323,7 +323,7 @@ static bool locale_is_ok(int rfd, const
 }
 
 static int prompt_locale(int rfd) {
-        _cleanup_strv_free_ char **locales = NULL;
+        _cleanup_sd_strv_free_ char **locales = NULL;
         bool acquired_from_creds = false;
         int r;
 
@@ -358,9 +358,9 @@ static int prompt_locale(int rfd) {
         if (r < 0)
                 return log_error_errno(r, "Cannot query locales list: %m");
 
-        if (strv_isempty(locales))
+        if (sd_strv_isempty(locales))
                 log_debug("No locales found, skipping locale selection.");
-        else if (strv_length(locales) == 1) {
+        else if (sd_strv_length(locales) == 1) {
 
                 if (streq(locales[0], SYSTEMD_DEFAULT_LOCALE))
                         log_debug("Only installed locale is default locale anyway, not setting locale explicitly.");
@@ -473,7 +473,7 @@ static typeof(&keymap_is_valid) determin
 }
 
 static int prompt_keymap(int rfd) {
-        _cleanup_strv_free_ char **kmaps = NULL;
+        _cleanup_sd_strv_free_ char **kmaps = NULL;
         int r;
 
         assert(rfd >= 0);
@@ -565,7 +565,7 @@ static bool timezone_is_valid_log_error(
 }
 
 static int prompt_timezone(int rfd) {
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
         int r;
 
         assert(rfd >= 0);
@@ -794,7 +794,7 @@ static int prompt_root_password(int rfd)
         suggest_passwords();
 
         for (;;) {
-                _cleanup_strv_free_erase_ char **a = NULL, **b = NULL;
+                _cleanup_sd_strv_free_erase_ char **a = NULL, **b = NULL;
                 _cleanup_free_ char *error = NULL;
 
                 AskPasswordRequest req = {
@@ -804,7 +804,7 @@ static int prompt_root_password(int rfd)
                 r = ask_password_tty(-EBADF, &req, /* until= */ 0, /* flags= */ 0, /* flag_file= */ NULL, &a);
                 if (r < 0)
                         return log_error_errno(r, "Failed to query root password: %m");
-                if (strv_length(a) != 1)
+                if (sd_strv_length(a) != 1)
                         return log_error_errno(SYNTHETIC_ERRNO(EIO),
                                                "Received multiple passwords, where we expected one.");
 
@@ -826,7 +826,7 @@ static int prompt_root_password(int rfd)
                 r = ask_password_tty(-EBADF, &req, /* until= */ 0, /* flags= */ 0, /* flag_file= */ NULL, &b);
                 if (r < 0)
                         return log_error_errno(r, "Failed to query root password: %m");
-                if (strv_length(b) != 1)
+                if (sd_strv_length(b) != 1)
                         return log_error_errno(SYNTHETIC_ERRNO(EIO),
                                                "Received multiple passwords, where we expected one.");
 
diff '--color=auto' -Nurp a/src/fstab-generator/fstab-generator.c b/src/fstab-generator/fstab-generator.c
--- a/src/fstab-generator/fstab-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/fstab-generator/fstab-generator.c	2025-06-30 18:37:42.000000000 +0000
@@ -127,9 +127,9 @@ static int mount_array_add_internal(
                 where = mfree(where);
 
         if (!isempty(in_options)) {
-                _cleanup_strv_free_ char **options_strv = NULL;
+                _cleanup_sd_strv_free_ char **options_strv = NULL;
 
-                r = strv_split_full(&options_strv, in_options, ",", 0);
+                r = sd_strv_split_full(&options_strv, in_options, ",", 0);
                 if (r < 0)
                         return r;
 
@@ -375,7 +375,7 @@ static int write_dependency(
                 const char *filter,
                 const char* const *unit_settings) {
 
-        _cleanup_strv_free_ char **unit_names = NULL;
+        _cleanup_sd_strv_free_ char **unit_names = NULL;
         _cleanup_free_ char *units = NULL;
         int r;
 
@@ -428,7 +428,7 @@ static int write_mounts_for(
                 const char *filter,
                 const char *unit_setting) {
 
-        _cleanup_strv_free_ char **paths = NULL, **paths_escaped = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL, **paths_escaped = NULL;
         int r;
 
         assert(f);
@@ -527,7 +527,7 @@ static int add_mount(
 
         _cleanup_free_ char *name = NULL, *automount_name = NULL, *filtered = NULL, *where_escaped = NULL,
                 *opts_root_filtered = NULL;
-        _cleanup_strv_free_ char **wanted_by = NULL, **required_by = NULL;
+        _cleanup_sd_strv_free_ char **wanted_by = NULL, **required_by = NULL;
         _cleanup_fclose_ FILE *f = NULL;
         int r;
 
@@ -567,13 +567,13 @@ static int add_mount(
                         return r;
                 opts = opts_root_filtered;
 
-                if (!strv_isempty(wanted_by))
+                if (!sd_strv_isempty(wanted_by))
                         log_debug("Ignoring 'x-systemd.wanted-by=' option for root/usr device.");
-                if (!strv_isempty(required_by))
+                if (!sd_strv_isempty(required_by))
                         log_debug("Ignoring 'x-systemd.required-by=' option for root/usr device.");
 
-                required_by = strv_free(required_by);
-                wanted_by = strv_free(wanted_by);
+                required_by = sd_strv_free(required_by);
+                wanted_by = sd_strv_free(wanted_by);
         }
 
         r = unit_name_from_path(where, ".mount", &name);
@@ -604,7 +604,7 @@ static int add_mount(
                 SET_FLAG(flags, MOUNT_NOFAIL, true);
         }
 
-        if (!strv_isempty(wanted_by) || !strv_isempty(required_by)) {
+        if (!sd_strv_isempty(wanted_by) || !sd_strv_isempty(required_by)) {
                 /* If x-systemd.{wanted,required}-by= is specified, target_unit is not used */
                 target_unit = NULL;
 
@@ -758,8 +758,8 @@ static int add_mount(
         }
 
         if (target_unit) {
-                assert(strv_isempty(wanted_by));
-                assert(strv_isempty(required_by));
+                assert(sd_strv_isempty(wanted_by));
+                assert(sd_strv_isempty(required_by));
 
                 /* noauto has no effect if x-systemd.automount is used */
                 if (!FLAGS_SET(flags, MOUNT_NOAUTO) || automount_name) {
@@ -1667,7 +1667,7 @@ static int run(int argc, char **argv) {
                 /* Run as in systemd-sysroot-fstab-check mode */
                 log_setup();
 
-                if (strv_length(argv) > 1)
+                if (sd_strv_length(argv) > 1)
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                "This program takes no arguments.");
                 if (!in_initrd())
@@ -1677,7 +1677,7 @@ static int run(int argc, char **argv) {
                 /* Run in generator mode */
                 log_setup_generator();
 
-                if (!IN_SET(strv_length(argv), 2, 4))
+                if (!IN_SET(sd_strv_length(argv), 2, 4))
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                "This program takes one or three arguments.");
 
diff '--color=auto' -Nurp a/src/fuzz/fuzz-bootspec.c b/src/fuzz/fuzz-bootspec.c
--- a/src/fuzz/fuzz-bootspec.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/fuzz/fuzz-bootspec.c	2025-06-30 18:33:49.000000000 +0000
@@ -61,7 +61,7 @@ static int json_dispatch_entries(const c
 
 static int json_dispatch_loader(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
         BootConfig *config = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **entries = NULL;
+        _cleanup_sd_strv_free_ char **entries = NULL;
         int r;
 
         r = json_dispatch_strv(name, variant, flags, &entries);
diff '--color=auto' -Nurp a/src/fuzz/fuzz-env-file.c b/src/fuzz/fuzz-env-file.c
--- a/src/fuzz/fuzz-env-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/fuzz/fuzz-env-file.c	2025-06-30 18:33:49.000000000 +0000
@@ -10,7 +10,7 @@
 
 int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **rl = NULL, **rlp =  NULL;
+        _cleanup_sd_strv_free_ char **rl = NULL, **rlp =  NULL;
 
         if (outside_size_range(size, 0, 65536))
                 return 0;
diff '--color=auto' -Nurp a/src/home/homectl-fido2.c b/src/home/homectl-fido2.c
--- a/src/home/homectl-fido2.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homectl-fido2.c	2025-06-30 18:35:42.000000000 +0000
@@ -24,7 +24,7 @@ static int add_fido2_credential_id(
                 size_t cid_size) {
 
         _cleanup_(json_variant_unrefp) JsonVariant *w = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_free_ char *escaped = NULL;
         ssize_t escaped_size;
         int r;
@@ -46,7 +46,7 @@ static int add_fido2_credential_id(
                         return 0;
         }
 
-        r = strv_extend(&l, escaped);
+        r = sd_strv_extend(&l, escaped);
         if (r < 0)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/home/homectl-pkcs11.c b/src/home/homectl-pkcs11.c
--- a/src/home/homectl-pkcs11.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homectl-pkcs11.c	2025-06-30 18:35:42.000000000 +0000
@@ -12,7 +12,7 @@
 
 int identity_add_token_pin(JsonVariant **v, const char *pin) {
         _cleanup_(json_variant_unrefp) JsonVariant *w = NULL, *l = NULL;
-        _cleanup_strv_free_erase_ char **pins = NULL;
+        _cleanup_sd_strv_free_erase_ char **pins = NULL;
         int r;
 
         assert(v);
@@ -30,7 +30,7 @@ int identity_add_token_pin(JsonVariant *
         if (strv_contains(pins, pin))
                 return 0;
 
-        r = strv_extend(&pins, pin);
+        r = sd_strv_extend(&pins, pin);
         if (r < 0)
                 return log_oom();
 
@@ -59,7 +59,7 @@ int identity_add_token_pin(JsonVariant *
 
 static int add_pkcs11_token_uri(JsonVariant **v, const char *uri) {
         _cleanup_(json_variant_unrefp) JsonVariant *w = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(v);
@@ -75,7 +75,7 @@ static int add_pkcs11_token_uri(JsonVari
                         return 0;
         }
 
-        r = strv_extend(&l, uri);
+        r = sd_strv_extend(&l, uri);
         if (r < 0)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/home/homectl-recovery-key.c b/src/home/homectl-recovery-key.c
--- a/src/home/homectl-recovery-key.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homectl-recovery-key.c	2025-06-30 18:35:42.000000000 +0000
@@ -45,7 +45,7 @@ static int add_privileged(JsonVariant **
 }
 
 static int add_public(JsonVariant **v) {
-        _cleanup_strv_free_ char **types = NULL;
+        _cleanup_sd_strv_free_ char **types = NULL;
         int r;
 
         assert(v);
@@ -54,7 +54,7 @@ static int add_public(JsonVariant **v) {
         if (r < 0)
                 return log_error_errno(r, "Failed to parse recovery key type list: %m");
 
-        r = strv_extend(&types, "modhex64");
+        r = sd_strv_extend(&types, "modhex64");
         if (r < 0)
                 return log_oom();
 
@@ -67,7 +67,7 @@ static int add_public(JsonVariant **v) {
 
 static int add_secret(JsonVariant **v, const char *password) {
         _cleanup_(json_variant_unrefp) JsonVariant *w = NULL, *l = NULL;
-        _cleanup_strv_free_erase_ char **passwords = NULL;
+        _cleanup_sd_strv_free_erase_ char **passwords = NULL;
         int r;
 
         assert(v);
@@ -80,7 +80,7 @@ static int add_secret(JsonVariant **v, c
         if (r < 0)
                 return log_error_errno(r, "Failed to convert password array: %m");
 
-        r = strv_extend(&passwords, password);
+        r = sd_strv_extend(&passwords, password);
         if (r < 0)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/home/homectl.c b/src/home/homectl.c
--- a/src/home/homectl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homectl.c	2025-06-30 18:37:25.000000000 +0000
@@ -99,10 +99,10 @@ STATIC_DESTRUCTOR_REGISTER(arg_identity_
 STATIC_DESTRUCTOR_REGISTER(arg_identity_extra_this_machine, json_variant_unrefp);
 STATIC_DESTRUCTOR_REGISTER(arg_identity_extra_privileged, json_variant_unrefp);
 STATIC_DESTRUCTOR_REGISTER(arg_identity_extra_rlimits, json_variant_unrefp);
-STATIC_DESTRUCTOR_REGISTER(arg_identity_filter, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_identity_filter_rlimits, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_pkcs11_token_uri, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_fido2_device, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_identity_filter, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_identity_filter_rlimits, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_pkcs11_token_uri, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_fido2_device, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_blob_dir, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_blob_files, hashmap_freep);
 
@@ -115,10 +115,10 @@ static bool identity_properties_specifie
                 !json_variant_is_blank_object(arg_identity_extra_privileged) ||
                 !json_variant_is_blank_object(arg_identity_extra_this_machine) ||
                 !json_variant_is_blank_object(arg_identity_extra_rlimits) ||
-                !strv_isempty(arg_identity_filter) ||
-                !strv_isempty(arg_identity_filter_rlimits) ||
-                !strv_isempty(arg_pkcs11_token_uri) ||
-                !strv_isempty(arg_fido2_device) ||
+                !sd_strv_isempty(arg_identity_filter) ||
+                !sd_strv_isempty(arg_identity_filter_rlimits) ||
+                !sd_strv_isempty(arg_pkcs11_token_uri) ||
+                !sd_strv_isempty(arg_fido2_device) ||
                 arg_blob_dir ||
                 arg_blob_clear ||
                 !hashmap_isempty(arg_blob_files);
@@ -229,7 +229,7 @@ static int acquire_existing_password(
                 bool emphasize_current,
                 AskPasswordFlags flags) {
 
-        _cleanup_strv_free_erase_ char **password = NULL;
+        _cleanup_sd_strv_free_erase_ char **password = NULL;
         _cleanup_(erase_and_freep) char *envpw = NULL;
         _cleanup_free_ char *question = NULL;
         int r;
@@ -290,7 +290,7 @@ static int acquire_recovery_key(
                 UserRecord *hr,
                 AskPasswordFlags flags) {
 
-        _cleanup_strv_free_erase_ char **recovery_key = NULL;
+        _cleanup_sd_strv_free_erase_ char **recovery_key = NULL;
         _cleanup_(erase_and_freep) char *envpw = NULL;
         _cleanup_free_ char *question = NULL;
         int r;
@@ -348,7 +348,7 @@ static int acquire_token_pin(
                 UserRecord *hr,
                 AskPasswordFlags flags) {
 
-        _cleanup_strv_free_erase_ char **pin = NULL;
+        _cleanup_sd_strv_free_erase_ char **pin = NULL;
         _cleanup_(erase_and_freep) char *envpin = NULL;
         _cleanup_free_ char *question = NULL;
         int r;
@@ -418,7 +418,7 @@ static int handle_generic_user_record_er
 
         else if (sd_bus_error_has_name(error, BUS_ERROR_BAD_PASSWORD)) {
 
-                if (!strv_isempty(hr->password))
+                if (!sd_strv_isempty(hr->password))
                         log_notice("Password incorrect or not sufficient, please try again.");
 
                 /* Don't consume cache entries or credentials here, we already tried that unsuccessfully. But
@@ -433,7 +433,7 @@ static int handle_generic_user_record_er
 
         } else if (sd_bus_error_has_name(error, BUS_ERROR_BAD_RECOVERY_KEY)) {
 
-                if (!strv_isempty(hr->password))
+                if (!sd_strv_isempty(hr->password))
                         log_notice("Recovery key incorrect or not sufficient, please try again.");
 
                 /* Don't consume cache entries or credentials here, we already tried that unsuccessfully. But
@@ -447,7 +447,7 @@ static int handle_generic_user_record_er
 
         } else if (sd_bus_error_has_name(error, BUS_ERROR_BAD_PASSWORD_AND_NO_TOKEN)) {
 
-                if (strv_isempty(hr->password))
+                if (sd_strv_isempty(hr->password))
                         log_notice("Security token not inserted, please enter password.");
                 else
                         log_notice("Password incorrect or not sufficient, and configured security token not inserted, please try again.");
@@ -695,7 +695,7 @@ static char **mangle_user_list(char **li
         _cleanup_free_ char *myself = NULL;
         char **l;
 
-        if (!strv_isempty(list)) {
+        if (!sd_strv_isempty(list)) {
                 *ret_allocated = NULL;
                 return list;
         }
@@ -717,7 +717,7 @@ static char **mangle_user_list(char **li
 
 static int inspect_home(int argc, char *argv[], void *userdata) {
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **mangled_list = NULL;
+        _cleanup_sd_strv_free_ char **mangled_list = NULL;
         int r, ret = 0;
         char **items;
 
@@ -800,7 +800,7 @@ static int inspect_home(int argc, char *
 
 static int authenticate_home(int argc, char *argv[], void *userdata) {
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **mangled_list = NULL;
+        _cleanup_sd_strv_free_ char **mangled_list = NULL;
         int r, ret = 0;
         char **items;
 
@@ -924,7 +924,7 @@ static int apply_identity_changes(JsonVa
         if (r < 0)
                 return log_error_errno(r, "Failed to merge identities: %m");
 
-        if (arg_identity_extra_this_machine || !strv_isempty(arg_identity_filter)) {
+        if (arg_identity_extra_this_machine || !sd_strv_isempty(arg_identity_filter)) {
                 _cleanup_(json_variant_unrefp) JsonVariant *per_machine = NULL, *mmid = NULL;
                 sd_id128_t mid;
 
@@ -1219,7 +1219,7 @@ static int acquire_new_password(
                 (void) suggest_passwords();
 
         for (;;) {
-                _cleanup_strv_free_erase_ char **first = NULL, **second = NULL;
+                _cleanup_sd_strv_free_erase_ char **first = NULL, **second = NULL;
                 _cleanup_free_ char *question = NULL;
 
                 if (--i == 0)
@@ -1243,7 +1243,7 @@ static int acquire_new_password(
                 if (r < 0)
                         return log_error_errno(r, "Failed to acquire password: %m");
 
-                assert(!strv_isempty(first));
+                assert(!sd_strv_isempty(first));
 
                 question = mfree(question);
                 if (asprintf(&question, "Please enter new password for user %s (repeat):", user_name) < 0)
@@ -1426,9 +1426,9 @@ static int create_home_common(JsonVarian
 
         /* If the JSON record carries no plain text password (besides the recovery key), then let's query it
          * manually. */
-        if (strv_length(hr->password) <= arg_recovery_key) {
+        if (sd_strv_length(hr->password) <= arg_recovery_key) {
 
-                if (strv_isempty(hr->hashed_password)) {
+                if (sd_strv_isempty(hr->hashed_password)) {
                         _cleanup_(erase_and_freep) char *new_password = NULL;
 
                         /* No regular (i.e. non-PKCS#11) hashed passwords set in the record, let's fix that. */
@@ -2142,7 +2142,7 @@ static int with_home(int argc, char *arg
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
         _cleanup_(user_record_unrefp) UserRecord *secret = NULL;
         _cleanup_close_ int acquired_fd = -EBADF;
-        _cleanup_strv_free_ char **cmdline  = NULL;
+        _cleanup_sd_strv_free_ char **cmdline  = NULL;
         const char *home;
         int r, ret;
         pid_t pid;
@@ -2159,9 +2159,9 @@ static int with_home(int argc, char *arg
                 if (r < 0)
                         return log_error_errno(r, "Failed to acquire shell: %m");
 
-                cmdline = strv_new(shell);
+                cmdline = sd_strv_new(shell);
         } else
-                cmdline = strv_copy(argv + 2);
+                cmdline = sd_strv_copy(argv + 2);
         if (!cmdline)
                 return log_oom();
 
@@ -2515,7 +2515,7 @@ static int drop_from_identity(const char
 
         /* If we are called to update an identity record and drop some field, let's keep track of what to
          * remove from the old record */
-        r = strv_extend(&arg_identity_filter, field);
+        r = sd_strv_extend(&arg_identity_filter, field);
         if (r < 0)
                 return log_oom();
 
@@ -2724,7 +2724,7 @@ static int help(int argc, char *argv[],
 }
 
 static int parse_argv(int argc, char *argv[]) {
-        _cleanup_strv_free_ char **arg_languages = NULL;
+        _cleanup_sd_strv_free_ char **arg_languages = NULL;
 
         enum {
                 ARG_VERSION = 0x100,
@@ -3133,7 +3133,7 @@ static int parse_argv(int argc, char *ar
                                 if (r < 0)
                                         return r;
 
-                                arg_identity_filter_rlimits = strv_free(arg_identity_filter_rlimits);
+                                arg_identity_filter_rlimits = sd_strv_free(arg_identity_filter_rlimits);
                                 arg_identity_extra_rlimits = json_variant_unref(arg_identity_extra_rlimits);
                                 break;
                         }
@@ -3153,7 +3153,7 @@ static int parse_argv(int argc, char *ar
                         if (isempty(eq + 1)) {
                                 /* Remove only the specific rlimit */
 
-                                r = strv_extend(&arg_identity_filter_rlimits, rlimit_to_string(l));
+                                r = sd_strv_extend(&arg_identity_filter_rlimits, rlimit_to_string(l));
                                 if (r < 0)
                                         return r;
 
@@ -3330,7 +3330,7 @@ static int parse_argv(int argc, char *ar
                                 if (r < 0)
                                         return r;
 
-                                arg_languages = strv_free(arg_languages);
+                                arg_languages = sd_strv_free(arg_languages);
                                 break;
                         }
 
@@ -3349,7 +3349,7 @@ static int parse_argv(int argc, char *ar
                                 if (locale_is_installed(word) <= 0)
                                         log_warning("Locale '%s' is not installed, accepting anyway.", word);
 
-                                r = strv_consume(&arg_languages, TAKE_PTR(word));
+                                r = sd_strv_consume(&arg_languages, TAKE_PTR(word));
                                 if (r < 0)
                                         return log_oom();
 
@@ -3591,7 +3591,7 @@ static int parse_argv(int argc, char *ar
 
                 case ARG_SSH_AUTHORIZED_KEYS: {
                         _cleanup_(json_variant_unrefp) JsonVariant *v = NULL;
-                        _cleanup_strv_free_ char **l = NULL, **add = NULL;
+                        _cleanup_sd_strv_free_ char **l = NULL, **add = NULL;
 
                         if (isempty(optarg)) {
                                 r = drop_from_identity("sshAuthorizedKeys");
@@ -3625,7 +3625,7 @@ static int parse_argv(int argc, char *ar
                                         if (line[0] == '#')
                                                 continue;
 
-                                        r = strv_consume(&add, TAKE_PTR(line));
+                                        r = sd_strv_consume(&add, TAKE_PTR(line));
                                         if (r < 0)
                                                 return log_oom();
                                 }
@@ -3638,7 +3638,7 @@ static int parse_argv(int argc, char *ar
                                 if (optarg[0] == '#')
                                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Specified key is a comment?");
 
-                                add = strv_new(optarg);
+                                add = sd_strv_new(optarg);
                                 if (!add)
                                         return log_oom();
                         }
@@ -3650,7 +3650,7 @@ static int parse_argv(int argc, char *ar
                                         return log_error_errno(r, "Failed to parse SSH authorized keys list: %m");
                         }
 
-                        r = strv_extend_strv(&l, add, true);
+                        r = sd_sd_strv_extend_strv(&l, add, true);
                         if (r < 0)
                                 return log_oom();
 
@@ -3815,7 +3815,7 @@ static int parse_argv(int argc, char *ar
 
                         for (;;) {
                                 _cleanup_(json_variant_unrefp) JsonVariant *mo = NULL;
-                                _cleanup_strv_free_ char **list = NULL;
+                                _cleanup_sd_strv_free_ char **list = NULL;
                                 _cleanup_free_ char *word = NULL;
 
                                 r = extract_first_word(&p, &word, ",", 0);
@@ -3833,7 +3833,7 @@ static int parse_argv(int argc, char *ar
                                 if (r < 0)
                                         return log_error_errno(r, "Failed to parse group list: %m");
 
-                                r = strv_extend(&list, word);
+                                r = sd_strv_extend(&list, word);
                                 if (r < 0)
                                         return log_oom();
 
@@ -3945,7 +3945,7 @@ static int parse_argv(int argc, char *ar
                         }
 
                         if (isempty(optarg)) {
-                                arg_pkcs11_token_uri = strv_free(arg_pkcs11_token_uri);
+                                arg_pkcs11_token_uri = sd_strv_free(arg_pkcs11_token_uri);
                                 break;
                         }
 
@@ -3955,12 +3955,12 @@ static int parse_argv(int argc, char *ar
                                 r = pkcs11_find_token_auto(&found);
                                 if (r < 0)
                                         return r;
-                                r = strv_consume(&arg_pkcs11_token_uri, TAKE_PTR(found));
+                                r = sd_strv_consume(&arg_pkcs11_token_uri, TAKE_PTR(found));
                         } else {
                                 if (!pkcs11_uri_valid(optarg))
                                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Not a valid PKCS#11 URI: %s", optarg);
 
-                                r = strv_extend(&arg_pkcs11_token_uri, optarg);
+                                r = sd_strv_extend(&arg_pkcs11_token_uri, optarg);
                         }
                         if (r < 0)
                                 return r;
@@ -3985,7 +3985,7 @@ static int parse_argv(int argc, char *ar
                         }
 
                         if (isempty(optarg)) {
-                                arg_fido2_device = strv_free(arg_fido2_device);
+                                arg_fido2_device = sd_strv_free(arg_fido2_device);
                                 break;
                         }
 
@@ -3996,9 +3996,9 @@ static int parse_argv(int argc, char *ar
                                 if (r < 0)
                                         return r;
 
-                                r = strv_consume(&arg_fido2_device, TAKE_PTR(found));
+                                r = sd_strv_consume(&arg_fido2_device, TAKE_PTR(found));
                         } else
-                                r = strv_extend(&arg_fido2_device, optarg);
+                                r = sd_strv_extend(&arg_fido2_device, optarg);
                         if (r < 0)
                                 return r;
 
@@ -4167,7 +4167,7 @@ static int parse_argv(int argc, char *ar
 
                 case ARG_CAPABILITY_AMBIENT_SET:
                 case ARG_CAPABILITY_BOUNDING_SET: {
-                        _cleanup_strv_free_ char **l = NULL;
+                        _cleanup_sd_strv_free_ char **l = NULL;
                         bool subtract = false;
                         uint64_t parsed, *which, updated;
                         const char *p, *field;
@@ -4304,13 +4304,13 @@ static int parse_argv(int argc, char *ar
                 }
         }
 
-        if (!strv_isempty(arg_pkcs11_token_uri) || !strv_isempty(arg_fido2_device))
+        if (!sd_strv_isempty(arg_pkcs11_token_uri) || !sd_strv_isempty(arg_fido2_device))
                 arg_and_change_password = true;
 
         if (arg_disk_size != UINT64_MAX || arg_disk_size_relative != UINT64_MAX)
                 arg_and_resize = true;
 
-        if (!strv_isempty(arg_languages)) {
+        if (!sd_strv_isempty(arg_languages)) {
                 char **additional;
 
                 r = json_variant_set_field_string(&arg_identity_extra, "preferredLanguage", arg_languages[0]);
@@ -4318,7 +4318,7 @@ static int parse_argv(int argc, char *ar
                         return log_error_errno(r, "Failed to update preferred language: %m");
 
                 additional = strv_skip(arg_languages, 1);
-                if (!strv_isempty(additional)) {
+                if (!sd_strv_isempty(additional)) {
                         r = json_variant_set_field_strv(&arg_identity_extra, "additionalLanguages", additional);
                         if (r < 0)
                                 return log_error_errno(r, "Failed to update additional language list: %m");
@@ -4386,7 +4386,7 @@ static bool is_fallback_shell(const char
 static int fallback_shell(int argc, char *argv[]) {
         _cleanup_(user_record_unrefp) UserRecord *secret = NULL, *hr = NULL;
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_free_ char *argv0 = NULL;
         const char *json, *hd, *shell;
         int r, incomplete;
@@ -4542,11 +4542,11 @@ static int fallback_shell(int argc, char
         if (!argv || isempty(argv[0]) || argv[0][0] == '-')
                 argv0[0] = '-';
 
-        l = strv_new(argv0);
+        l = sd_strv_new(argv0);
         if (!l)
                 return log_oom();
 
-        if (strv_extend_strv(&l, strv_skip(argv, 1), /* filter_duplicates= */ false) < 0)
+        if (sd_sd_strv_extend_strv(&l, strv_skip(argv, 1), /* filter_duplicates= */ false) < 0)
                 return log_oom();
 
         execv(shell, l);
diff '--color=auto' -Nurp a/src/home/homed-home-bus.c b/src/home/homed-home-bus.c
--- a/src/home/homed-home-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homed-home-bus.c	2025-06-30 18:33:49.000000000 +0000
@@ -793,7 +793,7 @@ static int bus_home_node_enumerator(
                 char ***nodes,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = userdata;
         size_t k = 0;
         Home *h;
diff '--color=auto' -Nurp a/src/home/homed-home.c b/src/home/homed-home.c
--- a/src/home/homed-home.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homed-home.c	2025-06-30 18:37:25.000000000 +0000
@@ -1984,7 +1984,7 @@ int home_passwd(Home *h,
         if (r < 0)
                 return r;
 
-        if (!strv_isempty(new_secret->password)) {
+        if (!sd_strv_isempty(new_secret->password)) {
                 /* Update the password only if one is specified, otherwise let's just reuse the old password
                  * data. This is useful as a way to propagate updated user records into the LUKS backends
                  * properly. */
@@ -3223,7 +3223,7 @@ int home_auto_login(Home *h, char ***ret
         }
 
         if (seat || seat2) {
-                _cleanup_strv_free_ char **list = NULL;
+                _cleanup_sd_strv_free_ char **list = NULL;
                 size_t i = 0;
 
                 list = new(char*, 3);
diff '--color=auto' -Nurp a/src/home/homed-manager-bus.c b/src/home/homed-manager-bus.c
--- a/src/home/homed-manager-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homed-manager-bus.c	2025-06-30 18:33:49.000000000 +0000
@@ -37,7 +37,7 @@ static int property_get_auto_login(
                 return r;
 
         HASHMAP_FOREACH(h, m->homes_by_name) {
-                _cleanup_strv_free_ char **seats = NULL;
+                _cleanup_sd_strv_free_ char **seats = NULL;
                 _cleanup_free_ char *home_path = NULL;
 
                 r = home_auto_login(h, &seats);
diff '--color=auto' -Nurp a/src/home/homed-manager.c b/src/home/homed-manager.c
--- a/src/home/homed-manager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homed-manager.c	2025-06-30 18:37:42.000000000 +0000
@@ -1143,7 +1143,7 @@ static ssize_t read_datagram(
 }
 
 static int on_notify_socket(sd_event_source *s, int fd, uint32_t revents, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_free_ void *datagram = NULL;
         _cleanup_close_ int passed_fd = -EBADF;
         struct ucred sender = UCRED_INVALID;
@@ -1171,7 +1171,7 @@ static int on_notify_socket(sd_event_sou
                 return 0;
         }
 
-        l = strv_split(datagram, "\n");
+        l = sd_strv_split(datagram, "\n");
         if (!l)
                 return log_oom();
 
@@ -1575,7 +1575,7 @@ static int manager_load_public_key_one(M
 }
 
 static int manager_load_public_keys(Manager *m) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(m);
diff '--color=auto' -Nurp a/src/home/homework-fido2.c b/src/home/homework-fido2.c
--- a/src/home/homework-fido2.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homework-fido2.c	2025-06-30 18:37:25.000000000 +0000
@@ -47,7 +47,7 @@ int fido2_use_token(
 
         if (salt->client_pin > 0) {
 
-                if (strv_isempty(secret->token_pin))
+                if (sd_strv_isempty(secret->token_pin))
                         return -ENOANO;
 
                 flags |= FIDO2ENROLL_PIN;
diff '--color=auto' -Nurp a/src/home/homework-luks.c b/src/home/homework-luks.c
--- a/src/home/homework-luks.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homework-luks.c	2025-06-30 18:35:00.000000000 +0000
@@ -2147,7 +2147,7 @@ int home_create_luks(
         const char *fstype, *ip;
         struct statfs sfs;
         int r;
-        _cleanup_strv_free_ char **extra_mkfs_options = NULL;
+        _cleanup_sd_strv_free_ char **extra_mkfs_options = NULL;
 
         assert(h);
         assert(h->storage < 0 || h->storage == USER_LUKS);
@@ -3639,7 +3639,7 @@ int home_passwd_luks(
         if (r < 0)
                 return log_error_errno(r, "Failed to unlock LUKS superblock: %m");
 
-        n_effective = strv_length(effective_passwords);
+        n_effective = sd_strv_length(effective_passwords);
 
         build_good_pbkdf(&good_pbkdf, h);
         build_minimal_pbkdf(&minimal_pbkdf, h);
diff '--color=auto' -Nurp a/src/home/homework-password-cache.c b/src/home/homework-password-cache.c
--- a/src/home/homework-password-cache.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homework-password-cache.c	2025-06-30 18:33:49.000000000 +0000
@@ -10,8 +10,8 @@ void password_cache_free(PasswordCache *
                 return;
 
         cache->volume_key = erase_and_free(cache->volume_key);
-        cache->pkcs11_passwords = strv_free_erase(cache->pkcs11_passwords);
-        cache->fido2_passwords = strv_free_erase(cache->fido2_passwords);
+        cache->pkcs11_passwords = sd_strv_free_erase(cache->pkcs11_passwords);
+        cache->fido2_passwords = sd_strv_free_erase(cache->fido2_passwords);
 }
 
 void password_cache_load_keyring(UserRecord *h, PasswordCache *cache) {
diff '--color=auto' -Nurp a/src/home/homework-pkcs11.c b/src/home/homework-pkcs11.c
--- a/src/home/homework-pkcs11.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/homework-pkcs11.c	2025-06-30 18:37:25.000000000 +0000
@@ -60,7 +60,7 @@ int pkcs11_callback(
                 goto decrypt;
         }
 
-        if (strv_isempty(data->secret->token_pin))
+        if (sd_strv_isempty(data->secret->token_pin))
                 return log_error_errno(SYNTHETIC_ERRNO(ENOANO), "Security token requires PIN.");
 
         STRV_FOREACH(i, data->secret->token_pin) {
diff '--color=auto' -Nurp a/src/home/homework.c b/src/home/homework.c
--- a/src/home/homework.c	2025-06-30 18:55:45.263159937 +0000
+++ b/src/home/homework.c	2025-06-30 18:37:25.000000000 +0000
@@ -189,7 +189,7 @@ int user_record_authenticate(
 
                         log_info("Decrypted password from PKCS#11 security token %s unlocks user record.", data.encrypted_key->uri);
 
-                        r = strv_extend(&cache->pkcs11_passwords, data.decrypted_password);
+                        r = sd_strv_extend(&cache->pkcs11_passwords, data.decrypted_password);
                         if (r < 0)
                                 return log_oom();
 
@@ -242,7 +242,7 @@ int user_record_authenticate(
 
                         log_info("Decrypted password from FIDO2 security token unlocks user record.");
 
-                        r = strv_extend(&cache->fido2_passwords, decrypted_password);
+                        r = sd_strv_extend(&cache->fido2_passwords, decrypted_password);
                         if (r < 0)
                                 return log_oom();
 
@@ -1124,7 +1124,7 @@ static int user_record_compile_effective
                 PasswordCache *cache,
                 char ***ret_effective_passwords) {
 
-        _cleanup_strv_free_erase_ char **effective = NULL;
+        _cleanup_sd_strv_free_erase_ char **effective = NULL;
         int r;
 
         assert(h);
@@ -1134,7 +1134,7 @@ static int user_record_compile_effective
          * a safe fallback, but also to simplify the password changing algorithm: there we require providing
          * the old literal password only (and do not care for the old PKCS#11 token) */
 
-        if (strv_isempty(h->hashed_password))
+        if (sd_strv_isempty(h->hashed_password))
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "User record has no hashed passwords, refusing.");
 
@@ -1154,7 +1154,7 @@ static int user_record_compile_effective
                                 return log_error_errno(r, "Failed to test plaintext password: %m");
                         if (r > 0) {
                                 if (ret_effective_passwords) {
-                                        r = strv_extend(&effective, *j);
+                                        r = sd_strv_extend(&effective, *j);
                                         if (r < 0)
                                                 return log_oom();
                                 }
@@ -1194,7 +1194,7 @@ static int user_record_compile_effective
                                 return log_error_errno(r, "Failed to test plaintext recovery key: %m");
                         if (r > 0) {
                                 if (ret_effective_passwords) {
-                                        r = strv_extend(&effective, p);
+                                        r = sd_strv_extend(&effective, p);
                                         if (r < 0)
                                                 return log_oom();
                                 }
@@ -1231,12 +1231,12 @@ static int user_record_compile_effective
                         return log_error_errno(SYNTHETIC_ERRNO(EPERM), "Decrypted password from token is not correct, refusing.");
 
                 if (ret_effective_passwords) {
-                        r = strv_extend(&effective, data.decrypted_password);
+                        r = sd_strv_extend(&effective, data.decrypted_password);
                         if (r < 0)
                                 return log_oom();
                 }
 
-                r = strv_extend(&cache->pkcs11_passwords, data.decrypted_password);
+                r = sd_strv_extend(&cache->pkcs11_passwords, data.decrypted_password);
                 if (r < 0)
                         return log_oom();
 #else
@@ -1260,12 +1260,12 @@ static int user_record_compile_effective
                                                "Decrypted password from token is not correct, refusing.");
 
                 if (ret_effective_passwords) {
-                        r = strv_extend(&effective, decrypted_password);
+                        r = sd_strv_extend(&effective, decrypted_password);
                         if (r < 0)
                                 return log_oom();
                 }
 
-                r = strv_extend(&cache->fido2_passwords, decrypted_password);
+                r = sd_strv_extend(&cache->fido2_passwords, decrypted_password);
                 if (r < 0)
                         return log_oom();
 #else
@@ -1343,7 +1343,7 @@ static int determine_default_storage(Use
 }
 
 static int home_create(UserRecord *h, Hashmap *blobs, UserRecord **ret_home) {
-        _cleanup_strv_free_erase_ char **effective_passwords = NULL;
+        _cleanup_sd_strv_free_erase_ char **effective_passwords = NULL;
         _cleanup_(home_setup_done) HomeSetup setup = HOME_SETUP_INIT;
         _cleanup_(user_record_unrefp) UserRecord *new_home = NULL;
         _cleanup_(password_cache_free) PasswordCache cache = {};
@@ -1749,7 +1749,7 @@ static int home_resize(UserRecord *h, Us
 
 static int home_passwd(UserRecord *h, UserRecord **ret_home) {
         _cleanup_(user_record_unrefp) UserRecord *header_home = NULL, *embedded_home = NULL, *new_home = NULL;
-        _cleanup_strv_free_erase_ char **effective_passwords = NULL;
+        _cleanup_sd_strv_free_erase_ char **effective_passwords = NULL;
         _cleanup_(home_setup_done) HomeSetup setup = HOME_SETUP_INIT;
         _cleanup_(password_cache_free) PasswordCache cache = {};
         HomeSetupFlags flags = 0;
@@ -2117,7 +2117,7 @@ static int run(int argc, char *argv[]) {
                 r = home_unlock(home);
         else
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Unknown verb '%s'.", argv[1]);
-        if (IN_SET(r, -ENOKEY, -EREMOTEIO) && !strv_isempty(home->password) ) { /* There were passwords specified but they were incorrect */
+        if (IN_SET(r, -ENOKEY, -EREMOTEIO) && !sd_strv_isempty(home->password) ) { /* There were passwords specified but they were incorrect */
                 usec_t end, n, d;
 
                 /* Make sure bad password replies always take at least 3s, and if longer multiples of 3s, so
diff '--color=auto' -Nurp a/src/home/pam_systemd_home.c b/src/home/pam_systemd_home.c
--- a/src/home/pam_systemd_home.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/pam_systemd_home.c	2025-06-30 18:37:25.000000000 +0000
@@ -306,7 +306,7 @@ static int handle_generic_user_record_er
 
                 /* This didn't work? Ask for an (additional?) password */
 
-                if (strv_isempty(secret->password))
+                if (sd_strv_isempty(secret->password))
                         r = pam_prompt_graceful(handle, PAM_PROMPT_ECHO_OFF, &newp, _("Password: "));
                 else {
                         (void) pam_prompt_graceful(handle, PAM_ERROR_MSG, NULL, _("Password incorrect or not sufficient for authentication of user %s."), user_name);
@@ -331,7 +331,7 @@ static int handle_generic_user_record_er
 
                 /* Hmm, homed asks for recovery key (because no regular password is defined maybe)? Provide it. */
 
-                if (strv_isempty(secret->password))
+                if (sd_strv_isempty(secret->password))
                         r = pam_prompt_graceful(handle, PAM_PROMPT_ECHO_OFF, &newp, _("Recovery key: "));
                 else {
                         (void) pam_prompt_graceful(handle, PAM_ERROR_MSG, NULL, _("Password/recovery key incorrect or not sufficient for authentication of user %s."), user_name);
@@ -354,7 +354,7 @@ static int handle_generic_user_record_er
 
                 assert(secret);
 
-                if (strv_isempty(secret->password)) {
+                if (sd_strv_isempty(secret->password)) {
                         (void) pam_prompt_graceful(handle, PAM_ERROR_MSG, NULL, _("Security token of user %s not inserted."), user_name);
                         r = pam_prompt_graceful(handle, PAM_PROMPT_ECHO_OFF, &newp, _("Try again with password: "));
                 } else {
@@ -681,7 +681,7 @@ static int acquire_home(
         }
 
         /* Later PAM modules may need the auth token, but only during pam_authenticate. */
-        if (FLAGS_SET(flags, ACQUIRE_MUST_AUTHENTICATE) && !strv_isempty(secret->password)) {
+        if (FLAGS_SET(flags, ACQUIRE_MUST_AUTHENTICATE) && !sd_strv_isempty(secret->password)) {
                 r = pam_set_item(handle, PAM_AUTHTOK, *secret->password);
                 if (r != PAM_SUCCESS)
                         return pam_syslog_pam_error(handle, LOG_ERR, r, "Failed to set PAM auth token: @PAMERR@");
diff '--color=auto' -Nurp a/src/home/user-record-util.c b/src/home/user-record-util.c
--- a/src/home/user-record-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/home/user-record-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -578,7 +578,7 @@ int user_record_test_password(UserRecord
 
         /* Checks whether any of the specified passwords matches any of the hashed passwords of the entry */
 
-        if (strv_isempty(h->hashed_password))
+        if (sd_strv_isempty(h->hashed_password))
                 return -ENXIO;
 
         STRV_FOREACH(i, secret->password) {
@@ -785,7 +785,7 @@ int user_record_update_last_changed(User
 
 int user_record_make_hashed_password(UserRecord *h, char **secret, bool extend) {
         _cleanup_(json_variant_unrefp) JsonVariant *priv = NULL;
-        _cleanup_strv_free_ char **np = NULL;
+        _cleanup_sd_strv_free_ char **np = NULL;
         int r;
 
         assert(h);
@@ -794,7 +794,7 @@ int user_record_make_hashed_password(Use
         /* Initializes the hashed password list from the specified plaintext passwords */
 
         if (extend) {
-                np = strv_copy(h->hashed_password);
+                np = sd_strv_copy(h->hashed_password);
                 if (!np)
                         return -ENOMEM;
 
@@ -808,14 +808,14 @@ int user_record_make_hashed_password(Use
                 if (r < 0)
                         return r;
 
-                r = strv_consume(&np, TAKE_PTR(hashed));
+                r = sd_strv_consume(&np, TAKE_PTR(hashed));
                 if (r < 0)
                         return r;
         }
 
         priv = json_variant_ref(json_variant_by_key(h->json, "privileged"));
 
-        if (strv_isempty(np))
+        if (sd_strv_isempty(np))
                 r = json_variant_filter(&priv, STRV_MAKE("hashedPassword"));
         else {
                 _cleanup_(json_variant_unrefp) JsonVariant *new_array = NULL;
@@ -833,7 +833,7 @@ int user_record_make_hashed_password(Use
         if (r < 0)
                 return r;
 
-        strv_free_and_replace(h->hashed_password, np);
+        sd_strv_free_and_replace(h->hashed_password, np);
 
         SET_FLAG(h->mask, USER_RECORD_PRIVILEGED, !json_variant_is_blank_object(priv));
         return 0;
@@ -841,19 +841,19 @@ int user_record_make_hashed_password(Use
 
 int user_record_set_hashed_password(UserRecord *h, char **hashed_password) {
         _cleanup_(json_variant_unrefp) JsonVariant *priv = NULL;
-        _cleanup_strv_free_ char **copy = NULL;
+        _cleanup_sd_strv_free_ char **copy = NULL;
         int r;
 
         assert(h);
 
         priv = json_variant_ref(json_variant_by_key(h->json, "privileged"));
 
-        if (strv_isempty(hashed_password))
+        if (sd_strv_isempty(hashed_password))
                 r = json_variant_filter(&priv, STRV_MAKE("hashedPassword"));
         else {
                 _cleanup_(json_variant_unrefp) JsonVariant *array = NULL;
 
-                copy = strv_copy(hashed_password);
+                copy = sd_strv_copy(hashed_password);
                 if (!copy)
                         return -ENOMEM;
 
@@ -872,7 +872,7 @@ int user_record_set_hashed_password(User
         if (r < 0)
                 return r;
 
-        strv_free_and_replace(h->hashed_password, copy);
+        sd_strv_free_and_replace(h->hashed_password, copy);
 
         SET_FLAG(h->mask, USER_RECORD_PRIVILEGED, !json_variant_is_blank_object(priv));
         return 0;
@@ -880,17 +880,17 @@ int user_record_set_hashed_password(User
 
 int user_record_set_password(UserRecord *h, char **password, bool prepend) {
         _cleanup_(json_variant_unrefp) JsonVariant *w = NULL;
-        _cleanup_strv_free_erase_ char **e = NULL;
+        _cleanup_sd_strv_free_erase_ char **e = NULL;
         int r;
 
         assert(h);
 
         if (prepend) {
-                e = strv_copy(password);
+                e = sd_strv_copy(password);
                 if (!e)
                         return -ENOMEM;
 
-                r = strv_extend_strv(&e, h->password, true);
+                r = sd_sd_strv_extend_strv(&e, h->password, true);
                 if (r < 0)
                         return r;
 
@@ -903,7 +903,7 @@ int user_record_set_password(UserRecord
                 if (strv_equal(h->password, password))
                         return 0;
 
-                e = strv_copy(password);
+                e = sd_strv_copy(password);
                 if (!e)
                         return -ENOMEM;
 
@@ -912,7 +912,7 @@ int user_record_set_password(UserRecord
 
         w = json_variant_ref(json_variant_by_key(h->json, "secret"));
 
-        if (strv_isempty(e))
+        if (sd_strv_isempty(e))
                 r = json_variant_filter(&w, STRV_MAKE("password"));
         else {
                 _cleanup_(json_variant_unrefp) JsonVariant *l = NULL;
@@ -934,7 +934,7 @@ int user_record_set_password(UserRecord
         if (r < 0)
                 return r;
 
-        strv_free_and_replace(h->password, e);
+        sd_strv_free_and_replace(h->password, e);
 
         SET_FLAG(h->mask, USER_RECORD_SECRET, !json_variant_is_blank_object(w));
         return 0;
@@ -942,17 +942,17 @@ int user_record_set_password(UserRecord
 
 int user_record_set_token_pin(UserRecord *h, char **pin, bool prepend) {
         _cleanup_(json_variant_unrefp) JsonVariant *w = NULL;
-        _cleanup_strv_free_erase_ char **e = NULL;
+        _cleanup_sd_strv_free_erase_ char **e = NULL;
         int r;
 
         assert(h);
 
         if (prepend) {
-                e = strv_copy(pin);
+                e = sd_strv_copy(pin);
                 if (!e)
                         return -ENOMEM;
 
-                r = strv_extend_strv(&e, h->token_pin, true);
+                r = sd_sd_strv_extend_strv(&e, h->token_pin, true);
                 if (r < 0)
                         return r;
 
@@ -965,7 +965,7 @@ int user_record_set_token_pin(UserRecord
                 if (strv_equal(h->token_pin, pin))
                         return 0;
 
-                e = strv_copy(pin);
+                e = sd_strv_copy(pin);
                 if (!e)
                         return -ENOMEM;
 
@@ -974,7 +974,7 @@ int user_record_set_token_pin(UserRecord
 
         w = json_variant_ref(json_variant_by_key(h->json, "secret"));
 
-        if (strv_isempty(e))
+        if (sd_strv_isempty(e))
                 r = json_variant_filter(&w, STRV_MAKE("tokenPin"));
         else {
                 _cleanup_(json_variant_unrefp) JsonVariant *l = NULL;
@@ -996,7 +996,7 @@ int user_record_set_token_pin(UserRecord
         if (r < 0)
                 return r;
 
-        strv_free_and_replace(h->token_pin, e);
+        sd_strv_free_and_replace(h->token_pin, e);
 
         SET_FLAG(h->mask, USER_RECORD_SECRET, !json_variant_is_blank_object(w));
         return 0;
diff '--color=auto' -Nurp a/src/hostname/hostnamed.c b/src/hostname/hostnamed.c
--- a/src/hostname/hostnamed.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/hostname/hostnamed.c	2025-06-30 18:37:25.000000000 +0000
@@ -637,7 +637,7 @@ static int context_write_data_machine_in
                 [PROP_DEPLOYMENT] = "DEPLOYMENT",
                 [PROP_LOCATION] = "LOCATION",
         };
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(c);
@@ -658,7 +658,7 @@ static int context_write_data_machine_in
                         return r;
         }
 
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 if (unlink("/etc/machine-info") < 0 && errno != ENOENT)
                         return -errno;
 
@@ -1347,7 +1347,7 @@ static int build_describe_response(Conte
         _cleanup_free_ char *hn = NULL, *dhn = NULL, *in = NULL,
                 *chassis = NULL, *vendor = NULL, *model = NULL, *serial = NULL, *firmware_version = NULL,
                 *firmware_vendor = NULL;
-        _cleanup_strv_free_ char **os_release_pairs = NULL, **machine_info_pairs = NULL;
+        _cleanup_sd_strv_free_ char **os_release_pairs = NULL, **machine_info_pairs = NULL;
         usec_t firmware_date = USEC_INFINITY, eol = USEC_INFINITY;
         _cleanup_(json_variant_unrefp) JsonVariant *v = NULL;
         sd_id128_t machine_id, boot_id, product_uuid = SD_ID128_NULL;
diff '--color=auto' -Nurp a/src/id128/id128.c b/src/id128/id128.c
--- a/src/id128/id128.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/id128/id128.c	2025-06-30 18:37:25.000000000 +0000
@@ -117,7 +117,7 @@ static int verb_show(int argc, char **ar
         int r;
 
         argv = strv_skip(argv, 1);
-        if (strv_isempty(argv)) {
+        if (sd_strv_isempty(argv)) {
                 if (!sd_id128_is_null(arg_app))
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                "'show --app-specific=' can only be used with explicit UUID input.");
diff '--color=auto' -Nurp a/src/import/importd.c b/src/import/importd.c
--- a/src/import/importd.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/import/importd.c	2025-06-30 18:37:56.000000000 +0000
@@ -522,7 +522,7 @@ static int transfer_start(Transfer *t) {
                 assert(k < ELEMENTSOF(cmd));
 
                 if (DEBUG_LOGGING) {
-                        _cleanup_free_ char *joined = strv_join((char**) cmd, " ");
+                        _cleanup_free_ char *joined = sd_strv_join((char**) cmd, " ");
                         log_debug("Calling: %s", strnull(joined));
                 }
 
@@ -1438,7 +1438,7 @@ static int transfer_node_enumerator(
                 char ***nodes,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = userdata;
         Transfer *t;
         unsigned k = 0;
diff '--color=auto' -Nurp a/src/import/pull-common.c b/src/import/pull-common.c
--- a/src/import/pull-common.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/import/pull-common.c	2025-06-30 18:36:37.000000000 +0000
@@ -55,7 +55,7 @@ int pull_find_old_etags(
                 return -errno;
         }
 
-        _cleanup_strv_free_ char **ans = NULL;
+        _cleanup_sd_strv_free_ char **ans = NULL;
 
         FOREACH_DIRENT_ALL(de, d, return -errno) {
                 _cleanup_free_ char *u = NULL;
@@ -99,7 +99,7 @@ int pull_find_old_etags(
                 if (!http_etag_is_valid(u))
                         continue;
 
-                r = strv_consume(&ans, TAKE_PTR(u));
+                r = sd_strv_consume(&ans, TAKE_PTR(u));
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/import/pull-job.c b/src/import/pull-job.c
--- a/src/import/pull-job.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/import/pull-job.c	2025-06-30 18:37:56.000000000 +0000
@@ -50,7 +50,7 @@ PullJob* pull_job_unref(PullJob *j) {
 
         free(j->url);
         free(j->etag);
-        strv_free(j->old_etags);
+        sd_strv_free(j->old_etags);
         free(j->payload);
         free(j->checksum);
 
@@ -724,10 +724,10 @@ int pull_job_begin(PullJob *j) {
         if (r < 0)
                 return r;
 
-        if (!strv_isempty(j->old_etags)) {
+        if (!sd_strv_isempty(j->old_etags)) {
                 _cleanup_free_ char *cc = NULL, *hdr = NULL;
 
-                cc = strv_join(j->old_etags, ", ");
+                cc = sd_strv_join(j->old_etags, ", ");
                 if (!cc)
                         return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/journal/journalctl-filter.c b/src/journal/journalctl-filter.c
--- a/src/journal/journalctl-filter.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal/journalctl-filter.c	2025-06-30 18:37:25.000000000 +0000
@@ -116,13 +116,13 @@ static int get_possible_units(
         "_SYSTEMD_USER_SLICE\0"
 
 static int add_units(sd_journal *j) {
-        _cleanup_strv_free_ char **patterns = NULL;
+        _cleanup_sd_strv_free_ char **patterns = NULL;
         bool added = false;
         int r;
 
         assert(j);
 
-        if (strv_isempty(arg_system_units) && strv_isempty(arg_user_units))
+        if (sd_strv_isempty(arg_system_units) && sd_strv_isempty(arg_user_units))
                 return 0;
 
         STRV_FOREACH(i, arg_system_units) {
@@ -133,7 +133,7 @@ static int add_units(sd_journal *j) {
                         return r;
 
                 if (string_is_glob(u)) {
-                        r = strv_consume(&patterns, TAKE_PTR(u));
+                        r = sd_strv_consume(&patterns, TAKE_PTR(u));
                         if (r < 0)
                                 return r;
                 } else {
@@ -147,7 +147,7 @@ static int add_units(sd_journal *j) {
                 }
         }
 
-        if (!strv_isempty(patterns)) {
+        if (!sd_strv_isempty(patterns)) {
                 _cleanup_set_free_ Set *units = NULL;
                 char *u;
 
@@ -166,7 +166,7 @@ static int add_units(sd_journal *j) {
                 }
         }
 
-        patterns = strv_free(patterns);
+        patterns = sd_strv_free(patterns);
 
         STRV_FOREACH(i, arg_user_units) {
                 _cleanup_free_ char *u = NULL;
@@ -176,7 +176,7 @@ static int add_units(sd_journal *j) {
                         return r;
 
                 if (string_is_glob(u)) {
-                        r = strv_consume(&patterns, TAKE_PTR(u));
+                        r = sd_strv_consume(&patterns, TAKE_PTR(u));
                         if (r < 0)
                                 return r;
                 } else {
@@ -190,7 +190,7 @@ static int add_units(sd_journal *j) {
                 }
         }
 
-        if (!strv_isempty(patterns)) {
+        if (!sd_strv_isempty(patterns)) {
                 _cleanup_set_free_ Set *units = NULL;
                 char *u;
 
@@ -222,7 +222,7 @@ static int add_syslog_identifier(sd_jour
 
         assert(j);
 
-        if (strv_isempty(arg_syslog_identifier))
+        if (sd_strv_isempty(arg_syslog_identifier))
                 return 0;
 
         STRV_FOREACH(i, arg_syslog_identifier) {
@@ -391,7 +391,7 @@ static int add_matches(sd_journal *j, ch
 
         assert(j);
 
-        if (strv_isempty(args))
+        if (sd_strv_isempty(args))
                 return 0;
 
         STRV_FOREACH(i, args)
diff '--color=auto' -Nurp a/src/journal/journalctl.c b/src/journal/journalctl.c
--- a/src/journal/journalctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal/journalctl.c	2025-06-30 18:37:42.000000000 +0000
@@ -91,13 +91,13 @@ pcre2_code *arg_compiled_pattern = NULL;
 PatternCompileCase arg_case = PATTERN_COMPILE_CASE_AUTO;
 static ImagePolicy *arg_image_policy = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_file, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_file, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_facilities, set_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_verify_key, erase_and_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_syslog_identifier, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_exclude_identifier, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_system_units, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_user_units, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_syslog_identifier, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_exclude_identifier, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_system_units, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_user_units, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_output_fields, set_freep);
@@ -810,25 +810,25 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case 't':
-                        r = strv_extend(&arg_syslog_identifier, optarg);
+                        r = sd_strv_extend(&arg_syslog_identifier, optarg);
                         if (r < 0)
                                 return log_oom();
                         break;
 
                 case 'T':
-                        r = strv_extend(&arg_exclude_identifier, optarg);
+                        r = sd_strv_extend(&arg_exclude_identifier, optarg);
                         if (r < 0)
                                 return log_oom();
                         break;
 
                 case 'u':
-                        r = strv_extend(&arg_system_units, optarg);
+                        r = sd_strv_extend(&arg_system_units, optarg);
                         if (r < 0)
                                 return log_oom();
                         break;
 
                 case ARG_USER_UNIT:
-                        r = strv_extend(&arg_user_units, optarg);
+                        r = sd_strv_extend(&arg_user_units, optarg);
                         if (r < 0)
                                 return log_oom();
                         break;
@@ -912,9 +912,9 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_OUTPUT_FIELDS: {
-                        _cleanup_strv_free_ char **v = NULL;
+                        _cleanup_sd_strv_free_ char **v = NULL;
 
-                        v = strv_split(optarg, ",");
+                        v = sd_strv_split(optarg, ",");
                         if (!v)
                                 return log_oom();
 
@@ -972,15 +972,15 @@ static int parse_argv(int argc, char *ar
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "Using --boot or --list-boots with --merge is not supported.");
 
-        if (!strv_isempty(arg_system_units) && arg_journal_type == SD_JOURNAL_CURRENT_USER) {
+        if (!sd_strv_isempty(arg_system_units) && arg_journal_type == SD_JOURNAL_CURRENT_USER) {
                 /* Specifying --user and --unit= at the same time makes no sense (as the former excludes the user
                  * journal, but the latter excludes the system journal, thus resulting in empty output). Let's be nice
                  * to users, and automatically turn --unit= into --user-unit= if combined with --user. */
-                r = strv_extend_strv(&arg_user_units, arg_system_units, true);
+                r = sd_sd_strv_extend_strv(&arg_user_units, arg_system_units, true);
                 if (r < 0)
                         return r;
 
-                arg_system_units = strv_free(arg_system_units);
+                arg_system_units = sd_strv_free(arg_system_units);
         }
 
         if (arg_pattern) {
diff '--color=auto' -Nurp a/src/journal/journald-client.c b/src/journal/journald-client.c
--- a/src/journal/journald-client.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal/journald-client.c	2025-06-30 18:33:49.000000000 +0000
@@ -17,7 +17,7 @@ static void client_set_filtering_pattern
 
 static int client_parse_log_filter_nulstr(const char *nulstr, size_t len, Set **ret) {
         _cleanup_set_free_ Set *s = NULL;
-        _cleanup_strv_free_ char **patterns_strv = NULL;
+        _cleanup_sd_strv_free_ char **patterns_strv = NULL;
         int r;
 
         assert(nulstr);
diff '--color=auto' -Nurp a/src/journal/journald-server.c b/src/journal/journald-server.c
--- a/src/journal/journald-server.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal/journald-server.c	2025-06-30 18:33:49.000000000 +0000
@@ -1419,7 +1419,7 @@ finish:
                 journal_file_post_change(s->system_journal);
 
         /* Save parent directories of runtime journals before closing runtime journals. */
-        _cleanup_strv_free_ char **dirs = NULL;
+        _cleanup_sd_strv_free_ char **dirs = NULL;
         (void) journal_get_directories(j, &dirs);
 
         /* First, close all runtime journals opened in the above. */
diff '--color=auto' -Nurp a/src/journal-remote/journal-gatewayd.c b/src/journal-remote/journal-gatewayd.c
--- a/src/journal-remote/journal-gatewayd.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal-remote/journal-gatewayd.c	2025-06-30 18:33:49.000000000 +0000
@@ -50,7 +50,7 @@ static char **arg_file = NULL;
 STATIC_DESTRUCTOR_REGISTER(arg_key_pem, erase_and_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_cert_pem, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_trust_pem, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_file, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_file, sd_strv_freep);
 
 typedef struct RequestMeta {
         sd_journal *journal;
diff '--color=auto' -Nurp a/src/journal-remote/journal-remote-main.c b/src/journal-remote/journal-remote-main.c
--- a/src/journal-remote/journal-remote-main.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal-remote/journal-remote-main.c	2025-06-30 18:37:42.000000000 +0000
@@ -60,7 +60,7 @@ static uint64_t arg_max_size = UINT64_MA
 static uint64_t arg_n_max_files = UINT64_MAX;
 static uint64_t arg_keep_free = UINT64_MAX;
 
-STATIC_DESTRUCTOR_REGISTER(arg_gnutls_log, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_gnutls_log, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_key, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_cert, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_trust, freep);
@@ -129,10 +129,10 @@ static int spawn_curl(const char* url) {
 
 static int spawn_getter(const char *getter) {
         int r;
-        _cleanup_strv_free_ char **words = NULL;
+        _cleanup_sd_strv_free_ char **words = NULL;
 
         assert(getter);
-        r = strv_split_full(&words, getter, WHITESPACE, EXTRACT_UNQUOTE);
+        r = sd_strv_split_full(&words, getter, WHITESPACE, EXTRACT_UNQUOTE);
         if (r < 0)
                 return log_error_errno(r, "Failed to split getter option: %m");
 
@@ -949,7 +949,7 @@ static int parse_argv(int argc, char *ar
                                 if (r == 0)
                                         break;
 
-                                if (strv_push(&arg_gnutls_log, word) < 0)
+                                if (sd_strv_push(&arg_gnutls_log, word) < 0)
                                         return log_oom();
 
                                 word = NULL;
@@ -970,7 +970,7 @@ static int parse_argv(int argc, char *ar
         if (optind < argc)
                 arg_files = argv + optind;
 
-        type_a = arg_getter || !strv_isempty(arg_files);
+        type_a = arg_getter || !sd_strv_isempty(arg_files);
         type_b = arg_url
                 || arg_listen_raw
                 || arg_listen_http || arg_listen_https
diff '--color=auto' -Nurp a/src/journal-remote/journal-upload.c b/src/journal-remote/journal-upload.c
--- a/src/journal-remote/journal-upload.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/journal-remote/journal-upload.c	2025-06-30 18:33:49.000000000 +0000
@@ -59,7 +59,7 @@ static int arg_follow = -1;
 static const char *arg_save_state = NULL;
 static usec_t arg_network_timeout_usec = USEC_INFINITY;
 
-STATIC_DESTRUCTOR_REGISTER(arg_file, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_file, sd_strv_freep);
 
 static void close_fd_input(Uploader *u);
 
diff '--color=auto' -Nurp a/src/kernel-install/kernel-install.c b/src/kernel-install/kernel-install.c
--- a/src/kernel-install/kernel-install.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/kernel-install/kernel-install.c	2025-06-30 18:37:56.000000000 +0000
@@ -115,16 +115,16 @@ static void context_done(Context *c) {
         free(c->entry_dir);
         free(c->version);
         free(c->kernel);
-        strv_free(c->initrds);
+        sd_strv_free(c->initrds);
         free(c->initrd_generator);
         free(c->uki_generator);
         if (c->action == ACTION_INSPECT)
                 free(c->staging_area);
         else
                 rm_rf_physical_and_free(c->staging_area);
-        strv_free(c->plugins);
-        strv_free(c->argv);
-        strv_free(c->envp);
+        sd_strv_free(c->plugins);
+        sd_strv_free(c->argv);
+        sd_strv_free(c->envp);
 
         safe_close(c->rfd);
 }
@@ -173,7 +173,7 @@ static int context_copy(const Context *s
         r = strdup_to(&copy.kernel, source->kernel);
         if (r < 0)
                 return r;
-        r = strv_copy_unless_empty(source->initrds, &copy.initrds);
+        r = sd_strv_copy_unless_empty(source->initrds, &copy.initrds);
         if (r < 0)
                 return r;
         r = strdup_to(&copy.initrd_generator, source->initrd_generator);
@@ -185,13 +185,13 @@ static int context_copy(const Context *s
         r = strdup_to(&copy.staging_area, source->staging_area);
         if (r < 0)
                 return r;
-        r = strv_copy_unless_empty(source->plugins, &copy.plugins);
+        r = sd_strv_copy_unless_empty(source->plugins, &copy.plugins);
         if (r < 0)
                 return r;
-        r = strv_copy_unless_empty(source->argv, &copy.argv);
+        r = sd_strv_copy_unless_empty(source->argv, &copy.argv);
         if (r < 0)
                 return r;
-        r = strv_copy_unless_empty(source->envp, &copy.envp);
+        r = sd_strv_copy_unless_empty(source->envp, &copy.envp);
         if (r < 0)
                 return r;
 
@@ -363,7 +363,7 @@ static int context_set_kernel(Context *c
 }
 
 static int context_set_path_strv(Context *c, char* const* strv, const char *source, const char *name, char ***dest) {
-        _cleanup_strv_free_ char **w = NULL;
+        _cleanup_sd_strv_free_ char **w = NULL;
         int r;
 
         assert(c);
@@ -388,12 +388,12 @@ static int context_set_path_strv(Context
                                 return log_warning_errno(r, "Failed to make path '%s' for %s specified via %s absolute, ignoring: %m",
                                                          *s, name, source);
                 }
-                r = strv_consume(&w, p);
+                r = sd_strv_consume(&w, p);
                 if (r < 0)
                         return log_oom();
         }
 
-        if (strv_isempty(w))
+        if (sd_strv_isempty(w))
                 return 0;
 
         log_debug("%s set via %s", name, source);
@@ -403,14 +403,14 @@ static int context_set_path_strv(Context
 }
 
 static int context_set_plugins(Context *c, const char *s, const char *source) {
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
 
         assert(c);
 
         if (c->plugins || !s)
                 return 0;
 
-        v = strv_split(s, NULL);
+        v = sd_strv_split(s, NULL);
         if (!v)
                 return log_oom();
 
@@ -896,7 +896,7 @@ static int context_remove_entry_dir(Cont
 }
 
 static int context_build_arguments(Context *c) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         const char *verb;
         int r;
 
@@ -928,7 +928,7 @@ static int context_build_arguments(Conte
                 assert_not_reached();
         }
 
-        a = strv_new("dummy-arg", /* to make strv_free() works for this variable. */
+        a = sd_strv_new("dummy-arg", /* to make sd_strv_free() works for this variable. */
                      verb,
                      c->version ?: "KERNEL_VERSION",
                      c->entry_dir);
@@ -936,16 +936,16 @@ static int context_build_arguments(Conte
                 return log_oom();
 
         if (c->action == ACTION_ADD) {
-                r = strv_extend(&a, c->kernel);
+                r = sd_strv_extend(&a, c->kernel);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend_strv(&a, c->initrds, /* filter_duplicates = */ false);
+                r = sd_sd_strv_extend_strv(&a, c->initrds, /* filter_duplicates = */ false);
                 if (r < 0)
                         return log_oom();
 
         } else if (c->action == ACTION_INSPECT) {
-                r = strv_extend_many(
+                r = sd_strv_extend_many(
                                 &a,
                                 c->kernel ?: "[KERNEL_IMAGE]",
                                 "[INITRD...]");
@@ -958,7 +958,7 @@ static int context_build_arguments(Conte
 }
 
 static int context_build_environment(Context *c) {
-        _cleanup_strv_free_ char **e = NULL;
+        _cleanup_sd_strv_free_ char **e = NULL;
         int r;
 
         assert(c);
@@ -1026,13 +1026,13 @@ static int context_execute(Context *c) {
                 return r;
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *x = strv_join_full(c->plugins, "", "\n  ", /* escape_separator = */ false);
+                _cleanup_free_ char *x = sd_strv_join_full(c->plugins, "", "\n  ", /* escape_separator = */ false);
                 log_debug("Using plugins: %s", strna(x));
 
-                _cleanup_free_ char *y = strv_join_full(c->envp, "", "\n  ", /* escape_separator = */ false);
+                _cleanup_free_ char *y = sd_strv_join_full(c->envp, "", "\n  ", /* escape_separator = */ false);
                 log_debug("Plugin environment: %s", strna(y));
 
-                _cleanup_free_ char *z = strv_join(strv_skip(c->argv, 1), " ");
+                _cleanup_free_ char *z = sd_strv_join(strv_skip(c->argv, 1), " ");
                 log_debug("Plugin arguments: %s", strna(z));
         }
 
diff '--color=auto' -Nurp a/src/libsystemd/libsystemd.sym b/src/libsystemd/libsystemd.sym
--- a/src/libsystemd/libsystemd.sym	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/libsystemd.sym	2025-06-30 18:35:42.000000000 +0000
@@ -781,7 +781,7 @@ global:
 
 LIBSYSTEMD_252 {
 global:
-        sd_bus_message_read_strv_extend;
+        sd_bus_message_read_sd_strv_extend;
         sd_bus_error_setfv;
 
         sd_device_new_child;
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/bus-control.c b/src/libsystemd/sd-bus/bus-control.c
--- a/src/libsystemd/sd-bus/bus-control.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/bus-control.c	2025-06-30 18:33:49.000000000 +0000
@@ -362,7 +362,7 @@ _public_ int sd_bus_release_name_async(
 
 _public_ int sd_bus_list_names(sd_bus *bus, char ***acquired, char ***activatable) {
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
-        _cleanup_strv_free_ char **x = NULL, **y = NULL;
+        _cleanup_sd_strv_free_ char **x = NULL, **y = NULL;
         int r;
 
         assert_return(bus, -EINVAL);
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/bus-creds.c b/src/libsystemd/sd-bus/bus-creds.c
--- a/src/libsystemd/sd-bus/bus-creds.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/bus-creds.c	2025-06-30 18:37:25.000000000 +0000
@@ -52,7 +52,7 @@ void bus_creds_done(sd_bus_creds *c) {
                                     * c->allocated is set, see
                                     * below. */
 
-        strv_free(c->cmdline_array);
+        sd_strv_free(c->cmdline_array);
 
         safe_close(c->pidfd);
 }
@@ -100,7 +100,7 @@ _public_ sd_bus_creds *sd_bus_creds_unre
 
                         c->supplementary_gids = mfree(c->supplementary_gids);
 
-                        c->well_known_names = strv_free(c->well_known_names);
+                        c->well_known_names = sd_strv_free(c->well_known_names);
 
                         bus_creds_done(c);
 
@@ -1374,10 +1374,10 @@ int bus_creds_extend_by_pid(sd_bus_creds
         }
 
         if (c->mask & mask & SD_BUS_CREDS_WELL_KNOWN_NAMES) {
-                if (strv_isempty(c->well_known_names))
+                if (sd_strv_isempty(c->well_known_names))
                         n->well_known_names = NULL;
                 else {
-                        n->well_known_names = strv_copy(c->well_known_names);
+                        n->well_known_names = sd_strv_copy(c->well_known_names);
                         if (!n->well_known_names)
                                 return -ENOMEM;
                 }
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/bus-match.c b/src/libsystemd/sd-bus/bus-match.c
--- a/src/libsystemd/sd-bus/bus-match.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/bus-match.c	2025-06-30 18:33:49.000000000 +0000
@@ -240,7 +240,7 @@ int bus_match_run(
                 struct bus_match_node *node,
                 sd_bus_message *m) {
 
-        _cleanup_strv_free_ char **test_strv = NULL;
+        _cleanup_sd_strv_free_ char **test_strv = NULL;
         const char *test_str = NULL;
         uint8_t test_u8 = 0;
         int r;
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/bus-message.c b/src/libsystemd/sd-bus/bus-message.c
--- a/src/libsystemd/sd-bus/bus-message.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/bus-message.c	2025-06-30 18:36:07.000000000 +0000
@@ -4296,7 +4296,7 @@ int bus_message_get_blob(sd_bus_message
         return 0;
 }
 
-_public_ int sd_bus_message_read_strv_extend(sd_bus_message *m, char ***l) {
+_public_ int sd_bus_message_read_sd_strv_extend(sd_bus_message *m, char ***l) {
         char type;
         const char *contents, *s;
         int r;
@@ -4317,7 +4317,7 @@ _public_ int sd_bus_message_read_strv_ex
 
         /* sd_bus_message_read_basic() does content validation for us. */
         while ((r = sd_bus_message_read_basic(m, *contents, &s)) > 0) {
-                r = strv_extend(l, s);
+                r = sd_strv_extend(l, s);
                 if (r < 0)
                         return r;
         }
@@ -4332,14 +4332,14 @@ _public_ int sd_bus_message_read_strv_ex
 }
 
 _public_ int sd_bus_message_read_strv(sd_bus_message *m, char ***l) {
-        _cleanup_strv_free_ char **strv = NULL;
+        _cleanup_sd_strv_free_ char **strv = NULL;
         int r;
 
         assert_return(m, -EINVAL);
         assert_return(m->sealed, -EPERM);
         assert_return(l, -EINVAL);
 
-        r = sd_bus_message_read_strv_extend(m, &strv);
+        r = sd_bus_message_read_sd_strv_extend(m, &strv);
         if (r <= 0)
                 return r;
 
@@ -4691,24 +4691,24 @@ _public_ int sd_bus_message_sensitive(sd
 }
 
 char** bus_message_make_log_fields(sd_bus_message *m) {
-        _cleanup_strv_free_ char **strv = NULL;
+        _cleanup_sd_strv_free_ char **strv = NULL;
 
         assert(m);
 
-        (void) strv_extend_assignment(&strv, "DBUS_MESSAGE_TYPE", bus_message_type_to_string(m->header->type));
-        (void) strv_extend_assignment(&strv, "DBUS_SENDER", sd_bus_message_get_sender(m));
-        (void) strv_extend_assignment(&strv, "DBUS_DESTINATION", sd_bus_message_get_destination(m));
-        (void) strv_extend_assignment(&strv, "DBUS_PATH", sd_bus_message_get_path(m));
-        (void) strv_extend_assignment(&strv, "DBUS_INTERFACE", sd_bus_message_get_interface(m));
-        (void) strv_extend_assignment(&strv, "DBUS_MEMBER", sd_bus_message_get_member(m));
+        (void) sd_strv_extend_assignment(&strv, "DBUS_MESSAGE_TYPE", bus_message_type_to_string(m->header->type));
+        (void) sd_strv_extend_assignment(&strv, "DBUS_SENDER", sd_bus_message_get_sender(m));
+        (void) sd_strv_extend_assignment(&strv, "DBUS_DESTINATION", sd_bus_message_get_destination(m));
+        (void) sd_strv_extend_assignment(&strv, "DBUS_PATH", sd_bus_message_get_path(m));
+        (void) sd_strv_extend_assignment(&strv, "DBUS_INTERFACE", sd_bus_message_get_interface(m));
+        (void) sd_strv_extend_assignment(&strv, "DBUS_MEMBER", sd_bus_message_get_member(m));
 
-        (void) strv_extendf(&strv, "DBUS_MESSAGE_COOKIE=%" PRIu64, BUS_MESSAGE_COOKIE(m));
+        (void) sd_sd_strv_extendf(&strv, "DBUS_MESSAGE_COOKIE=%" PRIu64, BUS_MESSAGE_COOKIE(m));
         if (m->reply_cookie != 0)
-                (void) strv_extendf(&strv, "DBUS_MESSAGE_REPLY_COOKIE=%" PRIu64, m->reply_cookie);
+                (void) sd_sd_strv_extendf(&strv, "DBUS_MESSAGE_REPLY_COOKIE=%" PRIu64, m->reply_cookie);
 
-        (void) strv_extend_assignment(&strv, "DBUS_SIGNATURE", m->root_container.signature);
-        (void) strv_extend_assignment(&strv, "DBUS_ERROR_NAME", m->error.name);
-        (void) strv_extend_assignment(&strv, "DBUS_ERROR_MESSAGE", m->error.message);
+        (void) sd_strv_extend_assignment(&strv, "DBUS_SIGNATURE", m->root_container.signature);
+        (void) sd_strv_extend_assignment(&strv, "DBUS_ERROR_NAME", m->error.name);
+        (void) sd_strv_extend_assignment(&strv, "DBUS_ERROR_MESSAGE", m->error.message);
 
         return TAKE_PTR(strv);
 }
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/bus-objects.c b/src/libsystemd/sd-bus/bus-objects.c
--- a/src/libsystemd/sd-bus/bus-objects.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/bus-objects.c	2025-06-30 18:37:25.000000000 +0000
@@ -2867,7 +2867,7 @@ _public_ int sd_bus_emit_interfaces_adde
         if (!BUS_IS_OPEN(bus->state))
                 return -ENOTCONN;
 
-        if (strv_isempty(interfaces))
+        if (sd_strv_isempty(interfaces))
                 return 0;
 
         bool path_has_object_manager = false;
@@ -2955,7 +2955,7 @@ _public_ int sd_bus_emit_interfaces_remo
         if (!BUS_IS_OPEN(bus->state))
                 return -ENOTCONN;
 
-        if (strv_isempty(interfaces))
+        if (sd_strv_isempty(interfaces))
                 return 0;
 
         bool path_has_object_manager = false;
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/sd-bus.c b/src/libsystemd/sd-bus/sd-bus.c
--- a/src/libsystemd/sd-bus/sd-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/sd-bus.c	2025-06-30 18:37:25.000000000 +0000
@@ -213,7 +213,7 @@ static sd_bus* bus_free(sd_bus *b) {
         free(b->patch_sender);
 
         free(b->exec_path);
-        strv_free(b->exec_argv);
+        sd_strv_free(b->exec_argv);
 
         close_many(b->fds, b->n_fds);
         free(b->fds);
@@ -304,17 +304,17 @@ _public_ int sd_bus_set_fd(sd_bus *bus,
 }
 
 _public_ int sd_bus_set_exec(sd_bus *bus, const char *path, char *const *argv) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         int r;
 
         assert_return(bus, -EINVAL);
         assert_return(bus = bus_resolve(bus), -ENOPKG);
         assert_return(bus->state == BUS_UNSET, -EPERM);
         assert_return(path, -EINVAL);
-        assert_return(!strv_isempty(argv), -EINVAL);
+        assert_return(!sd_strv_isempty(argv), -EINVAL);
         assert_return(!bus_origin_changed(bus), -ECHILD);
 
-        a = strv_copy(argv);
+        a = sd_strv_copy(argv);
         if (!a)
                 return -ENOMEM;
 
@@ -322,7 +322,7 @@ _public_ int sd_bus_set_exec(sd_bus *bus
         if (r < 0)
                 return r;
 
-        return strv_free_and_replace(bus->exec_argv, a);
+        return sd_strv_free_and_replace(bus->exec_argv, a);
 }
 
 _public_ int sd_bus_set_bus_client(sd_bus *bus, int b) {
@@ -1039,7 +1039,7 @@ static void bus_reset_parsed_address(sd_
 
         zero(b->sockaddr);
         b->sockaddr_size = 0;
-        b->exec_argv = strv_free(b->exec_argv);
+        b->exec_argv = sd_strv_free(b->exec_argv);
         b->exec_path = mfree(b->exec_path);
         b->server_id = SD_ID128_NULL;
         b->machine = mfree(b->machine);
@@ -3008,7 +3008,7 @@ static int process_message(sd_bus *bus,
         bus->iteration_counter++;
 
         if (log_context_enabled())
-                c = log_context_new_strv_consume(bus_message_make_log_fields(m));
+                c = log_context_new_sd_strv_consume(bus_message_make_log_fields(m));
 
         log_debug_bus_message(m);
 
@@ -4059,7 +4059,7 @@ _public_ int sd_bus_path_decode(const ch
 }
 
 _public_ int sd_bus_path_encode_many(char **out, const char *path_template, ...) {
-        _cleanup_strv_free_ char **labels = NULL;
+        _cleanup_sd_strv_free_ char **labels = NULL;
         char *path, *path_pos, **label_pos;
         const char *sep, *template_pos;
         size_t path_length;
@@ -4088,7 +4088,7 @@ _public_ int sd_bus_path_encode_many(cha
                         return -ENOMEM;
                 }
 
-                r = strv_consume(&labels, label);
+                r = sd_strv_consume(&labels, label);
                 if (r < 0) {
                         va_end(list);
                         return r;
@@ -4122,7 +4122,7 @@ _public_ int sd_bus_path_encode_many(cha
 }
 
 _public_ int sd_bus_path_decode_many(const char *path, const char *path_template, ...) {
-        _cleanup_strv_free_ char **labels = NULL;
+        _cleanup_sd_strv_free_ char **labels = NULL;
         const char *template_pos, *path_pos;
         char **label_pos;
         va_list list;
@@ -4194,7 +4194,7 @@ _public_ int sd_bus_path_decode_many(con
                 if (!label)
                         return -ENOMEM;
 
-                r = strv_consume(&labels, label);
+                r = sd_strv_consume(&labels, label);
                 if (r < 0)
                         return r;
 
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/test-bus-address.c b/src/libsystemd/sd-bus/test-bus-address.c
--- a/src/libsystemd/sd-bus/test-bus-address.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/test-bus-address.c	2025-06-30 18:37:25.000000000 +0000
@@ -24,7 +24,7 @@ TEST(bus_set_address_system_remote) {
         _cleanup_(sd_bus_unrefp) sd_bus *b = NULL;
 
         assert_se(sd_bus_new(&b) >= 0);
-        if (!strv_isempty(saved_argv + 1)) {
+        if (!sd_strv_isempty(saved_argv + 1)) {
                 STRV_FOREACH(a, saved_argv + 1)
                         test_one_address(b, *a, 0, NULL);
                 return;
diff '--color=auto' -Nurp a/src/libsystemd/sd-bus/test-bus-objects.c b/src/libsystemd/sd-bus/test-bus-objects.c
--- a/src/libsystemd/sd-bus/test-bus-objects.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-bus/test-bus-objects.c	2025-06-30 18:37:42.000000000 +0000
@@ -213,7 +213,7 @@ static const sd_bus_vtable vtable2[] = {
 static int enumerator_callback(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
 
         if (object_path_startswith("/value", path))
-                assert_se(*nodes = strv_new("/value/a", "/value/b", "/value/c"));
+                assert_se(*nodes = sd_strv_new("/value/a", "/value/b", "/value/c"));
 
         return 1;
 }
@@ -221,19 +221,19 @@ static int enumerator_callback(sd_bus *b
 static int enumerator2_callback(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
 
         if (object_path_startswith("/value/a", path))
-                assert_se(*nodes = strv_new("/value/a/x", "/value/a/y", "/value/a/z"));
+                assert_se(*nodes = sd_strv_new("/value/a/x", "/value/a/y", "/value/a/z"));
 
         return 1;
 }
 
 static int enumerator3_callback(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
 
         if (!object_path_startswith("/value/b", path))
                 return 1;
 
         for (unsigned i = 0; i < 30; i++)
-                assert_se(strv_extendf(&v, "/value/b/%u", i) >= 0);
+                assert_se(sd_sd_strv_extendf(&v, "/value/b/%u", i) >= 0);
 
         *nodes = TAKE_PTR(v);
         return 1;
@@ -301,7 +301,7 @@ static int client(struct context *c) {
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_(sd_bus_unrefp) sd_bus *bus = NULL;
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
-        _cleanup_strv_free_ char **lines = NULL;
+        _cleanup_sd_strv_free_ char **lines = NULL;
         const char *s;
         int r;
 
@@ -422,11 +422,11 @@ static int client(struct context *c) {
         assert_se(r >= 0);
         fputs(s, stdout);
 
-        assert_se(lines = strv_split_newlines(s));
+        assert_se(lines = sd_strv_split_newlines(s));
         assert_se(strv_contains(lines, " <node name=\"x\"/>"));
         assert_se(strv_contains(lines, " <node name=\"y\"/>"));
         assert_se(strv_contains(lines, " <node name=\"z\"/>"));
-        lines = strv_free(lines);
+        lines = sd_strv_free(lines);
 
         reply = sd_bus_message_unref(reply);
 
@@ -437,14 +437,14 @@ static int client(struct context *c) {
         assert_se(r >= 0);
         fputs(s, stdout);
 
-        assert_se(lines = strv_split_newlines(s));
+        assert_se(lines = sd_strv_split_newlines(s));
         for (unsigned i = 0; i < 30; i++) {
                 _cleanup_free_ char *n = NULL;
 
                 assert_se(asprintf(&n, " <node name=\"%u\"/>", i) >= 0);
                 assert_se(strv_contains(lines, n));
         }
-        lines = strv_free(lines);
+        lines = sd_strv_free(lines);
 
         reply = sd_bus_message_unref(reply);
 
diff '--color=auto' -Nurp a/src/libsystemd/sd-daemon/sd-daemon.c b/src/libsystemd/sd-daemon/sd-daemon.c
--- a/src/libsystemd/sd-daemon/sd-daemon.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-daemon/sd-daemon.c	2025-06-30 18:37:42.000000000 +0000
@@ -90,7 +90,7 @@ finish:
 }
 
 _public_ int sd_listen_fds_with_names(int unset_environment, char ***names) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         bool have_names;
         int n_names = 0, n_fds;
         const char *e;
@@ -101,7 +101,7 @@ _public_ int sd_listen_fds_with_names(in
 
         e = getenv("LISTEN_FDNAMES");
         if (e) {
-                n_names = strv_split_full(&l, e, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
+                n_names = sd_strv_split_full(&l, e, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
                 if (n_names < 0) {
                         unsetenv_all(unset_environment);
                         return n_names;
@@ -119,7 +119,7 @@ _public_ int sd_listen_fds_with_names(in
                 if (n_names != n_fds)
                         return -EINVAL;
         } else {
-                r = strv_extend_n(&l, "unknown", n_fds);
+                r = sd_strv_extend_n(&l, "unknown", n_fds);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/libsystemd/sd-device/device-enumerator.c b/src/libsystemd/sd-device/device-enumerator.c
--- a/src/libsystemd/sd-device/device-enumerator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-device/device-enumerator.c	2025-06-30 18:35:42.000000000 +0000
@@ -90,7 +90,7 @@ static sd_device_enumerator *device_enum
         device_enumerator_unref_devices(enumerator);
 
         hashmap_free(enumerator->devices_by_syspath);
-        strv_free(enumerator->prioritized_subsystems);
+        sd_strv_free(enumerator->prioritized_subsystems);
         set_free(enumerator->match_subsystem);
         set_free(enumerator->nomatch_subsystem);
         hashmap_free(enumerator->match_sysattr);
@@ -116,7 +116,7 @@ int device_enumerator_add_prioritized_su
         if (strv_contains(enumerator->prioritized_subsystems, subsystem))
                 return 0;
 
-        r = strv_extend(&enumerator->prioritized_subsystems, subsystem);
+        r = sd_strv_extend(&enumerator->prioritized_subsystems, subsystem);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/libsystemd/sd-device/device-filter.c b/src/libsystemd/sd-device/device-filter.c
--- a/src/libsystemd/sd-device/device-filter.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-device/device-filter.c	2025-06-30 18:37:25.000000000 +0000
@@ -17,7 +17,7 @@ int update_match_strv(Hashmap **match_st
                 if (!value) {
                         char **v;
 
-                        if (strv_isempty(strv) || !clear_on_null)
+                        if (sd_strv_isempty(strv) || !clear_on_null)
                                 return 0;
 
                         /* Accept all value. Clear previous assignment. */
@@ -26,12 +26,12 @@ int update_match_strv(Hashmap **match_st
                         if (!v)
                                 return -ENOMEM;
 
-                        strv_free_and_replace(strv, v);
+                        sd_strv_free_and_replace(strv, v);
                 } else {
                         if (strv_contains(strv, value))
                                 return 0;
 
-                        r = strv_extend(&strv, value);
+                        r = sd_strv_extend(&strv, value);
                         if (r < 0)
                                 return r;
                 }
@@ -41,18 +41,18 @@ int update_match_strv(Hashmap **match_st
                         return r;
 
         } else {
-                _cleanup_strv_free_ char **strv_alloc = NULL;
+                _cleanup_sd_strv_free_ char **strv_alloc = NULL;
                 _cleanup_free_ char *key_alloc = NULL;
 
                 key_alloc = strdup(key);
                 if (!key_alloc)
                         return -ENOMEM;
 
-                strv_alloc = strv_new(value);
+                strv_alloc = sd_strv_new(value);
                 if (!strv_alloc)
                         return -ENOMEM;
 
-                r = hashmap_ensure_put(match_strv, &string_hash_ops_free_strv_free, key_alloc, strv_alloc);
+                r = hashmap_ensure_put(match_strv, &string_hash_ops_free_sd_strv_free, key_alloc, strv_alloc);
                 if (r < 0)
                         return r;
 
diff '--color=auto' -Nurp a/src/libsystemd/sd-device/device-monitor.c b/src/libsystemd/sd-device/device-monitor.c
--- a/src/libsystemd/sd-device/device-monitor.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-device/device-monitor.c	2025-06-30 18:36:37.000000000 +0000
@@ -258,7 +258,7 @@ static int device_monitor_event_handler(
                 return 0;
 
         if (log_context_enabled())
-                c = log_context_new_strv_consume(device_make_log_fields(device));
+                c = log_context_new_sd_strv_consume(device_make_log_fields(device));
 
         if (m->callback)
                 return m->callback(m, device, m->userdata);
diff '--color=auto' -Nurp a/src/libsystemd/sd-device/device-util.c b/src/libsystemd/sd-device/device-util.c
--- a/src/libsystemd/sd-device/device-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-device/device-util.c	2025-06-30 18:36:07.000000000 +0000
@@ -74,13 +74,13 @@ static int add_string_field(
         if (r < 0 && r != -ENOENT)
                 log_device_debug_errno(device, r, "Failed to get device \"%s\" property, ignoring: %m", field);
         if (r >= 0)
-                (void) strv_extend_assignment(strv, field, s);
+                (void) sd_strv_extend_assignment(strv, field, s);
 
         return 0;
 }
 
 char** device_make_log_fields(sd_device *device) {
-        _cleanup_strv_free_ char **strv = NULL;
+        _cleanup_sd_strv_free_ char **strv = NULL;
         dev_t devnum;
         int ifindex;
         sd_device_action_t action;
@@ -102,31 +102,31 @@ char** device_make_log_fields(sd_device
         if (r < 0 && r != -ENOENT)
                 log_device_debug_errno(device, r, "Failed to get device \"DEVNUM\" property, ignoring: %m");
         if (r >= 0)
-                (void) strv_extendf(&strv, "DEVNUM="DEVNUM_FORMAT_STR, DEVNUM_FORMAT_VAL(devnum));
+                (void) sd_sd_strv_extendf(&strv, "DEVNUM="DEVNUM_FORMAT_STR, DEVNUM_FORMAT_VAL(devnum));
 
         r = sd_device_get_ifindex(device, &ifindex);
         if (r < 0 && r != -ENOENT)
                 log_device_debug_errno(device, r, "Failed to get device \"IFINDEX\" property, ignoring: %m");
         if (r >= 0)
-                (void) strv_extendf(&strv, "IFINDEX=%i", ifindex);
+                (void) sd_sd_strv_extendf(&strv, "IFINDEX=%i", ifindex);
 
         r = sd_device_get_action(device, &action);
         if (r < 0 && r != -ENOENT)
                 log_device_debug_errno(device, r, "Failed to get device \"ACTION\" property, ignoring: %m");
         if (r >= 0)
-                (void) strv_extendf(&strv, "ACTION=%s", device_action_to_string(action));
+                (void) sd_sd_strv_extendf(&strv, "ACTION=%s", device_action_to_string(action));
 
         r = sd_device_get_seqnum(device, &seqnum);
         if (r < 0 && r != -ENOENT)
                 log_device_debug_errno(device, r, "Failed to get device \"SEQNUM\" property, ignoring: %m");
         if (r >= 0)
-                (void) strv_extendf(&strv, "SEQNUM=%"PRIu64, seqnum);
+                (void) sd_sd_strv_extendf(&strv, "SEQNUM=%"PRIu64, seqnum);
 
         r = sd_device_get_diskseq(device, &diskseq);
         if (r < 0 && r != -ENOENT)
                 log_device_debug_errno(device, r, "Failed to get device \"DISKSEQ\" property, ignoring: %m");
         if (r >= 0)
-                (void) strv_extendf(&strv, "DISKSEQ=%"PRIu64, diskseq);
+                (void) sd_sd_strv_extendf(&strv, "DISKSEQ=%"PRIu64, diskseq);
 
         return TAKE_PTR(strv);
 }
diff '--color=auto' -Nurp a/src/libsystemd/sd-journal/catalog.c b/src/libsystemd/sd-journal/catalog.c
--- a/src/libsystemd/sd-journal/catalog.c	2025-06-30 18:55:45.103159940 +0000
+++ b/src/libsystemd/sd-journal/catalog.c	2025-06-30 18:33:49.000000000 +0000
@@ -418,7 +418,7 @@ static int64_t write_catalog(
 }
 
 int catalog_update(const char* database, const char* root, const char* const* dirs) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         _cleanup_(strbuf_freep) struct strbuf *sb = NULL;
         _cleanup_ordered_hashmap_free_free_free_ OrderedHashmap *h = NULL;
         _cleanup_free_ CatalogItem *items = NULL;
diff '--color=auto' -Nurp a/src/libsystemd/sd-journal/journal-file.c b/src/libsystemd/sd-journal/journal-file.c
--- a/src/libsystemd/sd-journal/journal-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-journal/journal-file.c	2025-06-30 18:37:56.000000000 +0000
@@ -503,7 +503,7 @@ static bool warn_wrong_flags(const Journ
                         strv[n] = NULL;
                         assert(n < ELEMENTSOF(strv));
 
-                        t = strv_join((char**) strv, ", ");
+                        t = sd_strv_join((char**) strv, ", ");
                         log_debug("Journal file %s uses %s %s %s disabled at compilation time.",
                                   f->path, type, n > 1 ? "flags" : "flag", strnull(t));
                 }
diff '--color=auto' -Nurp a/src/libsystemd/sd-journal/sd-journal.c b/src/libsystemd/sd-journal/sd-journal.c
--- a/src/libsystemd/sd-journal/sd-journal.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-journal/sd-journal.c	2025-06-30 18:35:42.000000000 +0000
@@ -1619,7 +1619,7 @@ error:
 }
 
 int journal_get_directories(sd_journal *j, char ***ret) {
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         JournalFile *f;
         const char *p;
         size_t n = SIZE_MAX;
@@ -1644,7 +1644,7 @@ int journal_get_directories(sd_journal *
                 if (path_strv_contains(paths, d))
                         continue;
 
-                r = strv_extend_with_size(&paths, &n, d);
+                r = sd_strv_extend_with_size(&paths, &n, d);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/libsystemd/sd-journal/test-journal-interleaving.c b/src/libsystemd/sd-journal/test-journal-interleaving.c
--- a/src/libsystemd/sd-journal/test-journal-interleaving.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-journal/test-journal-interleaving.c	2025-06-30 18:36:37.000000000 +0000
@@ -254,7 +254,7 @@ static void mkdtemp_chdir_chattr(char *p
 }
 
 static void test_cursor(sd_journal *j) {
-        _cleanup_strv_free_ char **cursors = NULL;
+        _cleanup_sd_strv_free_ char **cursors = NULL;
         int r;
 
         assert_se(sd_journal_seek_head(j) >= 0);
@@ -268,7 +268,7 @@ static void test_cursor(sd_journal *j) {
                 _cleanup_free_ char *cursor = NULL;
                 assert_se(sd_journal_get_cursor(j, &cursor) >= 0);
                 assert_se(sd_journal_test_cursor(j, cursor) > 0);
-                assert_se(strv_consume(&cursors, TAKE_PTR(cursor)) >= 0);
+                assert_se(sd_strv_consume(&cursors, TAKE_PTR(cursor)) >= 0);
         }
 
         STRV_FOREACH(c, cursors) {
diff '--color=auto' -Nurp a/src/libsystemd/sd-login/sd-login.c b/src/libsystemd/sd-login/sd-login.c
--- a/src/libsystemd/sd-login/sd-login.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-login/sd-login.c	2025-06-30 18:37:42.000000000 +0000
@@ -602,17 +602,17 @@ static int uid_get_array(uid_t uid, cons
         if (r < 0)
                 return r;
 
-        a = strv_split(s, NULL);
+        a = sd_strv_split(s, NULL);
         if (!a)
                 return -ENOMEM;
 
         strv_uniq(a);
-        r = (int) strv_length(a);
+        r = (int) sd_strv_length(a);
 
         if (array)
                 *array = a;
         else
-                strv_free(a);
+                sd_strv_free(a);
 
         return r;
 }
@@ -929,7 +929,7 @@ _public_ int sd_seat_get_sessions(
                 unsigned *ret_n_uids) {
 
         _cleanup_free_ char *fname = NULL, *session_line = NULL, *uid_line = NULL;
-        _cleanup_strv_free_ char **sessions = NULL;
+        _cleanup_sd_strv_free_ char **sessions = NULL;
         _cleanup_free_ uid_t *uids = NULL;
         unsigned n_sessions = 0;
         int r;
@@ -947,11 +947,11 @@ _public_ int sd_seat_get_sessions(
                 return r;
 
         if (session_line) {
-                sessions = strv_split(session_line, NULL);
+                sessions = sd_strv_split(session_line, NULL);
                 if (!sessions)
                         return -ENOMEM;
 
-                n_sessions = strv_length(sessions);
+                n_sessions = sd_strv_length(sessions);
         };
 
         if (ret_uids && uid_line) {
@@ -1098,7 +1098,7 @@ _public_ int sd_get_uids(uid_t **users)
 }
 
 _public_ int sd_get_machine_names(char ***machines) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         char **a, **b;
         int r;
 
@@ -1181,13 +1181,13 @@ _public_ int sd_machine_get_ifindices(co
                 return 0;
         }
 
-        _cleanup_strv_free_ char **tt = strv_split(netif_line, NULL);
+        _cleanup_sd_strv_free_ char **tt = sd_strv_split(netif_line, NULL);
         if (!tt)
                 return -ENOMEM;
 
         _cleanup_free_ int *ifindices = NULL;
         if (ret_ifindices) {
-                ifindices = new(int, strv_length(tt));
+                ifindices = new(int, sd_strv_length(tt));
                 if (!ifindices)
                         return -ENOMEM;
         }
diff '--color=auto' -Nurp a/src/libsystemd/sd-login/test-login.c b/src/libsystemd/sd-login/test-login.c
--- a/src/libsystemd/sd-login/test-login.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-login/test-login.c	2025-06-30 18:37:56.000000000 +0000
@@ -120,29 +120,29 @@ TEST(login) {
         assert_se(streq_ptr(pp, qq));
 
         r = ASSERT_RETURN_IS_CRITICAL(uid_is_valid(u2), sd_uid_get_sessions(u2, false, &sessions));
-        assert_se(t = strv_join(sessions, " "));
+        assert_se(t = sd_strv_join(sessions, " "));
         log_info("sd_uid_get_sessions("UID_FMT", ‚Ä¶) ‚Üí %s \"%s\"", u2, e(r), t);
         if (u2 == UID_INVALID)
                 assert_se(r == -EINVAL);
         else {
                 assert_se(r >= 0);
-                assert_se(r == (int) strv_length(sessions));
+                assert_se(r == (int) sd_strv_length(sessions));
         }
-        sessions = strv_free(sessions);
+        sessions = sd_strv_free(sessions);
         free(t);
 
         assert_se(r == ASSERT_RETURN_IS_CRITICAL(uid_is_valid(u2), sd_uid_get_sessions(u2, false, NULL)));
 
         r = ASSERT_RETURN_IS_CRITICAL(uid_is_valid(u2), sd_uid_get_seats(u2, false, &seats));
-        assert_se(t = strv_join(seats, " "));
+        assert_se(t = sd_strv_join(seats, " "));
         log_info("sd_uid_get_seats("UID_FMT", ‚Ä¶) ‚Üí %s \"%s\"", u2, e(r), t);
         if (u2 == UID_INVALID)
                 assert_se(r == -EINVAL);
         else {
                 assert_se(r >= 0);
-                assert_se(r == (int) strv_length(seats));
+                assert_se(r == (int) sd_strv_length(seats));
         }
-        seats = strv_free(seats);
+        seats = sd_strv_free(seats);
         free(t);
 
         assert_se(r == ASSERT_RETURN_IS_CRITICAL(uid_is_valid(u2), sd_uid_get_seats(u2, false, NULL)));
@@ -236,9 +236,9 @@ TEST(login) {
 
                 r = sd_seat_get_sessions(seat, &sessions, &uids, &n);
                 assert_se(r >= 0);
-                assert_se(r == (int) strv_length(sessions));
-                assert_se(t = strv_join(sessions, " "));
-                strv_free(sessions);
+                assert_se(r == (int) sd_strv_length(sessions));
+                assert_se(t = sd_strv_join(sessions, " "));
+                sd_strv_free(sessions);
                 log_info("sd_seat_get_sessions(\"%s\", ‚Ä¶) ‚Üí %s, \"%s\", [%u] {%s}",
                          seat, e(r), t, n, format_uids(&buf, uids, n));
                 free(t);
@@ -248,9 +248,9 @@ TEST(login) {
 
         r = sd_get_seats(&seats);
         assert_se(r >= 0);
-        assert_se(r == (int) strv_length(seats));
-        assert_se(t = strv_join(seats, ", "));
-        strv_free(seats);
+        assert_se(r == (int) sd_strv_length(seats));
+        assert_se(t = sd_strv_join(seats, ", "));
+        sd_strv_free(seats);
         log_info("sd_get_seats(‚Ä¶) ‚Üí [%i] \"%s\"", r, t);
         t = mfree(t);
 
@@ -263,9 +263,9 @@ TEST(login) {
 
         r = sd_get_sessions(&sessions);
         assert_se(r >= 0);
-        assert_se(r == (int) strv_length(sessions));
-        assert_se(t = strv_join(sessions, ", "));
-        strv_free(sessions);
+        assert_se(r == (int) sd_strv_length(sessions));
+        assert_se(t = sd_strv_join(sessions, ", "));
+        sd_strv_free(sessions);
         log_info("sd_get_sessions(‚Ä¶) ‚Üí [%i] \"%s\"", r, t);
         free(t);
 
@@ -283,13 +283,13 @@ TEST(login) {
         }
 
         {
-                _cleanup_strv_free_ char **machines = NULL;
+                _cleanup_sd_strv_free_ char **machines = NULL;
                 _cleanup_free_ char *buf = NULL;
 
                 r = sd_get_machine_names(&machines);
                 assert_se(r >= 0);
-                assert_se(r == (int) strv_length(machines));
-                assert_se(buf = strv_join(machines, " "));
+                assert_se(r == (int) sd_strv_length(machines));
+                assert_se(buf = sd_strv_join(machines, " "));
                 log_info("sd_get_machines(‚Ä¶) ‚Üí [%i] \"%s\"", r, buf);
 
                 assert_se(sd_get_machine_names(NULL) == r);
diff '--color=auto' -Nurp a/src/libsystemd/sd-netlink/netlink-message.c b/src/libsystemd/sd-netlink/netlink-message.c
--- a/src/libsystemd/sd-netlink/netlink-message.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-netlink/netlink-message.c	2025-06-30 18:35:42.000000000 +0000
@@ -1067,7 +1067,7 @@ int sd_netlink_message_has_flag(sd_netli
 }
 
 int sd_netlink_message_read_strv(sd_netlink_message *m, uint16_t container_type, uint16_t attr_type, char ***ret) {
-        _cleanup_strv_free_ char **s = NULL;
+        _cleanup_sd_strv_free_ char **s = NULL;
         const NLAPolicySet *policy_set;
         const NLAPolicy *policy;
         struct rtattr *rta;
@@ -1118,7 +1118,7 @@ int sd_netlink_message_read_strv(sd_netl
                 if (type != attr_type)
                         continue;
 
-                r = strv_extend(&s, RTA_DATA(rta));
+                r = sd_strv_extend(&s, RTA_DATA(rta));
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/libsystemd/sd-netlink/netlink-util.c b/src/libsystemd/sd-netlink/netlink-util.c
--- a/src/libsystemd/sd-netlink/netlink-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-netlink/netlink-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -16,7 +16,7 @@ static int parse_newlink_message(
                   char **ret_name,
                   char ***ret_altnames) {
 
-        _cleanup_strv_free_ char **altnames = NULL;
+        _cleanup_sd_strv_free_ char **altnames = NULL;
         int r, ifindex;
 
         assert(message);
@@ -218,14 +218,14 @@ int rtnl_rename_link(sd_netlink **rtnl,
 }
 
 int rtnl_set_link_name(sd_netlink **rtnl, int ifindex, const char *name, char* const *alternative_names) {
-        _cleanup_strv_free_ char **original_altnames = NULL, **new_altnames = NULL;
+        _cleanup_sd_strv_free_ char **original_altnames = NULL, **new_altnames = NULL;
         bool altname_deleted = false;
         int r;
 
         assert(rtnl);
         assert(ifindex > 0);
 
-        if (isempty(name) && strv_isempty(alternative_names))
+        if (isempty(name) && sd_strv_isempty(alternative_names))
                 return 0;
 
         if (name && !ifname_valid(name))
@@ -266,7 +266,7 @@ int rtnl_set_link_name(sd_netlink **rtnl
                 if (!ifname_valid_full(*a, IFNAME_VALID_ALTERNATIVE))
                         continue;
 
-                r = strv_extend(&new_altnames, *a);
+                r = sd_strv_extend(&new_altnames, *a);
                 if (r < 0)
                         return r;
         }
@@ -403,7 +403,7 @@ static int rtnl_update_link_alternative_
         assert(ifindex > 0);
         assert(IN_SET(nlmsg_type, RTM_NEWLINKPROP, RTM_DELLINKPROP));
 
-        if (strv_isempty(alternative_names))
+        if (sd_strv_isempty(alternative_names))
                 return 0;
 
         if (!*rtnl) {
@@ -454,7 +454,7 @@ int rtnl_set_link_alternative_names_by_i
         assert(rtnl);
         assert(ifname);
 
-        if (strv_isempty(alternative_names))
+        if (sd_strv_isempty(alternative_names))
                 return 0;
 
         if (!*rtnl) {
diff '--color=auto' -Nurp a/src/libsystemd/sd-netlink/test-netlink.c b/src/libsystemd/sd-netlink/test-netlink.c
--- a/src/libsystemd/sd-netlink/test-netlink.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-netlink/test-netlink.c	2025-06-30 18:35:42.000000000 +0000
@@ -499,7 +499,7 @@ TEST(message_array) {
 TEST(message_strv) {
         _cleanup_(sd_netlink_unrefp) sd_netlink *rtnl = NULL;
         _cleanup_(sd_netlink_message_unrefp) sd_netlink_message *m = NULL;
-        _cleanup_strv_free_ char **names_in = NULL, **names_out;
+        _cleanup_sd_strv_free_ char **names_in = NULL, **names_out;
         const char *p;
 
         assert_se(sd_netlink_open(&rtnl) >= 0);
@@ -510,7 +510,7 @@ TEST(message_strv) {
                 char name[STRLEN("hoge") + DECIMAL_STR_MAX(uint32_t)];
 
                 xsprintf(name, "hoge%" PRIu32, i + 1000);
-                assert_se(strv_extend(&names_in, name) >= 0);
+                assert_se(sd_strv_extend(&names_in, name) >= 0);
         }
 
         assert_se(sd_netlink_message_open_container(m, IFLA_PROP_LIST) >= 0);
@@ -624,7 +624,7 @@ TEST(rtnl_set_link_name) {
         _cleanup_(sd_netlink_unrefp) sd_netlink *rtnl = NULL;
         _cleanup_(sd_netlink_message_unrefp) sd_netlink_message *message = NULL, *reply = NULL;
         _cleanup_(remove_dummy_interfacep) int ifindex = 0;
-        _cleanup_strv_free_ char **alternative_names = NULL;
+        _cleanup_sd_strv_free_ char **alternative_names = NULL;
         int r;
 
         if (geteuid() != 0)
@@ -671,7 +671,7 @@ TEST(rtnl_set_link_name) {
         assert_se(rtnl_set_link_name(&rtnl, ifindex, "testlongalternativename", NULL) == -EINVAL);
         assert_se(rtnl_set_link_name(&rtnl, ifindex, "test-shortname", STRV_MAKE("testlongalternativename", "test-shortname", "test-additional-name")) >= 0);
 
-        alternative_names = strv_free(alternative_names);
+        alternative_names = sd_strv_free(alternative_names);
         assert_se(rtnl_get_link_alternative_names(&rtnl, ifindex, &alternative_names) >= 0);
         assert_se(strv_contains(alternative_names, "testlongalternativename"));
         assert_se(strv_contains(alternative_names, "test-additional-name"));
@@ -679,7 +679,7 @@ TEST(rtnl_set_link_name) {
 
         assert_se(rtnl_delete_link_alternative_names(&rtnl, ifindex, STRV_MAKE("testlongalternativename")) >= 0);
 
-        alternative_names = strv_free(alternative_names);
+        alternative_names = sd_strv_free(alternative_names);
         assert_se(rtnl_get_link_alternative_names(&rtnl, ifindex, &alternative_names) >= 0);
         assert_se(!strv_contains(alternative_names, "testlongalternativename"));
         assert_se(strv_contains(alternative_names, "test-additional-name"));
diff '--color=auto' -Nurp a/src/libsystemd/sd-network/sd-network.c b/src/libsystemd/sd-network/sd-network.c
--- a/src/libsystemd/sd-network/sd-network.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-network/sd-network.c	2025-06-30 18:37:42.000000000 +0000
@@ -58,7 +58,7 @@ int sd_network_get_online_state(char **r
 }
 
 static int network_get_strv(const char *key, char ***ret) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         _cleanup_free_ char *s = NULL;
         int r;
 
@@ -70,12 +70,12 @@ static int network_get_strv(const char *
         if (isempty(s))
                 return -ENODATA;
 
-        a = strv_split(s, NULL);
+        a = sd_strv_split(s, NULL);
         if (!a)
                 return -ENOMEM;
 
         strv_uniq(a);
-        r = (int) strv_length(a);
+        r = (int) sd_strv_length(a);
 
         *ret = TAKE_PTR(a);
         return r;
@@ -129,7 +129,7 @@ static int network_link_get_boolean(int
 }
 
 static int network_link_get_strv(int ifindex, const char *key, char ***ret) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         _cleanup_free_ char *s = NULL;
         int r;
 
@@ -140,12 +140,12 @@ static int network_link_get_strv(int ifi
         if (r < 0)
                 return r;
 
-        a = strv_split(s, NULL);
+        a = sd_strv_split(s, NULL);
         if (!a)
                 return -ENOMEM;
 
         strv_uniq(a);
-        r = (int) strv_length(a);
+        r = (int) sd_strv_length(a);
 
         *ret = TAKE_PTR(a);
         return r;
@@ -170,7 +170,7 @@ int sd_network_link_get_network_file_dro
         if (r < 0)
                 return r;
 
-        r = strv_split_full(&sv, joined, ":", EXTRACT_CUNESCAPE);
+        r = sd_strv_split_full(&sv, joined, ":", EXTRACT_CUNESCAPE);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/libsystemd/sd-path/sd-path.c b/src/libsystemd/sd-path/sd-path.c
--- a/src/libsystemd/sd-path/sd-path.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd/sd-path/sd-path.c	2025-06-30 18:37:56.000000000 +0000
@@ -427,14 +427,14 @@ _public_ int sd_path_lookup(uint64_t typ
                 return r;
 
         /* Fall back to sd_path_lookup_strv */
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         char *buffer;
 
         r = sd_path_lookup_strv(type, suffix, &l);
         if (r < 0)
                 return r;
 
-        buffer = strv_join(l, ":");
+        buffer = sd_strv_join(l, ":");
         if (!buffer)
                 return -ENOMEM;
 
@@ -450,7 +450,7 @@ static int search_from_environment(
                 bool env_search_sufficient,
                 const char *first, ...) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *e;
         char *h = NULL;
         int r;
@@ -460,7 +460,7 @@ static int search_from_environment(
         if (env_search) {
                 e = secure_getenv(env_search);
                 if (e) {
-                        l = strv_split(e, ":");
+                        l = sd_strv_split(e, ":");
                         if (!l)
                                 return -ENOMEM;
 
@@ -475,7 +475,7 @@ static int search_from_environment(
                 va_list ap;
 
                 va_start(ap, first);
-                l = strv_new_ap(first, ap);
+                l = sd_strv_new_ap(first, ap);
                 va_end(ap);
 
                 if (!l)
@@ -501,7 +501,7 @@ static int search_from_environment(
         }
 
         if (h) {
-                r = strv_consume_prepend(&l, h);
+                r = sd_strv_consume_prepend(&l, h);
                 if (r < 0)
                         return -ENOMEM;
         }
@@ -592,7 +592,7 @@ static int get_search(uint64_t type, cha
                                                NULL);
 
         case SD_PATH_SEARCH_BINARIES_DEFAULT: {
-                char **t = strv_split(default_PATH(), ":");
+                char **t = sd_strv_split(default_PATH(), ":");
                 if (!t)
                         return -ENOMEM;
 
@@ -650,7 +650,7 @@ static int get_search(uint64_t type, cha
 }
 
 _public_ int sd_path_lookup_strv(uint64_t type, const char *suffix, char ***paths) {
-        _cleanup_strv_free_ char **l = NULL, **n = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL, **n = NULL;
         int r;
 
         assert_return(paths, -EINVAL);
@@ -680,7 +680,7 @@ _public_ int sd_path_lookup_strv(uint64_
                 return 0;
         }
 
-        n = new(char*, strv_length(l)+1);
+        n = new(char*, sd_strv_length(l)+1);
         if (!n)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/libsystemd-network/dhcp-option.c b/src/libsystemd-network/dhcp-option.c
--- a/src/libsystemd-network/dhcp-option.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/dhcp-option.c	2025-06-30 18:37:25.000000000 +0000
@@ -62,7 +62,7 @@ static int option_append(uint8_t options
         case SD_DHCP_OPTION_USER_CLASS: {
                 size_t total = 0;
 
-                if (strv_isempty((char **) optval))
+                if (sd_strv_isempty((char **) optval))
                         return -EINVAL;
 
                 STRV_FOREACH(s, (const char* const*) optval) {
diff '--color=auto' -Nurp a/src/libsystemd-network/dhcp6-option.c b/src/libsystemd-network/dhcp6-option.c
--- a/src/libsystemd-network/dhcp6-option.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/dhcp6-option.c	2025-06-30 18:37:25.000000000 +0000
@@ -405,7 +405,7 @@ int dhcp6_option_append_user_class(uint8
         assert(*buf);
         assert(offset);
 
-        if (strv_isempty(user_class))
+        if (sd_strv_isempty(user_class))
                 return 0;
 
         STRV_FOREACH(s, user_class) {
@@ -433,7 +433,7 @@ int dhcp6_option_append_vendor_class(uin
         assert(*buf);
         assert(offset);
 
-        if (strv_isempty(vendor_class))
+        if (sd_strv_isempty(vendor_class))
                 return 0;
 
         if (!GREEDY_REALLOC(p, sizeof(be32_t)))
@@ -908,7 +908,7 @@ int dhcp6_option_parse_domainname(const
 }
 
 int dhcp6_option_parse_domainname_list(const uint8_t *optval, size_t optlen, char ***ret) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int r;
 
         assert(optval || optlen == 0);
@@ -928,7 +928,7 @@ int dhcp6_option_parse_domainname_list(c
                 if (r == 0)
                         continue;
 
-                r = strv_consume(&names, TAKE_PTR(name));
+                r = sd_strv_consume(&names, TAKE_PTR(name));
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/libsystemd-network/ndisc-option.c b/src/libsystemd-network/ndisc-option.c
--- a/src/libsystemd-network/ndisc-option.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/ndisc-option.c	2025-06-30 18:37:25.000000000 +0000
@@ -85,7 +85,7 @@ static void ndisc_dnssl_done(sd_ndisc_dn
         if (!dnssl)
                 return;
 
-        strv_free(dnssl->domains);
+        sd_strv_free(dnssl->domains);
 }
 
 sd_ndisc_option* ndisc_option_free(sd_ndisc_option *option) {
@@ -906,7 +906,7 @@ int ndisc_option_add_dnssl_internal(
 
         assert(options);
 
-        if (strv_isempty(domains))
+        if (sd_strv_isempty(domains))
                 return -EINVAL;
 
         STRV_FOREACH(s, domains) {
@@ -918,7 +918,7 @@ int ndisc_option_add_dnssl_internal(
                         return -EINVAL;
         }
 
-        _cleanup_strv_free_ char **copy = strv_copy(domains);
+        _cleanup_sd_strv_free_ char **copy = sd_strv_copy(domains);
         if (!copy)
                 return -ENOMEM;
 
@@ -949,7 +949,7 @@ static int ndisc_option_parse_dnssl(Set
 
         usec_t lifetime = unaligned_be32_sec_to_usec(opt + 4, /* max_as_infinity = */ true);
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_free_ char *e = NULL;
         size_t n = 0;
         for (size_t c, pos = 8; pos < len; pos += c) {
@@ -970,7 +970,7 @@ static int ndisc_option_parse_dnssl(Set
 
                                 /* Ignore the root domain name or "localhost" and friends */
                                 if (!is_localhost(normalized) && !dns_name_is_root(normalized)) {
-                                        r = strv_consume(&l, TAKE_PTR(normalized));
+                                        r = sd_strv_consume(&l, TAKE_PTR(normalized));
                                         if (r < 0)
                                                 return r;
                                 }
diff '--color=auto' -Nurp a/src/libsystemd-network/sd-dhcp-client.c b/src/libsystemd-network/sd-dhcp-client.c
--- a/src/libsystemd-network/sd-dhcp-client.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/sd-dhcp-client.c	2025-06-30 18:37:25.000000000 +0000
@@ -489,7 +489,7 @@ int sd_dhcp_client_set_user_class(
 
         assert_return(client, -EINVAL);
         assert_return(!sd_dhcp_client_is_running(client), -EBUSY);
-        assert_return(!strv_isempty(user_class), -EINVAL);
+        assert_return(!sd_strv_isempty(user_class), -EINVAL);
 
         STRV_FOREACH(p, user_class) {
                 size_t n = strlen(*p);
@@ -498,11 +498,11 @@ int sd_dhcp_client_set_user_class(
                         return -EINVAL;
         }
 
-        s = strv_copy(user_class);
+        s = sd_strv_copy(user_class);
         if (!s)
                 return -ENOMEM;
 
-        return strv_free_and_replace(client->user_class, s);
+        return sd_strv_free_and_replace(client->user_class, s);
 }
 
 int sd_dhcp_client_set_client_port(
@@ -956,7 +956,7 @@ static int client_append_common_discover
         if (client->user_class) {
                 r = dhcp_option_append(&packet->dhcp, optlen, optoffset, 0,
                                        SD_DHCP_OPTION_USER_CLASS,
-                                       strv_length(client->user_class),
+                                       sd_strv_length(client->user_class),
                                        client->user_class);
                 if (r < 0)
                         return r;
@@ -2368,7 +2368,7 @@ static sd_dhcp_client *dhcp_client_free(
         free(client->hostname);
         free(client->vendor_class_identifier);
         free(client->mudurl);
-        client->user_class = strv_free(client->user_class);
+        client->user_class = sd_strv_free(client->user_class);
         ordered_hashmap_free(client->extra_options);
         ordered_hashmap_free(client->vendor_options);
         free(client->ifname);
diff '--color=auto' -Nurp a/src/libsystemd-network/sd-dhcp-lease.c b/src/libsystemd-network/sd-dhcp-lease.c
--- a/src/libsystemd-network/sd-dhcp-lease.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/sd-dhcp-lease.c	2025-06-30 18:37:42.000000000 +0000
@@ -345,7 +345,7 @@ int sd_dhcp_lease_get_search_domains(sd_
         assert_return(lease, -EINVAL);
         assert_return(domains, -EINVAL);
 
-        r = strv_length(lease->search_domains);
+        r = sd_strv_length(lease->search_domains);
         if (r > 0) {
                 *domains = lease->search_domains;
                 return (int) r;
@@ -421,7 +421,7 @@ static sd_dhcp_lease *dhcp_lease_free(sd
         free(lease->static_routes);
         free(lease->classless_routes);
         free(lease->vendor_specific);
-        strv_free(lease->search_domains);
+        sd_strv_free(lease->search_domains);
         free(lease->sixrd_br_addresses);
         return mfree(lease);
 }
@@ -929,7 +929,7 @@ int dhcp_lease_parse_options(uint8_t cod
 
 /* Parses compressed domain names. */
 int dhcp_lease_parse_search_domains(const uint8_t *option, size_t len, char ***domains) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         size_t pos = 0, cnt = 0;
         int r;
 
@@ -1004,7 +1004,7 @@ int dhcp_lease_parse_search_domains(cons
                         return -ENOMEM;
                 name[n] = 0;
 
-                r = strv_extend(&names, name);
+                r = sd_strv_extend(&names, name);
                 if (r < 0)
                         return r;
 
@@ -1014,7 +1014,7 @@ int dhcp_lease_parse_search_domains(cons
                       pos = next_chunk;
         }
 
-        strv_free_and_replace(*domains, names);
+        sd_strv_free_and_replace(*domains, names);
 
         return cnt;
 }
@@ -1434,12 +1434,12 @@ int dhcp_lease_load(sd_dhcp_lease **ret,
         }
 
         if (domains) {
-                _cleanup_strv_free_ char **a = NULL;
-                a = strv_split(domains, " ");
+                _cleanup_sd_strv_free_ char **a = NULL;
+                a = sd_strv_split(domains, " ");
                 if (!a)
                         return -ENOMEM;
 
-                if (!strv_isempty(a))
+                if (!sd_strv_isempty(a))
                         lease->search_domains = TAKE_PTR(a);
         }
 
diff '--color=auto' -Nurp a/src/libsystemd-network/sd-dhcp6-client.c b/src/libsystemd-network/sd-dhcp6-client.c
--- a/src/libsystemd-network/sd-dhcp6-client.c	2025-06-30 18:55:45.347159935 +0000
+++ b/src/libsystemd-network/sd-dhcp6-client.c	2025-06-30 18:37:25.000000000 +0000
@@ -417,7 +417,7 @@ int sd_dhcp6_client_set_request_user_cla
 
         assert_return(client, -EINVAL);
         assert_return(!sd_dhcp6_client_is_running(client), -EBUSY);
-        assert_return(!strv_isempty(user_class), -EINVAL);
+        assert_return(!sd_strv_isempty(user_class), -EINVAL);
 
         STRV_FOREACH(p, user_class) {
                 size_t len = strlen(*p);
@@ -426,11 +426,11 @@ int sd_dhcp6_client_set_request_user_cla
                         return -EINVAL;
         }
 
-        s = strv_copy(user_class);
+        s = sd_strv_copy(user_class);
         if (!s)
                 return -ENOMEM;
 
-        return strv_free_and_replace(client->user_class, s);
+        return sd_strv_free_and_replace(client->user_class, s);
 }
 
 int sd_dhcp6_client_set_request_vendor_class(sd_dhcp6_client *client, char * const *vendor_class) {
@@ -438,7 +438,7 @@ int sd_dhcp6_client_set_request_vendor_c
 
         assert_return(client, -EINVAL);
         assert_return(!sd_dhcp6_client_is_running(client), -EBUSY);
-        assert_return(!strv_isempty(vendor_class), -EINVAL);
+        assert_return(!sd_strv_isempty(vendor_class), -EINVAL);
 
         STRV_FOREACH(p, vendor_class) {
                 size_t len = strlen(*p);
@@ -447,11 +447,11 @@ int sd_dhcp6_client_set_request_vendor_c
                         return -EINVAL;
         }
 
-        s = strv_copy(vendor_class);
+        s = sd_strv_copy(vendor_class);
         if (!s)
                 return -ENOMEM;
 
-        return strv_free_and_replace(client->vendor_class, s);
+        return sd_strv_free_and_replace(client->vendor_class, s);
 }
 
 int sd_dhcp6_client_get_prefix_delegation(sd_dhcp6_client *client, int *delegation) {
@@ -1552,8 +1552,8 @@ static sd_dhcp6_client *dhcp6_client_fre
         dhcp6_ia_clear_addresses(&client->ia_pd);
         ordered_hashmap_free(client->extra_options);
         ordered_set_free(client->vendor_options);
-        strv_free(client->user_class);
-        strv_free(client->vendor_class);
+        sd_strv_free(client->user_class);
+        sd_strv_free(client->vendor_class);
         free(client->ifname);
 
         return mfree(client);
diff '--color=auto' -Nurp a/src/libsystemd-network/sd-dhcp6-lease.c b/src/libsystemd-network/sd-dhcp6-lease.c
--- a/src/libsystemd-network/sd-dhcp6-lease.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/sd-dhcp6-lease.c	2025-06-30 18:36:37.000000000 +0000
@@ -411,7 +411,7 @@ int sd_dhcp6_lease_get_dns(sd_dhcp6_leas
 }
 
 int dhcp6_lease_add_domains(sd_dhcp6_lease *lease, const uint8_t *optval, size_t optlen) {
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         int r;
 
         assert(lease);
@@ -424,7 +424,7 @@ int dhcp6_lease_add_domains(sd_dhcp6_lea
         if (r < 0)
                 return r;
 
-        return strv_extend_strv(&lease->domains, domains, true);
+        return sd_sd_strv_extend_strv(&lease->domains, domains, true);
 }
 
 int sd_dhcp6_lease_get_domains(sd_dhcp6_lease *lease, char ***ret) {
@@ -435,7 +435,7 @@ int sd_dhcp6_lease_get_domains(sd_dhcp6_
                 return -ENODATA;
 
         *ret = lease->domains;
-        return strv_length(lease->domains);
+        return sd_strv_length(lease->domains);
 }
 
 int dhcp6_lease_add_ntp(sd_dhcp6_lease *lease, const uint8_t *optval, size_t optlen) {
@@ -475,7 +475,7 @@ int dhcp6_lease_add_ntp(sd_dhcp6_lease *
                         if (strv_contains(lease->ntp_fqdn, server))
                                 continue;
 
-                        r = strv_consume(&lease->ntp_fqdn, TAKE_PTR(server));
+                        r = sd_strv_consume(&lease->ntp_fqdn, TAKE_PTR(server));
                         if (r < 0)
                                 return r;
 
@@ -524,7 +524,7 @@ int sd_dhcp6_lease_get_ntp_fqdn(sd_dhcp6
 
         if (ret)
                 *ret = lease->ntp_fqdn;
-        return strv_length(lease->ntp_fqdn);
+        return sd_strv_length(lease->ntp_fqdn);
 }
 
 int dhcp6_lease_set_fqdn(sd_dhcp6_lease *lease, const uint8_t *optval, size_t optlen) {
@@ -906,9 +906,9 @@ static sd_dhcp6_lease *dhcp6_lease_free(
         free(lease->dns);
         free(lease->fqdn);
         free(lease->captive_portal);
-        strv_free(lease->domains);
+        sd_strv_free(lease->domains);
         free(lease->ntp);
-        strv_free(lease->ntp_fqdn);
+        sd_strv_free(lease->ntp_fqdn);
         free(lease->sntp);
 
         return mfree(lease);
diff '--color=auto' -Nurp a/src/libsystemd-network/sd-radv.c b/src/libsystemd-network/sd-radv.c
--- a/src/libsystemd-network/sd-radv.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/sd-radv.c	2025-06-30 18:37:25.000000000 +0000
@@ -830,7 +830,7 @@ int sd_radv_set_dnssl(
         if (lifetime_usec > RADV_DNSSL_MAX_LIFETIME_USEC)
                 return -EINVAL;
 
-        if (strv_isempty(search_list)) {
+        if (sd_strv_isempty(search_list)) {
                 ra->dnssl = mfree(ra->dnssl);
                 return 0;
         }
diff '--color=auto' -Nurp a/src/libsystemd-network/test-dhcp6-client.c b/src/libsystemd-network/test-dhcp6-client.c
--- a/src/libsystemd-network/test-dhcp6-client.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/test-dhcp6-client.c	2025-06-30 18:33:49.000000000 +0000
@@ -155,7 +155,7 @@ TEST(client_basic) {
 
 TEST(parse_domain) {
         _cleanup_free_ char *domain = NULL;
-        _cleanup_strv_free_ char **list = NULL;
+        _cleanup_sd_strv_free_ char **list = NULL;
         uint8_t *data;
 
         data = (uint8_t []) { 7, 'e', 'x', 'a', 'm', 'p', 'l', 'e', 3, 'c', 'o', 'm', 0 };
@@ -180,7 +180,7 @@ TEST(parse_domain) {
         assert_se(streq(list[0], "example.com"));
         assert_se(streq(list[1], "foobar"));
         assert_se(!list[2]);
-        list = strv_free(list);
+        list = sd_strv_free(list);
 
         data = (uint8_t []) { 1, 'a', 0, 20, 'b', 'c' };
         assert_se(dhcp6_option_parse_domainname_list(data, 6, &list) < 0);
diff '--color=auto' -Nurp a/src/libsystemd-network/test-sd-dhcp-lease.c b/src/libsystemd-network/test-sd-dhcp-lease.c
--- a/src/libsystemd-network/test-sd-dhcp-lease.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/libsystemd-network/test-sd-dhcp-lease.c	2025-06-30 18:33:49.000000000 +0000
@@ -15,7 +15,7 @@
  */
 TEST(dhcp_lease_parse_search_domains_basic) {
         int r;
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         static const uint8_t optionbuf[] = {
                 0x03, 'F', 'O', 'O', 0x03, 'B', 'A', 'R', 0x00,
                 0x04, 'A', 'B', 'C', 'D', 0x03, 'E', 'F', 'G', 0x00,
@@ -29,7 +29,7 @@ TEST(dhcp_lease_parse_search_domains_bas
 
 TEST(dhcp_lease_parse_search_domains_ptr) {
         int r;
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         static const uint8_t optionbuf[] = {
                 0x03, 'F', 'O', 'O', 0x00, 0xC0, 0x00,
         };
@@ -42,7 +42,7 @@ TEST(dhcp_lease_parse_search_domains_ptr
 
 TEST(dhcp_lease_parse_search_domains_labels_and_ptr) {
         int r;
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         static const uint8_t optionbuf[] = {
                 0x03, 'F', 'O', 'O', 0x03, 'B', 'A', 'R', 0x00,
                 0x03, 'A', 'B', 'C', 0xC0, 0x04,
@@ -57,7 +57,7 @@ TEST(dhcp_lease_parse_search_domains_lab
 /* Tests for exceptions. */
 
 TEST(dhcp_lease_parse_search_domains_no_data) {
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         static const uint8_t optionbuf[3] = {0, 0, 0};
 
         assert_se(dhcp_lease_parse_search_domains(NULL, 0, &domains) == -EBADMSG);
@@ -65,7 +65,7 @@ TEST(dhcp_lease_parse_search_domains_no_
 }
 
 TEST(dhcp_lease_parse_search_domains_loops) {
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         static const uint8_t optionbuf[] = {
                 0x03, 'F', 'O', 'O', 0x00, 0x03, 'B', 'A', 'R', 0xC0, 0x06,
         };
@@ -74,7 +74,7 @@ TEST(dhcp_lease_parse_search_domains_loo
 }
 
 TEST(dhcp_lease_parse_search_domains_wrong_len) {
-        _cleanup_strv_free_ char **domains = NULL;
+        _cleanup_sd_strv_free_ char **domains = NULL;
         static const uint8_t optionbuf[] = {
                 0x03, 'F', 'O', 'O', 0x03, 'B', 'A', 'R', 0x00,
                 0x04, 'A', 'B', 'C', 'D', 0x03, 'E', 'F', 'G', 0x00,
diff '--color=auto' -Nurp a/src/locale/localectl.c b/src/locale/localectl.c
--- a/src/locale/localectl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/locale/localectl.c	2025-06-30 18:37:25.000000000 +0000
@@ -47,13 +47,13 @@ typedef struct StatusInfo {
 
 static void status_info_clear(StatusInfo *info) {
         if (info) {
-                strv_free(info->locale);
+                sd_strv_free(info->locale);
                 zero(*info);
         }
 }
 
 static int print_status_info(StatusInfo *i) {
-        _cleanup_strv_free_ char **kernel_locale = NULL;
+        _cleanup_sd_strv_free_ char **kernel_locale = NULL;
         _cleanup_(table_unrefp) Table *table = NULL;
         TableCell *cell;
         int r;
@@ -81,7 +81,7 @@ static int print_status_info(StatusInfo
 
         table_set_ersatz_string(table, TABLE_ERSATZ_UNSET);
 
-        if (!strv_isempty(kernel_locale)) {
+        if (!sd_strv_isempty(kernel_locale)) {
                 log_warning("Warning: Settings on kernel command line override system locale settings in /etc/locale.conf.");
                 r = table_add_many(table,
                                    TABLE_FIELD, "Command Line",
@@ -206,7 +206,7 @@ static int set_locale(int argc, char **a
 }
 
 static int list_locales(int argc, char **argv, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         r = get_locales(&l);
@@ -244,7 +244,7 @@ static int set_vconsole_keymap(int argc,
 }
 
 static int list_vconsole_keymaps(int argc, char **argv, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         r = get_keymaps(&l);
@@ -287,7 +287,7 @@ static int set_x11_keymap(int argc, char
 
 static int list_x11_keymaps(int argc, char **argv, void *userdata) {
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **list = NULL;
+        _cleanup_sd_strv_free_ char **list = NULL;
         enum {
                 NONE,
                 MODELS,
@@ -366,11 +366,11 @@ static int list_x11_keymaps(int argc, ch
                 } else
                         *w = 0;
 
-                if (strv_consume(&list, TAKE_PTR(line)) < 0)
+                if (sd_strv_consume(&list, TAKE_PTR(line)) < 0)
                         return log_oom();
         }
 
-        if (strv_isempty(list))
+        if (sd_strv_isempty(list))
                 return log_error_errno(SYNTHETIC_ERRNO(ENOENT),
                                        "Couldn't find any entries.");
 
diff '--color=auto' -Nurp a/src/locale/localed-util.c b/src/locale/localed-util.c
--- a/src/locale/localed-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/locale/localed-util.c	2025-06-30 18:38:15.000000000 +0000
@@ -445,13 +445,13 @@ int x11_read_data(Context *c, sd_bus_mes
                         continue;
 
                 if (in_section && first_word(line, "Option")) {
-                        _cleanup_strv_free_ char **a = NULL;
+                        _cleanup_sd_strv_free_ char **a = NULL;
 
-                        r = strv_split_full(&a, line, WHITESPACE, EXTRACT_UNQUOTE);
+                        r = sd_strv_split_full(&a, line, WHITESPACE, EXTRACT_UNQUOTE);
                         if (r < 0)
                                 return r;
 
-                        if (strv_length(a) == 3) {
+                        if (sd_strv_length(a) == 3) {
                                 char **p = NULL;
 
                                 if (streq(a[1], "XkbLayout"))
@@ -468,13 +468,13 @@ int x11_read_data(Context *c, sd_bus_mes
                         }
 
                 } else if (!in_section && first_word(line, "Section")) {
-                        _cleanup_strv_free_ char **a = NULL;
+                        _cleanup_sd_strv_free_ char **a = NULL;
 
-                        r = strv_split_full(&a, line, WHITESPACE, EXTRACT_UNQUOTE);
+                        r = sd_strv_split_full(&a, line, WHITESPACE, EXTRACT_UNQUOTE);
                         if (r < 0)
                                 return -ENOMEM;
 
-                        if (strv_length(a) == 2 && streq(a[1], "InputClass"))
+                        if (sd_strv_length(a) == 2 && streq(a[1], "InputClass"))
                                 in_section = true;
 
                 } else if (in_section && first_word(line, "EndSection"))
@@ -488,7 +488,7 @@ int x11_read_data(Context *c, sd_bus_mes
 }
 
 int vconsole_write_data(Context *c) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const X11Context *xc;
         int r;
 
@@ -524,7 +524,7 @@ int vconsole_write_data(Context *c) {
         if (r < 0)
                 return r;
 
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 if (unlink("/etc/vconsole.conf") < 0)
                         return errno == ENOENT ? 0 : -errno;
 
@@ -613,7 +613,7 @@ static int read_next_mapping(
         assert(ret);
 
         for (;;) {
-                _cleanup_strv_free_ char **b = NULL;
+                _cleanup_sd_strv_free_ char **b = NULL;
                 _cleanup_free_ char *line = NULL;
                 size_t length;
                 int r;
@@ -629,11 +629,11 @@ static int read_next_mapping(
                 if (IN_SET(line[0], 0, '#'))
                         continue;
 
-                r = strv_split_full(&b, line, WHITESPACE, EXTRACT_UNQUOTE);
+                r = sd_strv_split_full(&b, line, WHITESPACE, EXTRACT_UNQUOTE);
                 if (r < 0)
                         return r;
 
-                length = strv_length(b);
+                length = sd_strv_length(b);
                 if (length < min_fields || length > max_fields) {
                         log_debug("Invalid line %s:%u, ignoring.", strna(filename), *n);
                         continue;
@@ -668,7 +668,7 @@ int vconsole_convert_to_x11(const VCCont
                 return -errno;
 
         for (unsigned n = 0;;) {
-                _cleanup_strv_free_ char **a = NULL;
+                _cleanup_sd_strv_free_ char **a = NULL;
 
                 r = read_next_mapping(map, 5, UINT_MAX, f, &n, &a);
                 if (r < 0)
@@ -736,7 +736,7 @@ int vconsole_convert_to_x11(const VCCont
 
 int find_converted_keymap(const X11Context *xc, char **ret) {
         _cleanup_free_ char *n = NULL, *p = NULL, *pz = NULL;
-        _cleanup_strv_free_ char **keymap_dirs = NULL;
+        _cleanup_sd_strv_free_ char **keymap_dirs = NULL;
         int r;
 
         assert(xc);
@@ -798,7 +798,7 @@ int find_legacy_keymap(const X11Context
                 return -errno;
 
         for (unsigned n = 0;;) {
-                _cleanup_strv_free_ char **a = NULL;
+                _cleanup_sd_strv_free_ char **a = NULL;
                 unsigned matching = 0;
 
                 r = read_next_mapping(map, 5, UINT_MAX, f, &n, &a);
@@ -813,13 +813,13 @@ int find_legacy_keymap(const X11Context
                         matching = 10;
                 else {
                         /* see if we get an exact match with the order reversed */
-                        _cleanup_strv_free_ char **b = NULL;
+                        _cleanup_sd_strv_free_ char **b = NULL;
                         _cleanup_free_ char *c = NULL;
-                        r = strv_split_full(&b, a[1], ",", 0);
+                        r = sd_strv_split_full(&b, a[1], ",", 0);
                         if (r < 0)
                                 return r;
-                        strv_reverse(b);
-                        c = strv_join(b, ",");
+                        sd_strv_reverse(b);
+                        c = sd_strv_join(b, ",");
                         if (!c)
                                 return log_oom();
                         if (streq(xc->layout, c))
@@ -953,14 +953,14 @@ int find_language_fallback(const char *l
                 return -errno;
 
         for (;;) {
-                _cleanup_strv_free_ char **a = NULL;
+                _cleanup_sd_strv_free_ char **a = NULL;
 
                 r = read_next_mapping(map, 2, 2, f, &n, &a);
                 if (r <= 0)
                         return r;
 
                 if (streq(lang, a[0])) {
-                        assert(strv_length(a) == 2);
+                        assert(sd_strv_length(a) == 2);
                         *ret = TAKE_PTR(a[1]);
                         return 1;
                 }
diff '--color=auto' -Nurp a/src/locale/localed.c b/src/locale/localed.c
--- a/src/locale/localed.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/locale/localed.c	2025-06-30 18:37:56.000000000 +0000
@@ -51,7 +51,7 @@ static int property_get_locale(
                 sd_bus_error *error) {
 
         Context *c = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         r = locale_read_data(c, reply);
@@ -209,7 +209,7 @@ static int locale_gen_process_locale(cha
 
 static int method_set_locale(sd_bus_message *m, void *userdata, sd_bus_error *error) {
         _cleanup_(locale_variables_freep) char *new_locale[_VARIABLE_LC_MAX] = {};
-        _cleanup_strv_free_ char **l = NULL, **l_set = NULL, **l_unset = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL, **l_set = NULL, **l_unset = NULL;
         Context *c = ASSERT_PTR(userdata);
         int interactive, r;
         bool use_localegen;
@@ -227,7 +227,7 @@ static int method_set_locale(sd_bus_mess
         use_localegen = locale_gen_check_available();
 
         /* If single locale without variable name is provided, then we assume it is LANG=. */
-        if (strv_length(l) == 1 && !strchr(l[0], '=')) {
+        if (sd_strv_length(l) == 1 && !strchr(l[0], '=')) {
                 if (!locale_is_valid(l[0]))
                         return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid locale specification: %s", l[0]);
                 if (!use_localegen && locale_is_installed(l[0]) <= 0)
@@ -237,7 +237,7 @@ static int method_set_locale(sd_bus_mess
                 if (!new_locale[VARIABLE_LANG])
                         return log_oom();
 
-                l = strv_free(l);
+                l = sd_strv_free(l);
         }
 
         /* Check whether a variable is valid */
@@ -313,10 +313,10 @@ static int method_set_locale(sd_bus_mess
          * may be outdated, since locale.conf has just changed and PID1 hasn't read it */
         (void) bus_service_manager_reload(sd_bus_message_get_bus(m));
 
-        if (!strv_isempty(l_set)) {
+        if (!sd_strv_isempty(l_set)) {
                 _cleanup_free_ char *line = NULL;
 
-                line = strv_join(l_set, ", ");
+                line = sd_strv_join(l_set, ", ");
                 log_info("Changed locale to %s.", strnull(line));
         } else
                 log_info("Changed locale to unset.");
diff '--color=auto' -Nurp a/src/login/inhibit.c b/src/login/inhibit.c
--- a/src/login/inhibit.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/inhibit.c	2025-06-30 18:37:55.000000000 +0000
@@ -271,7 +271,7 @@ static int run(int argc, char *argv[]) {
                 return print_inhibitors(bus);
         else {
                 _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
-                _cleanup_strv_free_ char **arguments = NULL;
+                _cleanup_sd_strv_free_ char **arguments = NULL;
                 _cleanup_free_ char *w = NULL;
                 _cleanup_close_ int fd = -EBADF;
                 pid_t pid;
@@ -280,7 +280,7 @@ static int run(int argc, char *argv[]) {
                 (void) ignore_signals(SIGINT);
 
                 if (!arg_who) {
-                        w = strv_join(argv + optind, " ");
+                        w = sd_strv_join(argv + optind, " ");
                         if (!w)
                                 return log_oom();
 
@@ -294,7 +294,7 @@ static int run(int argc, char *argv[]) {
                 if (fd < 0)
                         return log_error_errno(fd, "Failed to inhibit: %s", bus_error_message(&error, fd));
 
-                arguments = strv_copy(argv + optind);
+                arguments = sd_strv_copy(argv + optind);
                 if (!arguments)
                         return log_oom();
 
diff '--color=auto' -Nurp a/src/login/loginctl.c b/src/login/loginctl.c
--- a/src/login/loginctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/loginctl.c	2025-06-30 18:37:25.000000000 +0000
@@ -53,7 +53,7 @@ static bool arg_ask_password = true;
 static unsigned arg_lines = 10;
 static OutputMode arg_output = OUTPUT_SHORT;
 
-STATIC_DESTRUCTOR_REGISTER(arg_property, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_property, sd_strv_freep);
 
 typedef struct SessionStatusInfo {
         const char *id;
@@ -98,13 +98,13 @@ typedef struct SeatStatusInfo {
 static void user_status_info_done(UserStatusInfo *info) {
         assert(info);
 
-        strv_free(info->sessions);
+        sd_strv_free(info->sessions);
 }
 
 static void seat_status_info_done(SeatStatusInfo *info) {
         assert(info);
 
-        strv_free(info->sessions);
+        sd_strv_free(info->sessions);
 }
 
 static OutputFlags get_output_flags(void) {
@@ -514,7 +514,7 @@ static int prop_map_sessions_strv(sd_bus
                 return r;
 
         while ((r = sd_bus_message_read(m, "(so)", &name, NULL)) > 0) {
-                r = strv_extend(userdata, name);
+                r = sd_strv_extend(userdata, name);
                 if (r < 0)
                         return r;
         }
@@ -796,8 +796,8 @@ static int print_user_status_info(sd_bus
         if (r < 0)
                 return table_log_add_error(r);
 
-        if (!strv_isempty(i.sessions)) {
-                _cleanup_strv_free_ char **sessions = TAKE_PTR(i.sessions);
+        if (!sd_strv_isempty(i.sessions)) {
+                _cleanup_sd_strv_free_ char **sessions = TAKE_PTR(i.sessions);
 
                 r = mark_session(sessions, i.display);
                 if (r < 0)
@@ -877,8 +877,8 @@ static int print_seat_status_info(sd_bus
 
         (void) table_set_ersatz_string(table, TABLE_ERSATZ_NA);
 
-        if (!strv_isempty(i.sessions)) {
-                _cleanup_strv_free_ char **sessions = TAKE_PTR(i.sessions);
+        if (!sd_strv_isempty(i.sessions)) {
+                _cleanup_sd_strv_free_ char **sessions = TAKE_PTR(i.sessions);
 
                 r = mark_session(sessions, i.active_session);
                 if (r < 0)
@@ -1579,7 +1579,7 @@ static int parse_argv(int argc, char *ar
                         _fallthrough_;
 
                 case 'p': {
-                        r = strv_extend(&arg_property, optarg);
+                        r = sd_strv_extend(&arg_property, optarg);
                         if (r < 0)
                                 return log_oom();
 
diff '--color=auto' -Nurp a/src/login/logind-action.c b/src/login/logind-action.c
--- a/src/login/logind-action.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind-action.c	2025-06-30 18:37:42.000000000 +0000
@@ -151,14 +151,14 @@ static const HandleAction sleep_actions[
 };
 
 int handle_action_get_enabled_sleep_actions(HandleActionSleepMask mask, char ***ret) {
-        _cleanup_strv_free_ char **actions = NULL;
+        _cleanup_sd_strv_free_ char **actions = NULL;
         int r;
 
         assert(ret);
 
         FOREACH_ELEMENT(i, sleep_actions)
                 if (FLAGS_SET(mask, 1U << *i)) {
-                        r = strv_extend(&actions, handle_action_to_string(*i));
+                        r = sd_strv_extend(&actions, handle_action_to_string(*i));
                         if (r < 0)
                                 return r;
                 }
@@ -404,7 +404,7 @@ int config_parse_handle_action_sleep(
                 void *userdata) {
 
         HandleActionSleepMask *mask = ASSERT_PTR(data);
-        _cleanup_strv_free_ char **actions = NULL;
+        _cleanup_sd_strv_free_ char **actions = NULL;
 
         assert(filename);
         assert(lvalue);
@@ -413,7 +413,7 @@ int config_parse_handle_action_sleep(
         if (isempty(rvalue))
                 goto empty;
 
-        if (strv_split_full(&actions, rvalue, NULL, EXTRACT_UNQUOTE|EXTRACT_RETAIN_ESCAPE) < 0)
+        if (sd_strv_split_full(&actions, rvalue, NULL, EXTRACT_UNQUOTE|EXTRACT_RETAIN_ESCAPE) < 0)
                 return log_oom();
 
         *mask = 0;
diff '--color=auto' -Nurp a/src/login/logind-core.c b/src/login/logind-core.c
--- a/src/login/logind-core.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind-core.c	2025-06-30 18:37:25.000000000 +0000
@@ -73,8 +73,8 @@ void manager_reset_config(Manager *m) {
 
         m->kill_user_processes = KILL_USER_PROCESSES;
 
-        m->kill_only_users = strv_free(m->kill_only_users);
-        m->kill_exclude_users = strv_free(m->kill_exclude_users);
+        m->kill_only_users = sd_strv_free(m->kill_only_users);
+        m->kill_exclude_users = sd_strv_free(m->kill_exclude_users);
 
         m->stop_idle_session_usec = USEC_INFINITY;
 }
@@ -456,7 +456,7 @@ bool manager_shall_kill(Manager *m, cons
         if (strv_contains(m->kill_exclude_users, user))
                 return false;
 
-        if (!strv_isempty(m->kill_only_users))
+        if (!sd_strv_isempty(m->kill_only_users))
                 return strv_contains(m->kill_only_users, user);
 
         return m->kill_user_processes;
diff '--color=auto' -Nurp a/src/login/logind-dbus.c b/src/login/logind-dbus.c
--- a/src/login/logind-dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind-dbus.c	2025-06-30 18:33:49.000000000 +0000
@@ -351,7 +351,7 @@ static int property_get_sleep_operations
                 sd_bus_error *error) {
 
         Manager *m = ASSERT_PTR(userdata);
-        _cleanup_strv_free_ char **actions = NULL;
+        _cleanup_sd_strv_free_ char **actions = NULL;
         int r;
 
         assert(bus);
diff '--color=auto' -Nurp a/src/login/logind-seat-dbus.c b/src/login/logind-seat-dbus.c
--- a/src/login/logind-seat-dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind-seat-dbus.c	2025-06-30 18:36:37.000000000 +0000
@@ -295,7 +295,7 @@ char *seat_bus_path(Seat *s) {
 }
 
 static int seat_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         sd_bus_message *message;
         Manager *m = userdata;
         Seat *seat;
@@ -312,7 +312,7 @@ static int seat_node_enumerator(sd_bus *
                 if (!p)
                         return -ENOMEM;
 
-                r = strv_consume(&l, p);
+                r = sd_strv_consume(&l, p);
                 if (r < 0)
                         return r;
         }
@@ -332,7 +332,7 @@ static int seat_node_enumerator(sd_bus *
 
                                 session = hashmap_get(m->sessions, name);
                                 if (session && session->seat) {
-                                        r = strv_extend(&l, "/org/freedesktop/login1/seat/self");
+                                        r = sd_strv_extend(&l, "/org/freedesktop/login1/seat/self");
                                         if (r < 0)
                                                 return r;
 
@@ -353,7 +353,7 @@ static int seat_node_enumerator(sd_bus *
                         }
 
                         if (may_auto) {
-                                r = strv_extend(&l, "/org/freedesktop/login1/seat/auto");
+                                r = sd_strv_extend(&l, "/org/freedesktop/login1/seat/auto");
                                 if (r < 0)
                                         return r;
                         }
diff '--color=auto' -Nurp a/src/login/logind-session-dbus.c b/src/login/logind-session-dbus.c
--- a/src/login/logind-session-dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind-session-dbus.c	2025-06-30 18:36:37.000000000 +0000
@@ -726,7 +726,7 @@ char *session_bus_path(Session *s) {
 }
 
 static int session_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         sd_bus_message *message;
         Manager *m = userdata;
         Session *session;
@@ -743,7 +743,7 @@ static int session_node_enumerator(sd_bu
                 if (!p)
                         return -ENOMEM;
 
-                r = strv_consume(&l, p);
+                r = sd_strv_consume(&l, p);
                 if (r < 0)
                         return r;
         }
@@ -761,7 +761,7 @@ static int session_node_enumerator(sd_bu
                         if (r >= 0) {
                                 session = hashmap_get(m->sessions, name);
                                 if (session) {
-                                        r = strv_extend(&l, "/org/freedesktop/login1/session/self");
+                                        r = sd_strv_extend(&l, "/org/freedesktop/login1/session/self");
                                         if (r < 0)
                                                 return r;
 
@@ -782,7 +782,7 @@ static int session_node_enumerator(sd_bu
                         }
 
                         if (may_auto) {
-                                r = strv_extend(&l, "/org/freedesktop/login1/session/auto");
+                                r = sd_strv_extend(&l, "/org/freedesktop/login1/session/auto");
                                 if (r < 0)
                                         return r;
                         }
diff '--color=auto' -Nurp a/src/login/logind-user-dbus.c b/src/login/logind-user-dbus.c
--- a/src/login/logind-user-dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind-user-dbus.c	2025-06-30 18:36:37.000000000 +0000
@@ -301,7 +301,7 @@ char *user_bus_path(User *u) {
 }
 
 static int user_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         sd_bus_message *message;
         Manager *m = userdata;
         User *user;
@@ -318,7 +318,7 @@ static int user_node_enumerator(sd_bus *
                 if (!p)
                         return -ENOMEM;
 
-                r = strv_consume(&l, p);
+                r = sd_strv_consume(&l, p);
                 if (r < 0)
                         return r;
         }
@@ -335,7 +335,7 @@ static int user_node_enumerator(sd_bus *
                         if (r >= 0) {
                                 user = hashmap_get(m->users, UID_TO_PTR(uid));
                                 if (user) {
-                                        r = strv_extend(&l, "/org/freedesktop/login1/user/self");
+                                        r = sd_strv_extend(&l, "/org/freedesktop/login1/user/self");
                                         if (r < 0)
                                                 return r;
                                 }
diff '--color=auto' -Nurp a/src/login/logind.c b/src/login/logind.c
--- a/src/login/logind.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/logind.c	2025-06-30 18:37:42.000000000 +0000
@@ -164,14 +164,14 @@ static Manager* manager_free(Manager *m)
 
         safe_close(m->reserve_vt_fd);
 
-        strv_free(m->kill_only_users);
-        strv_free(m->kill_exclude_users);
+        sd_strv_free(m->kill_only_users);
+        sd_strv_free(m->kill_exclude_users);
 
         free(m->scheduled_shutdown_tty);
         free(m->wall_message);
         free(m->action_job);
 
-        strv_free(m->efi_boot_loader_entries);
+        sd_strv_free(m->efi_boot_loader_entries);
         free(m->efi_loader_entry_one_shot);
 
         return mfree(m);
@@ -359,14 +359,14 @@ static int manager_enumerate_users(Manag
 }
 
 static int parse_fdname(const char *fdname, char **ret_session_id, dev_t *ret_devno) {
-        _cleanup_strv_free_ char **parts = NULL;
+        _cleanup_sd_strv_free_ char **parts = NULL;
         _cleanup_free_ char *id = NULL;
         int r;
 
         assert(ret_session_id);
         assert(ret_devno);
 
-        parts = strv_split(fdname, "-");
+        parts = sd_strv_split(fdname, "-");
         if (!parts)
                 return -ENOMEM;
 
@@ -523,7 +523,7 @@ fail_close:
 }
 
 static int manager_enumerate_sessions(Manager *m) {
-        _cleanup_strv_free_ char **fdnames = NULL;
+        _cleanup_sd_strv_free_ char **fdnames = NULL;
         _cleanup_closedir_ DIR *d = NULL;
         int r = 0, n;
 
diff '--color=auto' -Nurp a/src/login/pam_systemd.c b/src/login/pam_systemd.c
--- a/src/login/pam_systemd.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/pam_systemd.c	2025-06-30 18:37:55.000000000 +0000
@@ -629,7 +629,7 @@ static int apply_user_record_settings(
                 bool debug,
                 uint64_t default_capability_bounding_set,
                 uint64_t default_capability_ambient_set) {
-        _cleanup_strv_free_ char **langs = NULL;
+        _cleanup_sd_strv_free_ char **langs = NULL;
         int r;
 
         assert(handle);
@@ -679,7 +679,7 @@ static int apply_user_record_settings(
         if (r < 0)
                 pam_syslog_errno(handle, LOG_ERR, r,
                                  "Failed to acquire user's language preferences, ignoring: %m");
-        else if (strv_isempty(langs))
+        else if (sd_strv_isempty(langs))
                 ; /* User has no preference set so we do nothing */
         else if (locale_is_installed(langs[0]) <= 0)
                 pam_debug_syslog(handle, debug,
@@ -695,10 +695,10 @@ static int apply_user_record_settings(
                 if (r != PAM_SUCCESS)
                         return r;
 
-                if (strv_length(langs) > 1) {
+                if (sd_strv_length(langs) > 1) {
                         _cleanup_free_ char *joined = NULL, *language = NULL;
 
-                        joined = strv_join(langs, ":");
+                        joined = sd_strv_join(langs, ":");
                         if (!joined)
                                 return pam_log_oom(handle);
 
diff '--color=auto' -Nurp a/src/login/pam_systemd_loadkey.c b/src/login/pam_systemd_loadkey.c
--- a/src/login/pam_systemd_loadkey.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/login/pam_systemd_loadkey.c	2025-06-30 18:35:00.000000000 +0000
@@ -73,11 +73,11 @@ _public_ PAM_EXTERN int pam_sm_authentic
 
         /* Split the key by NUL. Set the last item as authtok. */
 
-        _cleanup_(strv_free_erasep) char **passwords = strv_parse_nulstr(p, n);
+        _cleanup_(sd_strv_free_erasep) char **passwords = strv_parse_nulstr(p, n);
         if (!passwords)
                 return pam_log_oom(handle);
 
-        size_t passwords_len = strv_length(passwords);
+        size_t passwords_len = sd_strv_length(passwords);
         if (passwords_len == 0) {
                 pam_debug_syslog(handle, debug, "Key is empty");
                 return PAM_AUTHINFO_UNAVAIL;
diff '--color=auto' -Nurp a/src/machine/image-dbus.c b/src/machine/image-dbus.c
--- a/src/machine/image-dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/machine/image-dbus.c	2025-06-30 18:36:37.000000000 +0000
@@ -475,7 +475,7 @@ char *image_bus_path(const char *name) {
 
 static int image_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
         _cleanup_hashmap_free_ Hashmap *images = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Image *image;
         int r;
 
@@ -498,7 +498,7 @@ static int image_node_enumerator(sd_bus
                 if (!p)
                         return -ENOMEM;
 
-                r = strv_consume(&l, p);
+                r = sd_strv_consume(&l, p);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/machine/machine-dbus.c b/src/machine/machine-dbus.c
--- a/src/machine/machine-dbus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/machine/machine-dbus.c	2025-06-30 18:37:55.000000000 +0000
@@ -371,7 +371,7 @@ int bus_machine_method_get_ssh_info(sd_b
 #define EXIT_NOT_FOUND 2
 
 int bus_machine_method_get_os_release(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Machine *m = ASSERT_PTR(userdata);
         int r;
 
@@ -605,7 +605,7 @@ int bus_machine_method_open_shell(sd_bus
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *allocated_bus = NULL;
         sd_bus *container_bus = NULL;
         _cleanup_close_ int master = -EBADF, slave = -EBADF;
-        _cleanup_strv_free_ char **env = NULL, **args_wire = NULL, **args = NULL;
+        _cleanup_sd_strv_free_ char **env = NULL, **args_wire = NULL, **args = NULL;
         _cleanup_free_ char *command_line = NULL;
         Machine *m = ASSERT_PTR(userdata);
         const char *p, *unit, *user, *path, *description, *utmp_id;
@@ -644,10 +644,10 @@ int bus_machine_method_open_shell(sd_bus
                 if (!path_is_absolute(path))
                         return sd_bus_error_setf(error, SD_BUS_ERROR_INVALID_ARGS, "Specified path '%s' is not absolute", path);
                 args = TAKE_PTR(args_wire);
-                if (strv_isempty(args)) {
-                        args = strv_free(args);
+                if (sd_strv_isempty(args)) {
+                        args = sd_strv_free(args);
 
-                        args = strv_new(path);
+                        args = sd_strv_new(path);
                         if (!args)
                                 return -ENOMEM;
                 }
@@ -659,7 +659,7 @@ int bus_machine_method_open_shell(sd_bus
         if (!strv_env_is_valid(env))
                 return sd_bus_error_set(error, SD_BUS_ERROR_INVALID_ARGS, "Invalid environment assignments");
 
-        command_line = strv_join(args, " ");
+        command_line = sd_strv_join(args, " ");
         if (!command_line)
                 return -ENOMEM;
         const char *details[] = {
@@ -739,7 +739,7 @@ int bus_machine_method_open_shell(sd_bus
         if (r < 0)
                 return r;
 
-        if (!strv_isempty(env)) {
+        if (!sd_strv_isempty(env)) {
                 r = sd_bus_message_open_container(tm, 'r', "sv");
                 if (r < 0)
                         return r;
@@ -1244,7 +1244,7 @@ char *machine_bus_path(Machine *m) {
 }
 
 static int machine_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Machine *machine = NULL;
         Manager *m = userdata;
         int r;
@@ -1260,7 +1260,7 @@ static int machine_node_enumerator(sd_bu
                 if (!p)
                         return -ENOMEM;
 
-                r = strv_consume(&l, p);
+                r = sd_strv_consume(&l, p);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/machine/machinectl.c b/src/machine/machinectl.c
--- a/src/machine/machinectl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/machine/machinectl.c	2025-06-30 18:37:55.000000000 +0000
@@ -107,8 +107,8 @@ static const char *arg_uid = NULL;
 static char **arg_setenv = NULL;
 static unsigned arg_max_addresses = 1;
 
-STATIC_DESTRUCTOR_REGISTER(arg_property, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_setenv, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_property, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_setenv, sd_strv_freep);
 
 static OutputFlags get_output_flags(void) {
         return
@@ -1307,7 +1307,7 @@ static int login_machine(int argc, char
         sd_bus *bus = ASSERT_PTR(userdata);
         const char *match, *machine;
 
-        if (!strv_isempty(arg_setenv) || arg_uid)
+        if (!sd_strv_isempty(arg_setenv) || arg_uid)
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "--setenv= and --uid= are not supported for 'login'. Use 'shell' instead.");
 
@@ -1370,7 +1370,7 @@ static int shell_machine(int argc, char
 
                 t = strv_find_prefix(environ, "TERM=");
                 if (t) {
-                        if (strv_extend(&arg_setenv, t) < 0)
+                        if (sd_strv_extend(&arg_setenv, t) < 0)
                                 return log_oom();
                 }
         }
@@ -1410,7 +1410,7 @@ static int shell_machine(int argc, char
         if (r < 0)
                 return bus_log_create_error(r);
 
-        r = sd_bus_message_append_strv(m, strv_length(argv) <= 3 ? NULL : argv + 2);
+        r = sd_bus_message_append_strv(m, sd_strv_length(argv) <= 3 ? NULL : argv + 2);
         if (r < 0)
                 return bus_log_create_error(r);
 
@@ -1852,20 +1852,20 @@ static int enable_machine(int argc, char
                 return r;
 
         if (arg_now) {
-                _cleanup_strv_free_ char **new_args = NULL;
+                _cleanup_sd_strv_free_ char **new_args = NULL;
 
-                new_args = strv_new(enable ? "start" : "poweroff");
+                new_args = sd_strv_new(enable ? "start" : "poweroff");
                 if (!new_args)
                         return log_oom();
 
-                r = strv_extend_strv(&new_args, argv + 1, /* filter_duplicates = */ false);
+                r = sd_sd_strv_extend_strv(&new_args, argv + 1, /* filter_duplicates = */ false);
                 if (r < 0)
                         return log_oom();
 
                 if (enable)
-                        return start_machine(strv_length(new_args), new_args, userdata);
+                        return start_machine(sd_strv_length(new_args), new_args, userdata);
 
-                return poweroff_machine(strv_length(new_args), new_args, userdata);
+                return poweroff_machine(sd_strv_length(new_args), new_args, userdata);
         }
 
         return 0;
@@ -1960,40 +1960,40 @@ static int chainload_importctl(int argc,
 
         log_notice("The 'machinectl %1$s' command has been replaced by 'importctl -m %1$s'. Redirecting invocation.", argv[optind]);
 
-        _cleanup_strv_free_ char **c =
-                strv_new("importctl", "--class=machine");
+        _cleanup_sd_strv_free_ char **c =
+                sd_strv_new("importctl", "--class=machine");
         if (!c)
                 return log_oom();
 
         if (FLAGS_SET(arg_pager_flags, PAGER_DISABLE))
-                if (strv_extend(&c, "--no-pager") < 0)
+                if (sd_strv_extend(&c, "--no-pager") < 0)
                         return log_oom();
         if (!arg_legend)
-                if (strv_extend(&c, "--no-legend") < 0)
+                if (sd_strv_extend(&c, "--no-legend") < 0)
                         return log_oom();
         if (arg_read_only)
-                if (strv_extend(&c, "--read-only") < 0)
+                if (sd_strv_extend(&c, "--read-only") < 0)
                         return log_oom();
         if (arg_force)
-                if (strv_extend(&c, "--force") < 0)
+                if (sd_strv_extend(&c, "--force") < 0)
                         return log_oom();
         if (arg_quiet)
-                if (strv_extend(&c, "--quiet") < 0)
+                if (sd_strv_extend(&c, "--quiet") < 0)
                         return log_oom();
         if (!arg_ask_password)
-                if (strv_extend(&c, "--no-ask-password") < 0)
+                if (sd_strv_extend(&c, "--no-ask-password") < 0)
                         return log_oom();
-        if (strv_extend_many(&c, "--verify", import_verify_to_string(arg_verify)) < 0)
+        if (sd_strv_extend_many(&c, "--verify", import_verify_to_string(arg_verify)) < 0)
                 return log_oom();
         if (arg_format)
-                if (strv_extend_many(&c, "--format", arg_format) < 0)
+                if (sd_strv_extend_many(&c, "--format", arg_format) < 0)
                         return log_oom();
 
-        if (strv_extend_strv(&c, argv + optind, /* filter_duplicates= */ false) < 0)
+        if (sd_sd_strv_extend_strv(&c, argv + optind, /* filter_duplicates= */ false) < 0)
                 return log_oom();
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *joined = strv_join(c, " ");
+                _cleanup_free_ char *joined = sd_strv_join(c, " ");
                 log_debug("Chainloading: %s", joined);
         }
 
@@ -2211,7 +2211,7 @@ static int parse_argv(int argc, char *ar
 
                 case 'p':
                 case 'P':
-                        r = strv_extend(&arg_property, optarg);
+                        r = sd_strv_extend(&arg_property, optarg);
                         if (r < 0)
                                 return log_oom();
 
diff '--color=auto' -Nurp a/src/modules-load/modules-load.c b/src/modules-load/modules-load.c
--- a/src/modules-load/modules-load.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/modules-load/modules-load.c	2025-06-30 18:37:42.000000000 +0000
@@ -21,16 +21,16 @@
 static char **arg_proc_cmdline_modules = NULL;
 static const char conf_file_dirs[] = CONF_PATHS_NULSTR("modules-load.d");
 
-STATIC_DESTRUCTOR_REGISTER(arg_proc_cmdline_modules, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_proc_cmdline_modules, sd_strv_freep);
 
 static int add_modules(const char *p) {
-        _cleanup_strv_free_ char **k = NULL;
+        _cleanup_sd_strv_free_ char **k = NULL;
 
-        k = strv_split(p, ",");
+        k = sd_strv_split(p, ",");
         if (!k)
                 return log_oom();
 
-        if (strv_extend_strv(&arg_proc_cmdline_modules, k, true) < 0)
+        if (sd_sd_strv_extend_strv(&arg_proc_cmdline_modules, k, true) < 0)
                 return log_oom();
 
         return 0;
@@ -174,7 +174,7 @@ static int run(int argc, char *argv[]) {
                         RET_GATHER(r, apply_file(ctx, argv[i], false));
 
         } else {
-                _cleanup_strv_free_ char **files = NULL;
+                _cleanup_sd_strv_free_ char **files = NULL;
 
                 STRV_FOREACH(i, arg_proc_cmdline_modules) {
                         k = module_load_and_warn(ctx, *i, true);
diff '--color=auto' -Nurp a/src/mount/mount-tool.c b/src/mount/mount-tool.c
--- a/src/mount/mount-tool.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/mount/mount-tool.c	2025-06-30 18:35:42.000000000 +0000
@@ -80,8 +80,8 @@ STATIC_DESTRUCTOR_REGISTER(arg_mount_whe
 STATIC_DESTRUCTOR_REGISTER(arg_mount_type, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_mount_options, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_description, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_property, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_automount_property, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_property, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_automount_property, sd_strv_freep);
 
 static int parse_where(const char *input, char **ret_where) {
         int r;
@@ -311,7 +311,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case 'p':
-                        if (strv_extend(&arg_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_property, optarg) < 0)
                                 return log_oom();
 
                         break;
@@ -336,7 +336,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_AUTOMOUNT_PROPERTY:
-                        if (strv_extend(&arg_automount_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_automount_property, optarg) < 0)
                                 return log_oom();
 
                         break;
@@ -420,7 +420,7 @@ static int parse_argv(int argc, char *ar
                         }
 
                         if (!strv_contains(arg_property, "Type=tmpfs") &&
-                            strv_extend(&arg_property, "Type=tmpfs") < 0)
+                            sd_strv_extend(&arg_property, "Type=tmpfs") < 0)
                                 return log_oom();
                 } else {
                         if (arg_mount_type && !fstype_is_blockdev_backed(arg_mount_type)) {
@@ -790,7 +790,7 @@ static int start_transient_automount(
 static int find_mount_points(const char *what, char ***list) {
         _cleanup_(mnt_free_tablep) struct libmnt_table *table = NULL;
         _cleanup_(mnt_free_iterp) struct libmnt_iter *iter = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         size_t n = 0;
         int r;
 
@@ -975,7 +975,7 @@ static int stop_mounts(
 }
 
 static int umount_by_device(sd_bus *bus, sd_device *dev) {
-        _cleanup_strv_free_ char **list = NULL;
+        _cleanup_sd_strv_free_ char **list = NULL;
         const char *v;
         int r, ret = 0;
 
@@ -1192,7 +1192,7 @@ static int acquire_mount_where(sd_device
 }
 
 static int acquire_mount_where_for_loop_dev(sd_device *dev) {
-        _cleanup_strv_free_ char **list = NULL;
+        _cleanup_sd_strv_free_ char **list = NULL;
         const char *node;
         int r;
 
diff '--color=auto' -Nurp a/src/network/generator/network-generator.c b/src/network/generator/network-generator.c
--- a/src/network/generator/network-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/generator/network-generator.c	2025-06-30 18:37:25.000000000 +0000
@@ -181,8 +181,8 @@ static Network *network_free(Network *ne
 
         free(network->ifname);
         free(network->hostname);
-        strv_free(network->dns);
-        strv_free(network->vlan);
+        sd_strv_free(network->dns);
+        sd_strv_free(network->vlan);
         free(network->bridge);
         free(network->bond);
 
@@ -296,8 +296,8 @@ static Link *link_free(Link *link) {
 
         free(link->filename);
         free(link->ifname);
-        strv_free(link->policies);
-        strv_free(link->alt_policies);
+        sd_strv_free(link->policies);
+        sd_strv_free(link->alt_policies);
         return mfree(link);
 }
 
@@ -506,7 +506,7 @@ static int network_set_dns(Context *cont
                         return log_debug_errno(r, "Failed to create network for '%s': %m", ifname);
         }
 
-        return strv_extend(&network->dns, dns);
+        return sd_strv_extend(&network->dns, dns);
 }
 
 static int network_set_dhcp_use_dns(Context *context, const char *ifname, bool value) {
@@ -544,7 +544,7 @@ static int network_set_vlan(Context *con
                         return log_debug_errno(r, "Failed to create network for '%s': %m", ifname);
         }
 
-        return strv_extend(&network->vlan, value);
+        return sd_strv_extend(&network->vlan, value);
 }
 
 static int network_set_bridge(Context *context, const char *ifname, const char *value) {
@@ -1141,7 +1141,7 @@ static int parse_cmdline_ifname(Context
 }
 
 static int parse_cmdline_ifname_policy(Context *context, const char *key, const char *value) {
-        _cleanup_strv_free_ char **policies = NULL, **alt_policies = NULL;
+        _cleanup_sd_strv_free_ char **policies = NULL, **alt_policies = NULL;
         struct hw_addr_data mac = HW_ADDR_NULL;
         Link *link;
         int r;
@@ -1180,17 +1180,17 @@ static int parse_cmdline_ifname_policy(C
                 }
 
                 if (alternative_names_policy_from_string(word) >= 0) {
-                        r = strv_extend(&alt_policies, word);
+                        r = sd_strv_extend(&alt_policies, word);
                         if (r < 0)
                                 return log_oom_debug();
                 }
 
-                r = strv_consume(&policies, TAKE_PTR(word));
+                r = sd_strv_consume(&policies, TAKE_PTR(word));
                 if (r < 0)
                         return log_oom_debug();
         }
 
-        if (strv_isempty(policies))
+        if (sd_strv_isempty(policies))
                 return log_debug_errno(SYNTHETIC_ERRNO(EINVAL), "No ifname policy specified");
 
         r = link_new(context, NULL, &mac, &link);
@@ -1253,7 +1253,7 @@ int context_merge_networks(Context *cont
 
                 network->dhcp_use_dns = all->dhcp_use_dns;
 
-                r = strv_extend_strv(&network->dns, all->dns, false);
+                r = sd_sd_strv_extend_strv(&network->dns, all->dns, false);
                 if (r < 0)
                         return log_oom_debug();
 
@@ -1346,7 +1346,7 @@ void network_dump(Network *network, FILE
         if (ra)
                 fprintf(f, "IPv6AcceptRA=%s\n", ra);
 
-        if (!strv_isempty(network->dns))
+        if (!sd_strv_isempty(network->dns))
                 STRV_FOREACH(dns, network->dns)
                         fprintf(f, "DNS=%s\n", *dns);
 
@@ -1412,13 +1412,13 @@ void link_dump(Link *link, FILE *f) {
         if (!isempty(link->ifname))
                 fprintf(f, "Name=%s\n", link->ifname);
 
-        if (!strv_isempty(link->policies)) {
+        if (!sd_strv_isempty(link->policies)) {
                 fputs("NamePolicy=", f);
                 fputstrv(f, link->policies, " ", NULL);
                 fputc('\n', f);
         }
 
-        if (!strv_isempty(link->alt_policies)) {
+        if (!sd_strv_isempty(link->alt_policies)) {
                 fputs("AlternativeNamesPolicy=", f);
                 fputstrv(f, link->alt_policies, " ", NULL);
                 fputc('\n', f);
diff '--color=auto' -Nurp a/src/network/netdev/netdev.c b/src/network/netdev/netdev.c
--- a/src/network/netdev/netdev.c	2025-06-30 18:55:45.355159935 +0000
+++ b/src/network/netdev/netdev.c	2025-06-30 18:33:49.000000000 +0000
@@ -877,7 +877,7 @@ int netdev_load_one(Manager *manager, co
 }
 
 int netdev_load(Manager *manager, bool reload) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(manager);
diff '--color=auto' -Nurp a/src/network/networkctl-config-file.c b/src/network/networkctl-config-file.c
--- a/src/network/networkctl-config-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkctl-config-file.c	2025-06-30 18:37:42.000000000 +0000
@@ -119,7 +119,7 @@ static int get_network_files_by_link(
                 char **ret_path,
                 char ***ret_dropins) {
 
-        _cleanup_strv_free_ char **dropins = NULL;
+        _cleanup_sd_strv_free_ char **dropins = NULL;
         _cleanup_free_ char *path = NULL;
         int r, ifindex;
 
@@ -151,7 +151,7 @@ static int get_network_files_by_link(
 
 static int get_link_files_by_link(const char *link, char **ret_path, char ***ret_dropins) {
         _cleanup_(sd_device_unrefp) sd_device *device = NULL;
-        _cleanup_strv_free_ char **dropins_split = NULL;
+        _cleanup_sd_strv_free_ char **dropins_split = NULL;
         _cleanup_free_ char *p = NULL;
         const char *path, *dropins;
         int r;
@@ -174,7 +174,7 @@ static int get_link_files_by_link(const
         if (r < 0 && r != -ENOENT)
                 return log_error_errno(r, "Failed to get link drop-ins for link '%s': %m", link);
         if (r >= 0) {
-                r = strv_split_full(&dropins_split, dropins, ":", EXTRACT_CUNESCAPE);
+                r = sd_strv_split_full(&dropins_split, dropins, ":", EXTRACT_CUNESCAPE);
                 if (r < 0)
                         return log_error_errno(r, "Failed to parse link drop-ins for link '%s': %m", link);
         }
@@ -196,7 +196,7 @@ static int get_config_files_by_link_conf
                 char ***ret_dropins,
                 ReloadFlags *ret_reload) {
 
-        _cleanup_strv_free_ char **dropins = NULL, **link_config_split = NULL;
+        _cleanup_sd_strv_free_ char **dropins = NULL, **link_config_split = NULL;
         _cleanup_free_ char *path = NULL;
         const char *ifname, *type;
         ReloadFlags reload;
@@ -208,11 +208,11 @@ static int get_config_files_by_link_conf
         assert(ret_path);
         assert(ret_dropins);
 
-        link_config_split = strv_split(link_config, ":");
+        link_config_split = sd_strv_split(link_config, ":");
         if (!link_config_split)
                 return log_oom();
 
-        n = strv_length(link_config_split);
+        n = sd_strv_length(link_config_split);
         if (n == 0 || isempty(link_config_split[0]))
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "No link name is given.");
         if (n > 2)
@@ -256,7 +256,7 @@ static int add_config_to_edit(
                 char * const *dropins) {
 
         _cleanup_free_ char *new_path = NULL, *dropin_path = NULL, *old_dropin = NULL;
-        _cleanup_strv_free_ char **comment_paths = NULL;
+        _cleanup_sd_strv_free_ char **comment_paths = NULL;
         int r;
 
         assert(context);
@@ -309,11 +309,11 @@ static int add_config_to_edit(
                         return log_oom();
         }
 
-        comment_paths = strv_new(path);
+        comment_paths = sd_strv_new(path);
         if (!comment_paths)
                 return log_oom();
 
-        r = strv_extend_strv(&comment_paths, dropins, /* filter_duplicates = */ false);
+        r = sd_sd_strv_extend_strv(&comment_paths, dropins, /* filter_duplicates = */ false);
         if (r < 0)
                 return log_oom();
 
@@ -413,7 +413,7 @@ int verb_edit(int argc, char *argv[], vo
                 return r;
 
         STRV_FOREACH(name, strv_skip(argv, 1)) {
-                _cleanup_strv_free_ char **dropins = NULL;
+                _cleanup_sd_strv_free_ char **dropins = NULL;
                 _cleanup_free_ char *path = NULL;
                 const char *link_config;
 
@@ -481,12 +481,12 @@ int verb_cat(int argc, char *argv[], voi
 
         pager_open(arg_pager_flags);
 
-        if (strv_isempty(args))
+        if (sd_strv_isempty(args))
                 return conf_files_cat(NULL, "systemd/networkd.conf", CAT_FORMAT_HAS_SECTIONS);
 
         bool first = true;
         STRV_FOREACH(name, args) {
-                _cleanup_strv_free_ char **dropins = NULL;
+                _cleanup_sd_strv_free_ char **dropins = NULL;
                 _cleanup_free_ char *path = NULL;
                 const char *link_config;
 
diff '--color=auto' -Nurp a/src/network/networkctl.c b/src/network/networkctl.c
--- a/src/network/networkctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkctl.c	2025-06-30 18:37:55.000000000 +0000
@@ -233,7 +233,7 @@ static int dump_link_description(sd_bus
         if (r < 0)
                 return r;
 
-        matched_patterns = new0(bool, strv_length(patterns));
+        matched_patterns = new0(bool, sd_strv_length(patterns));
         if (!matched_patterns)
                 return log_oom();
 
@@ -269,7 +269,7 @@ static int dump_link_description(sd_bus
 
         /* Look if we matched all our arguments that are not globs. It is OK for a glob to match
          * nothing, but not for an exact argument. */
-        for (size_t pos = 0; pos < strv_length(patterns); pos++) {
+        for (size_t pos = 0; pos < sd_strv_length(patterns); pos++) {
                 if (matched_patterns[pos])
                         continue;
 
@@ -482,7 +482,7 @@ static LinkInfo* link_info_array_free(Li
                 free(array[i].netdev_kind);
                 free(array[i].ssid);
                 free(array[i].qdisc);
-                strv_free(array[i].alternative_names);
+                sd_strv_free(array[i].alternative_names);
         }
 
         return mfree(array);
@@ -608,7 +608,7 @@ static int decode_link(
                 char * const *patterns,
                 bool matched_patterns[]) {
 
-        _cleanup_strv_free_ char **altnames = NULL;
+        _cleanup_sd_strv_free_ char **altnames = NULL;
         const char *name, *qdisc;
         int ifindex, r;
         uint16_t type;
@@ -856,7 +856,7 @@ static int acquire_link_info(sd_bus *bus
                 return log_error_errno(r, "Failed to enumerate links: %m");
 
         if (patterns) {
-                matched_patterns = new0(bool, strv_length(patterns));
+                matched_patterns = new0(bool, sd_strv_length(patterns));
                 if (!matched_patterns)
                         return log_oom();
         }
@@ -883,7 +883,7 @@ static int acquire_link_info(sd_bus *bus
 
         /* Look if we matched all our arguments that are not globs. It
          * is OK for a glob to match nothing, but not for an exact argument. */
-        for (size_t pos = 0; pos < strv_length(patterns); pos++) {
+        for (size_t pos = 0; pos < sd_strv_length(patterns); pos++) {
                 if (matched_patterns[pos])
                         continue;
 
@@ -1140,7 +1140,7 @@ static int dump_list(Table *table, const
         assert(table);
         assert(key);
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return 0;
 
         r = table_add_many(table,
@@ -1154,7 +1154,7 @@ static int dump_list(Table *table, const
 
 static int dump_gateways(sd_netlink *rtnl, sd_hwdb *hwdb, Table *table, int ifindex) {
         _cleanup_free_ struct local_address *local_addrs = NULL;
-        _cleanup_strv_free_ char **buf = NULL;
+        _cleanup_sd_strv_free_ char **buf = NULL;
         int r, n;
 
         assert(rtnl);
@@ -1172,7 +1172,7 @@ static int dump_gateways(sd_netlink *rtn
                         log_debug_errno(r, "Could not get description of gateway, ignoring: %m");
 
                 /* Show interface name for the entry if we show entries for all interfaces */
-                r = strv_extendf(&buf, "%s%s%s%s%s%s",
+                r = sd_sd_strv_extendf(&buf, "%s%s%s%s%s%s",
                                  IN_ADDR_TO_STRING(local->family, &local->address),
                                  description ? " (" : "",
                                  strempty(description),
@@ -1193,7 +1193,7 @@ static int dump_addresses(
                 int ifindex) {
 
         _cleanup_free_ struct local_address *local_addrs = NULL;
-        _cleanup_strv_free_ char **buf = NULL;
+        _cleanup_sd_strv_free_ char **buf = NULL;
         struct in_addr dhcp4_address = {};
         int r, n;
 
@@ -1214,7 +1214,7 @@ static int dump_addresses(
                 if (local->family == AF_INET && in4_addr_equal(&local->address.in, &dhcp4_address))
                         dhcp4 = sd_dhcp_lease_get_server_identifier(lease, &server_address) >= 0;
 
-                r = strv_extendf(&buf, "%s%s%s%s%s%s",
+                r = sd_sd_strv_extendf(&buf, "%s%s%s%s%s%s",
                                  IN_ADDR_TO_STRING(local->family, &local->address),
                                  dhcp4 ? " (DHCPv4 via " : "",
                                  dhcp4 ? IN4_ADDR_TO_STRING(&server_address) : "",
@@ -1329,7 +1329,7 @@ static void interface_info_done(Interfac
         if (!p)
                 return;
 
-        strv_free(p->altnames);
+        sd_strv_free(p->altnames);
         json_variant_unref(p->v);
 }
 
@@ -1361,7 +1361,7 @@ static const JsonDispatch lldp_neighbor_
 };
 
 static int dump_lldp_neighbors(Varlink *vl, Table *table, int ifindex) {
-        _cleanup_strv_free_ char **buf = NULL;
+        _cleanup_sd_strv_free_ char **buf = NULL;
         JsonVariant *reply;
         int r;
 
@@ -1393,7 +1393,7 @@ static int dump_lldp_neighbors(Varlink *
                         if (r < 0)
                                 return r;
 
-                        r = strv_extendf(&buf, "%s%s%s%s on port %s%s%s%s",
+                        r = sd_sd_strv_extendf(&buf, "%s%s%s%s on port %s%s%s%s",
                                          strna(neighbor_info.system_name),
                                          isempty(neighbor_info.system_description) ? "" : " (",
                                          strempty(neighbor_info.system_description),
@@ -1411,7 +1411,7 @@ static int dump_lldp_neighbors(Varlink *
 }
 
 static int dump_dhcp_leases(Table *table, const char *prefix, sd_bus *bus, const LinkInfo *link) {
-        _cleanup_strv_free_ char **buf = NULL;
+        _cleanup_sd_strv_free_ char **buf = NULL;
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
         int r;
@@ -1473,7 +1473,7 @@ static int dump_dhcp_leases(Table *table
                 if (r < 0)
                         return bus_log_parse_error(r);
 
-                r = strv_extendf(&buf, "%s (to %s)", ip, id);
+                r = sd_sd_strv_extendf(&buf, "%s (to %s)", ip, id);
                 if (r < 0)
                         return log_oom();
 
@@ -1492,8 +1492,8 @@ static int dump_dhcp_leases(Table *table
         if (r < 0)
                 return bus_log_parse_error(r);
 
-        if (strv_isempty(buf)) {
-                r = strv_extendf(&buf, "none");
+        if (sd_strv_isempty(buf)) {
+                r = sd_sd_strv_extendf(&buf, "none");
                 if (r < 0)
                         return log_oom();
         }
@@ -1683,7 +1683,7 @@ static int link_status_one(
                 Varlink *vl,
                 const LinkInfo *info) {
 
-        _cleanup_strv_free_ char **dns = NULL, **ntp = NULL, **sip = NULL, **search_domains = NULL,
+        _cleanup_sd_strv_free_ char **dns = NULL, **ntp = NULL, **sip = NULL, **search_domains = NULL,
                 **route_domains = NULL, **link_dropins = NULL, **network_dropins = NULL;
         _cleanup_free_ char *t = NULL, *network = NULL, *iaid = NULL, *duid = NULL, *captive_portal = NULL,
                 *setup_state = NULL, *operational_state = NULL, *online_state = NULL, *activation_policy = NULL;
@@ -1726,7 +1726,7 @@ static int link_status_one(
                 (void) sd_device_get_property_value(info->sd_device, "ID_NET_LINK_FILE", &link);
 
                 if (sd_device_get_property_value(info->sd_device, "ID_NET_LINK_FILE_DROPINS", &joined) >= 0) {
-                        r = strv_split_full(&link_dropins, joined, ":", EXTRACT_CUNESCAPE);
+                        r = sd_strv_split_full(&link_dropins, joined, ":", EXTRACT_CUNESCAPE);
                         if (r < 0)
                                 return r;
                 }
@@ -2341,7 +2341,7 @@ static int link_status_one(
 
 static int system_status(sd_netlink *rtnl, sd_hwdb *hwdb) {
         _cleanup_free_ char *operational_state = NULL, *online_state = NULL, *netifs_joined = NULL;
-        _cleanup_strv_free_ char **netifs = NULL, **dns = NULL, **ntp = NULL, **search_domains = NULL, **route_domains = NULL;
+        _cleanup_sd_strv_free_ char **netifs = NULL, **dns = NULL, **ntp = NULL, **search_domains = NULL, **route_domains = NULL;
         const char *on_color_operational, *off_color_operational, *on_color_online;
         _cleanup_(table_unrefp) Table *table = NULL;
         int r;
@@ -2365,7 +2365,7 @@ static int system_status(sd_netlink *rtn
         if (r < 0 && r != -ENOENT)
                 return log_error_errno(r, "Failed to list network interfaces: %m");
         else if (r > 0) {
-                netifs_joined = strv_join(netifs, ", ");
+                netifs_joined = sd_strv_join(netifs, ", ");
                 if (!netifs_joined)
                         return log_oom();
         }
@@ -2529,7 +2529,7 @@ static void lldp_capabilities_legend(uin
 static bool interface_match_pattern(const InterfaceInfo *info, char * const *patterns) {
         assert(info);
 
-        if (strv_isempty(patterns))
+        if (sd_strv_isempty(patterns))
                 return true;
 
         if (strv_fnmatch(patterns, info->ifname))
@@ -2553,7 +2553,7 @@ static int dump_lldp_neighbors_json(Json
 
         assert(reply);
 
-        if (strv_isempty(patterns))
+        if (sd_strv_isempty(patterns))
                 return json_variant_dump(reply, arg_json_format_flags, NULL, NULL);
 
         /* Filter and dump the result. */
diff '--color=auto' -Nurp a/src/network/networkd-dhcp-common.c b/src/network/networkd-dhcp-common.c
--- a/src/network/networkd-dhcp-common.c	2025-06-30 18:55:45.359159935 +0000
+++ b/src/network/networkd-dhcp-common.c	2025-06-30 18:36:37.000000000 +0000
@@ -643,7 +643,7 @@ int config_parse_dhcp_user_or_vendor_cla
         assert(IN_SET(ltype, AF_INET, AF_INET6));
 
         if (isempty(rvalue)) {
-                *l = strv_free(*l);
+                *l = sd_strv_free(*l);
                 return 0;
         }
 
@@ -677,7 +677,7 @@ int config_parse_dhcp_user_or_vendor_cla
                         }
                 }
 
-                r = strv_consume(l, TAKE_PTR(w));
+                r = sd_strv_consume(l, TAKE_PTR(w));
                 if (r < 0)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/network/networkd-json.c b/src/network/networkd-json.c
--- a/src/network/networkd-json.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-json.c	2025-06-30 18:37:42.000000000 +0000
@@ -374,7 +374,7 @@ static int network_append_json(Network *
 }
 
 static int device_append_json(sd_device *device, JsonVariant **v) {
-        _cleanup_strv_free_ char **link_dropins = NULL;
+        _cleanup_sd_strv_free_ char **link_dropins = NULL;
         const char *link = NULL, *path = NULL, *vendor = NULL, *model = NULL, *joined;
         int r;
 
@@ -386,7 +386,7 @@ static int device_append_json(sd_device
         (void) sd_device_get_property_value(device, "ID_NET_LINK_FILE", &link);
 
         if (sd_device_get_property_value(device, "ID_NET_LINK_FILE_DROPINS", &joined) >= 0) {
-                 r = strv_split_full(&link_dropins, joined, ":", EXTRACT_CUNESCAPE);
+                 r = sd_strv_split_full(&link_dropins, joined, ":", EXTRACT_CUNESCAPE);
                  if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/network/networkd-link-bus.c b/src/network/networkd-link-bus.c
--- a/src/network/networkd-link-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-link-bus.c	2025-06-30 18:33:49.000000000 +0000
@@ -78,7 +78,7 @@ static int verify_managed_link(Link *l,
 }
 
 int bus_link_method_set_ntp_servers(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **ntp = NULL;
+        _cleanup_sd_strv_free_ char **ntp = NULL;
         Link *l = ASSERT_PTR(userdata);
         int r;
 
@@ -111,7 +111,7 @@ int bus_link_method_set_ntp_servers(sd_b
         if (r == 0)
                 return 1; /* Polkit will call us back */
 
-        strv_free_and_replace(l->ntp, ntp);
+        sd_strv_free_and_replace(l->ntp, ntp);
 
         r = link_save_and_clean_full(l, /* also_save_manager = */ true);
         if (r < 0)
@@ -480,7 +480,7 @@ int bus_link_method_set_dnssec(sd_bus_me
 
 int bus_link_method_set_dnssec_negative_trust_anchors(sd_bus_message *message, void *userdata, sd_bus_error *error) {
         _cleanup_set_free_free_ Set *ns = NULL;
-        _cleanup_strv_free_ char **ntas = NULL;
+        _cleanup_sd_strv_free_ char **ntas = NULL;
         Link *l = ASSERT_PTR(userdata);
         int r;
 
@@ -821,7 +821,7 @@ char *link_bus_path(Link *link) {
 }
 
 int link_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = ASSERT_PTR(userdata);
         unsigned c = 0;
         Link *link;
diff '--color=auto' -Nurp a/src/network/networkd-link.c b/src/network/networkd-link.c
--- a/src/network/networkd-link.c	2025-06-30 18:55:45.363159935 +0000
+++ b/src/network/networkd-link.c	2025-06-30 18:37:55.000000000 +0000
@@ -200,7 +200,7 @@ bool link_is_ready_to_configure(Link *li
 }
 
 void link_ntp_settings_clear(Link *link) {
-        link->ntp = strv_free(link->ntp);
+        link->ntp = sd_strv_free(link->ntp);
 }
 
 void link_dns_settings_clear(Link *link) {
@@ -266,7 +266,7 @@ static Link *link_free(Link *link) {
 
         set_free(link->sr_iov_virt_port_ifindices);
         free(link->ifname);
-        strv_free(link->alternative_names);
+        sd_strv_free(link->alternative_names);
         free(link->kind);
         free(link->ssid);
         free(link->previous_ssid);
@@ -869,7 +869,7 @@ static int link_new_bound_by_list(Link *
                 if (!carrier->network)
                         continue;
 
-                if (strv_isempty(carrier->network->bind_carrier))
+                if (sd_strv_isempty(carrier->network->bind_carrier))
                         continue;
 
                 if (strv_fnmatch(carrier->network->bind_carrier, link->ifname)) {
@@ -899,7 +899,7 @@ static int link_new_bound_to_list(Link *
         if (!link->network)
                 return 0;
 
-        if (strv_isempty(link->network->bind_carrier))
+        if (sd_strv_isempty(link->network->bind_carrier))
                 return 0;
 
         m = link->manager;
@@ -1345,7 +1345,7 @@ int link_reconfigure_impl(Link *link, bo
                 return 0;
 
         if (network) {
-                _cleanup_free_ char *joined = strv_join(network->dropins, ", ");
+                _cleanup_free_ char *joined = sd_strv_join(network->dropins, ", ");
 
                 if (link->state == LINK_STATE_INITIALIZED)
                         log_link_info(link, "Configuring with %s%s%s%s.",
@@ -1916,7 +1916,7 @@ void link_update_operstate(Link *link, b
         LinkCarrierState carrier_state;
         LinkAddressState ipv4_address_state, ipv6_address_state, address_state;
         LinkOnlineState online_state;
-        _cleanup_strv_free_ char **p = NULL;
+        _cleanup_sd_strv_free_ char **p = NULL;
         bool changed = false;
 
         assert(link);
@@ -2006,42 +2006,42 @@ void link_update_operstate(Link *link, b
         if (link->carrier_state != carrier_state) {
                 link->carrier_state = carrier_state;
                 changed = true;
-                if (strv_extend(&p, "CarrierState") < 0)
+                if (sd_strv_extend(&p, "CarrierState") < 0)
                         log_oom();
         }
 
         if (link->address_state != address_state) {
                 link->address_state = address_state;
                 changed = true;
-                if (strv_extend(&p, "AddressState") < 0)
+                if (sd_strv_extend(&p, "AddressState") < 0)
                         log_oom();
         }
 
         if (link->ipv4_address_state != ipv4_address_state) {
                 link->ipv4_address_state = ipv4_address_state;
                 changed = true;
-                if (strv_extend(&p, "IPv4AddressState") < 0)
+                if (sd_strv_extend(&p, "IPv4AddressState") < 0)
                         log_oom();
         }
 
         if (link->ipv6_address_state != ipv6_address_state) {
                 link->ipv6_address_state = ipv6_address_state;
                 changed = true;
-                if (strv_extend(&p, "IPv6AddressState") < 0)
+                if (sd_strv_extend(&p, "IPv6AddressState") < 0)
                         log_oom();
         }
 
         if (link->operstate != operstate) {
                 link->operstate = operstate;
                 changed = true;
-                if (strv_extend(&p, "OperationalState") < 0)
+                if (sd_strv_extend(&p, "OperationalState") < 0)
                         log_oom();
         }
 
         if (link->online_state != online_state) {
                 link->online_state = online_state;
                 changed = true;
-                if (strv_extend(&p, "OnlineState") < 0)
+                if (sd_strv_extend(&p, "OnlineState") < 0)
                         log_oom();
         }
 
@@ -2456,7 +2456,7 @@ static int link_update_mtu(Link *link, s
 }
 
 static int link_update_alternative_names(Link *link, sd_netlink_message *message) {
-        _cleanup_strv_free_ char **altnames = NULL;
+        _cleanup_sd_strv_free_ char **altnames = NULL;
         int r;
 
         assert(link);
@@ -2476,7 +2476,7 @@ static int link_update_alternative_names
         STRV_FOREACH(n, link->alternative_names)
                 hashmap_remove(link->manager->links_by_name, *n);
 
-        strv_free_and_replace(link->alternative_names, altnames);
+        sd_strv_free_and_replace(link->alternative_names, altnames);
 
         STRV_FOREACH(n, link->alternative_names) {
                 r = hashmap_ensure_put(&link->manager->links_by_name, &string_hash_ops, *n, link);
diff '--color=auto' -Nurp a/src/network/networkd-manager.c b/src/network/networkd-manager.c
--- a/src/network/networkd-manager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-manager.c	2025-06-30 18:35:00.000000000 +0000
@@ -222,7 +222,7 @@ static int manager_connect_udev(Manager
 }
 
 static int manager_listen_fds(Manager *m, int *ret_rtnl_fd) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int n, rtnl_fd = -EBADF;
 
         assert(m);
@@ -232,7 +232,7 @@ static int manager_listen_fds(Manager *m
         if (n < 0)
                 return n;
 
-        if (strv_length(names) != (size_t) n)
+        if (sd_strv_length(names) != (size_t) n)
                 return -EINVAL;
 
         for (int i = 0; i < n; i++) {
diff '--color=auto' -Nurp a/src/network/networkd-network-bus.c b/src/network/networkd-network-bus.c
--- a/src/network/networkd-network-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-network-bus.c	2025-06-30 18:36:37.000000000 +0000
@@ -86,7 +86,7 @@ static char *network_bus_path(Network *n
 }
 
 int network_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = ASSERT_PTR(userdata);
         Network *network;
         int r;
@@ -102,7 +102,7 @@ int network_node_enumerator(sd_bus *bus,
                 if (!p)
                         return -ENOMEM;
 
-                r = strv_consume(&l, p);
+                r = sd_strv_consume(&l, p);
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/network/networkd-network.c b/src/network/networkd-network.c
--- a/src/network/networkd-network.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-network.c	2025-06-30 18:37:25.000000000 +0000
@@ -247,7 +247,7 @@ int network_verify(Network *network) {
                         network->keep_configuration = KEEP_CONFIGURATION_NO;
         }
 
-        if (!strv_isempty(network->bind_carrier)) {
+        if (!sd_strv_isempty(network->bind_carrier)) {
                 if (!IN_SET(network->activation_policy, _ACTIVATION_POLICY_INVALID, ACTIVATION_POLICY_BOUND))
                         log_warning("%s: ActivationPolicy=bound is required with BindCarrier=. "
                                     "Setting ActivationPolicy=bound.", network->filename);
@@ -590,7 +590,7 @@ int network_load_one(Manager *manager, O
 }
 
 int network_load(Manager *manager, OrderedHashmap **networks) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(manager);
@@ -690,7 +690,7 @@ static Network *network_free(Network *ne
         free(network->name);
         free(network->filename);
         free(network->description);
-        strv_free(network->dropins);
+        sd_strv_free(network->dropins);
         hashmap_free(network->stats_by_path);
 
         /* conditions */
@@ -698,10 +698,10 @@ static Network *network_free(Network *ne
         condition_free_list(network->conditions);
 
         /* link settings */
-        strv_free(network->bind_carrier);
+        sd_strv_free(network->bind_carrier);
 
         /* NTP */
-        strv_free(network->ntp);
+        sd_strv_free(network->ntp);
 
         /* DNS */
         for (unsigned i = 0; i < network->n_dns; i++)
@@ -730,7 +730,7 @@ static Network *network_free(Network *ne
         free(network->dhcp_label);
         set_free(network->dhcp_deny_listed_ip);
         set_free(network->dhcp_allow_listed_ip);
-        strv_free(network->dhcp_user_class);
+        sd_strv_free(network->dhcp_user_class);
         set_free(network->dhcp_request_options);
         ordered_hashmap_free(network->dhcp_client_send_options);
         ordered_hashmap_free(network->dhcp_client_send_vendor_options);
@@ -740,8 +740,8 @@ static Network *network_free(Network *ne
         /* DHCPv6 client */
         free(network->dhcp6_mudurl);
         free(network->dhcp6_hostname);
-        strv_free(network->dhcp6_user_class);
-        strv_free(network->dhcp6_vendor_class);
+        sd_strv_free(network->dhcp6_user_class);
+        sd_strv_free(network->dhcp6_vendor_class);
         set_free(network->dhcp6_request_options);
         ordered_hashmap_free(network->dhcp6_client_send_options);
         ordered_hashmap_free(network->dhcp6_client_send_vendor_options);
diff '--color=auto' -Nurp a/src/network/networkd-ntp.c b/src/network/networkd-ntp.c
--- a/src/network/networkd-ntp.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-ntp.c	2025-06-30 18:36:37.000000000 +0000
@@ -62,7 +62,7 @@ int config_parse_ntp(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *l = strv_free(*l);
+                *l = sd_strv_free(*l);
                 return 0;
         }
 
@@ -87,14 +87,14 @@ int config_parse_ntp(
                         continue;
                 }
 
-                if (strv_length(*l) > MAX_NTP_SERVERS) {
+                if (sd_strv_length(*l) > MAX_NTP_SERVERS) {
                         log_syntax(unit, LOG_WARNING, filename, line, 0,
                                    "More than %u NTP servers specified, ignoring \"%s\" and any subsequent entries.",
                                    MAX_NTP_SERVERS, w);
                         return 0;
                 }
 
-                r = strv_consume(l, TAKE_PTR(w));
+                r = sd_strv_consume(l, TAKE_PTR(w));
                 if (r < 0)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/network/networkd-state-file.c b/src/network/networkd-state-file.c
--- a/src/network/networkd-state-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/networkd-state-file.c	2025-06-30 18:35:42.000000000 +0000
@@ -278,7 +278,7 @@ int manager_save(Manager *m) {
         LinkOnlineState online_state;
         size_t links_offline = 0, links_online = 0;
         _cleanup_(unlink_and_freep) char *temp_path = NULL;
-        _cleanup_strv_free_ char **p = NULL;
+        _cleanup_sd_strv_free_ char **p = NULL;
         _cleanup_fclose_ FILE *f = NULL;
         Link *link;
         int r;
@@ -388,37 +388,37 @@ int manager_save(Manager *m) {
 
         if (m->operational_state != operstate) {
                 m->operational_state = operstate;
-                if (strv_extend(&p, "OperationalState") < 0)
+                if (sd_strv_extend(&p, "OperationalState") < 0)
                         log_oom();
         }
 
         if (m->carrier_state != carrier_state) {
                 m->carrier_state = carrier_state;
-                if (strv_extend(&p, "CarrierState") < 0)
+                if (sd_strv_extend(&p, "CarrierState") < 0)
                         log_oom();
         }
 
         if (m->address_state != address_state) {
                 m->address_state = address_state;
-                if (strv_extend(&p, "AddressState") < 0)
+                if (sd_strv_extend(&p, "AddressState") < 0)
                         log_oom();
         }
 
         if (m->ipv4_address_state != ipv4_address_state) {
                 m->ipv4_address_state = ipv4_address_state;
-                if (strv_extend(&p, "IPv4AddressState") < 0)
+                if (sd_strv_extend(&p, "IPv4AddressState") < 0)
                         log_oom();
         }
 
         if (m->ipv6_address_state != ipv6_address_state) {
                 m->ipv6_address_state = ipv6_address_state;
-                if (strv_extend(&p, "IPv6AddressState") < 0)
+                if (sd_strv_extend(&p, "IPv6AddressState") < 0)
                         log_oom();
         }
 
         if (m->online_state != online_state) {
                 m->online_state = online_state;
-                if (strv_extend(&p, "OnlineState") < 0)
+                if (sd_strv_extend(&p, "OnlineState") < 0)
                         log_oom();
         }
 
diff '--color=auto' -Nurp a/src/network/test-networkd-conf.c b/src/network/test-networkd-conf.c
--- a/src/network/test-networkd-conf.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/test-networkd-conf.c	2025-06-30 18:33:49.000000000 +0000
@@ -248,7 +248,7 @@ TEST(config_parse_address) {
 }
 
 TEST(config_parse_match_ifnames) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
 
         assert_se(config_parse_match_ifnames("network", "filename", 1, "section", 1, "Name", 0, "!hoge hogehoge foo", &names, NULL) == 0);
         assert_se(config_parse_match_ifnames("network", "filename", 1, "section", 1, "Name", 0, "!baz", &names, NULL) == 0);
@@ -258,7 +258,7 @@ TEST(config_parse_match_ifnames) {
 }
 
 TEST(config_parse_match_strv) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
 
         assert_se(config_parse_match_strv("network", "filename", 1, "section", 1, "Name", 0, "!hoge hogehoge foo", &names, NULL) == 0);
         assert_se(config_parse_match_strv("network", "filename", 1, "section", 1, "Name", 0, "!baz", &names, NULL) == 0);
diff '--color=auto' -Nurp a/src/network/wait-online/link.c b/src/network/wait-online/link.c
--- a/src/network/wait-online/link.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/wait-online/link.c	2025-06-30 18:33:49.000000000 +0000
@@ -64,7 +64,7 @@ Link *link_free(Link *l) {
 
         free(l->state);
         free(l->ifname);
-        strv_free(l->altnames);
+        sd_strv_free(l->altnames);
         return mfree(l);
 }
 
@@ -113,7 +113,7 @@ static int link_update_name(Link *l, sd_
 }
 
 static int link_update_altnames(Link *l, sd_netlink_message *m) {
-        _cleanup_strv_free_ char **altnames = NULL;
+        _cleanup_sd_strv_free_ char **altnames = NULL;
         int r;
 
         assert(l);
@@ -134,7 +134,7 @@ static int link_update_altnames(Link *l,
         STRV_FOREACH(n, l->altnames)
                 hashmap_remove(l->manager->links_by_name, *n);
 
-        strv_free_and_replace(l->altnames, altnames);
+        sd_strv_free_and_replace(l->altnames, altnames);
 
         STRV_FOREACH(n, l->altnames) {
                 r = hashmap_ensure_put(&l->manager->links_by_name, &string_hash_ops, *n, l);
diff '--color=auto' -Nurp a/src/network/wait-online/wait-online.c b/src/network/wait-online/wait-online.c
--- a/src/network/wait-online/wait-online.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/network/wait-online/wait-online.c	2025-06-30 18:35:42.000000000 +0000
@@ -24,7 +24,7 @@ static AddressFamily arg_required_family
 static bool arg_any = false;
 
 STATIC_DESTRUCTOR_REGISTER(arg_interfaces, hashmap_free_free_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_ignore, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_ignore, sd_strv_freep);
 
 static int help(void) {
         _cleanup_free_ char *link = NULL;
@@ -149,7 +149,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_IGNORE:
-                        if (strv_extend(&arg_ignore, optarg) < 0)
+                        if (sd_strv_extend(&arg_ignore, optarg) < 0)
                                 return log_oom();
 
                         break;
diff '--color=auto' -Nurp a/src/notify/notify.c b/src/notify/notify.c
--- a/src/notify/notify.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/notify/notify.c	2025-06-30 18:37:55.000000000 +0000
@@ -39,8 +39,8 @@ static char **arg_exec = NULL;
 static FDSet *arg_fds = NULL;
 static char *arg_fdname = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_env, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_exec, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_env, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_exec, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_fds, fdset_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_fdname, freep);
 
@@ -291,7 +291,7 @@ static int parse_argv(int argc, char *ar
                 if (i+1 == argc)
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Empty command line specified after ';' separator, refusing.");
 
-                arg_exec = strv_copy_n(argv + i + 1, argc - i - 1);
+                arg_exec = sd_strv_copy_n(argv + i + 1, argc - i - 1);
                 if (!arg_exec)
                         return log_oom();
 
@@ -314,7 +314,7 @@ static int parse_argv(int argc, char *ar
                 log_warning("Notify message specified along with --booted, ignoring.");
 
         if (n_arg_env > 0) {
-                arg_env = strv_copy_n(argv + optind, n_arg_env);
+                arg_env = sd_strv_copy_n(argv + optind, n_arg_env);
                 if (!arg_env)
                         return log_oom();
         }
@@ -327,7 +327,7 @@ static int parse_argv(int argc, char *ar
 
 static int run(int argc, char* argv[]) {
         _cleanup_free_ char *status = NULL, *cpid = NULL, *msg = NULL, *monotonic_usec = NULL, *fdn = NULL;
-        _cleanup_strv_free_ char **final_env = NULL;
+        _cleanup_sd_strv_free_ char **final_env = NULL;
         const char *our_env[9];
         size_t i = 0;
         int r;
@@ -395,9 +395,9 @@ static int run(int argc, char* argv[]) {
         final_env = strv_env_merge((char**) our_env, arg_env);
         if (!final_env)
                 return log_oom();
-        assert(!strv_isempty(final_env));
+        assert(!sd_strv_isempty(final_env));
 
-        msg = strv_join(final_env, "\n");
+        msg = sd_strv_join(final_env, "\n");
         if (!msg)
                 return log_oom();
 
@@ -451,7 +451,7 @@ static int run(int argc, char* argv[]) {
         if (arg_exec) {
                 execvp(arg_exec[0], arg_exec);
 
-                _cleanup_free_ char *cmdline = strv_join(arg_exec, " ");
+                _cleanup_free_ char *cmdline = sd_strv_join(arg_exec, " ");
                 return log_error_errno(errno, "Failed to execute command line: %s", strnull(cmdline));
         }
 
diff '--color=auto' -Nurp a/src/nspawn/nspawn-bind-user.c b/src/nspawn/nspawn-bind-user.c
--- a/src/nspawn/nspawn-bind-user.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-bind-user.c	2025-06-30 18:37:25.000000000 +0000
@@ -126,7 +126,7 @@ static int convert_user(
                                         JSON_BUILD_PAIR_CONDITION(u->disposition >= 0, "disposition", JSON_BUILD_STRING(user_disposition_to_string(u->disposition))),
                                         JSON_BUILD_PAIR("homeDirectory", JSON_BUILD_STRING(h)),
                                         JSON_BUILD_PAIR("service", JSON_BUILD_CONST_STRING("io.systemd.NSpawn")),
-                                        JSON_BUILD_PAIR_CONDITION(!strv_isempty(u->hashed_password), "privileged", JSON_BUILD_OBJECT(
+                                        JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(u->hashed_password), "privileged", JSON_BUILD_OBJECT(
                                                                                   JSON_BUILD_PAIR("hashedPassword", JSON_BUILD_VARIANT(hp))))));
         if (r < 0)
                 return log_error_errno(r, "Failed to build container user record: %m");
@@ -213,7 +213,7 @@ int bind_user_prepare(
          * This extends the passed custom_mounts/n_custom_mounts with the home directories, and allocates a
          * new BindUserContext for the user records */
 
-        if (strv_isempty(bind_user)) {
+        if (sd_strv_isempty(bind_user)) {
                 *ret = NULL;
                 return 0;
         }
diff '--color=auto' -Nurp a/src/nspawn/nspawn-mount.c b/src/nspawn/nspawn-mount.c
--- a/src/nspawn/nspawn-mount.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-mount.c	2025-06-30 18:38:15.000000000 +0000
@@ -67,7 +67,7 @@ void custom_mount_free_all(CustomMount *
                         free(m->rm_rf_tmpdir);
                 }
 
-                strv_free(m->lower);
+                sd_strv_free(m->lower);
                 free(m->type_argument);
         }
 
@@ -317,11 +317,11 @@ int tmpfs_mount_parse(CustomMount **l, s
 
 int overlay_mount_parse(CustomMount **l, size_t *n, const char *s, bool read_only) {
         _cleanup_free_ char *upper = NULL, *destination = NULL;
-        _cleanup_strv_free_ char **lower = NULL;
+        _cleanup_sd_strv_free_ char **lower = NULL;
         CustomMount *m;
         int r, k;
 
-        k = strv_split_full(&lower, s, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
+        k = sd_strv_split_full(&lower, s, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
         if (k < 0)
                 return k;
         if (k < 2)
@@ -891,18 +891,18 @@ static int mount_tmpfs(const char *dest,
 }
 
 static char *joined_and_escaped_lower_dirs(char **lower) {
-        _cleanup_strv_free_ char **sv = NULL;
+        _cleanup_sd_strv_free_ char **sv = NULL;
 
-        sv = strv_copy(lower);
+        sv = sd_strv_copy(lower);
         if (!sv)
                 return NULL;
 
-        strv_reverse(sv);
+        sd_strv_reverse(sv);
 
         if (!strv_shell_escape(sv, ",:"))
                 return NULL;
 
-        return strv_join(sv, ":");
+        return sd_strv_join(sv, ":");
 }
 
 static int mount_overlay(const char *dest, CustomMount *m) {
diff '--color=auto' -Nurp a/src/nspawn/nspawn-network.c b/src/nspawn/nspawn-network.c
--- a/src/nspawn/nspawn-network.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-network.c	2025-06-30 18:38:15.000000000 +0000
@@ -228,7 +228,7 @@ int setup_veth_extra(
         assert(machine_name);
         assert(pid > 0);
 
-        if (strv_isempty(pairs))
+        if (sd_strv_isempty(pairs))
                 return 0;
 
         r = sd_netlink_open(&rtnl);
@@ -448,7 +448,7 @@ int resolve_network_interface_names(char
 
         STRV_FOREACH_PAIR(from, to, iface_pairs) {
                 _cleanup_free_ char *name = NULL;
-                _cleanup_strv_free_ char **altnames = NULL;
+                _cleanup_sd_strv_free_ char **altnames = NULL;
 
                 r = rtnl_resolve_ifname_full(&rtnl, _RESOLVE_IFNAME_ALL, *from, &name, &altnames);
                 if (r < 0)
@@ -690,7 +690,7 @@ int move_network_interfaces(int netns_fd
 
         assert(netns_fd >= 0);
 
-        if (strv_isempty(iface_pairs))
+        if (sd_strv_isempty(iface_pairs))
                 return 0;
 
         STRV_FOREACH_PAIR(from, to, iface_pairs) {
@@ -720,7 +720,7 @@ int move_back_network_interfaces(int chi
 
         assert(child_netns_fd >= 0);
 
-        if (strv_isempty(interface_pairs))
+        if (sd_strv_isempty(interface_pairs))
                 return 0;
 
         r = netns_fork_and_wait(child_netns_fd, &parent_netns_fd);
@@ -729,7 +729,7 @@ int move_back_network_interfaces(int chi
         if (r == 0) {
                 /* Reverse network interfaces pair list so that interfaces get their initial name back.
                  * This is about ensuring interfaces get their old name back when being moved back. */
-                interface_pairs = strv_reverse(interface_pairs);
+                interface_pairs = sd_strv_reverse(interface_pairs);
 
                 r = move_network_interfaces(parent_netns_fd, interface_pairs);
                 _exit(r < 0 ? EXIT_FAILURE : EXIT_SUCCESS);
@@ -743,7 +743,7 @@ int setup_macvlan(const char *machine_na
         unsigned idx = 0;
         int r;
 
-        if (strv_isempty(iface_pairs))
+        if (sd_strv_isempty(iface_pairs))
                 return 0;
 
         r = sd_netlink_open(&rtnl);
@@ -857,7 +857,7 @@ int remove_macvlan(int child_netns_fd, c
 
         assert(child_netns_fd >= 0);
 
-        if (strv_isempty(interface_pairs))
+        if (sd_strv_isempty(interface_pairs))
                 return 0;
 
         r = netns_fork_and_wait(child_netns_fd, &parent_netns_fd);
@@ -875,7 +875,7 @@ int setup_ipvlan(const char *machine_nam
         _cleanup_(sd_netlink_unrefp) sd_netlink *rtnl = NULL;
         int r;
 
-        if (strv_isempty(iface_pairs))
+        if (sd_strv_isempty(iface_pairs))
                 return 0;
 
         r = sd_netlink_open(&rtnl);
@@ -966,7 +966,7 @@ int veth_extra_parse(char ***l, const ch
         if (p)
                 return -EINVAL;
 
-        r = strv_push_pair(l, a, b);
+        r = sd_strv_push_pair(l, a, b);
         if (r < 0)
                 return -ENOMEM;
 
@@ -981,7 +981,7 @@ int remove_veth_links(const char *primar
         /* In some cases the kernel might pin the veth links between host and container even after the namespace
          * died. Hence, let's better remove them explicitly too. */
 
-        if (isempty(primary) && strv_isempty(pairs))
+        if (isempty(primary) && sd_strv_isempty(pairs))
                 return 0;
 
         r = sd_netlink_open(&rtnl);
@@ -1036,7 +1036,7 @@ static int network_iface_pair_parse(cons
                 if (!b)
                         return log_oom();
 
-                r = strv_consume_pair(l, TAKE_PTR(a), TAKE_PTR(b));
+                r = sd_strv_consume_pair(l, TAKE_PTR(a), TAKE_PTR(b));
                 if (r < 0)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/nspawn/nspawn-oci.c b/src/nspawn/nspawn-oci.c
--- a/src/nspawn/nspawn-oci.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-oci.c	2025-06-30 18:37:55.000000000 +0000
@@ -156,7 +156,7 @@ static int oci_env(const char *name, Jso
                         return json_log(e, flags, SYNTHETIC_ERRNO(EINVAL),
                                         "Environment assignment not valid: %s", n);
 
-                r = strv_extend(l, n);
+                r = sd_strv_extend(l, n);
                 if (r < 0)
                         return log_oom();
         }
@@ -165,7 +165,7 @@ static int oci_env(const char *name, Jso
 }
 
 static int oci_args(const char *name, JsonVariant *v, JsonDispatchFlags flags, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         char ***value = ASSERT_PTR(userdata);
         int r;
 
@@ -173,7 +173,7 @@ static int oci_args(const char *name, Js
         if (r < 0)
                 return json_log(v, flags, r, "Cannot parse arguments as list of strings: %m");
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return json_log(v, flags, SYNTHETIC_ERRNO(EINVAL),
                                 "Argument list empty, refusing.");
 
@@ -181,7 +181,7 @@ static int oci_args(const char *name, Js
                 return json_log(v, flags, SYNTHETIC_ERRNO(EINVAL),
                                 "Executable name is empty, refusing.");
 
-        return strv_free_and_replace(*value, l);
+        return sd_strv_free_and_replace(*value, l);
 }
 
 static int oci_rlimit_type(const char *name, JsonVariant *v, JsonDispatchFlags flags, void *userdata) {
@@ -518,7 +518,7 @@ static void oci_mount_data_done(oci_moun
         free(data->destination);
         free(data->source);
         free(data->type);
-        strv_free(data->options);
+        sd_strv_free(data->options);
 }
 
 static int oci_mounts(const char *name, JsonVariant *v, JsonDispatchFlags flags, void *userdata) {
@@ -551,7 +551,7 @@ static int oci_mounts(const char *name,
                         continue;
 
                 if (data.options) {
-                        joined_options = strv_join(data.options, ",");
+                        joined_options = sd_strv_join(data.options, ",");
                         if (!joined_options)
                                 return log_oom();
                 }
@@ -1588,7 +1588,7 @@ static int oci_sysctl(const char *name,
                         return json_log(v, flags, SYNTHETIC_ERRNO(EINVAL),
                                         "sysctl key invalid, refusing: %s", k);
 
-                r = strv_extend_many(&s->sysctl, k, m);
+                r = sd_strv_extend_many(&s->sysctl, k, m);
                 if (r < 0)
                         return log_oom();
         }
@@ -1742,7 +1742,7 @@ struct syscall_rule {
 static void syscall_rule_done(struct syscall_rule *rule) {
         assert(rule);
 
-        strv_free(rule->names);
+        sd_strv_free(rule->names);
         free(rule->arguments);
 };
 
@@ -1837,7 +1837,7 @@ static int oci_seccomp_syscalls(const ch
                 if (r < 0)
                         return r;
 
-                if (strv_isempty(rule.names))
+                if (sd_strv_isempty(rule.names))
                         return json_log(e, flags, SYNTHETIC_ERRNO(EINVAL), "System call name list is empty.");
 
                 STRV_FOREACH(i, rule.names) {
@@ -2075,8 +2075,8 @@ static int oci_hooks_array(const char *n
                 r = oci_dispatch(e, table, flags, new_item);
                 if (r < 0) {
                         free(new_item->path);
-                        strv_free(new_item->args);
-                        strv_free(new_item->env);
+                        sd_strv_free(new_item->args);
+                        sd_strv_free(new_item->env);
                         return r;
                 }
 
diff '--color=auto' -Nurp a/src/nspawn/nspawn-seccomp.c b/src/nspawn/nspawn-seccomp.c
--- a/src/nspawn/nspawn-seccomp.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-seccomp.c	2025-06-30 18:33:48.000000000 +0000
@@ -134,7 +134,7 @@ static int add_syscall_filters(
                  */
         };
 
-        _cleanup_strv_free_ char **added = NULL;
+        _cleanup_sd_strv_free_ char **added = NULL;
         int r;
 
         for (size_t i = 0; i < ELEMENTSOF(allow_list); i++) {
diff '--color=auto' -Nurp a/src/nspawn/nspawn-settings.c b/src/nspawn/nspawn-settings.c
--- a/src/nspawn/nspawn-settings.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-settings.c	2025-06-30 18:36:37.000000000 +0000
@@ -102,8 +102,8 @@ static void free_oci_hooks(OciHook *hook
 
         FOREACH_ARRAY(hook, hooks, n) {
                 free(hook->path);
-                strv_free(hook->args);
-                strv_free(hook->env);
+                sd_strv_free(hook->args);
+                sd_strv_free(hook->env);
         }
 
         free(hooks);
@@ -122,23 +122,23 @@ Settings* settings_free(Settings *s) {
         if (!s)
                 return NULL;
 
-        strv_free(s->parameters);
-        strv_free(s->environment);
+        sd_strv_free(s->parameters);
+        sd_strv_free(s->environment);
         free(s->user);
         free(s->pivot_root_new);
         free(s->pivot_root_old);
         free(s->working_directory);
-        strv_free(s->syscall_allow_list);
-        strv_free(s->syscall_deny_list);
+        sd_strv_free(s->syscall_allow_list);
+        sd_strv_free(s->syscall_deny_list);
         rlimit_free_all(s->rlimit);
         free(s->hostname);
         cpu_set_reset(&s->cpu_set);
-        strv_free(s->bind_user);
+        sd_strv_free(s->bind_user);
 
-        strv_free(s->network_interfaces);
-        strv_free(s->network_macvlan);
-        strv_free(s->network_ipvlan);
-        strv_free(s->network_veth_extra);
+        sd_strv_free(s->network_interfaces);
+        sd_strv_free(s->network_macvlan);
+        sd_strv_free(s->network_ipvlan);
+        sd_strv_free(s->network_veth_extra);
         free(s->network_bridge);
         free(s->network_zone);
         expose_port_free_all(s->expose_ports);
@@ -159,7 +159,7 @@ Settings* settings_free(Settings *s) {
         device_node_array_free(s->extra_nodes, s->n_extra_nodes);
         free(s->network_namespace_path);
 
-        strv_free(s->sysctl);
+        sd_strv_free(s->sysctl);
 
 #if HAVE_SECCOMP
         seccomp_release(s->seccomp);
@@ -767,9 +767,9 @@ int config_parse_syscall_filter(
                 }
 
                 if (negative)
-                        r = strv_extend(&settings->syscall_deny_list, word);
+                        r = sd_strv_extend(&settings->syscall_deny_list, word);
                 else
-                        r = strv_extend(&settings->syscall_allow_list, word);
+                        r = sd_strv_extend(&settings->syscall_allow_list, word);
                 if (r < 0)
                         return log_oom();
         }
@@ -986,7 +986,7 @@ int config_parse_bind_user(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *bind_user = strv_free(*bind_user);
+                *bind_user = sd_strv_free(*bind_user);
                 return 0;
         }
 
@@ -1008,7 +1008,7 @@ int config_parse_bind_user(
                         return 0;
                 }
 
-                if (strv_consume(bind_user, TAKE_PTR(word)) < 0)
+                if (sd_strv_consume(bind_user, TAKE_PTR(word)) < 0)
                         return log_oom();
         }
 
diff '--color=auto' -Nurp a/src/nspawn/nspawn-util.c b/src/nspawn/nspawn-util.c
--- a/src/nspawn/nspawn-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nspawn/nspawn-util.c	2025-06-30 18:33:48.000000000 +0000
@@ -29,7 +29,7 @@ int systemd_installation_has_version(con
                        "/usr/lib/systemd/libsystemd-shared-*.so",
                        "/usr/lib64/systemd/libsystemd-shared-*.so") {
 
-                _cleanup_strv_free_ char **names = NULL;
+                _cleanup_sd_strv_free_ char **names = NULL;
                 _cleanup_free_ char *path = NULL;
                 char *c;
 
diff '--color=auto' -Nurp a/src/nspawn/nspawn.c b/src/nspawn/nspawn.c
--- a/src/nspawn/nspawn.c	2025-06-30 18:55:45.267159937 +0000
+++ b/src/nspawn/nspawn.c	2025-06-30 18:37:55.000000000 +0000
@@ -250,29 +250,29 @@ STATIC_DESTRUCTOR_REGISTER(arg_supplemen
 STATIC_DESTRUCTOR_REGISTER(arg_machine, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_hostname, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_slice, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_setenv, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_network_interfaces, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_network_macvlan, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_network_ipvlan, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_network_veth_extra, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_setenv, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_network_interfaces, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_network_macvlan, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_network_ipvlan, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_network_veth_extra, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_network_bridge, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_network_zone, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_network_namespace_path, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_oci_bundle, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_property, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_property, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_property_message, sd_bus_message_unrefp);
-STATIC_DESTRUCTOR_REGISTER(arg_parameters, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_parameters, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_verity_settings, verity_settings_done);
-STATIC_DESTRUCTOR_REGISTER(arg_syscall_allow_list, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_syscall_deny_list, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_syscall_allow_list, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_syscall_deny_list, sd_strv_freep);
 #if HAVE_SECCOMP
 STATIC_DESTRUCTOR_REGISTER(arg_seccomp, seccomp_releasep);
 #endif
 STATIC_DESTRUCTOR_REGISTER(arg_credentials, machine_credential_context_done);
 STATIC_DESTRUCTOR_REGISTER(arg_cpu_set, cpu_set_reset);
-STATIC_DESTRUCTOR_REGISTER(arg_sysctl, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_bind_user, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_sysctl, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_bind_user, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_settings_filename, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_background, freep);
@@ -1221,7 +1221,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_PROPERTY:
-                        if (strv_extend(&arg_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_property, optarg) < 0)
                                 return log_oom();
 
                         break;
@@ -1454,9 +1454,9 @@ static int parse_argv(int argc, char *ar
                                         return log_error_errno(r, "Failed to parse system call filter: %m");
 
                                 if (negative)
-                                        r = strv_extend(&arg_syscall_deny_list, word);
+                                        r = sd_strv_extend(&arg_syscall_deny_list, word);
                                 else
-                                        r = strv_extend(&arg_syscall_allow_list, word);
+                                        r = sd_strv_extend(&arg_syscall_allow_list, word);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -1589,7 +1589,7 @@ static int parse_argv(int argc, char *ar
                         if (!valid_user_group_name(optarg, 0))
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Invalid user name to bind: %s", optarg);
 
-                        if (strv_extend(&arg_bind_user, optarg) < 0)
+                        if (sd_strv_extend(&arg_bind_user, optarg) < 0)
                                 return log_oom();
 
                         arg_settings_mask |= SETTING_BIND_USER;
@@ -1623,8 +1623,8 @@ static int parse_argv(int argc, char *ar
                 }
 
         if (argc > optind) {
-                strv_free(arg_parameters);
-                arg_parameters = strv_copy(argv + optind);
+                sd_strv_free(arg_parameters);
+                arg_parameters = sd_strv_copy(argv + optind);
                 if (!arg_parameters)
                         return log_oom();
 
@@ -1790,7 +1790,7 @@ static int verify_arguments(void) {
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "AmbientCapability= setting is not useful for boot mode.");
         }
 
-        if (arg_userns_mode == USER_NAMESPACE_NO && !strv_isempty(arg_bind_user))
+        if (arg_userns_mode == USER_NAMESPACE_NO && !sd_strv_isempty(arg_bind_user))
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "--bind-user= requires --private-users");
 
         /* Drop duplicate --bind-user= entries */
@@ -3288,7 +3288,7 @@ static int inner_child(
                 NULL
         };
         const char *exec_target;
-        _cleanup_strv_free_ char **env_use = NULL;
+        _cleanup_sd_strv_free_ char **env_use = NULL;
         int r, which_failed;
 
         /* This is the "inner" child process, i.e. the one forked off by the "outer" child process, which is the one
@@ -3617,7 +3617,7 @@ static int inner_child(
 
                 /* Automatically search for the init system */
 
-                m = strv_length(arg_parameters);
+                m = sd_strv_length(arg_parameters);
                 a = newa(char*, m + 2);
                 memcpy_safe(a + 1, arg_parameters, m * sizeof(char*));
                 a[1 + m] = NULL;
@@ -3631,7 +3631,7 @@ static int inner_child(
                 }
 
                 exec_target = "/usr/lib/systemd/systemd, /lib/systemd/systemd, /sbin/init";
-        } else if (!strv_isempty(arg_parameters)) {
+        } else if (!sd_strv_isempty(arg_parameters)) {
                 const char *dollar_path;
 
                 exec_target = arg_parameters[0];
@@ -3834,7 +3834,7 @@ static int outer_child(
                 const char *unix_export_path) {
 
         _cleanup_(bind_user_context_freep) BindUserContext *bind_user_context = NULL;
-        _cleanup_strv_free_ char **os_release_pairs = NULL;
+        _cleanup_sd_strv_free_ char **os_release_pairs = NULL;
         _cleanup_close_ int fd = -EBADF, mntns_fd = -EBADF;
         bool idmap = false;
         const char *p;
@@ -4024,10 +4024,10 @@ static int outer_child(
         if (arg_userns_mode != USER_NAMESPACE_NO &&
             IN_SET(arg_userns_ownership, USER_NAMESPACE_OWNERSHIP_MAP, USER_NAMESPACE_OWNERSHIP_AUTO) &&
             arg_uid_shift != 0) {
-                _cleanup_strv_free_ char **dirs = NULL;
+                _cleanup_sd_strv_free_ char **dirs = NULL;
 
                 if (arg_volatile_mode != VOLATILE_YES) {
-                        r = strv_extend(&dirs, directory);
+                        r = sd_strv_extend(&dirs, directory);
                         if (r < 0)
                                 return log_oom();
                 }
@@ -4038,7 +4038,7 @@ static int outer_child(
                         if (!s)
                                 return log_oom();
 
-                        r = strv_consume(&dirs, s);
+                        r = sd_strv_consume(&dirs, s);
                         if (r < 0)
                                 return log_oom();
                 }
@@ -4513,7 +4513,7 @@ static int nspawn_dispatch_notify_fd(sd_
         struct ucred *ucred;
         ssize_t n;
         pid_t inner_child_pid;
-        _cleanup_strv_free_ char **tags = NULL;
+        _cleanup_sd_strv_free_ char **tags = NULL;
         int r;
 
         assert(userdata);
@@ -4548,12 +4548,12 @@ static int nspawn_dispatch_notify_fd(sd_
         }
 
         buf[n] = 0;
-        tags = strv_split(buf, "\n\r");
+        tags = sd_strv_split(buf, "\n\r");
         if (!tags)
                 return log_oom();
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *joined = strv_join(tags, " ");
+                _cleanup_free_ char *joined = sd_strv_join(tags, " ");
 
                 if (joined) {
                         _cleanup_free_ char *j = cescape(joined);
@@ -4622,7 +4622,7 @@ static int merge_settings(Settings *sett
         if ((arg_settings_mask & SETTING_START_MODE) == 0 &&
             settings->start_mode >= 0) {
                 arg_start_mode = settings->start_mode;
-                strv_free_and_replace(arg_parameters, settings->parameters);
+                sd_strv_free_and_replace(arg_parameters, settings->parameters);
         }
 
         if ((arg_settings_mask & SETTING_EPHEMERAL) == 0 &&
@@ -4650,7 +4650,7 @@ static int merge_settings(Settings *sett
 
         if ((arg_settings_mask & SETTING_ENVIRONMENT) == 0 &&
             settings->environment)
-                strv_free_and_replace(arg_setenv, settings->environment);
+                sd_strv_free_and_replace(arg_setenv, settings->environment);
 
         if ((arg_settings_mask & SETTING_USER) == 0) {
 
@@ -4758,10 +4758,10 @@ static int merge_settings(Settings *sett
                         arg_network_veth = settings_network_veth(settings);
                         arg_private_network = settings_private_network(settings);
 
-                        strv_free_and_replace(arg_network_interfaces, settings->network_interfaces);
-                        strv_free_and_replace(arg_network_macvlan, settings->network_macvlan);
-                        strv_free_and_replace(arg_network_ipvlan, settings->network_ipvlan);
-                        strv_free_and_replace(arg_network_veth_extra, settings->network_veth_extra);
+                        sd_strv_free_and_replace(arg_network_interfaces, settings->network_interfaces);
+                        sd_strv_free_and_replace(arg_network_macvlan, settings->network_macvlan);
+                        sd_strv_free_and_replace(arg_network_ipvlan, settings->network_ipvlan);
+                        sd_strv_free_and_replace(arg_network_veth_extra, settings->network_veth_extra);
 
                         free_and_replace(arg_network_bridge, settings->network_bridge);
                         free_and_replace(arg_network_zone, settings->network_zone);
@@ -4795,8 +4795,8 @@ static int merge_settings(Settings *sett
         }
 
         if ((arg_settings_mask & SETTING_BIND_USER) == 0 &&
-            !strv_isempty(settings->bind_user))
-                strv_free_and_replace(arg_bind_user, settings->bind_user);
+            !sd_strv_isempty(settings->bind_user))
+                sd_strv_free_and_replace(arg_bind_user, settings->bind_user);
 
         if ((arg_settings_mask & SETTING_NOTIFY_READY) == 0 &&
             settings->notify_ready >= 0)
@@ -4804,12 +4804,12 @@ static int merge_settings(Settings *sett
 
         if ((arg_settings_mask & SETTING_SYSCALL_FILTER) == 0) {
 
-                if (!strv_isempty(settings->syscall_allow_list) || !strv_isempty(settings->syscall_deny_list)) {
-                        if (!arg_settings_trusted && !strv_isempty(settings->syscall_allow_list))
+                if (!sd_strv_isempty(settings->syscall_allow_list) || !sd_strv_isempty(settings->syscall_deny_list)) {
+                        if (!arg_settings_trusted && !sd_strv_isempty(settings->syscall_allow_list))
                                 log_warning("Ignoring SystemCallFilter= settings, file %s is not trusted.", path);
                         else {
-                                strv_free_and_replace(arg_syscall_allow_list, settings->syscall_allow_list);
-                                strv_free_and_replace(arg_syscall_deny_list, settings->syscall_deny_list);
+                                sd_strv_free_and_replace(arg_syscall_allow_list, settings->syscall_allow_list);
+                                sd_strv_free_and_replace(arg_syscall_deny_list, settings->syscall_deny_list);
                         }
                 }
 
@@ -5232,7 +5232,7 @@ static int run_container(
                                 return log_error_errno(SYNTHETIC_ERRNO(EIO), "Short write while writing UID shift.");
                 }
 
-                n_bind_user_uid = strv_length(arg_bind_user);
+                n_bind_user_uid = sd_strv_length(arg_bind_user);
                 if (n_bind_user_uid > 0) {
                         /* Right after the UID shift, we'll receive the list of UID mappings for the
                          * --bind-user= logic. Always a quadruplet of payload and host UID + GID. */
diff '--color=auto' -Nurp a/src/nsresourced/nsresourced-manager.c b/src/nsresourced/nsresourced-manager.c
--- a/src/nsresourced/nsresourced-manager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nsresourced/nsresourced-manager.c	2025-06-30 18:33:48.000000000 +0000
@@ -459,7 +459,7 @@ static int manager_make_listen_socket(Ma
 }
 
 static int manager_scan_listen_fds(Manager *m, Set **fdstore_inodes) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int n, r;
 
         assert(m);
diff '--color=auto' -Nurp a/src/nss-systemd/nss-systemd.c b/src/nss-systemd/nss-systemd.c
--- a/src/nss-systemd/nss-systemd.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nss-systemd/nss-systemd.c	2025-06-30 18:37:06.000000000 +0000
@@ -827,7 +827,7 @@ enum nss_status _nss_systemd_getgrent_r(
                                 continue;
                         }
 
-                        members = strv_new(user_name);
+                        members = sd_strv_new(user_name);
                         if (!members) {
                                 UNPROTECT_ERRNO;
                                 *errnop = ENOMEM;
diff '--color=auto' -Nurp a/src/nss-systemd/userdb-glue.c b/src/nss-systemd/userdb-glue.c
--- a/src/nss-systemd/userdb-glue.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/nss-systemd/userdb-glue.c	2025-06-30 18:37:25.000000000 +0000
@@ -146,7 +146,7 @@ int nss_pack_user_record_shadow(
         assert(hr->user_name);
         required = strlen(hr->user_name) + 1;
 
-        assert_se(hashed = strv_isempty(hr->hashed_password) ? PASSWORD_LOCKED_AND_INVALID : hr->hashed_password[0]);
+        assert_se(hashed = sd_strv_isempty(hr->hashed_password) ? PASSWORD_LOCKED_AND_INVALID : hr->hashed_password[0]);
         required += strlen(hashed) + 1;
 
         if (buflen < required)
@@ -281,7 +281,7 @@ enum nss_status userdb_getgrnam(
                 int *errnop) {
 
         _cleanup_(group_record_unrefp) GroupRecord *g = NULL;
-        _cleanup_strv_free_ char **members = NULL;
+        _cleanup_sd_strv_free_ char **members = NULL;
         int r;
 
         assert(gr);
@@ -305,7 +305,7 @@ enum nss_status userdb_getgrnam(
         if (!g) {
                 _unused_ _cleanup_(_nss_systemd_unblockp) bool blocked = false;
 
-                if (strv_isempty(members))
+                if (sd_strv_isempty(members))
                         return NSS_STATUS_NOTFOUND;
 
                 /* Grmbl, so we are supposed to extend a group entry, but the group entry itself is not
@@ -348,7 +348,7 @@ enum nss_status userdb_getgrgid(
 
 
         _cleanup_(group_record_unrefp) GroupRecord *g = NULL;
-        _cleanup_strv_free_ char **members = NULL;
+        _cleanup_sd_strv_free_ char **members = NULL;
         bool from_nss;
         int r;
 
@@ -397,7 +397,7 @@ enum nss_status userdb_getgrgid(
 
         /* If we acquired the record via NSS then there's no reason to respond unless we have to augment the
          * list of members of the group */
-        if (from_nss && strv_isempty(members))
+        if (from_nss && sd_strv_isempty(members))
                 return NSS_STATUS_NOTFOUND;
 
         r = nss_pack_group_record(g, members, gr, buffer, buflen);
@@ -424,7 +424,7 @@ int nss_pack_group_record_shadow(
         assert(hr->group_name);
         required = strlen(hr->group_name) + 1;
 
-        assert_se(hashed = strv_isempty(hr->hashed_password) ? PASSWORD_LOCKED_AND_INVALID : hr->hashed_password[0]);
+        assert_se(hashed = sd_strv_isempty(hr->hashed_password) ? PASSWORD_LOCKED_AND_INVALID : hr->hashed_password[0]);
         required += strlen(hashed) + 1;
 
         if (buflen < required)
diff '--color=auto' -Nurp a/src/partition/repart.c b/src/partition/repart.c
--- a/src/partition/repart.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/partition/repart.c	2025-06-30 18:37:25.000000000 +0000
@@ -176,7 +176,7 @@ static char *arg_generate_crypttab = NUL
 STATIC_DESTRUCTOR_REGISTER(arg_node, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_definitions, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_definitions, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_key, erase_and_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_private_key, EVP_PKEY_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_private_key_source, freep);
@@ -189,7 +189,7 @@ STATIC_DESTRUCTOR_REGISTER(arg_tpm2_pcrl
 STATIC_DESTRUCTOR_REGISTER(arg_filter_partitions, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_defer_partitions, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_copy_from, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_copy_from, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_copy_source, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_make_ddi, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_generate_fstab, freep);
@@ -495,7 +495,7 @@ static Partition* partition_free(Partiti
         free(p->current_label);
         free(p->new_label);
         free(p->definition_path);
-        strv_free(p->drop_in_files);
+        sd_strv_free(p->drop_in_files);
 
         if (p->current_partition)
                 fdisk_unref_partition(p->current_partition);
@@ -509,11 +509,11 @@ static Partition* partition_free(Partiti
         safe_close(p->copy_blocks_fd);
 
         free(p->format);
-        strv_free(p->copy_files);
-        strv_free(p->exclude_files_source);
-        strv_free(p->exclude_files_target);
-        strv_free(p->make_directories);
-        strv_free(p->subvolumes);
+        sd_strv_free(p->copy_files);
+        sd_strv_free(p->exclude_files_source);
+        sd_strv_free(p->exclude_files_target);
+        sd_strv_free(p->make_directories);
+        sd_strv_free(p->subvolumes);
         free(p->verity_match_key);
 
         iovec_done(&p->roothash);
@@ -537,18 +537,18 @@ static void partition_foreignize(Partiti
         /* Reset several parameters set through definition file to make the partition foreign. */
 
         p->definition_path = mfree(p->definition_path);
-        p->drop_in_files = strv_free(p->drop_in_files);
+        p->drop_in_files = sd_strv_free(p->drop_in_files);
 
         p->copy_blocks_path = mfree(p->copy_blocks_path);
         p->copy_blocks_fd = safe_close(p->copy_blocks_fd);
         p->copy_blocks_root = NULL;
 
         p->format = mfree(p->format);
-        p->copy_files = strv_free(p->copy_files);
-        p->exclude_files_source = strv_free(p->exclude_files_source);
-        p->exclude_files_target = strv_free(p->exclude_files_target);
-        p->make_directories = strv_free(p->make_directories);
-        p->subvolumes = strv_free(p->subvolumes);
+        p->copy_files = sd_strv_free(p->copy_files);
+        p->exclude_files_source = sd_strv_free(p->exclude_files_source);
+        p->exclude_files_target = sd_strv_free(p->exclude_files_target);
+        p->make_directories = sd_strv_free(p->make_directories);
+        p->subvolumes = sd_strv_free(p->subvolumes);
         p->verity_match_key = mfree(p->verity_match_key);
 
         p->priority = 0;
@@ -1580,7 +1580,7 @@ static int config_parse_copy_files(
         if (r < 0)
                 return 0;
 
-        r = strv_consume_pair(copy_files, TAKE_PTR(resolved_source), TAKE_PTR(resolved_target));
+        r = sd_strv_consume_pair(copy_files, TAKE_PTR(resolved_source), TAKE_PTR(resolved_target));
         if (r < 0)
                 return log_oom();
 
@@ -1603,7 +1603,7 @@ static int config_parse_exclude_files(
         int r;
 
         if (isempty(rvalue)) {
-                *exclude_files = strv_free(*exclude_files);
+                *exclude_files = sd_strv_free(*exclude_files);
                 return 0;
         }
 
@@ -1618,7 +1618,7 @@ static int config_parse_exclude_files(
         if (r < 0)
                 return 0;
 
-        if (strv_consume(exclude_files, TAKE_PTR(resolved)) < 0)
+        if (sd_strv_consume(exclude_files, TAKE_PTR(resolved)) < 0)
                 return log_oom();
 
         return 0;
@@ -1712,7 +1712,7 @@ static int config_parse_make_dirs(
                 if (r < 0)
                         continue;
 
-                r = strv_consume(sv, TAKE_PTR(d));
+                r = sd_strv_consume(sv, TAKE_PTR(d));
                 if (r < 0)
                         return log_oom();
         }
@@ -2048,18 +2048,18 @@ static int partition_read_definition(Par
                                   "Type= not defined, refusing.");
 
         if ((p->copy_blocks_path || p->copy_blocks_auto) &&
-            (p->format || !strv_isempty(p->copy_files) || !strv_isempty(p->make_directories)))
+            (p->format || !sd_strv_isempty(p->copy_files) || !sd_strv_isempty(p->make_directories)))
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EINVAL),
                                   "Format=/CopyFiles=/MakeDirectories= and CopyBlocks= cannot be combined, refusing.");
 
-        if ((!strv_isempty(p->copy_files) || !strv_isempty(p->make_directories)) && streq_ptr(p->format, "swap"))
+        if ((!sd_strv_isempty(p->copy_files) || !sd_strv_isempty(p->make_directories)) && streq_ptr(p->format, "swap"))
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EINVAL),
                                   "Format=swap and CopyFiles= cannot be combined, refusing.");
 
         if (!p->format) {
                 const char *format = NULL;
 
-                if (!strv_isempty(p->copy_files) || !strv_isempty(p->make_directories) || (p->encrypt != ENCRYPT_OFF && !(p->copy_blocks_path || p->copy_blocks_auto)))
+                if (!sd_strv_isempty(p->copy_files) || !sd_strv_isempty(p->make_directories) || (p->encrypt != ENCRYPT_OFF && !(p->copy_blocks_path || p->copy_blocks_auto)))
                         /* Pick "vfat" as file system for esp and xbootldr partitions, otherwise default to "ext4". */
                         format = IN_SET(p->type.designator, PARTITION_ESP, PARTITION_XBOOTLDR) ? "vfat" : "ext4";
                 else if (p->type.designator == PARTITION_SWAP)
@@ -2080,12 +2080,12 @@ static int partition_read_definition(Par
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EINVAL),
                                   "Minimize=best can only be used with read-only filesystems or Verity=hash.");
 
-        if ((!strv_isempty(p->copy_files) || !strv_isempty(p->make_directories)) && !mkfs_supports_root_option(p->format) && geteuid() != 0)
+        if ((!sd_strv_isempty(p->copy_files) || !sd_strv_isempty(p->make_directories)) && !mkfs_supports_root_option(p->format) && geteuid() != 0)
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EPERM),
                                   "Need to be root to populate %s filesystems with CopyFiles=/MakeDirectories=.",
                                   p->format);
 
-        if (p->format && fstype_is_ro(p->format) && strv_isempty(p->copy_files) && strv_isempty(p->make_directories))
+        if (p->format && fstype_is_ro(p->format) && sd_strv_isempty(p->copy_files) && sd_strv_isempty(p->make_directories))
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EINVAL),
                                   "Cannot format %s filesystem without source files, refusing.", p->format);
 
@@ -2128,7 +2128,7 @@ static int partition_read_definition(Par
                                   "SizeMinBytes=/SizeMaxBytes= cannot be used with Verity=%s.",
                                   verity_mode_to_string(p->verity));
 
-        if (!strv_isempty(p->subvolumes) && arg_offline > 0)
+        if (!sd_strv_isempty(p->subvolumes) && arg_offline > 0)
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EOPNOTSUPP),
                                   "Subvolumes= cannot be used with --offline=yes.");
 
@@ -2443,7 +2443,7 @@ static int context_copy_from(Context *co
 }
 
 static int context_read_definitions(Context *context) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         Partition *last = LIST_FIND_TAIL(partitions, context->partitions);
         const char *const *dirs;
         int r;
@@ -3168,7 +3168,7 @@ static int context_dump_partitions(Conte
                         return table_log_add_error(r);
 
                 has_roothash = has_roothash || !isempty(rh);
-                has_dropin_files = has_dropin_files || !strv_isempty(p->drop_in_files);
+                has_dropin_files = has_dropin_files || !sd_strv_isempty(p->drop_in_files);
                 has_split_path = has_split_path || !isempty(p->split_path);
         }
 
@@ -3865,7 +3865,7 @@ static int prepare_temporary_file(Partit
 
 static bool loop_device_error_is_fatal(const Partition *p, int r) {
         assert(p);
-        return arg_offline == 0 || (r != -ENOENT && !ERRNO_IS_PRIVILEGE(r)) || !strv_isempty(p->subvolumes) || p->default_subvolume;
+        return arg_offline == 0 || (r != -ENOENT && !ERRNO_IS_PRIVILEGE(r)) || !sd_strv_isempty(p->subvolumes) || p->default_subvolume;
 }
 
 static int partition_target_prepare(
@@ -5118,7 +5118,7 @@ static int set_default_subvolume(Partiti
 
 static bool partition_needs_populate(Partition *p) {
         assert(p);
-        return !strv_isempty(p->copy_files) || !strv_isempty(p->make_directories);
+        return !sd_strv_isempty(p->copy_files) || !sd_strv_isempty(p->make_directories);
 }
 
 static int partition_populate_directory(Context *context, Partition *p, char **ret) {
@@ -5216,7 +5216,7 @@ static int context_mkfs(Context *context
         LIST_FOREACH(partitions, p, context->partitions) {
                 _cleanup_(rm_rf_physical_and_freep) char *root = NULL;
                 _cleanup_(partition_target_freep) PartitionTarget *t = NULL;
-                _cleanup_strv_free_ char **extra_mkfs_options = NULL;
+                _cleanup_sd_strv_free_ char **extra_mkfs_options = NULL;
 
                 if (p->dropped)
                         continue;
@@ -6786,7 +6786,7 @@ static int context_minimize(Context *con
                 _cleanup_(rm_rf_physical_and_freep) char *root = NULL;
                 _cleanup_(unlink_and_freep) char *temp = NULL;
                 _cleanup_(loop_device_unrefp) LoopDevice *d = NULL;
-                _cleanup_strv_free_ char **extra_mkfs_options = NULL;
+                _cleanup_sd_strv_free_ char **extra_mkfs_options = NULL;
                 _cleanup_close_ int fd = -EBADF;
                 _cleanup_free_ char *hint = NULL;
                 sd_id128_t fs_uuid;
@@ -6948,7 +6948,7 @@ static int context_minimize(Context *con
 
                 if (arg_offline <= 0) {
                         r = loop_device_make(fd, O_RDWR, 0, UINT64_MAX, context->sector_size, 0, LOCK_EX, &d);
-                        if (r < 0 && (arg_offline == 0 || (r != -ENOENT && !ERRNO_IS_PRIVILEGE(r)) || !strv_isempty(p->subvolumes)))
+                        if (r < 0 && (arg_offline == 0 || (r != -ENOENT && !ERRNO_IS_PRIVILEGE(r)) || !sd_strv_isempty(p->subvolumes)))
                                 return log_error_errno(r, "Failed to make loopback device of %s: %m", temp);
                 }
 
@@ -7368,7 +7368,7 @@ static int parse_argv(int argc, char *ar
                         r = parse_path_argument(optarg, false, &path);
                         if (r < 0)
                                 return r;
-                        if (strv_consume(&arg_definitions, TAKE_PTR(path)) < 0)
+                        if (sd_strv_consume(&arg_definitions, TAKE_PTR(path)) < 0)
                                 return log_oom();
                         break;
                 }
@@ -7600,7 +7600,7 @@ static int parse_argv(int argc, char *ar
                         if (r < 0)
                                 return r;
 
-                        if (strv_consume(&arg_copy_from, TAKE_PTR(p)) < 0)
+                        if (sd_strv_consume(&arg_copy_from, TAKE_PTR(p)) < 0)
                                 return log_oom();
 
                         break;
@@ -8325,7 +8325,7 @@ static int run(int argc, char *argv[]) {
                 if (r < 0)
                         return log_error_errno(r, "DDI type '%s' is not defined: %m", arg_make_ddi);
 
-                if (strv_consume(&arg_definitions, TAKE_PTR(dp)) < 0)
+                if (sd_strv_consume(&arg_definitions, TAKE_PTR(dp)) < 0)
                         return log_oom();
         } else
                 strv_uniq(arg_definitions);
diff '--color=auto' -Nurp a/src/pcrextend/pcrextend.c b/src/pcrextend/pcrextend.c
--- a/src/pcrextend/pcrextend.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/pcrextend/pcrextend.c	2025-06-30 18:37:55.000000000 +0000
@@ -27,7 +27,7 @@ static bool arg_machine_id = false;
 static unsigned arg_pcr_index = UINT_MAX;
 static bool arg_varlink = false;
 
-STATIC_DESTRUCTOR_REGISTER(arg_banks, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_banks, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_tpm2_device, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_file_system, freep);
 
@@ -110,7 +110,7 @@ static int parse_argv(int argc, char *ar
                         if (!implementation)
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Unknown bank '%s', refusing.", optarg);
 
-                        if (strv_extend(&arg_banks, EVP_MD_name(implementation)) < 0)
+                        if (sd_strv_extend(&arg_banks, EVP_MD_name(implementation)) < 0)
                                 return log_oom();
 
                         break;
@@ -179,19 +179,19 @@ static int parse_argv(int argc, char *ar
 }
 
 static int determine_banks(Tpm2Context *c, unsigned target_pcr_nr) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(c);
 
-        if (!strv_isempty(arg_banks)) /* Explicitly configured? Then use that */
+        if (!sd_strv_isempty(arg_banks)) /* Explicitly configured? Then use that */
                 return 0;
 
         r = tpm2_get_good_pcr_banks_strv(c, UINT32_C(1) << target_pcr_nr, &l);
         if (r < 0)
                 return log_error_errno(r, "Could not verify pcr banks: %m");
 
-        strv_free_and_replace(arg_banks, l);
+        sd_strv_free_and_replace(arg_banks, l);
         return 0;
 }
 
@@ -206,11 +206,11 @@ static int extend_now(unsigned pcr, cons
         r = determine_banks(c, pcr);
         if (r < 0)
                 return r;
-        if (strv_isempty(arg_banks)) /* Still none? */
+        if (sd_strv_isempty(arg_banks)) /* Still none? */
                 return log_error_errno(SYNTHETIC_ERRNO(ENOENT), "Found a TPM2 without enabled PCR banks. Can't operate.");
 
         _cleanup_free_ char *joined_banks = NULL;
-        joined_banks = strv_join(arg_banks, ", ");
+        joined_banks = sd_strv_join(arg_banks, ", ");
         if (!joined_banks)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/pcrlock/pcrlock.c b/src/pcrlock/pcrlock.c
--- a/src/pcrlock/pcrlock.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/pcrlock/pcrlock.c	2025-06-30 18:36:37.000000000 +0000
@@ -78,7 +78,7 @@ static BootEntryTokenType arg_entry_toke
 static char *arg_entry_token = NULL;
 static bool arg_varlink = false;
 
-STATIC_DESTRUCTOR_REGISTER(arg_components, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_components, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_pcrlock_path, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_location_start, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_location_end, freep);
@@ -1727,7 +1727,7 @@ static int event_log_add_component_file(
 
 static int event_log_add_component_dir(EventLog *el, const char *path, char **base_search) {
         _cleanup_free_ char *fname = NULL, *id = NULL;
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         EventLogComponent *component;
         const char *e;
         int r;
@@ -1750,7 +1750,7 @@ static int event_log_add_component_dir(E
         if (r < 0)
                 return r;
 
-        _cleanup_strv_free_ char **search = NULL;
+        _cleanup_sd_strv_free_ char **search = NULL;
 
         STRV_FOREACH(b, base_search) {
                 _cleanup_free_ char *q = NULL;
@@ -1759,7 +1759,7 @@ static int event_log_add_component_dir(E
                 if (!q)
                         return log_oom();
 
-                r = strv_consume(&search, TAKE_PTR(q));
+                r = sd_strv_consume(&search, TAKE_PTR(q));
                 if (r < 0)
                         return log_oom();
         }
@@ -1778,7 +1778,7 @@ static int event_log_add_component_dir(E
 }
 
 static int event_log_load_components(EventLog *el) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         char **dirs;
         int r;
 
@@ -4549,7 +4549,7 @@ static int make_policy(bool force, Recov
                 if (r < 0)
                         return log_error_errno(r, "Failed to acquire PIN from environment: %m");
                 if (r == 0) {
-                        _cleanup_(strv_free_erasep) char **l = NULL;
+                        _cleanup_(sd_strv_free_erasep) char **l = NULL;
 
                         AskPasswordRequest req = {
                                 .message = "Recovery PIN",
@@ -4565,7 +4565,7 @@ static int make_policy(bool force, Recov
                         if (r < 0)
                                 return log_error_errno(r, "Failed to query for recovery PIN: %m");
 
-                        if (strv_length(l) != 1)
+                        if (sd_strv_length(l) != 1)
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Expected a single PIN only.");
 
                         pin = TAKE_PTR(l[0]);
@@ -5104,7 +5104,7 @@ static int parse_argv(int argc, char *ar
                         if (r < 0)
                                 return r;
 
-                        r = strv_consume(&arg_components, TAKE_PTR(p));
+                        r = sd_strv_consume(&arg_components, TAKE_PTR(p));
                         if (r < 0)
                                 return log_oom();
 
diff '--color=auto' -Nurp a/src/portable/portable.c b/src/portable/portable.c
--- a/src/portable/portable.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/portable/portable.c	2025-06-30 18:37:55.000000000 +0000
@@ -72,7 +72,7 @@ static bool unit_match(const char *unit,
                 return false;
 
         /* Empty match expression means: everything */
-        if (strv_isempty(matches))
+        if (sd_strv_isempty(matches))
                 return true;
 
         /* Otherwise, at least one needs to match */
@@ -567,7 +567,7 @@ static int extract_image_and_extensions(
         _cleanup_ordered_hashmap_free_ OrderedHashmap *extension_images = NULL, *extension_releases = NULL;
         _cleanup_(pick_result_done) PickResult result = PICK_RESULT_NULL;
         _cleanup_hashmap_free_ Hashmap *unit_files = NULL;
-        _cleanup_strv_free_ char **valid_prefixes = NULL;
+        _cleanup_sd_strv_free_ char **valid_prefixes = NULL;
         _cleanup_(image_unrefp) Image *image = NULL;
         Image *ext;
         int r;
@@ -598,7 +598,7 @@ static int extract_image_and_extensions(
         if (r < 0)
                 return r;
 
-        if (!strv_isempty(extension_image_paths)) {
+        if (!sd_strv_isempty(extension_image_paths)) {
                 extension_images = ordered_hashmap_new(&image_hash_ops);
                 if (!extension_images)
                         return -ENOMEM;
@@ -673,7 +673,7 @@ static int extract_image_and_extensions(
                         return sd_bus_error_set_errnof(error, ESTALE, "Image %s os-release metadata lacks the ID field", name_or_path);
 
                 if (prefixes) {
-                        valid_prefixes = strv_split(prefixes, WHITESPACE);
+                        valid_prefixes = sd_strv_split(prefixes, WHITESPACE);
                         if (!valid_prefixes)
                                 return -ENOMEM;
                 }
@@ -682,7 +682,7 @@ static int extract_image_and_extensions(
         ORDERED_HASHMAP_FOREACH(ext, extension_images) {
                 _cleanup_(portable_metadata_unrefp) PortableMetadata *extension_release_meta = NULL;
                 _cleanup_hashmap_free_ Hashmap *extra_unit_files = NULL;
-                _cleanup_strv_free_ char **extension_release = NULL;
+                _cleanup_sd_strv_free_ char **extension_release = NULL;
                 const char *e;
 
                 r = portable_extract_by_path(
@@ -721,13 +721,13 @@ static int extract_image_and_extensions(
 
                 e = strv_env_pairs_get(extension_release, "PORTABLE_PREFIXES");
                 if (e) {
-                        _cleanup_strv_free_ char **l = NULL;
+                        _cleanup_sd_strv_free_ char **l = NULL;
 
-                        l = strv_split(e, WHITESPACE);
+                        l = sd_strv_split(e, WHITESPACE);
                         if (!l)
                                 return -ENOMEM;
 
-                        r = strv_extend_strv(&valid_prefixes, l, true);
+                        r = sd_sd_strv_extend_strv(&valid_prefixes, l, true);
                         if (r < 0)
                                 return r;
                 }
@@ -773,7 +773,7 @@ int portable_extract(
         _cleanup_(portable_metadata_unrefp) PortableMetadata *os_release = NULL;
         _cleanup_ordered_hashmap_free_ OrderedHashmap *extension_images = NULL, *extension_releases = NULL;
         _cleanup_hashmap_free_ Hashmap *unit_files = NULL;
-        _cleanup_strv_free_ char **valid_prefixes = NULL;
+        _cleanup_sd_strv_free_ char **valid_prefixes = NULL;
         _cleanup_(image_unrefp) Image *image = NULL;
         int r;
 
@@ -797,7 +797,7 @@ int portable_extract(
                 return r;
 
         if (hashmap_isempty(unit_files)) {
-                _cleanup_free_ char *extensions = strv_join(extension_image_paths, ", ");
+                _cleanup_free_ char *extensions = sd_strv_join(extension_image_paths, ", ");
                 if (!extensions)
                         return -ENOMEM;
 
@@ -1052,13 +1052,13 @@ static int append_release_log_fields(
                  [IMAGE_SYSEXT] = { "SYSEXT_IMAGE_ID", "SYSEXT_ID", NULL },
                  [IMAGE_CONFEXT] = { "CONFEXT_IMAGE_ID", "CONFEXT_ID", NULL },
         };
-        _cleanup_strv_free_ char **fields = NULL;
+        _cleanup_sd_strv_free_ char **fields = NULL;
         const char *id = NULL, *version = NULL;
         int r;
 
         assert(IN_SET(type, IMAGE_PORTABLE, IMAGE_SYSEXT, IMAGE_CONFEXT));
-        assert(!strv_isempty((char *const *)field_ids[type]));
-        assert(!strv_isempty((char *const *)field_versions[type]));
+        assert(!sd_strv_isempty((char *const *)field_ids[type]));
+        assert(!sd_strv_isempty((char *const *)field_versions[type]));
         assert(field_name);
         assert(text);
 
@@ -1537,7 +1537,7 @@ static void log_portable_verb(
                 PortableFlags flags) {
 
         _cleanup_free_ char *root_base_name = NULL, *extensions_joined = NULL;
-        _cleanup_strv_free_ char **extension_base_names = NULL;
+        _cleanup_sd_strv_free_ char **extension_base_names = NULL;
         Image *ext;
         int r;
 
@@ -1562,7 +1562,7 @@ static void log_portable_verb(
                         continue;
                 }
 
-                r = strv_extendf(&extension_base_names, "PORTABLE_EXTENSION=%s", extension_base_name);
+                r = sd_sd_strv_extendf(&extension_base_names, "PORTABLE_EXTENSION=%s", extension_base_name);
                 if (r < 0)
                         log_oom_debug();
 
@@ -1579,7 +1579,7 @@ static void log_portable_verb(
                         continue;
                 }
 
-                r = strv_extendf(&extension_base_names, "PORTABLE_EXTENSION=%s", extension_base_name);
+                r = sd_sd_strv_extendf(&extension_base_names, "PORTABLE_EXTENSION=%s", extension_base_name);
                 if (r < 0)
                         log_oom_debug();
 
@@ -1618,7 +1618,7 @@ int portable_attach(
         _cleanup_(portable_metadata_unrefp) PortableMetadata *os_release = NULL;
         _cleanup_hashmap_free_ Hashmap *unit_files = NULL;
         _cleanup_(lookup_paths_done) LookupPaths paths = {};
-        _cleanup_strv_free_ char **valid_prefixes = NULL;
+        _cleanup_sd_strv_free_ char **valid_prefixes = NULL;
         _cleanup_(image_unrefp) Image *image = NULL;
         PortableMetadata *item;
         int r;
@@ -1643,15 +1643,15 @@ int portable_attach(
         if (valid_prefixes && !prefix_matches_compatible(matches, valid_prefixes)) {
                 _cleanup_free_ char *matches_joined = NULL, *extensions_joined = NULL, *valid_prefixes_joined = NULL;
 
-                matches_joined = strv_join(matches, "', '");
+                matches_joined = sd_strv_join(matches, "', '");
                 if (!matches_joined)
                         return -ENOMEM;
 
-                extensions_joined = strv_join(extension_image_paths, ", ");
+                extensions_joined = sd_strv_join(extension_image_paths, ", ");
                 if (!extensions_joined)
                         return -ENOMEM;
 
-                valid_prefixes_joined = strv_join(valid_prefixes, ", ");
+                valid_prefixes_joined = sd_strv_join(valid_prefixes, ", ");
                 if (!valid_prefixes_joined)
                         return -ENOMEM;
 
@@ -1667,7 +1667,7 @@ int portable_attach(
         }
 
         if (hashmap_isempty(unit_files)) {
-                _cleanup_free_ char *extensions_joined = strv_join(extension_image_paths, ", ");
+                _cleanup_free_ char *extensions_joined = sd_strv_join(extension_image_paths, ", ");
                 if (!extensions_joined)
                         return -ENOMEM;
 
@@ -1723,7 +1723,7 @@ int portable_attach(
 }
 
 static bool marker_matches_images(const char *marker, const char *name_or_path, char **extension_image_paths, bool match_all) {
-        _cleanup_strv_free_ char **root_and_extensions = NULL;
+        _cleanup_sd_strv_free_ char **root_and_extensions = NULL;
         int r;
 
         assert(marker);
@@ -1737,11 +1737,11 @@ static bool marker_matches_images(const
          * If a partial match is allowed, then return immediately once it is found, otherwise
          * ensure that everything matches. */
 
-        root_and_extensions = strv_new(name_or_path);
+        root_and_extensions = sd_strv_new(name_or_path);
         if (!root_and_extensions)
                 return -ENOMEM;
 
-        r = strv_extend_strv(&root_and_extensions, extension_image_paths, false);
+        r = sd_sd_strv_extend_strv(&root_and_extensions, extension_image_paths, false);
         if (r < 0)
                 return r;
 
@@ -2025,7 +2025,7 @@ int portable_detach(
         return ret;
 
 not_found:
-        extensions = strv_join(extension_image_paths, ", ");
+        extensions = sd_strv_join(extension_image_paths, ", ");
         if (!extensions)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/portable/portablectl.c b/src/portable/portablectl.c
--- a/src/portable/portablectl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/portable/portablectl.c	2025-06-30 18:37:55.000000000 +0000
@@ -52,7 +52,7 @@ static char **arg_extension_images = NUL
 static bool arg_force = false;
 static bool arg_clean = false;
 
-STATIC_DESTRUCTOR_REGISTER(arg_extension_images, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_extension_images, sd_strv_freep);
 
 static bool is_portable_managed(const char *unit) {
         return ENDSWITH_SET(unit, ".service", ".target", ".socket", ".path", ".timer");
@@ -99,7 +99,7 @@ static int attach_extensions_to_message(
         assert(method);
 
         /* The new methods also have flags parameters that are independent of the extensions */
-        if (strv_isempty(extensions) && !endswith(method, "WithExtensions"))
+        if (sd_strv_isempty(extensions) && !endswith(method, "WithExtensions"))
                 return 0;
 
         r = sd_bus_message_open_container(m, 'a', "s");
@@ -168,14 +168,14 @@ static int extract_prefix(const char *pa
 }
 
 static int determine_matches(const char *image, char **l, bool allow_any, char ***ret) {
-        _cleanup_strv_free_ char **k = NULL;
+        _cleanup_sd_strv_free_ char **k = NULL;
         int r;
 
         /* Determine the matches to apply. If the list is empty we derive the match from the image name. If the list
          * contains exactly the "-" we return a wildcard list (which is the empty list), but only if this is expressly
          * permitted. */
 
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 char *prefix;
 
                 r = extract_prefix(image, &prefix);
@@ -185,7 +185,7 @@ static int determine_matches(const char
                 if (!arg_quiet)
                         log_info("(Matching unit files with prefix '%s'.)", prefix);
 
-                r = strv_consume(&k, prefix);
+                r = sd_strv_consume(&k, prefix);
                 if (r < 0)
                         return log_oom();
 
@@ -199,14 +199,14 @@ static int determine_matches(const char
                         log_info("(Matching all unit files.)");
         } else {
 
-                k = strv_copy(l);
+                k = sd_strv_copy(l);
                 if (!k)
                         return log_oom();
 
                 if (!arg_quiet) {
                         _cleanup_free_ char *joined = NULL;
 
-                        joined = strv_join(k, "', '");
+                        joined = sd_strv_join(k, "', '");
                         if (!joined)
                                 return log_oom();
 
@@ -259,7 +259,7 @@ static int get_image_metadata(sd_bus *bu
         assert(bus);
         assert(reply);
 
-        method = strv_isempty(arg_extension_images) && !arg_force ? "GetImageMetadata" : "GetImageMetadataWithExtensions";
+        method = sd_strv_isempty(arg_extension_images) && !arg_force ? "GetImageMetadata" : "GetImageMetadataWithExtensions";
 
         r = bus_message_new_method_call(bus, &m, bus_portable_mgr, method);
         if (r < 0)
@@ -293,7 +293,7 @@ static int get_image_metadata(sd_bus *bu
 static int inspect_image(int argc, char *argv[], void *userdata) {
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **matches = NULL;
+        _cleanup_sd_strv_free_ char **matches = NULL;
         _cleanup_free_ char *image = NULL;
         bool nl = false, header = false;
         const char *path;
@@ -354,7 +354,7 @@ static int inspect_image(int argc, char
                        strna(pretty_os));
         }
 
-        if (!strv_isempty(arg_extension_images)) {
+        if (!sd_strv_isempty(arg_extension_images)) {
                 /* If we specified any extensions, we'll first get back exactly the paths (and
                  * extension-release content) for each one of the arguments. */
 
@@ -362,7 +362,7 @@ static int inspect_image(int argc, char
                 if (r < 0)
                         return bus_log_parse_error(r);
 
-                for (size_t i = 0; i < strv_length(arg_extension_images); ++i) {
+                for (size_t i = 0; i < sd_strv_length(arg_extension_images); ++i) {
                         const char *name;
 
                         r = sd_bus_message_enter_container(reply, 'e', "say");
@@ -559,14 +559,14 @@ static int print_changes(sd_bus_message
 static int maybe_enable_disable(sd_bus *bus, const char *path, bool enable) {
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *m = NULL, *reply = NULL;
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         const uint64_t flags = UNIT_FILE_PORTABLE | (arg_runtime ? UNIT_FILE_RUNTIME : 0);
         int r;
 
         if (!arg_enable)
                 return 0;
 
-        names = strv_new(path, NULL);
+        names = sd_strv_new(path, NULL);
         if (!names)
                 return log_oom();
 
@@ -809,7 +809,7 @@ static int maybe_clean_units(sd_bus *bus
 static int maybe_stop_disable_clean(sd_bus *bus, char *image, char *argv[]) {
         _cleanup_(bus_wait_for_jobs_freep) BusWaitForJobs *wait = NULL;
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
-        _cleanup_strv_free_ char **matches = NULL, **units = NULL;
+        _cleanup_sd_strv_free_ char **matches = NULL, **units = NULL;
         int r;
 
         if (!arg_enable && !arg_now && !arg_clean)
@@ -833,7 +833,7 @@ static int maybe_stop_disable_clean(sd_b
 
         /* If we specified any extensions or --force (which makes the request go through the new
          * WithExtensions calls), we'll first get an array of extension-release metadata. */
-        if (!strv_isempty(arg_extension_images) || arg_force) {
+        if (!sd_strv_isempty(arg_extension_images) || arg_force) {
                 r = sd_bus_message_skip(reply, "a{say}");
                 if (r < 0)
                         return bus_log_parse_error(r);
@@ -867,7 +867,7 @@ static int maybe_stop_disable_clean(sd_b
                 (void) maybe_start_stop_restart(bus, name, "StopUnit", wait);
                 (void) maybe_enable_disable(bus, name, false);
 
-                r = strv_extend(&units, name);
+                r = sd_strv_extend(&units, name);
                 if (r < 0)
                         return log_oom();
         }
@@ -891,7 +891,7 @@ static int attach_reattach_image(int arg
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *m = NULL, *reply = NULL;
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **matches = NULL;
+        _cleanup_sd_strv_free_ char **matches = NULL;
         _cleanup_free_ char *image = NULL;
         int r;
 
@@ -961,11 +961,11 @@ static int attach_reattach_image(int arg
 }
 
 static int attach_image(int argc, char *argv[], void *userdata) {
-        return attach_reattach_image(argc, argv, strv_isempty(arg_extension_images) && !arg_force ? "AttachImage" : "AttachImageWithExtensions");
+        return attach_reattach_image(argc, argv, sd_strv_isempty(arg_extension_images) && !arg_force ? "AttachImage" : "AttachImageWithExtensions");
 }
 
 static int reattach_image(int argc, char *argv[], void *userdata) {
-        return attach_reattach_image(argc, argv, strv_isempty(arg_extension_images) && !arg_force ? "ReattachImage" : "ReattachImageWithExtensions");
+        return attach_reattach_image(argc, argv, sd_strv_isempty(arg_extension_images) && !arg_force ? "ReattachImage" : "ReattachImageWithExtensions");
 }
 
 static int detach_image(int argc, char *argv[], void *userdata) {
@@ -988,7 +988,7 @@ static int detach_image(int argc, char *
 
         (void) maybe_stop_disable_clean(bus, image, argv);
 
-        method = strv_isempty(arg_extension_images) && !arg_force ? "DetachImage" : "DetachImageWithExtensions";
+        method = sd_strv_isempty(arg_extension_images) && !arg_force ? "DetachImage" : "DetachImageWithExtensions";
 
         r = bus_message_new_method_call(bus, &m, bus_portable_mgr, method);
         if (r < 0)
@@ -1200,7 +1200,7 @@ static int is_image_attached(int argc, c
         if (r < 0)
                 return r;
 
-        method = strv_isempty(arg_extension_images) ? "GetImageState" : "GetImageStateWithExtensions";
+        method = sd_strv_isempty(arg_extension_images) ? "GetImageState" : "GetImageStateWithExtensions";
 
         r = bus_message_new_method_call(bus, &m, bus_portable_mgr, method);
         if (r < 0)
@@ -1214,7 +1214,7 @@ static int is_image_attached(int argc, c
         if (r < 0)
                 return r;
 
-        if (!strv_isempty(arg_extension_images)) {
+        if (!sd_strv_isempty(arg_extension_images)) {
                 r = sd_bus_message_append(m, "t", UINT64_C(0));
                 if (r < 0)
                         return bus_log_create_error(r);
@@ -1237,7 +1237,7 @@ static int is_image_attached(int argc, c
 static int dump_profiles(void) {
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         r = acquire_bus(&bus);
@@ -1461,7 +1461,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_EXTENSION:
-                        r = strv_extend(&arg_extension_images, optarg);
+                        r = sd_strv_extend(&arg_extension_images, optarg);
                         if (r < 0)
                                 return log_oom();
                         break;
diff '--color=auto' -Nurp a/src/portable/portabled-bus.c b/src/portable/portabled-bus.c
--- a/src/portable/portabled-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/portable/portabled-bus.c	2025-06-30 18:33:48.000000000 +0000
@@ -93,7 +93,7 @@ static int property_get_profiles(
                 void *userdata,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(bus);
@@ -224,7 +224,7 @@ static int method_get_image_metadata(sd_
 }
 
 static int method_get_image_state(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **extension_images = NULL;
         const char *name_or_path;
         PortableState state;
         int r;
@@ -271,7 +271,7 @@ static int method_attach_image(sd_bus_me
 }
 
 static int method_detach_image(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **extension_images = NULL;
         PortableChange *changes = NULL;
         PortableFlags flags = 0;
         Manager *m = ASSERT_PTR(userdata);
diff '--color=auto' -Nurp a/src/portable/portabled-image-bus.c b/src/portable/portabled-image-bus.c
--- a/src/portable/portabled-image-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/portable/portabled-image-bus.c	2025-06-30 18:33:48.000000000 +0000
@@ -104,7 +104,7 @@ int bus_image_common_get_metadata(
 
         _cleanup_ordered_hashmap_free_ OrderedHashmap *extension_releases = NULL;
         _cleanup_(portable_metadata_unrefp) PortableMetadata *os_release = NULL;
-        _cleanup_strv_free_ char **matches = NULL, **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **matches = NULL, **extension_images = NULL;
         _cleanup_hashmap_free_ Hashmap *unit_files = NULL;
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_free_ PortableMetadata **sorted = NULL;
@@ -262,7 +262,7 @@ static int bus_image_method_get_state(
                 void *userdata,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **extension_images = NULL;
         Image *image = ASSERT_PTR(userdata);
         PortableState state;
         int r;
@@ -307,7 +307,7 @@ int bus_image_common_attach(
                 Image *image,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **matches = NULL, **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **matches = NULL, **extension_images = NULL;
         PortableChange *changes = NULL;
         PortableFlags flags = 0;
         const char *profile, *copy_mode;
@@ -410,7 +410,7 @@ static int bus_image_method_detach(
                 void *userdata,
                 sd_bus_error *error) {
 
-        _cleanup_strv_free_ char **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **extension_images = NULL;
         PortableChange *changes = NULL;
         Image *image = ASSERT_PTR(userdata);
         Manager *m = ASSERT_PTR(image->userdata);
@@ -637,7 +637,7 @@ int bus_image_common_reattach(
 
         PortableChange *changes_detached = NULL, *changes_attached = NULL, *changes_gone = NULL;
         size_t n_changes_detached = 0, n_changes_attached = 0, n_changes_gone = 0;
-        _cleanup_strv_free_ char **matches = NULL, **extension_images = NULL;
+        _cleanup_sd_strv_free_ char **matches = NULL, **extension_images = NULL;
         PortableFlags flags = PORTABLE_REATTACH;
         const char *profile, *copy_mode;
         int r;
@@ -1139,7 +1139,7 @@ not_found:
 
 int bus_image_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
         _cleanup_hashmap_free_ Hashmap *images = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = userdata;
         size_t n = 0;
         Image *image;
diff '--color=auto' -Nurp a/src/resolve/resolvconf-compat.c b/src/resolve/resolvconf-compat.c
--- a/src/resolve/resolvconf-compat.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolvconf-compat.c	2025-06-30 18:36:23.000000000 +0000
@@ -65,7 +65,7 @@ static int parse_nameserver(const char *
                 if (r == 0)
                         break;
 
-                if (strv_push(&arg_set_dns, word) < 0)
+                if (sd_strv_push(&arg_set_dns, word) < 0)
                         return log_oom();
 
                 word = NULL;
@@ -88,7 +88,7 @@ static int parse_search_domain(const cha
                 if (r == 0)
                         break;
 
-                if (strv_push(&arg_set_domain, word) < 0)
+                if (sd_strv_push(&arg_set_domain, word) < 0)
                         return log_oom();
 
                 word = NULL;
@@ -261,7 +261,7 @@ int resolvconf_parse_argv(int argc, char
                         /* If -x mode is selected, let's preferably route non-suffixed lookups to this interface. This
                          * somewhat matches the original -x behaviour */
 
-                        r = strv_extend(&arg_set_domain, "~.");
+                        r = sd_strv_extend(&arg_set_domain, "~.");
                         if (r < 0)
                                 return log_oom();
 
diff '--color=auto' -Nurp a/src/resolve/resolvectl.c b/src/resolve/resolvectl.c
--- a/src/resolve/resolvectl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolvectl.c	2025-06-30 18:37:55.000000000 +0000
@@ -79,9 +79,9 @@ static const char *arg_set_dnssec = NULL
 static char **arg_set_nta = NULL;
 
 STATIC_DESTRUCTOR_REGISTER(arg_ifname, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_set_dns, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_set_domain, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_set_nta, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_set_dns, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_set_domain, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_set_nta, sd_strv_freep);
 
 typedef enum StatusMode {
         STATUS_ALL,
@@ -112,7 +112,7 @@ static int interface_info_compare(const
 
 int ifname_mangle_full(const char *s, bool drop_protocol_specifier) {
         _cleanup_(sd_netlink_unrefp) sd_netlink *rtnl = NULL;
-        _cleanup_strv_free_ char **found = NULL;
+        _cleanup_sd_strv_free_ char **found = NULL;
         int r;
 
         assert(s);
@@ -133,7 +133,7 @@ int ifname_mangle_full(const char *s, bo
                                 if (ifindex_longest_name <= 0)
                                         ifindex_longest_name = r;
 
-                                r = strv_extend(&found, buf);
+                                r = sd_strv_extend(&found, buf);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -145,11 +145,11 @@ int ifname_mangle_full(const char *s, bo
                         *dot = '\0';
                 }
 
-                unsigned n = strv_length(found);
+                unsigned n = sd_strv_length(found);
                 if (n > 1) {
                         _cleanup_free_ char *joined = NULL;
 
-                        joined = strv_join(found, ", ");
+                        joined = sd_strv_join(found, ", ");
                         log_warning("Found multiple interfaces (%s) matching with '%s'. Using '%s' (ifindex=%i).",
                                     strna(joined), s, found[0], ifindex_longest_name);
 
@@ -1399,7 +1399,7 @@ static int map_link_dns_servers_internal
                 if (isempty(pretty))
                         continue;
 
-                r = strv_consume(l, TAKE_PTR(pretty));
+                r = sd_strv_consume(l, TAKE_PTR(pretty));
                 if (r < 0)
                         return r;
         }
@@ -1490,7 +1490,7 @@ static int map_link_domains(sd_bus *bus,
                 if (isempty(pretty))
                         continue;
 
-                r = strv_consume(l, TAKE_PTR(pretty));
+                r = sd_strv_consume(l, TAKE_PTR(pretty));
                 if (r < 0)
                         return r;
         }
@@ -1571,27 +1571,27 @@ typedef struct GlobalInfo {
 static void link_info_clear(LinkInfo *p) {
         free(p->current_dns);
         free(p->current_dns_ex);
-        strv_free(p->dns);
-        strv_free(p->dns_ex);
-        strv_free(p->domains);
-        strv_free(p->ntas);
+        sd_strv_free(p->dns);
+        sd_strv_free(p->dns_ex);
+        sd_strv_free(p->domains);
+        sd_strv_free(p->ntas);
 }
 
 static void global_info_clear(GlobalInfo *p) {
         free(p->current_dns);
         free(p->current_dns_ex);
-        strv_free(p->dns);
-        strv_free(p->dns_ex);
-        strv_free(p->fallback_dns);
-        strv_free(p->fallback_dns_ex);
-        strv_free(p->domains);
-        strv_free(p->ntas);
+        sd_strv_free(p->dns);
+        sd_strv_free(p->dns_ex);
+        sd_strv_free(p->fallback_dns);
+        sd_strv_free(p->fallback_dns_ex);
+        sd_strv_free(p->domains);
+        sd_strv_free(p->ntas);
 }
 
 static int dump_list(Table *table, const char *field, char * const *l) {
         int r;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return 0;
 
         r = table_add_many(table,
@@ -1603,34 +1603,34 @@ static int dump_list(Table *table, const
         return 0;
 }
 
-static int strv_extend_extended_bool(char ***strv, const char *name, const char *value) {
+static int sd_strv_extend_extended_bool(char ***strv, const char *name, const char *value) {
         int r;
 
         if (value) {
                 r = parse_boolean(value);
                 if (r >= 0)
-                        return strv_extendf(strv, "%s%s", plus_minus(r), name);
+                        return sd_sd_strv_extendf(strv, "%s%s", plus_minus(r), name);
         }
 
-        return strv_extendf(strv, "%s=%s", name, value ?: "???");
+        return sd_sd_strv_extendf(strv, "%s=%s", name, value ?: "???");
 }
 
 static char** link_protocol_status(const LinkInfo *info) {
-        _cleanup_strv_free_ char **s = NULL;
+        _cleanup_sd_strv_free_ char **s = NULL;
 
-        if (strv_extendf(&s, "%sDefaultRoute", plus_minus(info->default_route)) < 0)
+        if (sd_sd_strv_extendf(&s, "%sDefaultRoute", plus_minus(info->default_route)) < 0)
                 return NULL;
 
-        if (strv_extend_extended_bool(&s, "LLMNR", info->llmnr) < 0)
+        if (sd_strv_extend_extended_bool(&s, "LLMNR", info->llmnr) < 0)
                 return NULL;
 
-        if (strv_extend_extended_bool(&s, "mDNS", info->mdns) < 0)
+        if (sd_strv_extend_extended_bool(&s, "mDNS", info->mdns) < 0)
                 return NULL;
 
-        if (strv_extend_extended_bool(&s, "DNSOverTLS", info->dns_over_tls) < 0)
+        if (sd_strv_extend_extended_bool(&s, "DNSOverTLS", info->dns_over_tls) < 0)
                 return NULL;
 
-        if (strv_extendf(&s, "DNSSEC=%s/%s",
+        if (sd_sd_strv_extendf(&s, "DNSSEC=%s/%s",
                          info->dnssec ?: "???",
                          info->dnssec_supported ? "supported" : "unsupported") < 0)
                 return NULL;
@@ -1639,18 +1639,18 @@ static char** link_protocol_status(const
 }
 
 static char** global_protocol_status(const GlobalInfo *info) {
-        _cleanup_strv_free_ char **s = NULL;
+        _cleanup_sd_strv_free_ char **s = NULL;
 
-        if (strv_extend_extended_bool(&s, "LLMNR", info->llmnr) < 0)
+        if (sd_strv_extend_extended_bool(&s, "LLMNR", info->llmnr) < 0)
                 return NULL;
 
-        if (strv_extend_extended_bool(&s, "mDNS", info->mdns) < 0)
+        if (sd_strv_extend_extended_bool(&s, "mDNS", info->mdns) < 0)
                 return NULL;
 
-        if (strv_extend_extended_bool(&s, "DNSOverTLS", info->dns_over_tls) < 0)
+        if (sd_strv_extend_extended_bool(&s, "DNSOverTLS", info->dns_over_tls) < 0)
                 return NULL;
 
-        if (strv_extendf(&s, "DNSSEC=%s/%s",
+        if (sd_sd_strv_extendf(&s, "DNSSEC=%s/%s",
                          info->dnssec ?: "???",
                          info->dnssec_supported ? "supported" : "unsupported") < 0)
                 return NULL;
@@ -1800,7 +1800,7 @@ static int status_ifindex(sd_bus *bus, i
         if (r < 0)
                 return table_log_add_error(r);
 
-        _cleanup_strv_free_ char **pstatus = link_protocol_status(&link_info);
+        _cleanup_sd_strv_free_ char **pstatus = link_protocol_status(&link_info);
         if (!pstatus)
                 return log_oom();
 
@@ -1867,7 +1867,7 @@ static int map_global_dns_servers_intern
                 if (isempty(pretty))
                         continue;
 
-                r = strv_consume(l, TAKE_PTR(pretty));
+                r = sd_strv_consume(l, TAKE_PTR(pretty));
                 if (r < 0)
                         return r;
         }
@@ -1919,7 +1919,7 @@ static int map_global_domains(sd_bus *bu
                 if (isempty(pretty))
                         continue;
 
-                r = strv_consume(l, TAKE_PTR(pretty));
+                r = sd_strv_consume(l, TAKE_PTR(pretty));
                 if (r < 0)
                         return r;
         }
@@ -2016,7 +2016,7 @@ static int status_global(sd_bus *bus, St
         if (!table)
                 return log_oom();
 
-        _cleanup_strv_free_ char **pstatus = global_protocol_status(&global_info);
+        _cleanup_sd_strv_free_ char **pstatus = global_protocol_status(&global_info);
         if (!pstatus)
                 return log_oom();
 
@@ -3607,7 +3607,7 @@ static int compat_parse_argv(int argc, c
                         break;
 
                 case ARG_SET_DNS:
-                        r = strv_extend(&arg_set_dns, optarg);
+                        r = sd_strv_extend(&arg_set_dns, optarg);
                         if (r < 0)
                                 return log_oom();
 
@@ -3615,7 +3615,7 @@ static int compat_parse_argv(int argc, c
                         break;
 
                 case ARG_SET_DOMAIN:
-                        r = strv_extend(&arg_set_domain, optarg);
+                        r = sd_strv_extend(&arg_set_domain, optarg);
                         if (r < 0)
                                 return log_oom();
 
@@ -3643,7 +3643,7 @@ static int compat_parse_argv(int argc, c
                         break;
 
                 case ARG_SET_NTA:
-                        r = strv_extend(&arg_set_nta, optarg);
+                        r = sd_strv_extend(&arg_set_nta, optarg);
                         if (r < 0)
                                 return log_oom();
 
@@ -4045,19 +4045,19 @@ static int compat_main(int argc, char *a
                 assert(arg_ifname);
 
                 if (arg_set_dns) {
-                        r = translate("dns", arg_ifname, strv_length(arg_set_dns), arg_set_dns, bus);
+                        r = translate("dns", arg_ifname, sd_strv_length(arg_set_dns), arg_set_dns, bus);
                         if (r < 0)
                                 return r;
                 }
 
                 if (arg_set_domain) {
-                        r = translate("domain", arg_ifname, strv_length(arg_set_domain), arg_set_domain, bus);
+                        r = translate("domain", arg_ifname, sd_strv_length(arg_set_domain), arg_set_domain, bus);
                         if (r < 0)
                                 return r;
                 }
 
                 if (arg_set_nta) {
-                        r = translate("nta", arg_ifname, strv_length(arg_set_nta), arg_set_nta, bus);
+                        r = translate("nta", arg_ifname, sd_strv_length(arg_set_nta), arg_set_nta, bus);
                         if (r < 0)
                                 return r;
                 }
diff '--color=auto' -Nurp a/src/resolve/resolved-dns-rr.c b/src/resolve/resolved-dns-rr.c
--- a/src/resolve/resolved-dns-rr.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolved-dns-rr.c	2025-06-30 18:37:55.000000000 +0000
@@ -806,14 +806,14 @@ static int format_timestamp_dns(char *bu
 }
 
 static char *format_types(Bitmap *types) {
-        _cleanup_strv_free_ char **strv = NULL;
+        _cleanup_sd_strv_free_ char **strv = NULL;
         _cleanup_free_ char *str = NULL;
         unsigned type;
         int r;
 
         BITMAP_FOREACH(type, types) {
                 if (dns_type_to_string(type)) {
-                        r = strv_extend(&strv, dns_type_to_string(type));
+                        r = sd_strv_extend(&strv, dns_type_to_string(type));
                         if (r < 0)
                                 return NULL;
                 } else {
@@ -823,13 +823,13 @@ static char *format_types(Bitmap *types)
                         if (r < 0)
                                 return NULL;
 
-                        r = strv_consume(&strv, t);
+                        r = sd_strv_consume(&strv, t);
                         if (r < 0)
                                 return NULL;
                 }
         }
 
-        str = strv_join(strv, " ");
+        str = sd_strv_join(strv, " ");
         if (!str)
                 return NULL;
 
@@ -878,7 +878,7 @@ static char *format_svc_param_value(DnsS
         switch (i->key) {
         case DNS_SVC_PARAM_KEY_ALPN: {
                 size_t offset = 0;
-                _cleanup_strv_free_ char **values_strv = NULL;
+                _cleanup_sd_strv_free_ char **values_strv = NULL;
                 while (offset < i->length) {
                         size_t sz = (uint8_t) i->value[offset++];
 
@@ -886,12 +886,12 @@ static char *format_svc_param_value(DnsS
                         if (!alpn)
                                 return NULL;
 
-                        if (strv_push(&values_strv, alpn) < 0)
+                        if (sd_strv_push(&values_strv, alpn) < 0)
                                 return NULL;
 
                         offset += sz;
                 }
-                value = strv_join(values_strv, ",");
+                value = sd_strv_join(values_strv, ",");
                 if (!value)
                         return NULL;
                 break;
@@ -905,27 +905,27 @@ static char *format_svc_param_value(DnsS
         }
         case DNS_SVC_PARAM_KEY_IPV4HINT: {
                 const struct in_addr *addrs = i->value_in_addr;
-                _cleanup_strv_free_ char **values_strv = NULL;
+                _cleanup_sd_strv_free_ char **values_strv = NULL;
                 for (size_t n = 0; n < i->length / sizeof (struct in_addr); n++) {
                         char *addr;
                         if (in_addr_to_string(AF_INET, (const union in_addr_union*) &addrs[n], &addr) < 0)
                                 return NULL;
-                        if (strv_push(&values_strv, addr) < 0)
+                        if (sd_strv_push(&values_strv, addr) < 0)
                                 return NULL;
                 }
-                return strv_join(values_strv, ",");
+                return sd_strv_join(values_strv, ",");
         }
         case DNS_SVC_PARAM_KEY_IPV6HINT: {
                 const struct in6_addr *addrs = i->value_in6_addr;
-                _cleanup_strv_free_ char **values_strv = NULL;
+                _cleanup_sd_strv_free_ char **values_strv = NULL;
                 for (size_t n = 0; n < i->length / sizeof (struct in6_addr); n++) {
                         char *addr;
                         if (in_addr_to_string(AF_INET6, (const union in_addr_union*) &addrs[n], &addr) < 0)
                                 return NULL;
-                        if (strv_push(&values_strv, addr) < 0)
+                        if (sd_strv_push(&values_strv, addr) < 0)
                                 return NULL;
                 }
-                return strv_join(values_strv, ",");
+                return sd_strv_join(values_strv, ",");
         }
         default: {
                 value = decescape((char *)&i->value, " ,", i->length);
@@ -958,17 +958,17 @@ static char *format_svc_param(DnsSvcPara
 }
 
 static char *format_svc_params(DnsSvcParam *first) {
-        _cleanup_strv_free_ char **params = NULL;
+        _cleanup_sd_strv_free_ char **params = NULL;
 
         LIST_FOREACH(params, i, first) {
                 char *param = format_svc_param(i);
                 if (!param)
                         return NULL;
-                if (strv_push(&params, param) < 0)
+                if (sd_strv_push(&params, param) < 0)
                         return NULL;
         }
 
-        return strv_join(params, " ");
+        return sd_strv_join(params, " ");
 }
 
 const char *dns_resource_record_to_string(DnsResourceRecord *rr) {
diff '--color=auto' -Nurp a/src/resolve/resolved-dns-trust-anchor.c b/src/resolve/resolved-dns-trust-anchor.c
--- a/src/resolve/resolved-dns-trust-anchor.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolved-dns-trust-anchor.c	2025-06-30 18:37:55.000000000 +0000
@@ -427,7 +427,7 @@ static int dns_trust_anchor_load_files(
                 const char *suffix,
                 int (*loader)(DnsTrustAnchor *d, const char *path, unsigned n, const char *line)) {
 
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(d);
@@ -509,7 +509,7 @@ static int dns_trust_anchor_dump(DnsTrus
 
                 typesafe_qsort(l, set_size(d->negative_by_name), domain_name_cmp);
 
-                j = strv_join(l, " ");
+                j = sd_strv_join(l, " ");
                 if (!j)
                         return log_oom();
 
diff '--color=auto' -Nurp a/src/resolve/resolved-dnssd-bus.c b/src/resolve/resolved-dnssd-bus.c
--- a/src/resolve/resolved-dnssd-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolved-dnssd-bus.c	2025-06-30 18:33:48.000000000 +0000
@@ -90,7 +90,7 @@ static int dnssd_object_find(sd_bus *bus
 }
 
 static int dnssd_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = ASSERT_PTR(userdata);
         DnssdService *service;
         unsigned c = 0;
diff '--color=auto' -Nurp a/src/resolve/resolved-dnssd.c b/src/resolve/resolved-dnssd.c
--- a/src/resolve/resolved-dnssd.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolved-dnssd.c	2025-06-30 18:33:48.000000000 +0000
@@ -207,7 +207,7 @@ int dnssd_render_instance_name(Manager *
 }
 
 int dnssd_load(Manager *manager) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(manager);
diff '--color=auto' -Nurp a/src/resolve/resolved-link-bus.c b/src/resolve/resolved-link-bus.c
--- a/src/resolve/resolved-link-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolved-link-bus.c	2025-06-30 18:33:48.000000000 +0000
@@ -682,7 +682,7 @@ int bus_link_method_set_dnssec(sd_bus_me
 
 int bus_link_method_set_dnssec_negative_trust_anchors(sd_bus_message *message, void *userdata, sd_bus_error *error) {
         _cleanup_set_free_free_ Set *ns = NULL;
-        _cleanup_strv_free_ char **ntas = NULL;
+        _cleanup_sd_strv_free_ char **ntas = NULL;
         _cleanup_free_ char *j = NULL;
         Link *l = ASSERT_PTR(userdata);
         int r;
@@ -825,7 +825,7 @@ char *link_bus_path(const Link *link) {
 }
 
 static int link_node_enumerator(sd_bus *bus, const char *path, void *userdata, char ***nodes, sd_bus_error *error) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         Manager *m = ASSERT_PTR(userdata);
         Link *link;
         unsigned c = 0;
diff '--color=auto' -Nurp a/src/resolve/resolved-link.c b/src/resolve/resolved-link.c
--- a/src/resolve/resolved-link.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/resolve/resolved-link.c	2025-06-30 18:33:48.000000000 +0000
@@ -277,7 +277,7 @@ static int link_update_dns_server_one(Li
 }
 
 static int link_update_dns_servers(Link *l) {
-        _cleanup_strv_free_ char **nameservers = NULL;
+        _cleanup_sd_strv_free_ char **nameservers = NULL;
         int r;
 
         assert(l);
@@ -454,7 +454,7 @@ static int link_update_dnssec_mode(Link
 }
 
 static int link_update_dnssec_negative_trust_anchors(Link *l) {
-        _cleanup_strv_free_ char **ntas = NULL;
+        _cleanup_sd_strv_free_ char **ntas = NULL;
         _cleanup_set_free_free_ Set *ns = NULL;
         int r;
 
@@ -503,7 +503,7 @@ static int link_update_search_domain_one
 }
 
 static int link_update_search_domains(Link *l) {
-        _cleanup_strv_free_ char **sdomains = NULL, **rdomains = NULL;
+        _cleanup_sd_strv_free_ char **sdomains = NULL, **rdomains = NULL;
         int r, q;
 
         assert(l);
diff '--color=auto' -Nurp a/src/run/run.c b/src/run/run.c
--- a/src/run/run.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/run/run.c	2025-06-30 18:37:55.000000000 +0000
@@ -84,13 +84,13 @@ static bool arg_ignore_failure = false;
 static char *arg_background = NULL;
 
 STATIC_DESTRUCTOR_REGISTER(arg_description, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_environment, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_property, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_path_property, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_socket_property, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_timer_property, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_environment, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_property, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_path_property, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_socket_property, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_timer_property, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_working_directory, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_cmdline, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_cmdline, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_exec_path, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_background, freep);
 
@@ -210,7 +210,7 @@ static int add_timer_property(const char
         if (!p)
                 return log_oom();
 
-        if (strv_consume(&arg_timer_property, p) < 0)
+        if (sd_strv_consume(&arg_timer_property, p) < 0)
                 return log_oom();
 
         return 0;
@@ -225,7 +225,7 @@ static char **make_login_shell_cmdline(c
         if (!argv0)
                 return NULL;
 
-        return strv_new(argv0);
+        return sd_strv_new(argv0);
 }
 
 static int parse_argv(int argc, char *argv[]) {
@@ -436,7 +436,7 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case 'p':
-                        if (strv_extend(&arg_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_property, optarg) < 0)
                                 return log_oom();
 
                         break;
@@ -543,7 +543,7 @@ static int parse_argv(int argc, char *ar
 
                 case ARG_TIMER_PROPERTY:
 
-                        if (strv_extend(&arg_timer_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_timer_property, optarg) < 0)
                                 return log_oom();
 
                         arg_with_timer = arg_with_timer ||
@@ -558,14 +558,14 @@ static int parse_argv(int argc, char *ar
 
                 case ARG_PATH_PROPERTY:
 
-                        if (strv_extend(&arg_path_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_path_property, optarg) < 0)
                                 return log_oom();
 
                         break;
 
                 case ARG_SOCKET_PROPERTY:
 
-                        if (strv_extend(&arg_socket_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_socket_property, optarg) < 0)
                                 return log_oom();
 
                         break;
@@ -672,11 +672,11 @@ static int parse_argv(int argc, char *ar
                 if (arg_shell)
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "If --shell is used, no command line is expected.");
 
-                l = strv_copy(argv + optind);
+                l = sd_strv_copy(argv + optind);
                 if (!l)
                         return log_oom();
 
-                strv_free_and_replace(arg_cmdline, l);
+                sd_strv_free_and_replace(arg_cmdline, l);
 
         } else if (arg_shell) {
                 _cleanup_free_ char *s = NULL;
@@ -686,11 +686,11 @@ static int parse_argv(int argc, char *ar
                 if (r < 0)
                         return log_error_errno(r, "Failed to determine shell: %m");
 
-                l = strv_new(s);
+                l = sd_strv_new(s);
                 if (!l)
                         return log_oom();
 
-                strv_free_and_replace(arg_cmdline, l);
+                sd_strv_free_and_replace(arg_cmdline, l);
 
         } else if (!arg_unit || !with_trigger)
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Command line to execute required.");
@@ -814,7 +814,7 @@ static int parse_argv_sudo_mode(int argc
                         break;
 
                 case ARG_PROPERTY:
-                        if (strv_extend(&arg_property, optarg) < 0)
+                        if (sd_strv_extend(&arg_property, optarg) < 0)
                                 return log_oom();
 
                         break;
@@ -905,9 +905,9 @@ static int parse_argv_sudo_mode(int argc
         arg_expand_environment = false;
         arg_send_sighup = true;
 
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         if (argc > optind)
-                l = strv_copy(argv + optind);
+                l = sd_strv_copy(argv + optind);
         else {
                 const char *e;
 
@@ -930,7 +930,7 @@ static int parse_argv_sudo_mode(int argc
         if (!l)
                 return log_oom();
 
-        strv_free_and_replace(arg_cmdline, l);
+        sd_strv_free_and_replace(arg_cmdline, l);
 
         if (!arg_slice) {
                 arg_slice = strdup(SPECIAL_USER_SLICE);
@@ -956,16 +956,16 @@ static int parse_argv_sudo_mode(int argc
         if (r < 0)
                 return log_error_errno(r, "Failed to set $SUDO_GID environment variable: %m");
 
-        if (strv_extendf(&arg_property, "LogExtraFields=ELEVATED_UID=" UID_FMT, getuid()) < 0)
+        if (sd_sd_strv_extendf(&arg_property, "LogExtraFields=ELEVATED_UID=" UID_FMT, getuid()) < 0)
                 return log_oom();
 
-        if (strv_extendf(&arg_property, "LogExtraFields=ELEVATED_GID=" GID_FMT, getgid()) < 0)
+        if (sd_sd_strv_extendf(&arg_property, "LogExtraFields=ELEVATED_GID=" GID_FMT, getgid()) < 0)
                 return log_oom();
 
-        if (strv_extendf(&arg_property, "LogExtraFields=ELEVATED_USER=%s", un) < 0)
+        if (sd_sd_strv_extendf(&arg_property, "LogExtraFields=ELEVATED_USER=%s", un) < 0)
                 return log_oom();
 
-        if (strv_extend(&arg_property, "PAMName=systemd-run0") < 0)
+        if (sd_strv_extend(&arg_property, "PAMName=systemd-run0") < 0)
                 return log_oom();
 
         if (!arg_background && arg_stdio == ARG_STDIO_PTY && shall_tint_background()) {
@@ -1191,7 +1191,7 @@ static int transient_service_set_propert
                 }
         }
 
-        if (!strv_isempty(arg_environment)) {
+        if (!sd_strv_isempty(arg_environment)) {
                 r = sd_bus_message_open_container(m, 'r', "sv");
                 if (r < 0)
                         return bus_log_create_error(r);
@@ -1218,7 +1218,7 @@ static int transient_service_set_propert
         }
 
         /* Exec container */
-        if (!strv_isempty(arg_cmdline)) {
+        if (!sd_strv_isempty(arg_cmdline)) {
                 r = sd_bus_message_open_container(m, 'r', "sv");
                 if (r < 0)
                         return bus_log_create_error(r);
@@ -1644,7 +1644,7 @@ static void set_window_title(PTYForward
         if (!arg_host)
                 (void) gethostname_strict(&hn);
 
-        cl = strv_join(arg_cmdline, " ");
+        cl = sd_strv_join(arg_cmdline, " ");
         if (!cl)
                 return (void) log_oom();
 
@@ -1969,7 +1969,7 @@ static int start_transient_service(sd_bu
 static int start_transient_scope(sd_bus *bus) {
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_(bus_wait_for_jobs_freep) BusWaitForJobs *w = NULL;
-        _cleanup_strv_free_ char **env = NULL, **user_env = NULL;
+        _cleanup_sd_strv_free_ char **env = NULL, **user_env = NULL;
         _cleanup_free_ char *scope = NULL;
         const char *object = NULL;
         sd_id128_t invocation_id;
@@ -1977,7 +1977,7 @@ static int start_transient_scope(sd_bus
         int r;
 
         assert(bus);
-        assert(!strv_isempty(arg_cmdline));
+        assert(!sd_strv_isempty(arg_cmdline));
 
         r = bus_wait_for_jobs_new(bus, &w);
         if (r < 0)
@@ -2061,7 +2061,7 @@ static int start_transient_scope(sd_bus
         if (r == 0)
                 log_debug("No invocation ID set.");
         else {
-                if (strv_extendf(&user_env, "INVOCATION_ID=" SD_ID128_FORMAT_STR, SD_ID128_FORMAT_VAL(invocation_id)) < 0)
+                if (sd_sd_strv_extendf(&user_env, "INVOCATION_ID=" SD_ID128_FORMAT_STR, SD_ID128_FORMAT_VAL(invocation_id)) < 0)
                         return log_oom();
         }
 
@@ -2092,22 +2092,22 @@ static int start_transient_scope(sd_bus
                         return log_error_errno(r, "Failed to resolve user %s: %m", arg_exec_user);
 
                 if (home) {
-                        r = strv_extendf(&user_env, "HOME=%s", home);
+                        r = sd_sd_strv_extendf(&user_env, "HOME=%s", home);
                         if (r < 0)
                                 return log_oom();
                 }
 
                 if (shell) {
-                        r = strv_extendf(&user_env, "SHELL=%s", shell);
+                        r = sd_sd_strv_extendf(&user_env, "SHELL=%s", shell);
                         if (r < 0)
                                 return log_oom();
                 }
 
-                r = strv_extendf(&user_env, "USER=%s", arg_exec_user);
+                r = sd_sd_strv_extendf(&user_env, "USER=%s", arg_exec_user);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&user_env, "LOGNAME=%s", arg_exec_user);
+                r = sd_sd_strv_extendf(&user_env, "LOGNAME=%s", arg_exec_user);
                 if (r < 0)
                         return log_oom();
 
@@ -2135,7 +2135,7 @@ static int start_transient_scope(sd_bus
         }
 
         if (arg_expand_environment > 0) {
-                _cleanup_strv_free_ char **expanded_cmdline = NULL, **unset_variables = NULL, **bad_variables = NULL;
+                _cleanup_sd_strv_free_ char **expanded_cmdline = NULL, **unset_variables = NULL, **bad_variables = NULL;
 
                 r = replace_env_argv(arg_cmdline, env, &expanded_cmdline, &unset_variables, &bad_variables);
                 if (r < 0)
@@ -2143,13 +2143,13 @@ static int start_transient_scope(sd_bus
 
                 free_and_replace(arg_cmdline, expanded_cmdline);
 
-                if (!strv_isempty(unset_variables)) {
-                        _cleanup_free_ char *ju = strv_join(unset_variables, ", ");
+                if (!sd_strv_isempty(unset_variables)) {
+                        _cleanup_free_ char *ju = sd_strv_join(unset_variables, ", ");
                         log_warning("Referenced but unset environment variable evaluates to an empty string: %s", strna(ju));
                 }
 
-                if (!strv_isempty(bad_variables)) {
-                        _cleanup_free_ char *jb = strv_join(bad_variables, ", ");
+                if (!sd_strv_isempty(bad_variables)) {
+                        _cleanup_free_ char *jb = sd_strv_join(bad_variables, ", ");
                         log_warning("Invalid environment variable name evaluates to an empty string: %s", strna(jb));
                 }
         }
@@ -2212,7 +2212,7 @@ static int make_transient_trigger_unit(
         if (r < 0)
                 return bus_log_create_error(r);
 
-        if (!strv_isempty(arg_cmdline)) {
+        if (!sd_strv_isempty(arg_cmdline)) {
                 r = sd_bus_message_open_container(m, 'r', "sa(sv)");
                 if (r < 0)
                         return bus_log_create_error(r);
@@ -2329,7 +2329,7 @@ static int start_transient_trigger(sd_bu
 
         if (!arg_quiet) {
                 log_info("Running %s as unit: %s", suffix + 1, trigger);
-                if (!strv_isempty(arg_cmdline))
+                if (!sd_strv_isempty(arg_cmdline))
                         log_info("Will run service as unit: %s", service);
         }
 
@@ -2339,7 +2339,7 @@ static int start_transient_trigger(sd_bu
 static bool shall_make_executable_absolute(void) {
         if (arg_exec_path)
                 return false;
-        if (strv_isempty(arg_cmdline))
+        if (sd_strv_isempty(arg_cmdline))
                 return false;
         if (arg_transport != BUS_TRANSPORT_LOCAL)
                 return false;
@@ -2382,7 +2382,7 @@ static int run(int argc, char* argv[]) {
         if (!arg_description) {
                 char *t;
 
-                if (strv_isempty(arg_cmdline))
+                if (sd_strv_isempty(arg_cmdline))
                         t = strdup(arg_unit);
                 else
                         t = quote_command_line(arg_cmdline, SHELL_ESCAPE_EMPTY);
diff '--color=auto' -Nurp a/src/run-generator/run-generator.c b/src/run-generator/run-generator.c
--- a/src/run-generator/run-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/run-generator/run-generator.c	2025-06-30 18:37:25.000000000 +0000
@@ -19,7 +19,7 @@ static char **arg_commands = NULL;
 static char *arg_success_action = NULL;
 static char *arg_failure_action = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_commands, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_commands, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_success_action, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_failure_action, freep);
 
@@ -33,7 +33,7 @@ static int parse(const char *key, const
                 if (proc_cmdline_value_missing(key, value))
                         return 0;
 
-                r = strv_extend(&arg_commands, value);
+                r = sd_strv_extend(&arg_commands, value);
                 if (r < 0)
                         return log_oom();
 
@@ -60,7 +60,7 @@ static int generate(void) {
         const char *p;
         int r;
 
-        if (strv_isempty(arg_commands) && !arg_success_action)
+        if (sd_strv_isempty(arg_commands) && !arg_success_action)
                 return 0;
 
         r = generator_open_unit_file(arg_dest, /* source = */ NULL, "kernel-command-line.service", &f);
diff '--color=auto' -Nurp a/src/shared/acl-util.c b/src/shared/acl-util.c
--- a/src/shared/acl-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/acl-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -151,7 +151,7 @@ int add_base_acls_if_needed(acl_t *acl_p
 }
 
 int acl_search_groups(const char *path, char ***ret_groups) {
-        _cleanup_strv_free_ char **g = NULL;
+        _cleanup_sd_strv_free_ char **g = NULL;
         _cleanup_(acl_freep) acl_t acl = NULL;
         bool ret = false;
         acl_entry_t entry;
@@ -197,7 +197,7 @@ int acl_search_groups(const char *path,
                         if (!name)
                                 return -ENOMEM;
 
-                        r = strv_consume(&g, name);
+                        r = sd_strv_consume(&g, name);
                         if (r < 0)
                                 return r;
                 }
@@ -219,7 +219,7 @@ int parse_acl(
                 acl_t *ret_acl_default,
                 bool want_mask) {
 
-        _cleanup_strv_free_ char **a = NULL, **e = NULL, **d = NULL, **split = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL, **e = NULL, **d = NULL, **split = NULL;
         _cleanup_(acl_freep) acl_t a_acl = NULL, e_acl = NULL, d_acl = NULL;
         int r;
 
@@ -228,16 +228,16 @@ int parse_acl(
         assert(ret_acl_access_exec);
         assert(ret_acl_default);
 
-        split = strv_split(text, ",");
+        split = sd_strv_split(text, ",");
         if (!split)
                 return -ENOMEM;
 
         STRV_FOREACH(entry, split) {
-                _cleanup_strv_free_ char **entry_split = NULL;
+                _cleanup_sd_strv_free_ char **entry_split = NULL;
                 _cleanup_free_ char *entry_join = NULL;
                 int n;
 
-                n = strv_split_full(&entry_split, *entry, ":", EXTRACT_DONT_COALESCE_SEPARATORS|EXTRACT_RETAIN_ESCAPE);
+                n = sd_strv_split_full(&entry_split, *entry, ":", EXTRACT_DONT_COALESCE_SEPARATORS|EXTRACT_RETAIN_ESCAPE);
                 if (n < 0)
                         return n;
 
@@ -250,29 +250,29 @@ int parse_acl(
                         if (!STR_IN_SET(entry_split[0], "default", "d"))
                                 return -EINVAL;
 
-                        entry_join = strv_join(entry_split + 1, ":");
+                        entry_join = sd_strv_join(entry_split + 1, ":");
                         if (!entry_join)
                                 return -ENOMEM;
 
-                        r = strv_consume(&d, TAKE_PTR(entry_join));
+                        r = sd_strv_consume(&d, TAKE_PTR(entry_join));
                 } else { /* n == 3 */
-                        entry_join = strv_join(entry_split, ":");
+                        entry_join = sd_strv_join(entry_split, ":");
                         if (!entry_join)
                                 return -ENOMEM;
 
                         if (!streq(*entry, entry_join))
-                                r = strv_consume(&e, TAKE_PTR(entry_join));
+                                r = sd_strv_consume(&e, TAKE_PTR(entry_join));
                         else
-                                r = strv_consume(&a, TAKE_PTR(entry_join));
+                                r = sd_strv_consume(&a, TAKE_PTR(entry_join));
                 }
                 if (r < 0)
                         return r;
         }
 
-        if (!strv_isempty(a)) {
+        if (!sd_strv_isempty(a)) {
                 _cleanup_free_ char *join = NULL;
 
-                join = strv_join(a, ",");
+                join = sd_strv_join(a, ",");
                 if (!join)
                         return -ENOMEM;
 
@@ -287,10 +287,10 @@ int parse_acl(
                 }
         }
 
-        if (!strv_isempty(e)) {
+        if (!sd_strv_isempty(e)) {
                 _cleanup_free_ char *join = NULL;
 
-                join = strv_join(e, ",");
+                join = sd_strv_join(e, ",");
                 if (!join)
                         return -ENOMEM;
 
@@ -301,10 +301,10 @@ int parse_acl(
                 /* The mask must be calculated after deciding whether the execute bit should be set. */
         }
 
-        if (!strv_isempty(d)) {
+        if (!sd_strv_isempty(d)) {
                 _cleanup_free_ char *join = NULL;
 
-                join = strv_join(d, ",");
+                join = sd_strv_join(d, ",");
                 if (!join)
                         return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/shared/ask-password-api.c b/src/shared/ask-password-api.c
--- a/src/shared/ask-password-api.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/ask-password-api.c	2025-06-30 18:37:25.000000000 +0000
@@ -85,7 +85,7 @@ static int retrieve_key(key_serial_t ser
 }
 
 static int add_to_keyring(const char *keyname, AskPasswordFlags flags, char **passwords) {
-        _cleanup_strv_free_erase_ char **l = NULL;
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         _cleanup_(erase_and_freep) char *p = NULL;
         key_serial_t serial;
         size_t n;
@@ -95,7 +95,7 @@ static int add_to_keyring(const char *ke
 
         if (!FLAGS_SET(flags, ASK_PASSWORD_PUSH_CACHE))
                 return 0;
-        if (strv_isempty(passwords))
+        if (sd_strv_isempty(passwords))
                 return 0;
 
         r = lookup_key(keyname, &serial);
@@ -106,7 +106,7 @@ static int add_to_keyring(const char *ke
         } else if (r != -ENOKEY)
                 return r;
 
-        r = strv_extend_strv(&l, passwords, true);
+        r = sd_sd_strv_extend_strv(&l, passwords, true);
         if (r <= 0)
                 return r;
 
@@ -167,12 +167,12 @@ static int ask_password_keyring(const As
         if (r < 0)
                 return r;
 
-        _cleanup_strv_free_erase_ char **l = NULL;
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         r = retrieve_key(serial, &l);
         if (r < 0)
                 return r;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return log_debug_errno(SYNTHETIC_ERRNO(ENOKEY), "Found an empty password from keyring.");
 
         *ret = TAKE_PTR(l);
@@ -331,7 +331,7 @@ int ask_password_plymouth(
                         return -ENOENT;
 
                 } else if (IN_SET(buffer[0], 2, 9)) {
-                        _cleanup_strv_free_erase_ char **l = NULL;
+                        _cleanup_sd_strv_free_erase_ char **l = NULL;
                         uint32_t size;
 
                         /* One or more answers */
@@ -350,7 +350,7 @@ int ask_password_plymouth(
                         if (!l)
                                 return -ENOMEM;
 
-                        if (strv_isempty(l))
+                        if (sd_strv_isempty(l))
                                 return log_debug_errno(SYNTHETIC_ERRNO(ECANCELED), "Received an empty password.");
 
                         *ret = TAKE_PTR(l);
@@ -384,7 +384,7 @@ int ask_password_tty(
         _cleanup_close_ int cttyfd = -EBADF, notify = -EBADF;
         struct termios old_termios, new_termios;
         char passphrase[LINE_MAX + 1] = {}, *x;
-        _cleanup_strv_free_erase_ char **l = NULL;
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         struct pollfd pollfd[_POLL_MAX];
         size_t p = 0, codepoint = 0;
         int r;
@@ -634,12 +634,12 @@ int ask_password_tty(
                 goto finish;
         }
 
-        r = strv_consume(&l, x);
+        r = sd_strv_consume(&l, x);
         if (r < 0)
                 goto finish;
 
 skipped:
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 r = log_debug_errno(SYNTHETIC_ERRNO(ECANCELED), "Password query was cancelled.");
         else {
                 if (keyring)
@@ -708,7 +708,7 @@ int ask_password_agent(
         char temp[] = "/run/systemd/ask-password/tmp.XXXXXX";
         char final[sizeof(temp)] = "";
         _cleanup_free_ char *socket_name = NULL;
-        _cleanup_strv_free_erase_ char **l = NULL;
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         _cleanup_fclose_ FILE *f = NULL;
         struct pollfd pollfd[_FD_MAX];
         sigset_t mask, oldmask;
@@ -913,7 +913,7 @@ int ask_password_agent(
                 if (passphrase[0] == '+') {
                         /* An empty message refers to the empty password */
                         if (n == 1)
-                                l = strv_new("");
+                                l = sd_strv_new("");
                         else
                                 l = strv_parse_nulstr(passphrase+1, n-1);
                         if (!l) {
@@ -921,8 +921,8 @@ int ask_password_agent(
                                 goto finish;
                         }
 
-                        if (strv_isempty(l)) {
-                                l = strv_free(l);
+                        if (sd_strv_isempty(l)) {
+                                l = sd_strv_free(l);
                                 log_debug("Invalid packet");
                                 continue;
                         }
@@ -959,7 +959,7 @@ finish:
 
 static int ask_password_credential(const AskPasswordRequest *req, AskPasswordFlags flags, char ***ret) {
         _cleanup_(erase_and_freep) char *buffer = NULL;
-        _cleanup_strv_free_erase_ char **l = NULL;
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         size_t size;
         int r;
 
@@ -975,7 +975,7 @@ static int ask_password_credential(const
         if (!l)
                 return -ENOMEM;
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return log_debug_errno(SYNTHETIC_ERRNO(ENOKEY), "Found an empty password in credential.");
 
         *ret = TAKE_PTR(l);
diff '--color=auto' -Nurp a/src/shared/bootspec.c b/src/shared/bootspec.c
--- a/src/shared/bootspec.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/bootspec.c	2025-06-30 18:37:55.000000000 +0000
@@ -56,13 +56,13 @@ static void boot_entry_free(BootEntry *e
         free(entry->version);
         free(entry->machine_id);
         free(entry->architecture);
-        strv_free(entry->options);
+        sd_strv_free(entry->options);
         free(entry->local_addons.items);
         free(entry->kernel);
         free(entry->efi);
-        strv_free(entry->initrd);
+        sd_strv_free(entry->initrd);
         free(entry->device_tree);
-        strv_free(entry->device_tree_overlay);
+        sd_strv_free(entry->device_tree_overlay);
 }
 
 static int mangle_path(
@@ -143,7 +143,7 @@ static int parse_path_strv(
         if (r <= 0)
                 return r;
 
-        return strv_consume(s, c);
+        return sd_strv_consume(s, c);
 }
 
 static int parse_path_many(
@@ -153,10 +153,10 @@ static int parse_path_many(
                 char ***s,
                 const char *p) {
 
-        _cleanup_strv_free_ char **l = NULL, **f = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL, **f = NULL;
         int r;
 
-        l = strv_split(p, NULL);
+        l = sd_strv_split(p, NULL);
         if (!l)
                 return -ENOMEM;
 
@@ -169,12 +169,12 @@ static int parse_path_many(
                 if (r == 0)
                         continue;
 
-                r = strv_consume(&f, c);
+                r = sd_strv_consume(&f, c);
                 if (r < 0)
                         return r;
         }
 
-        return strv_extend_strv(s, f, /* filter_duplicates= */ false);
+        return sd_sd_strv_extend_strv(s, f, /* filter_duplicates= */ false);
 }
 
 static int parse_tries(const char *fname, const char **p, unsigned *ret) {
@@ -364,7 +364,7 @@ static int boot_entry_load_type1(
                 else if (streq(field, "architecture"))
                         r = free_and_strdup(&tmp.architecture, p);
                 else if (streq(field, "options"))
-                        r = strv_extend(&tmp.options, p);
+                        r = sd_strv_extend(&tmp.options, p);
                 else if (streq(field, "linux"))
                         r = parse_path_one(tmp.path, line, field, &tmp.kernel, p);
                 else if (streq(field, "efi"))
@@ -714,7 +714,7 @@ static int boot_entry_load_unified(
         if (!tmp.kernel)
                 return log_oom();
 
-        tmp.options = strv_new(skip_leading_chars(cmdline, WHITESPACE));
+        tmp.options = sd_strv_new(skip_leading_chars(cmdline, WHITESPACE));
         if (!tmp.options)
                 return log_oom();
 
@@ -1479,15 +1479,15 @@ static void print_addon(
 
 static int indent_embedded_newlines(char *cmdline, char **ret_cmdline) {
         _cleanup_free_ char *t = NULL;
-        _cleanup_strv_free_ char **ts = NULL;
+        _cleanup_sd_strv_free_ char **ts = NULL;
 
         assert(ret_cmdline);
 
-        ts = strv_split_newlines(cmdline);
+        ts = sd_strv_split_newlines(cmdline);
         if (!ts)
                 return -ENOMEM;
 
-        t = strv_join(ts, "\n              ");
+        t = sd_strv_join(ts, "\n              ");
         if (!t)
                 return -ENOMEM;
 
@@ -1504,10 +1504,10 @@ static int print_cmdline(
 
         assert(e);
 
-        if (!strv_isempty(e->options)) {
+        if (!sd_strv_isempty(e->options)) {
                 _cleanup_free_ char *t = NULL;
 
-                options = strv_join(e->options, " ");
+                options = sd_strv_join(e->options, " ");
                 if (!options)
                         return log_oom();
 
@@ -1728,8 +1728,8 @@ int boot_entry_to_json(const BootConfig
 
         e = c->entries + i;
 
-        if (!strv_isempty(e->options)) {
-                opts = strv_join(e->options, " ");
+        if (!sd_strv_isempty(e->options)) {
+                opts = sd_strv_join(e->options, " ");
                 if (!opts)
                         return log_oom();
         }
@@ -1749,9 +1749,9 @@ int boot_entry_to_json(const BootConfig
                                         JSON_BUILD_PAIR_CONDITION(opts, "options", JSON_BUILD_STRING(opts)),
                                         JSON_BUILD_PAIR_CONDITION(e->kernel, "linux", JSON_BUILD_STRING(e->kernel)),
                                         JSON_BUILD_PAIR_CONDITION(e->efi, "efi", JSON_BUILD_STRING(e->efi)),
-                                        JSON_BUILD_PAIR_CONDITION(!strv_isempty(e->initrd), "initrd", JSON_BUILD_STRV(e->initrd)),
+                                        JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(e->initrd), "initrd", JSON_BUILD_STRV(e->initrd)),
                                         JSON_BUILD_PAIR_CONDITION(e->device_tree, "devicetree", JSON_BUILD_STRING(e->device_tree)),
-                                        JSON_BUILD_PAIR_CONDITION(!strv_isempty(e->device_tree_overlay), "devicetreeOverlay", JSON_BUILD_STRV(e->device_tree_overlay))));
+                                        JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(e->device_tree_overlay), "devicetreeOverlay", JSON_BUILD_STRV(e->device_tree_overlay))));
         if (r < 0)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/shared/bus-map-properties.c b/src/shared/bus-map-properties.c
--- a/src/shared/bus-map-properties.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/bus-map-properties.c	2025-06-30 18:35:42.000000000 +0000
@@ -18,15 +18,15 @@ int bus_map_id128(sd_bus *bus, const cha
 }
 
 int bus_map_strv_sort(sd_bus *bus, const char *member, sd_bus_message *m, sd_bus_error *error, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         char ***p = userdata;
         int r;
 
-        r = sd_bus_message_read_strv_extend(m, &l);
+        r = sd_bus_message_read_sd_strv_extend(m, &l);
         if (r < 0)
                 return bus_log_parse_error_debug(r);
 
-        r = strv_extend_strv(p, l, false);
+        r = sd_sd_strv_extend_strv(p, l, false);
         if (r < 0)
                 return bus_log_parse_error_debug(r);
 
@@ -64,14 +64,14 @@ static int map_basic(sd_bus *bus, const
         }
 
         case SD_BUS_TYPE_ARRAY: {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 char ***p = userdata;
 
-                r = sd_bus_message_read_strv_extend(m, &l);
+                r = sd_bus_message_read_sd_strv_extend(m, &l);
                 if (r < 0)
                         return bus_log_parse_error_debug(r);
 
-                return strv_extend_strv(p, l, false);
+                return sd_sd_strv_extend_strv(p, l, false);
         }
 
         case SD_BUS_TYPE_BOOLEAN: {
diff '--color=auto' -Nurp a/src/shared/bus-polkit.c b/src/shared/bus-polkit.c
--- a/src/shared/bus-polkit.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/bus-polkit.c	2025-06-30 18:34:43.000000000 +0000
@@ -175,7 +175,7 @@ static AsyncPolkitQueryAction *async_pol
                 return NULL;
 
         free(a->action);
-        strv_free(a->details);
+        sd_strv_free(a->details);
 
         return mfree(a);
 }
@@ -600,7 +600,7 @@ int bus_verify_polkit_async_full(
 
         *q->action = (AsyncPolkitQueryAction) {
                 .action = strdup(action),
-                .details = strv_copy((char**) details),
+                .details = sd_strv_copy((char**) details),
         };
         if (!q->action->action || !q->action->details)
                 return -ENOMEM;
@@ -841,7 +841,7 @@ int varlink_verify_polkit_async_full(
 
         *q->action = (AsyncPolkitQueryAction) {
                 .action = strdup(action),
-                .details = strv_copy((char**) details),
+                .details = sd_strv_copy((char**) details),
         };
         if (!q->action->action || !q->action->details)
                 return -ENOMEM;
diff '--color=auto' -Nurp a/src/shared/bus-unit-util.c b/src/shared/bus-unit-util.c
--- a/src/shared/bus-unit-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/bus-unit-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -267,7 +267,7 @@ static int bus_append_parse_size(sd_bus_
 
 static int bus_append_exec_command(sd_bus_message *m, const char *field, const char *eq) {
         bool explicit_path = false, done = false;
-        _cleanup_strv_free_ char **l = NULL, **ex_opts = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL, **ex_opts = NULL;
         _cleanup_free_ char *path = NULL, *upgraded_name = NULL;
         ExecCommandFlags flags = 0;
         bool is_ex_prop = endswith(field, "Ex");
@@ -351,7 +351,7 @@ static int bus_append_exec_command(sd_bu
                         return log_error_errno(r, "Failed to parse path: %m");
         }
 
-        r = strv_split_full(&l, eq, NULL, EXTRACT_UNQUOTE|EXTRACT_CUNESCAPE);
+        r = sd_strv_split_full(&l, eq, NULL, EXTRACT_UNQUOTE|EXTRACT_CUNESCAPE);
         if (r < 0)
                 return log_error_errno(r, "Failed to parse command line: %m");
 
@@ -371,7 +371,7 @@ static int bus_append_exec_command(sd_bu
         if (r < 0)
                 return bus_log_create_error(r);
 
-        if (!strv_isempty(l)) {
+        if (!sd_strv_isempty(l)) {
 
                 r = sd_bus_message_open_container(m, 'r', is_ex_prop ? "sasas" : "sasb");
                 if (r < 0)
@@ -1818,7 +1818,7 @@ static int bus_append_execute_property(s
         }
 
         if (streq(field, "RootImageOptions")) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 const char *p = eq;
 
                 r = sd_bus_message_open_container(m, SD_BUS_TYPE_STRUCT, "sv");
@@ -1837,7 +1837,7 @@ static int bus_append_execute_property(s
                 if (r < 0)
                         return bus_log_create_error(r);
 
-                r = strv_split_colon_pairs(&l, p);
+                r = sd_strv_split_colon_pairs(&l, p);
                 if (r < 0)
                         return log_error_errno(r, "Failed to parse argument: %m");
 
@@ -2072,7 +2072,7 @@ static int bus_append_execute_property(s
         }
 
         if (STR_IN_SET(field, "StateDirectory", "RuntimeDirectory", "CacheDirectory", "LogsDirectory")) {
-                _cleanup_strv_free_ char **symlinks = NULL, **sources = NULL;
+                _cleanup_sd_strv_free_ char **symlinks = NULL, **sources = NULL;
                 const char *p = eq;
 
                 /* Adding new directories is supported from both *DirectorySymlink methods and the
@@ -2096,19 +2096,19 @@ static int bus_append_execute_property(s
                         path_simplify(source);
 
                         if (isempty(destination)) {
-                                r = strv_consume(&sources, TAKE_PTR(source));
+                                r = sd_strv_consume(&sources, TAKE_PTR(source));
                                 if (r < 0)
                                         return bus_log_create_error(r);
                         } else {
                                 path_simplify(destination);
 
-                                r = strv_consume_pair(&symlinks, TAKE_PTR(source), TAKE_PTR(destination));
+                                r = sd_strv_consume_pair(&symlinks, TAKE_PTR(source), TAKE_PTR(destination));
                                 if (r < 0)
                                         return log_oom();
                         }
                 }
 
-                if (!strv_isempty(sources)) {
+                if (!sd_strv_isempty(sources)) {
                         r = sd_bus_message_open_container(m, SD_BUS_TYPE_STRUCT, "sv");
                         if (r < 0)
                                 return bus_log_create_error(r);
@@ -2137,7 +2137,7 @@ static int bus_append_execute_property(s
                 /* For State and Runtime directories we support an optional destination parameter, which
                  * will be used to create a symlink to the source. But it is new so we cannot change the
                  * old DBUS signatures, so append a new message type. */
-                if (!strv_isempty(symlinks)) {
+                if (!sd_strv_isempty(symlinks)) {
                         const char *symlink_field;
 
                         r = sd_bus_message_open_container(m, SD_BUS_TYPE_STRUCT, "sv");
diff '--color=auto' -Nurp a/src/shared/bus-wait-for-jobs.c b/src/shared/bus-wait-for-jobs.c
--- a/src/shared/bus-wait-for-jobs.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/bus-wait-for-jobs.c	2025-06-30 18:37:55.000000000 +0000
@@ -179,10 +179,10 @@ static void log_job_error_with_service_r
 
         service_shell_quoted = shell_maybe_quote(service, 0);
 
-        if (!strv_isempty((char* const*) extra_args)) {
+        if (!sd_strv_isempty((char* const*) extra_args)) {
                 _cleanup_free_ char *t = NULL;
 
-                t = strv_join((char* const*) extra_args, " ");
+                t = sd_strv_join((char* const*) extra_args, " ");
                 systemctl = strjoina("systemctl ", t ?: "<args>");
                 journalctl = strjoina("journalctl ", t ?: "<args>");
         }
diff '--color=auto' -Nurp a/src/shared/cgroup-setup.c b/src/shared/cgroup-setup.c
--- a/src/shared/cgroup-setup.c	2025-06-30 18:55:45.267159937 +0000
+++ b/src/shared/cgroup-setup.c	2025-06-30 18:37:42.000000000 +0000
@@ -22,14 +22,14 @@
 
 static int cg_any_controller_used_for_v1(void) {
         _cleanup_free_ char *buf = NULL;
-        _cleanup_strv_free_ char **lines = NULL;
+        _cleanup_sd_strv_free_ char **lines = NULL;
         int r;
 
         r = read_full_virtual_file("/proc/cgroups", &buf, NULL);
         if (r < 0)
                 return log_debug_errno(r, "Could not read /proc/cgroups, ignoring: %m");
 
-        r = strv_split_newlines_full(&lines, buf, 0);
+        r = sd_strv_split_newlines_full(&lines, buf, 0);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/shared/condition.c b/src/shared/condition.c
--- a/src/shared/condition.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/condition.c	2025-06-30 18:33:48.000000000 +0000
@@ -108,7 +108,7 @@ Condition* condition_free_list_type(Cond
 }
 
 static int condition_test_kernel_command_line(Condition *c, char **env) {
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         int r;
 
         assert(c);
@@ -484,7 +484,7 @@ static int condition_test_architecture(C
 static int condition_test_firmware_devicetree_compatible(const char *dtcarg) {
         int r;
         _cleanup_free_ char *dtcompat = NULL;
-        _cleanup_strv_free_ char **dtcompatlist = NULL;
+        _cleanup_sd_strv_free_ char **dtcompatlist = NULL;
         size_t size;
 
         r = read_full_virtual_file(DTCOMPAT_FILE, &dtcompat, &size);
diff '--color=auto' -Nurp a/src/shared/conf-parser.c b/src/shared/conf-parser.c
--- a/src/shared/conf-parser.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/conf-parser.c	2025-06-30 18:36:37.000000000 +0000
@@ -613,7 +613,7 @@ int config_parse_many(
                 Hashmap **ret_stats_by_path,
                 char ***ret_dropin_files) {
 
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(conf_file_dirs);
@@ -646,11 +646,11 @@ int config_parse_standard_file_with_drop
                 char ***ret_dropin_files) {
 
         const char* const *conf_paths = (const char* const*) CONF_PATHS_STRV("");
-        _cleanup_strv_free_ char **configs = NULL;
+        _cleanup_sd_strv_free_ char **configs = NULL;
         int r;
 
         /* Build the list of main config files */
-        r = strv_extend_strv_biconcat(&configs, root, conf_paths, main_file);
+        r = sd_sd_strv_extend_strv_biconcat(&configs, root, conf_paths, main_file);
         if (r < 0) {
                 if (flags & CONFIG_PARSE_WARN)
                         log_oom();
@@ -683,7 +683,7 @@ static int dropins_get_stats_by_path(
                 const char* const* conf_file_dirs,
                 Hashmap **stats_by_path) {
 
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         _cleanup_free_ char *dropin_dirname = NULL;
         int r;
 
@@ -731,7 +731,7 @@ int config_get_stats_by_path(
                 Hashmap **ret) {
 
         _cleanup_hashmap_free_ Hashmap *stats_by_path = NULL;
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(suffix);
@@ -1252,7 +1252,7 @@ int config_parse_strv(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *sv = strv_free(*sv);
+                *sv = sd_strv_free(*sv);
                 return 0;
         }
 
@@ -1269,7 +1269,7 @@ int config_parse_strv(
                         return 0;
                 }
 
-                r = strv_consume(sv, word);
+                r = sd_strv_consume(sv, word);
                 if (r < 0)
                         return log_oom();
         }
@@ -1483,7 +1483,7 @@ int config_parse_ifnames(
                 void *data,
                 void *userdata) {
 
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         char ***s = ASSERT_PTR(data);
         int r;
 
@@ -1492,7 +1492,7 @@ int config_parse_ifnames(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *s = strv_free(*s);
+                *s = sd_strv_free(*s);
                 return 0;
         }
 
@@ -1518,12 +1518,12 @@ int config_parse_ifnames(
                         continue;
                 }
 
-                r = strv_consume(&names, TAKE_PTR(word));
+                r = sd_strv_consume(&names, TAKE_PTR(word));
                 if (r < 0)
                         return log_oom();
         }
 
-        r = strv_extend_strv(s, names, true);
+        r = sd_sd_strv_extend_strv(s, names, true);
         if (r < 0)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/shared/cryptsetup-fido2.c b/src/shared/cryptsetup-fido2.c
--- a/src/shared/cryptsetup-fido2.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/cryptsetup-fido2.c	2025-06-30 18:37:06.000000000 +0000
@@ -31,7 +31,7 @@ int acquire_fido2_key(
                 size_t *ret_decrypted_key_size) {
 
         _cleanup_(erase_and_freep) char *envpw = NULL;
-        _cleanup_strv_free_erase_ char **pins = NULL;
+        _cleanup_sd_strv_free_erase_ char **pins = NULL;
         _cleanup_free_ void *loaded_salt = NULL;
         bool device_exists = false;
         const char *salt;
@@ -74,7 +74,7 @@ int acquire_fido2_key(
         if (r < 0)
                 return log_error_errno(r, "Failed to acquire password from environment: %m");
         if (r > 0) {
-                pins = strv_new(envpw);
+                pins = sd_strv_new(envpw);
                 if (!pins)
                         return log_oom();
         }
@@ -125,7 +125,7 @@ int acquire_fido2_key(
                         .credential = "cryptsetup.fido2-pin",
                 };
 
-                pins = strv_free_erase(pins);
+                pins = sd_strv_free_erase(pins);
                 r = ask_password_auto(&req, until, askpw_flags, &pins);
                 if (r < 0)
                         return log_error_errno(r, "Failed to ask for user password: %m");
diff '--color=auto' -Nurp a/src/shared/cryptsetup-tpm2.c b/src/shared/cryptsetup-tpm2.c
--- a/src/shared/cryptsetup-tpm2.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/cryptsetup-tpm2.c	2025-06-30 18:35:00.000000000 +0000
@@ -18,7 +18,7 @@ static int get_pin(
                 AskPasswordFlags askpw_flags,
                 char **ret_pin_str) {
         _cleanup_(erase_and_freep) char *pin_str = NULL;
-        _cleanup_strv_free_erase_ char **pin = NULL;
+        _cleanup_sd_strv_free_erase_ char **pin = NULL;
         int r;
 
         assert(ret_pin_str);
@@ -40,11 +40,11 @@ static int get_pin(
                         .credential = askpw_credential,
                 };
 
-                pin = strv_free_erase(pin);
+                pin = sd_strv_free_erase(pin);
                 r = ask_password_auto(&req, until, askpw_flags, &pin);
                 if (r < 0)
                         return log_error_errno(r, "Failed to ask for user pin: %m");
-                assert(strv_length(pin) == 1);
+                assert(sd_strv_length(pin) == 1);
 
                 pin_str = strdup(pin[0]);
                 if (!pin_str)
diff '--color=auto' -Nurp a/src/shared/discover-image.c b/src/shared/discover-image.c
--- a/src/shared/discover-image.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/discover-image.c	2025-06-30 18:36:37.000000000 +0000
@@ -115,10 +115,10 @@ static Image *image_free(Image *i) {
         free(i->path);
 
         free(i->hostname);
-        strv_free(i->machine_info);
-        strv_free(i->os_release);
-        strv_free(i->sysext_release);
-        strv_free(i->confext_release);
+        sd_strv_free(i->machine_info);
+        sd_strv_free(i->os_release);
+        sd_strv_free(i->sysext_release);
+        sd_strv_free(i->confext_release);
 
         return mfree(i);
 }
@@ -128,7 +128,7 @@ DEFINE_HASH_OPS_WITH_VALUE_DESTRUCTOR(im
                                       Image, image_unref);
 
 static char **image_settings_path(Image *image) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         _cleanup_free_ char *fn = NULL;
         size_t i = 0;
         int r;
@@ -560,7 +560,7 @@ static const char *pick_image_search_pat
 }
 
 static char **make_possible_filenames(ImageClass class, const char *image_name) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         assert(image_name);
 
@@ -575,7 +575,7 @@ static char **make_possible_filenames(Im
                                 if (!j)
                                         return NULL;
 
-                                if (strv_consume(&l, TAKE_PTR(j)) < 0)
+                                if (sd_strv_consume(&l, TAKE_PTR(j)) < 0)
                                         return NULL;
                         }
 
@@ -583,7 +583,7 @@ static char **make_possible_filenames(Im
                         if (!j)
                                 return NULL;
 
-                        if (strv_consume(&l, TAKE_PTR(j)) < 0)
+                        if (sd_strv_consume(&l, TAKE_PTR(j)) < 0)
                                 return NULL;
                 }
 
@@ -605,7 +605,7 @@ int image_find(ImageClass class,
         if (!image_name_is_valid(name))
                 return -ENOENT;
 
-        _cleanup_strv_free_ char **names = make_possible_filenames(class, name);
+        _cleanup_sd_strv_free_ char **names = make_possible_filenames(class, name);
         if (!names)
                 return -ENOMEM;
 
@@ -936,7 +936,7 @@ int image_discover(
 
 int image_remove(Image *i) {
         _cleanup_(release_lock_file) LockFile global_lock = LOCK_FILE_INIT, local_lock = LOCK_FILE_INIT;
-        _cleanup_strv_free_ char **settings = NULL;
+        _cleanup_sd_strv_free_ char **settings = NULL;
         _cleanup_free_ char *roothash = NULL;
         int r;
 
@@ -1028,7 +1028,7 @@ static int rename_auxiliary_file(const c
 int image_rename(Image *i, const char *new_name) {
         _cleanup_(release_lock_file) LockFile global_lock = LOCK_FILE_INIT, local_lock = LOCK_FILE_INIT, name_lock = LOCK_FILE_INIT;
         _cleanup_free_ char *new_path = NULL, *nn = NULL, *roothash = NULL;
-        _cleanup_strv_free_ char **settings = NULL;
+        _cleanup_sd_strv_free_ char **settings = NULL;
         unsigned file_attr = 0;
         int r;
 
@@ -1149,7 +1149,7 @@ static int clone_auxiliary_file(const ch
 
 int image_clone(Image *i, const char *new_name, bool read_only) {
         _cleanup_(release_lock_file) LockFile name_lock = LOCK_FILE_INIT;
-        _cleanup_strv_free_ char **settings = NULL;
+        _cleanup_sd_strv_free_ char **settings = NULL;
         _cleanup_free_ char *roothash = NULL;
         const char *new_path;
         int r;
@@ -1461,7 +1461,7 @@ int image_read_metadata(Image *i, const
 
         case IMAGE_SUBVOLUME:
         case IMAGE_DIRECTORY: {
-                _cleanup_strv_free_ char **machine_info = NULL, **os_release = NULL, **sysext_release = NULL, **confext_release = NULL;
+                _cleanup_sd_strv_free_ char **machine_info = NULL, **os_release = NULL, **sysext_release = NULL, **confext_release = NULL;
                 _cleanup_free_ char *hostname = NULL, *path = NULL;
                 sd_id128_t machine_id = SD_ID128_NULL;
 
@@ -1513,10 +1513,10 @@ int image_read_metadata(Image *i, const
 
                 free_and_replace(i->hostname, hostname);
                 i->machine_id = machine_id;
-                strv_free_and_replace(i->machine_info, machine_info);
-                strv_free_and_replace(i->os_release, os_release);
-                strv_free_and_replace(i->sysext_release, sysext_release);
-                strv_free_and_replace(i->confext_release, confext_release);
+                sd_strv_free_and_replace(i->machine_info, machine_info);
+                sd_strv_free_and_replace(i->os_release, os_release);
+                sd_strv_free_and_replace(i->sysext_release, sysext_release);
+                sd_strv_free_and_replace(i->confext_release, confext_release);
                 break;
         }
 
@@ -1565,10 +1565,10 @@ int image_read_metadata(Image *i, const
 
                 free_and_replace(i->hostname, m->hostname);
                 i->machine_id = m->machine_id;
-                strv_free_and_replace(i->machine_info, m->machine_info);
-                strv_free_and_replace(i->os_release, m->os_release);
-                strv_free_and_replace(i->sysext_release, m->sysext_release);
-                strv_free_and_replace(i->confext_release, m->confext_release);
+                sd_strv_free_and_replace(i->machine_info, m->machine_info);
+                sd_strv_free_and_replace(i->os_release, m->os_release);
+                sd_strv_free_and_replace(i->sysext_release, m->sysext_release);
+                sd_strv_free_and_replace(i->confext_release, m->confext_release);
 
                 break;
         }
diff '--color=auto' -Nurp a/src/shared/dissect-image.c b/src/shared/dissect-image.c
--- a/src/shared/dissect-image.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/dissect-image.c	2025-06-30 18:37:42.000000000 +0000
@@ -91,9 +91,9 @@ int dissect_fstype_ok(const char *fstype
 
         e = secure_getenv("SYSTEMD_DISSECT_FILE_SYSTEMS");
         if (e) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
-                l = strv_split(e, ":");
+                l = sd_strv_split(e, ":");
                 if (!l)
                         return -ENOMEM;
 
@@ -1719,11 +1719,11 @@ DissectedImage* dissected_image_unref(Di
 
         free(m->image_name);
         free(m->hostname);
-        strv_free(m->machine_info);
-        strv_free(m->os_release);
-        strv_free(m->initrd_release);
-        strv_free(m->confext_release);
-        strv_free(m->sysext_release);
+        sd_strv_free(m->machine_info);
+        sd_strv_free(m->os_release);
+        sd_strv_free(m->initrd_release);
+        sd_strv_free(m->confext_release);
+        sd_strv_free(m->sysext_release);
 
         return mfree(m);
 }
@@ -2622,7 +2622,7 @@ static int validate_signature_userspace(
 
 #if HAVE_OPENSSL
         _cleanup_(sk_X509_free_allp) STACK_OF(X509) *sk = NULL;
-        _cleanup_strv_free_ char **certs = NULL;
+        _cleanup_sd_strv_free_ char **certs = NULL;
         _cleanup_(PKCS7_freep) PKCS7 *p7 = NULL;
         _cleanup_free_ char *s = NULL;
         _cleanup_(BIO_freep) BIO *bio = NULL; /* 'bio' must be freed first, 's' second, hence keep this order
@@ -2639,7 +2639,7 @@ static int validate_signature_userspace(
         r = conf_files_list_nulstr(&certs, ".crt", NULL, CONF_FILES_REGULAR|CONF_FILES_FILTER_MASKED, CONF_PATHS_NULSTR("verity.d"));
         if (r < 0)
                 return log_debug_errno(r, "Failed to enumerate certificates: %m");
-        if (strv_isempty(certs)) {
+        if (sd_strv_isempty(certs)) {
                 log_debug("No userspace dm-verity certificates found.");
                 return 0;
         }
@@ -3053,7 +3053,7 @@ int dissected_image_decrypt_interactivel
                 const VeritySettings *verity,
                 DissectImageFlags flags) {
 
-        _cleanup_strv_free_erase_ char **z = NULL;
+        _cleanup_sd_strv_free_erase_ char **z = NULL;
         int n = 3, r;
 
         if (passphrase)
@@ -3072,7 +3072,7 @@ int dissected_image_decrypt_interactivel
                         return log_error_errno(SYNTHETIC_ERRNO(EKEYREJECTED),
                                                "Too many retries.");
 
-                z = strv_free_erase(z);
+                z = sd_strv_free_erase(z);
 
                 static const AskPasswordRequest req = {
                         .message = "Please enter image passphrase:",
@@ -3085,7 +3085,7 @@ int dissected_image_decrypt_interactivel
                 if (r < 0)
                         return log_error_errno(r, "Failed to query for passphrase: %m");
 
-                assert(!strv_isempty(z));
+                assert(!sd_strv_isempty(z));
                 passphrase = z[0];
         }
 }
@@ -3479,7 +3479,7 @@ int dissected_image_acquire_metadata(
                 [META_HAS_INIT_SYSTEM]   = "has-init-system\0",      /* ditto */
         };
 
-        _cleanup_strv_free_ char **machine_info = NULL, **os_release = NULL, **initrd_release = NULL, **sysext_release = NULL, **confext_release = NULL;
+        _cleanup_sd_strv_free_ char **machine_info = NULL, **os_release = NULL, **initrd_release = NULL, **sysext_release = NULL, **confext_release = NULL;
         _cleanup_free_ char *hostname = NULL, *t = NULL;
         _cleanup_close_pair_ int error_pipe[2] = EBADF_PAIR;
         _cleanup_(sigkill_waitp) pid_t child = 0;
@@ -3764,11 +3764,11 @@ int dissected_image_acquire_metadata(
 
         free_and_replace(m->hostname, hostname);
         m->machine_id = machine_id;
-        strv_free_and_replace(m->machine_info, machine_info);
-        strv_free_and_replace(m->os_release, os_release);
-        strv_free_and_replace(m->initrd_release, initrd_release);
-        strv_free_and_replace(m->sysext_release, sysext_release);
-        strv_free_and_replace(m->confext_release, confext_release);
+        sd_strv_free_and_replace(m->machine_info, machine_info);
+        sd_strv_free_and_replace(m->os_release, os_release);
+        sd_strv_free_and_replace(m->initrd_release, initrd_release);
+        sd_strv_free_and_replace(m->sysext_release, sysext_release);
+        sd_strv_free_and_replace(m->confext_release, confext_release);
         m->has_init_system = has_init_system;
 
 finish:
@@ -4141,7 +4141,7 @@ int verity_dissect_and_mount(
          * available, or else fallback to VERSION_ID. If neither is present (eg: rolling release),
          * then a simple match on the ID will be performed. */
         if (required_host_os_release_id) {
-                _cleanup_strv_free_ char **extension_release = NULL;
+                _cleanup_sd_strv_free_ char **extension_release = NULL;
                 ImageClass class = IMAGE_SYSEXT;
 
                 assert(!isempty(required_host_os_release_id));
diff '--color=auto' -Nurp a/src/shared/dissect-image.h b/src/shared/dissect-image.h
--- a/src/shared/dissect-image.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/dissect-image.h	2025-06-30 18:37:25.000000000 +0000
@@ -190,7 +190,7 @@ static inline bool dissected_image_is_po
 }
 
 static inline bool dissected_image_is_initrd(DissectedImage *m) {
-        return m && !strv_isempty(m->initrd_release);
+        return m && !sd_strv_isempty(m->initrd_release);
 }
 
 DecryptedImage* decrypted_image_ref(DecryptedImage *p);
diff '--color=auto' -Nurp a/src/shared/dropin.c b/src/shared/dropin.c
--- a/src/shared/dropin.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/dropin.c	2025-06-30 18:37:25.000000000 +0000
@@ -118,7 +118,7 @@ static int unit_file_add_dir(
         if (r < 0)
                 return log_warning_errno(r, "Failed to canonicalize path '%s': %m", path);
 
-        if (strv_consume(dirs, TAKE_PTR(chased)) < 0)
+        if (sd_strv_consume(dirs, TAKE_PTR(chased)) < 0)
                 return log_oom();
 
         return 0;
@@ -231,7 +231,7 @@ int unit_file_find_dropin_paths(
                 const Set *aliases,
                 char ***ret) {
 
-        _cleanup_strv_free_ char **dirs = NULL;
+        _cleanup_sd_strv_free_ char **dirs = NULL;
         const char *n;
         int r;
 
@@ -266,7 +266,7 @@ int unit_file_find_dropin_paths(
                                                    &dirs);
         }
 
-        if (strv_isempty(dirs)) {
+        if (sd_strv_isempty(dirs)) {
                 *ret = NULL;
                 return 0;
         }
diff '--color=auto' -Nurp a/src/shared/edit-util.c b/src/shared/edit-util.c
--- a/src/shared/edit-util.c	2025-06-30 18:55:45.443159933 +0000
+++ b/src/shared/edit-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -47,7 +47,7 @@ void edit_file_context_done(EditFileCont
 
                 free(i->path);
                 free(i->original_path);
-                strv_free(i->comment_paths);
+                sd_strv_free(i->comment_paths);
         }
 
         context->files = mfree(context->files);
@@ -72,7 +72,7 @@ int edit_files_add(
                 char * const *comment_paths) {
 
         _cleanup_free_ char *new_path = NULL, *new_original_path = NULL;
-        _cleanup_strv_free_ char **new_comment_paths = NULL;
+        _cleanup_sd_strv_free_ char **new_comment_paths = NULL;
 
         assert(context);
         assert(path);
@@ -94,7 +94,7 @@ int edit_files_add(
         }
 
         if (comment_paths) {
-                new_comment_paths = strv_copy(comment_paths);
+                new_comment_paths = sd_strv_copy(comment_paths);
                 if (!new_comment_paths)
                         return log_oom();
         }
@@ -234,7 +234,7 @@ static int create_edit_temp_file(EditFil
 }
 
 static int run_editor_child(const EditFileContext *context) {
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         const char *editor;
         int r;
 
@@ -248,9 +248,9 @@ static int run_editor_child(const EditFi
                 editor = getenv("VISUAL");
 
         if (!isempty(editor)) {
-                _cleanup_strv_free_ char **editor_args = NULL;
+                _cleanup_sd_strv_free_ char **editor_args = NULL;
 
-                editor_args = strv_split(editor, WHITESPACE);
+                editor_args = sd_strv_split(editor, WHITESPACE);
                 if (!editor_args)
                         return log_oom();
 
@@ -259,13 +259,13 @@ static int run_editor_child(const EditFi
 
         if (context->n_files == 1 && context->files[0].line > 1) {
                 /* If editing a single file only, use the +LINE syntax to put cursor on the right line */
-                r = strv_extendf(&args, "+%u", context->files[0].line);
+                r = sd_sd_strv_extendf(&args, "+%u", context->files[0].line);
                 if (r < 0)
                         return log_oom();
         }
 
         FOREACH_ARRAY(i, context->files, context->n_files) {
-                r = strv_extend(&args, i->temp);
+                r = sd_strv_extend(&args, i->temp);
                 if (r < 0)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/shared/efi-loader.c b/src/shared/efi-loader.c
--- a/src/shared/efi-loader.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/efi-loader.c	2025-06-30 18:36:37.000000000 +0000
@@ -89,7 +89,7 @@ int efi_loader_get_device_part_uuid(sd_i
 
 int efi_loader_get_entries(char ***ret) {
         _cleanup_free_ char16_t *entries = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         size_t size;
         int r;
 
@@ -128,7 +128,7 @@ int efi_loader_get_entries(char ***ret)
                         return -ENOMEM;
 
                 if (efi_loader_entry_name_valid(decoded)) {
-                        r = strv_consume(&l, TAKE_PTR(decoded));
+                        r = sd_strv_consume(&l, TAKE_PTR(decoded));
                         if (r < 0)
                                 return r;
                 } else
diff '--color=auto' -Nurp a/src/shared/exec-util.c b/src/shared/exec-util.c
--- a/src/shared/exec-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/exec-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -251,7 +251,7 @@ int execute_strv(
 
         assert(!FLAGS_SET(flags, EXEC_DIR_PARALLEL | EXEC_DIR_SKIP_REMAINING));
 
-        if (strv_isempty(paths))
+        if (sd_strv_isempty(paths))
                 return 0;
 
         if (callbacks) {
@@ -305,17 +305,17 @@ int execute_directories(
                 char *envp[],
                 ExecDirFlags flags) {
 
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         _cleanup_free_ char *name = NULL;
         int r;
 
-        assert(!strv_isempty((char**) directories));
+        assert(!sd_strv_isempty((char**) directories));
 
         r = conf_files_list_strv(&paths, NULL, NULL, CONF_FILES_EXECUTABLE|CONF_FILES_REGULAR|CONF_FILES_FILTER_MASKED, directories);
         if (r < 0)
                 return log_error_errno(r, "Failed to enumerate executables: %m");
 
-        if (strv_isempty(paths)) {
+        if (sd_strv_isempty(paths)) {
                 log_debug("No executables found.");
                 return 0;
         }
@@ -332,7 +332,7 @@ int execute_directories(
 static int gather_environment_generate(int fd, void *arg) {
         char ***env = ASSERT_PTR(arg);
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **new = NULL;
+        _cleanup_sd_strv_free_ char **new = NULL;
         int r;
 
         /* Read a series of VAR=value assignments from fd, use them to update the list of
@@ -455,7 +455,7 @@ int exec_command_flags_from_strv(char **
 }
 
 int exec_command_flags_to_strv(ExecCommandFlags flags, char ***ex_opts) {
-        _cleanup_strv_free_ char **ret_opts = NULL;
+        _cleanup_sd_strv_free_ char **ret_opts = NULL;
         ExecCommandFlags it = flags;
         const char *str;
         int r;
@@ -471,7 +471,7 @@ int exec_command_flags_to_strv(ExecComma
                         if (!str)
                                 return -EINVAL;
 
-                        r = strv_extend(&ret_opts, str);
+                        r = sd_strv_extend(&ret_opts, str);
                         if (r < 0)
                                 return r;
                 }
@@ -520,7 +520,7 @@ int fexecve_or_execve(int executable_fd,
                 return -EBADF;
 
         /* Block any attempts on exploiting Linux' liberal argv[] handling, i.e. CVE-2021-4034 and suchlike */
-        if (isempty(executable) || strv_isempty(argv))
+        if (isempty(executable) || sd_strv_isempty(argv))
                 return -EINVAL;
 
 #if ENABLE_FEXECVE
diff '--color=auto' -Nurp a/src/shared/extension-util.c b/src/shared/extension-util.c
--- a/src/shared/extension-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/extension-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -26,19 +26,19 @@ int extension_release_validate(
         assert(!isempty(host_os_release_id));
 
         /* Now that we can look into the extension/confext image, let's see if the OS version is compatible */
-        if (strv_isempty(extension_release)) {
+        if (sd_strv_isempty(extension_release)) {
                 log_debug("Extension '%s' carries no release data, ignoring.", name);
                 return 0;
         }
 
         if (host_extension_scope) {
-                _cleanup_strv_free_ char **scope_list = NULL;
+                _cleanup_sd_strv_free_ char **scope_list = NULL;
                 const char *scope;
                 bool valid;
 
                 scope = strv_env_pairs_get(extension_release, extension_scope);
                 if (scope) {
-                        scope_list = strv_split(scope, WHITESPACE);
+                        scope_list = sd_strv_split(scope, WHITESPACE);
                         if (!scope_list)
                                 return -ENOMEM;
                 }
@@ -132,13 +132,13 @@ int parse_env_extension_hierarchies(char
         if (r == -ENXIO) {
                 if (streq(hierarchy_env, "SYSTEMD_CONFEXT_HIERARCHIES"))
                         /* Default for confext when unset */
-                        l = strv_new("/etc");
+                        l = sd_strv_new("/etc");
                 else if (streq(hierarchy_env, "SYSTEMD_SYSEXT_HIERARCHIES"))
                         /* Default for sysext when unset */
-                        l = strv_new("/usr", "/opt");
+                        l = sd_strv_new("/usr", "/opt");
                 else if (streq(hierarchy_env, "SYSTEMD_SYSEXT_AND_CONFEXT_HIERARCHIES"))
                         /* Combined sysext and confext directories */
-                        l = strv_new("/usr", "/opt", "/etc");
+                        l = sd_strv_new("/usr", "/opt", "/etc");
                 else
                         return -ENXIO;
         } else if (r < 0)
diff '--color=auto' -Nurp a/src/shared/format-table.c b/src/shared/format-table.c
--- a/src/shared/format-table.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/format-table.c	2025-06-30 18:37:55.000000000 +0000
@@ -250,7 +250,7 @@ static TableData *table_data_free(TableD
         free(d->url);
 
         if (IN_SET(d->type, TABLE_STRV, TABLE_STRV_WRAPPED))
-                strv_free(d->strv);
+                sd_strv_free(d->strv);
 
         return mfree(d);
 }
@@ -445,7 +445,7 @@ static TableData *table_data_new(
         d->uppercase = uppercase;
 
         if (IN_SET(type, TABLE_STRV, TABLE_STRV_WRAPPED)) {
-                d->strv = strv_copy(data);
+                d->strv = sd_strv_copy(data);
                 if (!d->strv)
                         return NULL;
         } else
@@ -1608,16 +1608,16 @@ static const char *table_data_format(Tab
         }
 
         case TABLE_STRV:
-                if (strv_isempty(d->strv))
+                if (sd_strv_isempty(d->strv))
                         return table_ersatz_string(t);
 
-                d->formatted = strv_join(d->strv, "\n");
+                d->formatted = sd_strv_join(d->strv, "\n");
                 if (!d->formatted)
                         return NULL;
                 break;
 
         case TABLE_STRV_WRAPPED: {
-                if (strv_isempty(d->strv))
+                if (sd_strv_isempty(d->strv))
                         return table_ersatz_string(t);
 
                 char *buf = format_strv_width(d->strv, column_width);
@@ -2183,7 +2183,7 @@ static bool table_data_isempty(TableData
 
         /* Let's also consider an empty strv as truly empty. */
         if (IN_SET(d->type, TABLE_STRV, TABLE_STRV_WRAPPED))
-                return strv_isempty(d->strv);
+                return sd_strv_isempty(d->strv);
 
         /* Note that an empty string we do not consider empty here! */
         return false;
diff '--color=auto' -Nurp a/src/shared/fstab-util.c b/src/shared/fstab-util.c
--- a/src/shared/fstab-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/fstab-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -174,7 +174,7 @@ int fstab_filter_options(
                 char ***ret_values,
                 char **ret_filtered) {
 
-        _cleanup_strv_free_ char **values = NULL;
+        _cleanup_sd_strv_free_ char **values = NULL;
         _cleanup_free_ char *value = NULL, *filtered = NULL;
         const char *namefound = NULL;
         int r;
@@ -196,12 +196,12 @@ int fstab_filter_options(
          * Returns negative on error, true if any matching options were found, false otherwise. */
 
         if (ret_value || ret_values || ret_filtered) {
-                _cleanup_strv_free_ char **opts_split = NULL;
+                _cleanup_sd_strv_free_ char **opts_split = NULL;
                 _cleanup_free_ char **filtered_strv = NULL; /* strings are owned by 'opts_split' */
 
                 /* For backwards compatibility, we need to pass-through escape characters.
                  * The only ones we "consume" are the ones used as "\," or "\\". */
-                r = strv_split_full(&opts_split, opts, ",", EXTRACT_UNESCAPE_SEPARATORS|EXTRACT_UNESCAPE_RELAX);
+                r = sd_strv_split_full(&opts_split, opts, ",", EXTRACT_UNESCAPE_SEPARATORS|EXTRACT_UNESCAPE_RELAX);
                 if (r < 0)
                         return r;
 
@@ -226,16 +226,16 @@ int fstab_filter_options(
                                 if (ret_value)
                                         r = free_and_strdup(&value, *x == '=' ? x + 1 : NULL);
                                 else if (ret_values)
-                                        r = strv_extend(&values, x + 1);
+                                        r = sd_strv_extend(&values, x + 1);
                                 else
                                         r = 0;
                         } else
-                                r = strv_push(&filtered_strv, *opt);
+                                r = sd_strv_push(&filtered_strv, *opt);
                         if (r < 0)
                                 return r;
                 }
 
-                filtered = strv_join_full(filtered_strv, ",", NULL, /* escape_separator = */ true);
+                filtered = sd_strv_join_full(filtered_strv, ",", NULL, /* escape_separator = */ true);
                 if (!filtered)
                         return -ENOMEM;
         } else
diff '--color=auto' -Nurp a/src/shared/group-record.c b/src/shared/group-record.c
--- a/src/shared/group-record.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/group-record.c	2025-06-30 18:33:48.000000000 +0000
@@ -31,10 +31,10 @@ static GroupRecord *group_record_free(Gr
         free(g->group_name_and_realm_auto);
         free(g->description);
 
-        strv_free(g->members);
+        sd_strv_free(g->members);
         free(g->service);
-        strv_free(g->administrators);
-        strv_free_erase(g->hashed_password);
+        sd_strv_free(g->administrators);
+        sd_strv_free_erase(g->hashed_password);
 
         json_variant_unref(g->json);
 
diff '--color=auto' -Nurp a/src/shared/hwdb-util.c b/src/shared/hwdb-util.c
--- a/src/shared/hwdb-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/hwdb-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -465,7 +465,7 @@ static int import_file(struct trie *trie
                 HW_DATA,
         } state = HW_NONE;
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **match_list = NULL;
+        _cleanup_sd_strv_free_ char **match_list = NULL;
         uint32_t line_number = 0;
         int r;
 
@@ -515,7 +515,7 @@ static int import_file(struct trie *trie
                         /* start of record, first match */
                         state = HW_MATCH;
 
-                        r = strv_extend(&match_list, line);
+                        r = sd_strv_extend(&match_list, line);
                         if (r < 0)
                                 return r;
                         break;
@@ -525,13 +525,13 @@ static int import_file(struct trie *trie
                                 log_syntax(NULL, LOG_WARNING, filename, line_number, 0,
                                            "Property expected, ignoring record with no properties.");
                                 state = HW_NONE;
-                                match_list = strv_free(match_list);
+                                match_list = sd_strv_free(match_list);
                                 break;
                         }
 
                         if (line[0] != ' ') {
                                 /* another match */
-                                r = strv_extend(&match_list, line);
+                                r = sd_strv_extend(&match_list, line);
                                 if (r < 0)
                                         return r;
                                 break;
@@ -546,7 +546,7 @@ static int import_file(struct trie *trie
                         if (len == 0) {
                                 /* end of record */
                                 state = HW_NONE;
-                                match_list = strv_free(match_list);
+                                match_list = sd_strv_free(match_list);
                                 break;
                         }
 
@@ -554,7 +554,7 @@ static int import_file(struct trie *trie
                                 log_syntax(NULL, LOG_WARNING, filename, line_number, 0,
                                            "Property or empty line expected, got \"%s\", ignoring record.", line);
                                 state = HW_NONE;
-                                match_list = strv_free(match_list);
+                                match_list = sd_strv_free(match_list);
                                 break;
                         }
 
@@ -573,7 +573,7 @@ static int import_file(struct trie *trie
 int hwdb_update(const char *root, const char *hwdb_bin_dir, bool strict, bool compat) {
         _cleanup_free_ char *hwdb_bin = NULL;
         _cleanup_(trie_freep) struct trie *trie = NULL;
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         uint16_t file_priority = 1;
         int r = 0, err;
 
@@ -606,7 +606,7 @@ int hwdb_update(const char *root, const
         if (err < 0)
                 return log_error_errno(err, "Failed to enumerate hwdb files: %m");
 
-        if (strv_isempty(files)) {
+        if (sd_strv_isempty(files)) {
                 if (unlink(hwdb_bin) < 0) {
                         if (errno != ENOENT)
                                 return log_error_errno(errno, "Failed to remove compiled hwdb database %s: %m", hwdb_bin);
diff '--color=auto' -Nurp a/src/shared/image-policy.c b/src/shared/image-policy.c
--- a/src/shared/image-policy.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/image-policy.c	2025-06-30 18:37:55.000000000 +0000
@@ -440,7 +440,7 @@ int partition_policy_flags_to_string(Par
                 assert(m+1 < ELEMENTSOF(l));
                 l[m] = NULL;
 
-                buf = strv_join((char**) l, "+");
+                buf = sd_strv_join((char**) l, "+");
         }
         if (!buf)
                 return -ENOMEM;
diff '--color=auto' -Nurp a/src/shared/install.c b/src/shared/install.c
--- a/src/shared/install.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/install.c	2025-06-30 18:37:42.000000000 +0000
@@ -72,23 +72,23 @@ DEFINE_STRING_TABLE_LOOKUP_TO_STRING(pre
 static bool install_info_has_rules(const InstallInfo *i) {
         assert(i);
 
-        return !strv_isempty(i->aliases) ||
-               !strv_isempty(i->wanted_by) ||
-               !strv_isempty(i->required_by) ||
-               !strv_isempty(i->upheld_by);
+        return !sd_strv_isempty(i->aliases) ||
+               !sd_strv_isempty(i->wanted_by) ||
+               !sd_strv_isempty(i->required_by) ||
+               !sd_strv_isempty(i->upheld_by);
 }
 
 static bool install_info_has_also(const InstallInfo *i) {
         assert(i);
 
-        return !strv_isempty(i->also);
+        return !sd_strv_isempty(i->also);
 }
 
 static void unit_file_preset_rule_done(UnitFilePresetRule *rule) {
         assert(rule);
 
         free(rule->pattern);
-        strv_free(rule->instances);
+        sd_strv_free(rule->instances);
 }
 
 void unit_file_presets_done(UnitFilePresets *p) {
@@ -1120,11 +1120,11 @@ static void install_info_clear(InstallIn
         i->name = mfree(i->name);
         i->path = mfree(i->path);
         i->root = mfree(i->root);
-        i->aliases = strv_free(i->aliases);
-        i->wanted_by = strv_free(i->wanted_by);
-        i->required_by = strv_free(i->required_by);
-        i->upheld_by = strv_free(i->upheld_by);
-        i->also = strv_free(i->also);
+        i->aliases = sd_strv_free(i->aliases);
+        i->wanted_by = sd_strv_free(i->wanted_by);
+        i->required_by = sd_strv_free(i->required_by);
+        i->upheld_by = sd_strv_free(i->upheld_by);
+        i->also = sd_strv_free(i->also);
         i->default_instance = mfree(i->default_instance);
         i->symlink_target = mfree(i->symlink_target);
 }
@@ -1314,7 +1314,7 @@ static int config_parse_also(
                 if (r < 0)
                         return r;
 
-                r = strv_push(&info->also, printed);
+                r = sd_strv_push(&info->also, printed);
                 if (r < 0)
                         return r;
 
@@ -1482,10 +1482,10 @@ static int unit_file_load(
                 info->install_mode = INSTALL_MODE_REGULAR;
 
         return
-                (int) strv_length(info->aliases) +
-                (int) strv_length(info->wanted_by) +
-                (int) strv_length(info->required_by) +
-                (int) strv_length(info->upheld_by);
+                (int) sd_strv_length(info->aliases) +
+                (int) sd_strv_length(info->wanted_by) +
+                (int) sd_strv_length(info->required_by) +
+                (int) sd_strv_length(info->upheld_by);
 }
 
 static int unit_file_load_or_readlink(
@@ -1528,7 +1528,7 @@ static int unit_file_search(
                 SearchFlags flags) {
 
         const char *dropin_dir_name = NULL, *dropin_template_dir_name = NULL;
-        _cleanup_strv_free_ char **dirs = NULL, **files = NULL;
+        _cleanup_sd_strv_free_ char **dirs = NULL, **files = NULL;
         _cleanup_free_ char *template = NULL;
         bool found_unit = false;
         int r, result;
@@ -1610,7 +1610,7 @@ static int unit_file_search(
                 if (!path)
                         return -ENOMEM;
 
-                r = strv_consume(&dirs, path);
+                r = sd_strv_consume(&dirs, path);
                 if (r < 0)
                         return r;
         }
@@ -1624,7 +1624,7 @@ static int unit_file_search(
                         if (!path)
                                 return -ENOMEM;
 
-                        r = strv_consume(&dirs, path);
+                        r = sd_strv_consume(&dirs, path);
                         if (r < 0)
                                 return r;
                 }
@@ -2020,7 +2020,7 @@ static int install_info_symlink_wants(
         assert(lp);
         assert(config_path);
 
-        if (strv_isempty(list))
+        if (sd_strv_isempty(list))
                 return 0;
 
         if (unit_name_is_valid(info->name, UNIT_NAME_PLAIN | UNIT_NAME_INSTANCE))
@@ -2363,7 +2363,7 @@ int unit_file_unmask(
 
         _cleanup_(lookup_paths_done) LookupPaths lp = {};
         _cleanup_set_free_free_ Set *remove_symlinks_to = NULL;
-        _cleanup_strv_free_ char **todo = NULL;
+        _cleanup_sd_strv_free_ char **todo = NULL;
         const char *config_path;
         size_t n_todo = 0;
         int r, q;
@@ -2474,7 +2474,7 @@ int unit_file_link(
                 size_t *n_changes) {
 
         _cleanup_(lookup_paths_done) LookupPaths lp = {};
-        _cleanup_strv_free_ char **todo = NULL;
+        _cleanup_sd_strv_free_ char **todo = NULL;
         const char *config_path;
         size_t n_todo = 0;
         int r;
@@ -2580,7 +2580,7 @@ int unit_file_revert(
 
         _cleanup_set_free_free_ Set *remove_symlinks_to = NULL;
         _cleanup_(lookup_paths_done) LookupPaths lp = {};
-        _cleanup_strv_free_ char **todo = NULL;
+        _cleanup_sd_strv_free_ char **todo = NULL;
         size_t n_todo = 0;
         int r, q;
 
@@ -2683,7 +2683,7 @@ int unit_file_revert(
 
         r = 0;
         STRV_FOREACH(i, todo) {
-                _cleanup_strv_free_ char **fs = NULL;
+                _cleanup_sd_strv_free_ char **fs = NULL;
                 const char *rp;
 
                 (void) get_files_in_directory(*i, &fs);
@@ -2788,8 +2788,8 @@ int unit_file_add_dependency(
                 else
                         l = &info->upheld_by;
 
-                strv_free(*l);
-                *l = strv_new(target_info->name);
+                sd_strv_free(*l);
+                *l = sd_strv_new(target_info->name);
                 if (!*l)
                         return -ENOMEM;
         }
@@ -2938,7 +2938,7 @@ static int normalize_linked_files(
          * but operates on real unit names. For each argument we look up the actual path
          * where the unit is found. This way linked units can be re-enabled successfully. */
 
-        _cleanup_strv_free_ char **files = NULL, **names = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL, **names = NULL;
         int r;
 
         STRV_FOREACH(a, names_or_paths) {
@@ -2959,7 +2959,7 @@ static int normalize_linked_files(
                                 log_debug_errno(r, "Failed to discover unit \"%s\", operating on name: %m", n);
                 }
 
-                r = strv_consume(&names, TAKE_PTR(n));
+                r = sd_strv_consume(&names, TAKE_PTR(n));
                 if (r < 0)
                         return r;
 
@@ -2975,7 +2975,7 @@ static int normalize_linked_files(
                          */
                         p = startswith(i->path, i->root);
 
-                r = strv_extend(&files, p ?: *a);
+                r = sd_strv_extend(&files, p ?: *a);
                 if (r < 0)
                         return r;
         }
@@ -2994,7 +2994,7 @@ int unit_file_reenable(
                 size_t *n_changes) {
 
         _cleanup_(lookup_paths_done) LookupPaths lp = {};
-        _cleanup_strv_free_ char **names = NULL, **files = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL, **files = NULL;
         int r;
 
         assert(scope >= 0);
@@ -3241,7 +3241,7 @@ int unit_file_exists_full(RuntimeScope s
 }
 
 static int split_pattern_into_name_and_instances(const char *pattern, char **out_unit_name, char ***out_instances) {
-        _cleanup_strv_free_ char **instances = NULL;
+        _cleanup_sd_strv_free_ char **instances = NULL;
         _cleanup_free_ char *unit_name = NULL;
         int r;
 
@@ -3261,7 +3261,7 @@ static int split_pattern_into_name_and_i
                 if (!unit_name_is_valid(unit_name, UNIT_NAME_TEMPLATE))
                         return -EINVAL;
 
-                instances = strv_split(pattern, WHITESPACE);
+                instances = sd_strv_split(pattern, WHITESPACE);
                 if (!instances)
                         return -ENOMEM;
 
@@ -3293,7 +3293,7 @@ static int presets_find_config(RuntimeSc
 
 static int read_presets(RuntimeScope scope, const char *root_dir, UnitFilePresets *presets) {
         _cleanup_(unit_file_presets_done) UnitFilePresets ps = {};
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(scope >= 0);
@@ -3420,7 +3420,7 @@ static int pattern_match_multiple_instan
 
         /* Compose a list of specified instances when unit name is a template  */
         if (unit_name_is_valid(unit_name, UNIT_NAME_TEMPLATE)) {
-                _cleanup_strv_free_ char **out_strv = NULL;
+                _cleanup_sd_strv_free_ char **out_strv = NULL;
 
                 STRV_FOREACH(iter, rule.instances) {
                         _cleanup_free_ char *name = NULL;
@@ -3429,7 +3429,7 @@ static int pattern_match_multiple_instan
                         if (r < 0)
                                 return r;
 
-                        r = strv_consume(&out_strv, TAKE_PTR(name));
+                        r = sd_strv_consume(&out_strv, TAKE_PTR(name));
                         if (r < 0)
                                 return r;
                 }
@@ -3559,7 +3559,7 @@ static int preset_prepare_one(
                 size_t *n_changes) {
 
         _cleanup_(install_context_done) InstallContext tmp = { .scope = scope };
-        _cleanup_strv_free_ char **instance_name_list = NULL;
+        _cleanup_sd_strv_free_ char **instance_name_list = NULL;
         InstallInfo *info;
         int r;
 
@@ -3792,7 +3792,7 @@ int unit_file_get_list(
                         if (r < 0)
                                 f->state = UNIT_FILE_BAD;
 
-                        if (!strv_isempty(states) &&
+                        if (!sd_strv_isempty(states) &&
                             !strv_contains(states, unit_file_state_to_string(f->state)))
                                 continue;
 
diff '--color=auto' -Nurp a/src/shared/journal-util.c b/src/shared/journal-util.c
--- a/src/shared/journal-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/journal-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -31,7 +31,7 @@ static int access_check_var_log_journal(
                 return 0;
 
 #if HAVE_ACL
-        _cleanup_strv_free_ char **g = NULL;
+        _cleanup_sd_strv_free_ char **g = NULL;
         const char* dir;
 
         if (laccess("/run/log/journal", F_OK) >= 0)
@@ -50,18 +50,18 @@ static int access_check_var_log_journal(
                 return 0;
 
         /* Print a pretty list, if there were ACLs set. */
-        if (!strv_isempty(g)) {
+        if (!sd_strv_isempty(g)) {
                 _cleanup_free_ char *s = NULL;
 
                 /* There are groups in the ACL, let's list them */
-                r = strv_extend(&g, "systemd-journal");
+                r = sd_strv_extend(&g, "systemd-journal");
                 if (r < 0)
                         return log_oom();
 
                 strv_sort(g);
                 strv_uniq(g);
 
-                s = strv_join(g, "', '");
+                s = sd_strv_join(g, "', '");
                 if (!s)
                         return log_oom();
 
diff '--color=auto' -Nurp a/src/shared/json.c b/src/shared/json.c
--- a/src/shared/json.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/json.c	2025-06-30 18:37:25.000000000 +0000
@@ -655,7 +655,7 @@ int json_variant_new_array_strv(JsonVari
 
         assert(ret);
 
-        n = strv_length(l);
+        n = sd_strv_length(l);
         if (n == 0) {
                 *ret = JSON_VARIANT_MAGIC_EMPTY_ARRAY;
                 return 0;
@@ -1892,7 +1892,7 @@ int json_variant_filter(JsonVariant **v,
         if (!json_variant_is_object(*v))
                 return -EINVAL;
 
-        if (strv_isempty(to_remove))
+        if (sd_strv_isempty(to_remove))
                 return 0;
 
         for (size_t i = 0; i < json_variant_elements(*v); i += 2) {
@@ -2299,9 +2299,9 @@ int json_variant_strv(JsonVariant *v, ch
 
 fail:
         if (sensitive)
-                strv_free_erase(l);
+                sd_strv_free_erase(l);
         else
-                strv_free(l);
+                sd_strv_free(l);
 
         return r;
 }
@@ -3763,7 +3763,7 @@ int json_buildv(JsonVariant **ret, va_li
 
                         l = va_arg(ap, char **);
 
-                        _cleanup_strv_free_ char **el = NULL;
+                        _cleanup_sd_strv_free_ char **el = NULL;
                         STRV_FOREACH_PAIR(x, y, l) {
                                 char *n = NULL;
 
@@ -3773,7 +3773,7 @@ int json_buildv(JsonVariant **ret, va_li
                                         goto finish;
                                 }
 
-                                r = strv_consume(&el, n);
+                                r = sd_strv_consume(&el, n);
                                 if (r < 0)
                                         goto finish;
                         }
@@ -4219,7 +4219,7 @@ int json_buildv(JsonVariant **ret, va_li
                         n = va_arg(ap, const char *);
                         l = va_arg(ap, char **);
 
-                        if (!strv_isempty(l) && current->n_suppress == 0) {
+                        if (!sd_strv_isempty(l) && current->n_suppress == 0) {
                                 r = json_variant_new_string(&add, n);
                                 if (r < 0)
                                         goto finish;
@@ -4894,7 +4894,7 @@ int json_dispatch_const_string(const cha
 }
 
 int json_dispatch_strv(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         char ***s = ASSERT_PTR(userdata);
         JsonVariant *e;
         int r;
@@ -4902,7 +4902,7 @@ int json_dispatch_strv(const char *name,
         assert(variant);
 
         if (json_variant_is_null(variant)) {
-                *s = strv_free(*s);
+                *s = sd_strv_free(*s);
                 return 0;
         }
 
@@ -4911,11 +4911,11 @@ int json_dispatch_strv(const char *name,
                 if ((flags & JSON_SAFE) && !string_is_safe(json_variant_string(variant)))
                         return json_log(variant, flags, SYNTHETIC_ERRNO(EINVAL), "JSON field '%s' contains unsafe characters, refusing.", strna(name));
 
-                l = strv_new(json_variant_string(variant));
+                l = sd_strv_new(json_variant_string(variant));
                 if (!l)
                         return log_oom();
 
-                strv_free_and_replace(*s, l);
+                sd_strv_free_and_replace(*s, l);
                 return 0;
         }
 
@@ -4929,12 +4929,12 @@ int json_dispatch_strv(const char *name,
                 if ((flags & JSON_SAFE) && !string_is_safe(json_variant_string(e)))
                         return json_log(e, flags, SYNTHETIC_ERRNO(EINVAL), "JSON field '%s' contains unsafe characters, refusing.", strna(name));
 
-                r = strv_extend(&l, json_variant_string(e));
+                r = sd_strv_extend(&l, json_variant_string(e));
                 if (r < 0)
                         return json_log(e, flags, r, "Failed to append array element: %m");
         }
 
-        strv_free_and_replace(*s, l);
+        sd_strv_free_and_replace(*s, l);
         return 0;
 }
 
diff '--color=auto' -Nurp a/src/shared/kbd-util.c b/src/shared/kbd-util.c
--- a/src/shared/kbd-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/kbd-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -22,7 +22,7 @@ int keymap_directories(char ***ret) {
         if (getenv_path_list("SYSTEMD_KEYMAP_DIRECTORIES", ret) >= 0)
                 return 0;
 
-        char **paths = strv_new(KBD_KEYMAP_DIRS);
+        char **paths = sd_strv_new(KBD_KEYMAP_DIRS);
         if (!paths)
                 return log_oom_debug();
 
@@ -84,7 +84,7 @@ static int keymap_recurse_dir_callback(
 
 int get_keymaps(char ***ret) {
         _cleanup_set_free_free_ Set *keymaps = NULL;
-        _cleanup_strv_free_ char **keymap_dirs = NULL;
+        _cleanup_sd_strv_free_ char **keymap_dirs = NULL;
         int r;
 
         r = keymap_directories(&keymap_dirs);
@@ -114,7 +114,7 @@ int get_keymaps(char ***ret) {
                         log_debug_errno(r, "Failed to read keymap list from %s, ignoring: %m", *dir);
         }
 
-        _cleanup_strv_free_ char **l = set_get_strv(keymaps);
+        _cleanup_sd_strv_free_ char **l = set_get_strv(keymaps);
         if (!l)
                 return -ENOMEM;
 
@@ -122,7 +122,7 @@ int get_keymaps(char ***ret) {
                                       * set_free_free() since the entries of the set are now owned by the
                                       * strv */
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return -ENOENT;
 
         strv_sort(l);
@@ -151,7 +151,7 @@ bool keymap_is_valid(const char *name) {
 }
 
 int keymap_exists(const char *name) {
-        _cleanup_strv_free_ char **keymap_dirs = NULL;
+        _cleanup_sd_strv_free_ char **keymap_dirs = NULL;
         int r;
 
         if (!keymap_is_valid(name))
diff '--color=auto' -Nurp a/src/shared/libfido2-util.c b/src/shared/libfido2-util.c
--- a/src/shared/libfido2-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/libfido2-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -470,7 +470,7 @@ static int fido2_use_hmac_hash_specific_
 
                 if (FLAGS_SET(required, FIDO2ENROLL_PIN)) {
                         /* OK, we need a pin, try with all pins in turn */
-                        if (strv_isempty(pins))
+                        if (sd_strv_isempty(pins))
                                 r = FIDO_ERR_PIN_REQUIRED;
                         else
                                 STRV_FOREACH(i, pins) {
@@ -527,7 +527,7 @@ static int fido2_use_hmac_hash_specific_
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                        "Token asks for PIN but doesn't advertise 'clientPin' feature.");
 
-                        if (FLAGS_SET(required, FIDO2ENROLL_PIN) && !strv_isempty(pins))
+                        if (FLAGS_SET(required, FIDO2ENROLL_PIN) && !sd_strv_isempty(pins))
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                                        "Token asks for PIN but one was already supplied.");
 
@@ -868,7 +868,7 @@ int fido2_generate_hmac_hash(
                 AskPasswordFlags askpw_flags = ASK_PASSWORD_ACCEPT_CACHED;
 
                 for (;;) {
-                        _cleanup_strv_free_erase_ char **pin = NULL;
+                        _cleanup_sd_strv_free_erase_ char **pin = NULL;
                         AskPasswordRequest req = {
                                 .message = "Please enter security token PIN:",
                                 .icon = askpw_icon,
diff '--color=auto' -Nurp a/src/shared/locale-setup.c b/src/shared/locale-setup.c
--- a/src/shared/locale-setup.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/locale-setup.c	2025-06-30 18:37:25.000000000 +0000
@@ -152,7 +152,7 @@ finalize:
 }
 
 int locale_context_build_env(const LocaleContext *c, char ***ret_set, char ***ret_unset) {
-        _cleanup_strv_free_ char **set = NULL, **unset = NULL;
+        _cleanup_sd_strv_free_ char **set = NULL, **unset = NULL;
         int r;
 
         assert(c);
@@ -166,7 +166,7 @@ int locale_context_build_env(const Local
                 if (isempty(c->locale[p])) {
                         if (!ret_unset)
                                 continue;
-                        r = strv_extend(&unset, name);
+                        r = sd_strv_extend(&unset, name);
                 } else {
                         if (!ret_set)
                                 continue;
@@ -184,7 +184,7 @@ int locale_context_build_env(const Local
 }
 
 int locale_context_save(LocaleContext *c, char ***ret_set, char ***ret_unset) {
-        _cleanup_strv_free_ char **set = NULL, **unset = NULL;
+        _cleanup_sd_strv_free_ char **set = NULL, **unset = NULL;
         int r;
 
         assert(c);
@@ -195,7 +195,7 @@ int locale_context_save(LocaleContext *c
         if (r < 0)
                 return r;
 
-        if (strv_isempty(set)) {
+        if (sd_strv_isempty(set)) {
                 if (unlink("/etc/locale.conf") < 0)
                         return errno == ENOENT ? 0 : -errno;
 
@@ -257,7 +257,7 @@ bool locale_context_equal(const LocaleCo
 
 int locale_setup(char ***environment) {
         _cleanup_(locale_context_clear) LocaleContext c = {};
-        _cleanup_strv_free_ char **add = NULL;
+        _cleanup_sd_strv_free_ char **add = NULL;
         int r;
 
         assert(environment);
@@ -270,16 +270,16 @@ int locale_setup(char ***environment) {
         if (r < 0)
                 return r;
 
-        if (strv_isempty(add)) {
+        if (sd_strv_isempty(add)) {
                 /* If no locale is configured then default to compile-time default. */
 
-                add = strv_new("LANG=" SYSTEMD_DEFAULT_LOCALE);
+                add = sd_strv_new("LANG=" SYSTEMD_DEFAULT_LOCALE);
                 if (!add)
                         return -ENOMEM;
         }
 
-        if (strv_isempty(*environment))
-                strv_free_and_replace(*environment, add);
+        if (sd_strv_isempty(*environment))
+                sd_strv_free_and_replace(*environment, add);
         else {
                 char **merged;
 
@@ -287,7 +287,7 @@ int locale_setup(char ***environment) {
                 if (!merged)
                         return -ENOMEM;
 
-                strv_free_and_replace(*environment, merged);
+                sd_strv_free_and_replace(*environment, merged);
         }
 
         return 0;
diff '--color=auto' -Nurp a/src/shared/mkfs-util.c b/src/shared/mkfs-util.c
--- a/src/shared/mkfs-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/mkfs-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -103,7 +103,7 @@ static int mangle_fat_label(const char *
 
 static int do_mcopy(const char *node, const char *root) {
         _cleanup_free_ char *mcopy = NULL;
-        _cleanup_strv_free_ char **argv = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL;
         _cleanup_free_ DirectoryEntries *de = NULL;
         int r;
 
@@ -120,7 +120,7 @@ static int do_mcopy(const char *node, co
         if (r < 0)
                 return log_error_errno(r, "Failed to determine whether mcopy binary exists: %m");
 
-        argv = strv_new(mcopy, "-s", "-p", "-Q", "-m", "-i", node);
+        argv = sd_strv_new(mcopy, "-s", "-p", "-Q", "-m", "-i", node);
         if (!argv)
                 return log_oom();
 
@@ -143,11 +143,11 @@ static int do_mcopy(const char *node, co
                         continue;
                 }
 
-                if (strv_consume(&argv, TAKE_PTR(p)) < 0)
+                if (sd_strv_consume(&argv, TAKE_PTR(p)) < 0)
                         return log_oom();
         }
 
-        if (strv_extend(&argv, "::") < 0)
+        if (sd_strv_extend(&argv, "::") < 0)
                 return log_oom();
 
         r = safe_fork("(mcopy)", FORK_RESET_SIGNALS|FORK_RLIMIT_NOFILE_SAFE|FORK_DEATHSIG_SIGTERM|FORK_LOG|FORK_WAIT|FORK_STDOUT_TO_STDERR|FORK_CLOSE_ALL_FDS, NULL);
@@ -326,7 +326,7 @@ int make_filesystem(
                 char * const *extra_mkfs_args) {
 
         _cleanup_free_ char *mkfs = NULL, *mangled_label = NULL;
-        _cleanup_strv_free_ char **argv = NULL, **env = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL, **env = NULL;
         _cleanup_(rm_rf_physical_and_freep) char *protofile_tmpdir = NULL;
         _cleanup_(unlink_and_freep) char *protofile = NULL;
         char vol_id[CONST_MAX(SD_ID128_UUID_STRING_MAX, 8U + 1U)] = {};
@@ -415,7 +415,7 @@ int make_filesystem(
 
         /* When changing this conditional, also adjust the log statement below. */
         if (STR_IN_SET(fstype, "ext2", "ext3", "ext4")) {
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-L", label,
                                 "-U", vol_id,
                                 "-I", "256",
@@ -425,35 +425,35 @@ int make_filesystem(
                                 "-T", "default",
                                 node);
 
-                if (root && strv_extend_many(&argv, "-d", root) < 0)
+                if (root && sd_strv_extend_many(&argv, "-d", root) < 0)
                         return log_oom();
 
-                if (quiet && strv_extend(&argv, "-q") < 0)
+                if (quiet && sd_strv_extend(&argv, "-q") < 0)
                         return log_oom();
 
                 if (sector_size > 0) {
-                        if (strv_extend(&env, "MKE2FS_DEVICE_SECTSIZE") < 0)
+                        if (sd_strv_extend(&env, "MKE2FS_DEVICE_SECTSIZE") < 0)
                                         return log_oom();
 
-                        if (strv_extendf(&env, "%"PRIu64, sector_size) < 0)
+                        if (sd_sd_strv_extendf(&env, "%"PRIu64, sector_size) < 0)
                                 return log_oom();
                 }
 
         } else if (streq(fstype, "btrfs")) {
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-L", label,
                                 "-U", vol_id,
                                 node);
                 if (!argv)
                         return log_oom();
 
-                if (!discard && strv_extend(&argv, "--nodiscard") < 0)
+                if (!discard && sd_strv_extend(&argv, "--nodiscard") < 0)
                         return log_oom();
 
-                if (root && strv_extend_many(&argv, "-r", root) < 0)
+                if (root && sd_strv_extend_many(&argv, "-r", root) < 0)
                         return log_oom();
 
-                if (quiet && strv_extend(&argv, "-q") < 0)
+                if (quiet && sd_strv_extend(&argv, "-q") < 0)
                         return log_oom();
 
                 /* mkfs.btrfs unconditionally warns about several settings changing from v5.15 onwards which
@@ -462,16 +462,16 @@ int make_filesystem(
                         stdio_fds[1] = -EBADF;
 
                 if (sector_size > 0) {
-                        if (strv_extend(&argv, "--sectorsize") < 0)
+                        if (sd_strv_extend(&argv, "--sectorsize") < 0)
                                 return log_oom();
 
                         /* mkfs.btrfs expects a sector size of at least 4k bytes. */
-                        if (strv_extendf(&argv, "%"PRIu64, MAX(sector_size, 4 * U64_KB)) < 0)
+                        if (sd_sd_strv_extendf(&argv, "%"PRIu64, MAX(sector_size, 4 * U64_KB)) < 0)
                                 return log_oom();
                 }
 
         } else if (streq(fstype, "f2fs")) {
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-g",  /* "default options" */
                                 "-f",  /* force override, without this it doesn't seem to want to write to an empty partition */
                                 "-l", label,
@@ -479,14 +479,14 @@ int make_filesystem(
                                 "-t", one_zero(discard),
                                 node);
 
-                if (quiet && strv_extend(&argv, "-q") < 0)
+                if (quiet && sd_strv_extend(&argv, "-q") < 0)
                         return log_oom();
 
                 if (sector_size > 0) {
-                        if (strv_extend(&argv, "-w") < 0)
+                        if (sd_strv_extend(&argv, "-w") < 0)
                                 return log_oom();
 
-                        if (strv_extendf(&argv, "%"PRIu64, sector_size) < 0)
+                        if (sd_sd_strv_extendf(&argv, "%"PRIu64, sector_size) < 0)
                                 return log_oom();
                 }
 
@@ -495,7 +495,7 @@ int make_filesystem(
 
                 j = strjoina("uuid=", vol_id);
 
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-L", label,
                                 "-m", j,
                                 "-m", "reflink=1",
@@ -503,7 +503,7 @@ int make_filesystem(
                 if (!argv)
                         return log_oom();
 
-                if (!discard && strv_extend(&argv, "-K") < 0)
+                if (!discard && sd_strv_extend(&argv, "-K") < 0)
                         return log_oom();
 
                 if (root) {
@@ -523,34 +523,34 @@ int make_filesystem(
                         if (!protofile_with_opt)
                                 return -ENOMEM;
 
-                        if (strv_extend_many(&argv, "-p", protofile_with_opt) < 0)
+                        if (sd_strv_extend_many(&argv, "-p", protofile_with_opt) < 0)
                                 return log_oom();
                 }
 
                 if (sector_size > 0) {
-                        if (strv_extend(&argv, "-s") < 0)
+                        if (sd_strv_extend(&argv, "-s") < 0)
                                 return log_oom();
 
-                        if (strv_extendf(&argv, "size=%"PRIu64, sector_size) < 0)
+                        if (sd_sd_strv_extendf(&argv, "size=%"PRIu64, sector_size) < 0)
                                 return log_oom();
                 }
 
-                if (quiet && strv_extend(&argv, "-q") < 0)
+                if (quiet && sd_strv_extend(&argv, "-q") < 0)
                         return log_oom();
 
         } else if (streq(fstype, "vfat")) {
 
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-i", vol_id,
                                 "-n", label,
                                 "-F", "32",  /* yes, we force FAT32 here */
                                 node);
 
                 if (sector_size > 0) {
-                        if (strv_extend(&argv, "-S") < 0)
+                        if (sd_strv_extend(&argv, "-S") < 0)
                                 return log_oom();
 
-                        if (strv_extendf(&argv, "%"PRIu64, sector_size) < 0)
+                        if (sd_sd_strv_extendf(&argv, "%"PRIu64, sector_size) < 0)
                                 return log_oom();
                 }
 
@@ -561,7 +561,7 @@ int make_filesystem(
         } else if (streq(fstype, "swap")) {
                 /* TODO: add --quiet once util-linux v2.38 is available everywhere. */
 
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-L", label,
                                 "-U", vol_id,
                                 node);
@@ -571,7 +571,7 @@ int make_filesystem(
 
         } else if (streq(fstype, "squashfs")) {
 
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 root, node,
                                 "-noappend");
 
@@ -581,21 +581,21 @@ int make_filesystem(
 
         } else if (streq(fstype, "erofs")) {
 
-                argv = strv_new(mkfs,
+                argv = sd_strv_new(mkfs,
                                 "-U", vol_id,
                                 node, root);
 
-                if (quiet && strv_extend(&argv, "--quiet") < 0)
+                if (quiet && sd_strv_extend(&argv, "--quiet") < 0)
                         return log_oom();
 
         } else
                 /* Generic fallback for all other file systems */
-                argv = strv_new(mkfs, node);
+                argv = sd_strv_new(mkfs, node);
 
         if (!argv)
                 return log_oom();
 
-        if (extra_mkfs_args && strv_extend_strv(&argv, extra_mkfs_args, false) < 0)
+        if (extra_mkfs_args && sd_sd_strv_extend_strv(&argv, extra_mkfs_args, false) < 0)
                 return log_oom();
 
         if (streq(fstype, "btrfs")) {
@@ -611,7 +611,7 @@ int make_filesystem(
         if (DEBUG_LOGGING) {
                 _cleanup_free_ char *j = NULL;
 
-                j = strv_join(argv, " ");
+                j = sd_strv_join(argv, " ");
                 log_debug("Executing mkfs command: %s", strna(j));
         }
 
@@ -667,7 +667,7 @@ int make_filesystem(
 }
 
 int mkfs_options_from_env(const char *component, const char *fstype, char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *e;
         char *n;
 
@@ -678,7 +678,7 @@ int mkfs_options_from_env(const char *co
         n = strjoina("SYSTEMD_", component, "_MKFS_OPTIONS_", fstype);
         e = getenv(ascii_strupper(n));
         if (e) {
-                l = strv_split(e, NULL);
+                l = sd_strv_split(e, NULL);
                 if (!l)
                         return -ENOMEM;
         }
diff '--color=auto' -Nurp a/src/shared/module-util.c b/src/shared/module-util.c
--- a/src/shared/module-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/module-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -50,17 +50,17 @@ int dlopen_libkmod(void) {
 }
 
 static int denylist_modules(const char *p, char ***denylist) {
-        _cleanup_strv_free_ char **k = NULL;
+        _cleanup_sd_strv_free_ char **k = NULL;
         int r;
 
         assert(p);
         assert(denylist);
 
-        k = strv_split(p, ",");
+        k = sd_strv_split(p, ",");
         if (!k)
                 return -ENOMEM;
 
-        r = strv_extend_strv(denylist, k, /* filter_duplicates= */ true);
+        r = sd_sd_strv_extend_strv(denylist, k, /* filter_duplicates= */ true);
         if (r < 0)
                 return r;
 
@@ -85,7 +85,7 @@ static int parse_proc_cmdline_item(const
 
 int module_load_and_warn(struct kmod_ctx *ctx, const char *module, bool verbose) {
         _cleanup_(sym_kmod_module_unref_listp) struct kmod_list *modlist = NULL;
-        _cleanup_strv_free_ char **denylist = NULL;
+        _cleanup_sd_strv_free_ char **denylist = NULL;
         bool denylist_parsed = false;
         struct kmod_list *itr;
         int r;
diff '--color=auto' -Nurp a/src/shared/mount-setup.c b/src/shared/mount-setup.c
--- a/src/shared/mount-setup.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/mount-setup.c	2025-06-30 18:33:48.000000000 +0000
@@ -327,7 +327,7 @@ static int relabel_tree(const char *path
 }
 
 static int relabel_extra(void) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r, c = 0;
 
         /* Support for relabelling additional files or directories after loading the policy. For this, code in the
diff '--color=auto' -Nurp a/src/shared/mount-util.c b/src/shared/mount-util.c
--- a/src/shared/mount-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/mount-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -159,7 +159,7 @@ int bind_remount_recursive_with_mountinf
 
         assert(prefix);
 
-        if ((flags_mask & ~MS_CONVERTIBLE_FLAGS) == 0 && strv_isempty(deny_list) && !skip_mount_set_attr) {
+        if ((flags_mask & ~MS_CONVERTIBLE_FLAGS) == 0 && sd_strv_isempty(deny_list) && !skip_mount_set_attr) {
                 /* Let's take a shortcut for all the flags we know how to convert into mount_setattr() flags */
 
                 if (mount_setattr(AT_FDCWD, prefix, AT_SYMLINK_NOFOLLOW|AT_RECURSIVE,
@@ -1402,7 +1402,7 @@ int remount_idmap_fd(
          * beginning, and nested directories in the right, so that the tree can be built correctly from left
          * to right. */
 
-        size_t n = strv_length(paths);
+        size_t n = sd_strv_length(paths);
         if (n == 0) /* Nothing to do? */
                 return 0;
 
diff '--color=auto' -Nurp a/src/shared/net-condition.c b/src/shared/net-condition.c
--- a/src/shared/net-condition.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/net-condition.c	2025-06-30 18:37:25.000000000 +0000
@@ -19,14 +19,14 @@ void net_match_clear(NetMatch *match) {
 
         match->hw_addr = set_free(match->hw_addr);
         match->permanent_hw_addr = set_free(match->permanent_hw_addr);
-        match->path = strv_free(match->path);
-        match->driver = strv_free(match->driver);
-        match->iftype = strv_free(match->iftype);
-        match->kind = strv_free(match->kind);
-        match->ifname = strv_free(match->ifname);
-        match->property = strv_free(match->property);
-        match->wlan_iftype = strv_free(match->wlan_iftype);
-        match->ssid = strv_free(match->ssid);
+        match->path = sd_strv_free(match->path);
+        match->driver = sd_strv_free(match->driver);
+        match->iftype = sd_strv_free(match->iftype);
+        match->kind = sd_strv_free(match->kind);
+        match->ifname = sd_strv_free(match->ifname);
+        match->property = sd_strv_free(match->property);
+        match->wlan_iftype = sd_strv_free(match->wlan_iftype);
+        match->ssid = sd_strv_free(match->ssid);
         match->bssid = set_free(match->bssid);
 }
 
@@ -36,21 +36,21 @@ bool net_match_is_empty(const NetMatch *
         return
                 set_isempty(match->hw_addr) &&
                 set_isempty(match->permanent_hw_addr) &&
-                strv_isempty(match->path) &&
-                strv_isempty(match->driver) &&
-                strv_isempty(match->iftype) &&
-                strv_isempty(match->kind) &&
-                strv_isempty(match->ifname) &&
-                strv_isempty(match->property) &&
-                strv_isempty(match->wlan_iftype) &&
-                strv_isempty(match->ssid) &&
+                sd_strv_isempty(match->path) &&
+                sd_strv_isempty(match->driver) &&
+                sd_strv_isempty(match->iftype) &&
+                sd_strv_isempty(match->kind) &&
+                sd_strv_isempty(match->ifname) &&
+                sd_strv_isempty(match->property) &&
+                sd_strv_isempty(match->wlan_iftype) &&
+                sd_strv_isempty(match->ssid) &&
                 set_isempty(match->bssid);
 }
 
 static bool net_condition_test_strv(char * const *patterns, const char *string) {
         bool match = false, has_positive_rule = false;
 
-        if (strv_isempty(patterns))
+        if (sd_strv_isempty(patterns))
                 return true;
 
         STRV_FOREACH(p, patterns) {
@@ -86,7 +86,7 @@ static bool net_condition_test_ifname(ch
 }
 
 static int net_condition_test_property(char * const *match_property, sd_device *device) {
-        if (strv_isempty(match_property))
+        if (sd_strv_isempty(match_property))
                 return true;
 
         STRV_FOREACH(p, match_property) {
@@ -242,7 +242,7 @@ int config_parse_match_strv(
         assert(lvalue);
 
         if (isempty(rvalue)) {
-                *sv = strv_free(*sv);
+                *sv = sd_strv_free(*sv);
                 return 0;
         }
 
@@ -270,7 +270,7 @@ int config_parse_match_strv(
                 } else
                         k = TAKE_PTR(word);
 
-                r = strv_consume(sv, TAKE_PTR(k));
+                r = sd_strv_consume(sv, TAKE_PTR(k));
                 if (r < 0)
                         return log_oom();
         }
@@ -297,7 +297,7 @@ int config_parse_match_ifnames(
         assert(lvalue);
 
         if (isempty(rvalue)) {
-                *sv = strv_free(*sv);
+                *sv = sd_strv_free(*sv);
                 return 0;
         }
 
@@ -331,7 +331,7 @@ int config_parse_match_ifnames(
                 } else
                         k = TAKE_PTR(word);
 
-                r = strv_consume(sv, TAKE_PTR(k));
+                r = sd_strv_consume(sv, TAKE_PTR(k));
                 if (r < 0)
                         return log_oom();
         }
@@ -358,7 +358,7 @@ int config_parse_match_property(
         assert(lvalue);
 
         if (isempty(rvalue)) {
-                *sv = strv_free(*sv);
+                *sv = sd_strv_free(*sv);
                 return 0;
         }
 
@@ -392,7 +392,7 @@ int config_parse_match_property(
                 } else
                         k = TAKE_PTR(word);
 
-                r = strv_consume(sv, TAKE_PTR(k));
+                r = sd_strv_consume(sv, TAKE_PTR(k));
                 if (r < 0)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/shared/pager.c b/src/shared/pager.c
--- a/src/shared/pager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/pager.c	2025-06-30 18:37:42.000000000 +0000
@@ -84,7 +84,7 @@ static int no_quit_on_interrupt(int exe_
 
 void pager_open(PagerFlags flags) {
         _cleanup_close_pair_ int fd[2] = EBADF_PAIR, exe_name_pipe[2] = EBADF_PAIR;
-        _cleanup_strv_free_ char **pager_args = NULL;
+        _cleanup_sd_strv_free_ char **pager_args = NULL;
         _cleanup_free_ char *l = NULL;
         const char *pager, *less_opts;
         int r;
@@ -106,12 +106,12 @@ void pager_open(PagerFlags flags) {
                 pager = getenv("PAGER");
 
         if (pager) {
-                pager_args = strv_split(pager, WHITESPACE);
+                pager_args = sd_strv_split(pager, WHITESPACE);
                 if (!pager_args)
                         return (void) log_oom();
 
                 /* If the pager is explicitly turned off, honour it */
-                if (strv_isempty(pager_args) || strv_equal(pager_args, STRV_MAKE("cat")))
+                if (sd_strv_isempty(pager_args) || strv_equal(pager_args, STRV_MAKE("cat")))
                         return;
         }
 
diff '--color=auto' -Nurp a/src/shared/password-quality-util-passwdqc.c b/src/shared/password-quality-util-passwdqc.c
--- a/src/shared/password-quality-util-passwdqc.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/password-quality-util-passwdqc.c	2025-06-30 18:37:55.000000000 +0000
@@ -67,7 +67,7 @@ static int pwqc_allocate_context(passwdq
 int suggest_passwords(void) {
 
         _cleanup_(sym_passwdqc_params_freep) passwdqc_params_t *params = NULL;
-        _cleanup_strv_free_erase_ char **suggestions = NULL;
+        _cleanup_sd_strv_free_erase_ char **suggestions = NULL;
         _cleanup_(erase_and_freep) char *joined = NULL;
         int r;
 
@@ -88,7 +88,7 @@ int suggest_passwords(void) {
                         return log_error_errno(SYNTHETIC_ERRNO(EIO), "Failed to generate password, ignoring");
         }
 
-        joined = strv_join(suggestions, " ");
+        joined = sd_strv_join(suggestions, " ");
         if (!joined)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/shared/password-quality-util-pwquality.c b/src/shared/password-quality-util-pwquality.c
--- a/src/shared/password-quality-util-pwquality.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/password-quality-util-pwquality.c	2025-06-30 18:37:55.000000000 +0000
@@ -103,7 +103,7 @@ static int pwq_allocate_context(pwqualit
 
 int suggest_passwords(void) {
         _cleanup_(sym_pwquality_free_settingsp) pwquality_settings_t *pwq = NULL;
-        _cleanup_strv_free_erase_ char **suggestions = NULL;
+        _cleanup_sd_strv_free_erase_ char **suggestions = NULL;
         _cleanup_(erase_and_freep) char *joined = NULL;
         char buf[PWQ_MAX_ERROR_MESSAGE_LEN];
         int r;
@@ -126,7 +126,7 @@ int suggest_passwords(void) {
                                                sym_pwquality_strerror(buf, sizeof(buf), r, NULL));
         }
 
-        joined = strv_join(suggestions, " ");
+        joined = sd_strv_join(suggestions, " ");
         if (!joined)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/shared/pcrextend-util.c b/src/shared/pcrextend-util.c
--- a/src/shared/pcrextend-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/pcrextend-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -53,7 +53,7 @@ static int device_get_file_system_word(
 
         assert(r == _BLKID_SAFEPROBE_FOUND);
 
-        _cleanup_strv_free_ char **l = strv_new(prefix);
+        _cleanup_sd_strv_free_ char **l = sd_strv_new(prefix);
         if (!l)
                 return -ENOMEM;
 
@@ -66,14 +66,14 @@ static int device_get_file_system_word(
                 if (!escaped)
                         return -ENOMEM;
 
-                r = strv_consume(&l, TAKE_PTR(escaped));
+                r = sd_strv_consume(&l, TAKE_PTR(escaped));
                 if (r < 0)
                         return r;
         }
 
-        assert(strv_length(l) == 7); /* We always want 7 components, to avoid ambiguous strings */
+        assert(sd_strv_length(l) == 7); /* We always want 7 components, to avoid ambiguous strings */
 
-        _cleanup_free_ char *word = strv_join(l, ":");
+        _cleanup_free_ char *word = sd_strv_join(l, ":");
         if (!word)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/shared/pkcs11-util.c b/src/shared/pkcs11-util.c
--- a/src/shared/pkcs11-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/pkcs11-util.c	2025-06-30 18:37:06.000000000 +0000
@@ -344,14 +344,14 @@ int pkcs11_token_login(
                 return log_oom();
 
         for (unsigned tries = 0; tries < 3; tries++) {
-                _cleanup_strv_free_erase_ char **passwords = NULL;
+                _cleanup_sd_strv_free_erase_ char **passwords = NULL;
                 _cleanup_(erase_and_freep) char *envpin = NULL;
 
                 r = getenv_steal_erase("PIN", &envpin);
                 if (r < 0)
                         return log_error_errno(r, "Failed to acquire PIN from environment: %m");
                 if (r > 0) {
-                        passwords = strv_new(envpin);
+                        passwords = sd_strv_new(envpin);
                         if (!passwords)
                                 return log_oom();
 
diff '--color=auto' -Nurp a/src/shared/pretty-print.c b/src/shared/pretty-print.c
--- a/src/shared/pretty-print.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/pretty-print.c	2025-06-30 18:36:07.000000000 +0000
@@ -355,7 +355,7 @@ static int guess_type(const char **name,
 }
 
 int conf_files_cat(const char *root, const char *name, CatFlags flags) {
-        _cleanup_strv_free_ char **dirs = NULL, **files = NULL;
+        _cleanup_sd_strv_free_ char **dirs = NULL, **files = NULL;
         _cleanup_free_ char *path = NULL;
         char **prefixes = NULL; /* explicit initialization to appease gcc */
         bool is_collection;
@@ -370,7 +370,7 @@ int conf_files_cat(const char *root, con
 
         STRV_FOREACH(prefix, prefixes) {
                 assert(endswith(*prefix, "/"));
-                r = strv_extendf(&dirs, "%s%s%s", *prefix, name,
+                r = sd_sd_strv_extendf(&dirs, "%s%s%s", *prefix, name,
                                  is_collection ? "" : ".d");
                 if (r < 0)
                         return log_error_errno(r, "Failed to build directory list: %m");
diff '--color=auto' -Nurp a/src/shared/seccomp-util.c b/src/shared/seccomp-util.c
--- a/src/shared/seccomp-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/seccomp-util.c	2025-06-30 18:35:42.000000000 +0000
@@ -1050,7 +1050,7 @@ int seccomp_add_syscall_filter_item(
                 }
 
                 if (added) {
-                        r = strv_extend(added, name);
+                        r = sd_strv_extend(added, name);
                         if (r < 0)
                                 return r;
                 }
@@ -1112,7 +1112,7 @@ int seccomp_load_syscall_filter_set(uint
 
         SECCOMP_FOREACH_LOCAL_ARCH(arch) {
                 _cleanup_(seccomp_releasep) scmp_filter_ctx seccomp = NULL;
-                _cleanup_strv_free_ char **added = NULL;
+                _cleanup_sd_strv_free_ char **added = NULL;
 
                 log_trace("Operating on architecture: %s", seccomp_arch_to_string(arch));
 
diff '--color=auto' -Nurp a/src/shared/serialize.c b/src/shared/serialize.c
--- a/src/shared/serialize.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/serialize.c	2025-06-30 18:36:37.000000000 +0000
@@ -403,7 +403,7 @@ int deserialize_strv(const char *value,
         if (unescaped_len < 0)
                 return unescaped_len;
 
-        return strv_consume(l, unescaped);
+        return sd_strv_consume(l, unescaped);
 }
 
 int deserialize_usec(const char *value, usec_t *ret) {
diff '--color=auto' -Nurp a/src/shared/sleep-config.c b/src/shared/sleep-config.c
--- a/src/shared/sleep-config.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/sleep-config.c	2025-06-30 18:37:55.000000000 +0000
@@ -50,11 +50,11 @@ SleepConfig* sleep_config_free(SleepConf
                 return NULL;
 
         for (SleepOperation i = 0; i < _SLEEP_OPERATION_CONFIG_MAX; i++) {
-                strv_free(sc->states[i]);
-                strv_free(sc->modes[i]);
+                sd_strv_free(sc->states[i]);
+                sd_strv_free(sc->modes[i]);
         }
 
-        strv_free(sc->mem_modes);
+        sd_strv_free(sc->mem_modes);
 
         return mfree(sc);
 }
@@ -72,7 +72,7 @@ static int config_parse_sleep_mode(
                 void *userdata) {
 
         char ***sv = ASSERT_PTR(data);
-        _cleanup_strv_free_ char **modes = NULL;
+        _cleanup_sd_strv_free_ char **modes = NULL;
         int r;
 
         assert(filename);
@@ -80,16 +80,16 @@ static int config_parse_sleep_mode(
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                modes = strv_new(NULL);
+                modes = sd_strv_new(NULL);
                 if (!modes)
                         return log_oom();
         } else {
-                r = strv_split_full(&modes, rvalue, NULL, EXTRACT_UNQUOTE|EXTRACT_RETAIN_ESCAPE);
+                r = sd_strv_split_full(&modes, rvalue, NULL, EXTRACT_UNQUOTE|EXTRACT_RETAIN_ESCAPE);
                 if (r < 0)
                         return log_oom();
         }
 
-        return strv_free_and_replace(*sv, modes);
+        return sd_strv_free_and_replace(*sv, modes);
 }
 
 static void sleep_config_validate_state_and_mode(SleepConfig *sc) {
@@ -100,7 +100,7 @@ static void sleep_config_validate_state_
          * EFI variable or resume= kernel command line option). It's simply not sensible to call the suspend
          * operation but eventually do an unsafe hibernation. */
         if (strv_contains(sc->states[SLEEP_SUSPEND], "disk")) {
-                strv_remove(sc->states[SLEEP_SUSPEND], "disk");
+                sd_strv_remove(sc->states[SLEEP_SUSPEND], "disk");
                 log_warning("Sleep state 'disk' is not supported by operation %s, ignoring.",
                             sleep_operation_to_string(SLEEP_SUSPEND));
         }
@@ -166,13 +166,13 @@ int parse_sleep_config(SleepConfig **ret
 
         for (SleepOperation i = 0; i < _SLEEP_OPERATION_CONFIG_MAX; i++) {
                 if (!sc->states[i] && sleep_default_state_table[i]) {
-                        sc->states[i] = strv_copy(sleep_default_state_table[i]);
+                        sc->states[i] = sd_strv_copy(sleep_default_state_table[i]);
                         if (!sc->states[i])
                                 return log_oom();
                 }
 
                 if (!sc->modes[i] && sleep_default_mode_table[i]) {
-                        sc->modes[i] = strv_copy(sleep_default_mode_table[i]);
+                        sc->modes[i] = sd_strv_copy(sleep_default_mode_table[i]);
                         if (!sc->modes[i])
                                 return log_oom();
                 }
@@ -192,7 +192,7 @@ int sleep_state_supported(char * const *
         const char *found;
         int r;
 
-        if (strv_isempty(states))
+        if (sd_strv_isempty(states))
                 return log_debug_errno(SYNTHETIC_ERRNO(ENOMSG), "No sleep state configured.");
 
         if (access("/sys/power/state", W_OK) < 0)
@@ -211,7 +211,7 @@ int sleep_state_supported(char * const *
         }
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *joined = strv_join(states, " ");
+                _cleanup_free_ char *joined = sd_strv_join(states, " ");
                 log_debug("None of the configured sleep states are supported by kernel: %s", strnull(joined));
         }
         return false;
@@ -224,7 +224,7 @@ int sleep_mode_supported(const char *pat
         assert(path);
 
         /* Unlike state, kernel has its own default choice if not configured */
-        if (strv_isempty(modes)) {
+        if (sd_strv_isempty(modes)) {
                 log_debug("No sleep mode configured, using kernel default for %s.", path);
                 return true;
         }
@@ -262,7 +262,7 @@ int sleep_mode_supported(const char *pat
         }
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *joined = strv_join(modes, " ");
+                _cleanup_free_ char *joined = sd_strv_join(modes, " ");
                 log_debug("None of the configured modes are supported by kernel (%s): %s",
                           path, strnull(joined));
         }
diff '--color=auto' -Nurp a/src/shared/specifier.c b/src/shared/specifier.c
--- a/src/shared/specifier.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/specifier.c	2025-06-30 18:37:25.000000000 +0000
@@ -428,17 +428,17 @@ int specifier_var_tmp_dir(char specifier
 }
 
 int specifier_escape_strv(char **l, char ***ret) {
-        _cleanup_strv_free_ char **z = NULL;
+        _cleanup_sd_strv_free_ char **z = NULL;
         char **p, **q;
 
         assert(ret);
 
-        if (strv_isempty(l)) {
+        if (sd_strv_isempty(l)) {
                 *ret = NULL;
                 return 0;
         }
 
-        z = new(char*, strv_length(l)+1);
+        z = new(char*, sd_strv_length(l)+1);
         if (!z)
                 return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/shared/tests.c b/src/shared/tests.c
--- a/src/shared/tests.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/tests.c	2025-06-30 18:33:48.000000000 +0000
@@ -44,7 +44,7 @@ char* setup_fake_runtime_dir(void) {
 static void load_testdata_env(void) {
         static bool called = false;
         _cleanup_free_ char *s = NULL, *d = NULL, *envpath = NULL;
-        _cleanup_strv_free_ char **pairs = NULL;
+        _cleanup_sd_strv_free_ char **pairs = NULL;
         int r;
 
         if (called)
diff '--color=auto' -Nurp a/src/shared/tests.h b/src/shared/tests.h
--- a/src/shared/tests.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/tests.h	2025-06-30 18:37:42.000000000 +0000
@@ -136,7 +136,7 @@ extern const TestFunc _weak_ __stop_SYST
         log_info("/* %s() */", __func__)
 
 static inline int run_test_table(void) {
-        _cleanup_strv_free_ char **tests = NULL;
+        _cleanup_sd_strv_free_ char **tests = NULL;
         int r = EXIT_SUCCESS;
         bool ran = false;
         const char *e;
@@ -146,7 +146,7 @@ static inline int run_test_table(void) {
 
         e = getenv("TESTFUNCS");
         if (e) {
-                r = strv_split_full(&tests, e, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
+                r = sd_strv_split_full(&tests, e, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
                 if (r < 0)
                         return log_error_errno(r, "Failed to parse $TESTFUNCS: %m");
         }
diff '--color=auto' -Nurp a/src/shared/tpm2-util.c b/src/shared/tpm2-util.c
--- a/src/shared/tpm2-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/tpm2-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -2949,7 +2949,7 @@ int tpm2_get_good_pcr_banks_strv(
 
 #if HAVE_OPENSSL
         _cleanup_free_ TPMI_ALG_HASH *algs = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int n_algs;
 
         assert(c);
@@ -2978,7 +2978,7 @@ int tpm2_get_good_pcr_banks_strv(
 
                 ascii_strlower(n); /* OpenSSL uses uppercase digest names, we prefer them lower case. */
 
-                if (strv_consume(&l, TAKE_PTR(n)) < 0)
+                if (sd_strv_consume(&l, TAKE_PTR(n)) < 0)
                         return log_oom_debug();
         }
 
@@ -6405,7 +6405,7 @@ int tpm2_extend_bytes(
         if (pcr_index >= TPM2_PCRS_MAX)
                 return log_debug_errno(SYNTHETIC_ERRNO(EOPNOTSUPP), "Can't measure into unsupported PCR %u, refusing.", pcr_index);
 
-        if (strv_isempty(banks))
+        if (sd_strv_isempty(banks))
                 return 0;
 
         STRV_FOREACH(bank, banks) {
@@ -7885,7 +7885,7 @@ int tpm2_parse_pcr_argument_to_mask(cons
 }
 
 int tpm2_load_pcr_signature(const char *path, JsonVariant **ret) {
-        _cleanup_strv_free_ char **search = NULL;
+        _cleanup_sd_strv_free_ char **search = NULL;
         _cleanup_free_ char *discovered_path = NULL;
         _cleanup_fclose_ FILE *f = NULL;
         int r;
@@ -7893,7 +7893,7 @@ int tpm2_load_pcr_signature(const char *
         /* Tries to load a JSON PCR signature file. Takes an absolute path, a simple file name or NULL. In
          * the latter two cases searches in /etc/, /usr/lib/, /run/, as usual. */
 
-        search = strv_new(CONF_PATHS("systemd"));
+        search = sd_strv_new(CONF_PATHS("systemd"));
         if (!search)
                 return log_oom_debug();
 
@@ -7905,7 +7905,7 @@ int tpm2_load_pcr_signature(const char *
                 path = "tpm2-pcr-signature.json";
 
                 if (in_initrd())
-                        if (strv_extend(&search, "/.extra") < 0)
+                        if (sd_strv_extend(&search, "/.extra") < 0)
                                 return log_oom_debug();
         }
 
diff '--color=auto' -Nurp a/src/shared/user-record-nss.c b/src/shared/user-record-nss.c
--- a/src/shared/user-record-nss.c	2025-06-30 18:55:45.295159936 +0000
+++ b/src/shared/user-record-nss.c	2025-06-30 18:37:25.000000000 +0000
@@ -15,12 +15,12 @@ static const char* utf8_only(const char
         return s && utf8_is_valid(s) ? s : NULL;
 }
 
-static int strv_extend_strv_utf8_only(char ***dst, char **src, bool filter_duplicates) {
+static int sd_sd_strv_extend_strv_utf8_only(char ***dst, char **src, bool filter_duplicates) {
         _cleanup_free_ char **t = NULL;
         size_t l, j = 0;
 
         /* First, do a shallow copy of s, filtering for only valid utf-8 strings */
-        l = strv_length(src);
+        l = sd_strv_length(src);
         t = new(char*, l + 1);
         if (!t)
                 return -ENOMEM;
@@ -32,7 +32,7 @@ static int strv_extend_strv_utf8_only(ch
                 return 0;
 
         t[j] = NULL;
-        return strv_extend_strv(dst, t, filter_duplicates);
+        return sd_sd_strv_extend_strv(dst, t, filter_duplicates);
 }
 
 int nss_passwd_to_user_record(
@@ -92,12 +92,12 @@ int nss_passwd_to_user_record(
 
         if (spwd &&
             looks_like_hashed_password(utf8_only(spwd->sp_pwdp))) { /* Ignore locked, disabled, and mojibake passwords */
-                strv_free_erase(hr->hashed_password);
-                hr->hashed_password = strv_new(spwd->sp_pwdp);
+                sd_strv_free_erase(hr->hashed_password);
+                hr->hashed_password = sd_strv_new(spwd->sp_pwdp);
                 if (!hr->hashed_password)
                         return -ENOMEM;
         } else
-                hr->hashed_password = strv_free_erase(hr->hashed_password);
+                hr->hashed_password = sd_strv_free_erase(hr->hashed_password);
 
         /* shadow-utils suggests using "chage -E 0" (or -E 1, depending on which man page you check)
          * for locking a whole account, hence check for that. Note that it also defines a way to lock
@@ -144,7 +144,7 @@ int nss_passwd_to_user_record(
                                        JSON_BUILD_PAIR_CONDITION(hr->real_name, "realName", JSON_BUILD_STRING(hr->real_name)),
                                        JSON_BUILD_PAIR_CONDITION(hr->home_directory, "homeDirectory", JSON_BUILD_STRING(hr->home_directory)),
                                        JSON_BUILD_PAIR_CONDITION(hr->shell, "shell", JSON_BUILD_STRING(hr->shell)),
-                                       JSON_BUILD_PAIR_CONDITION(!strv_isempty(hr->hashed_password), "privileged", JSON_BUILD_OBJECT(JSON_BUILD_PAIR("hashedPassword", JSON_BUILD_STRV(hr->hashed_password)))),
+                                       JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(hr->hashed_password), "privileged", JSON_BUILD_OBJECT(JSON_BUILD_PAIR("hashedPassword", JSON_BUILD_STRV(hr->hashed_password)))),
                                        JSON_BUILD_PAIR_CONDITION(hr->locked >= 0, "locked", JSON_BUILD_BOOLEAN(hr->locked)),
                                        JSON_BUILD_PAIR_CONDITION(hr->not_after_usec != UINT64_MAX, "notAfterUSec", JSON_BUILD_UNSIGNED(hr->not_after_usec)),
                                        JSON_BUILD_PAIR_CONDITION(hr->password_change_now >= 0, "passwordChangeNow", JSON_BUILD_BOOLEAN(hr->password_change_now)),
@@ -158,7 +158,7 @@ int nss_passwd_to_user_record(
                 return r;
 
         hr->mask = USER_RECORD_REGULAR |
-                (!strv_isempty(hr->hashed_password) ? USER_RECORD_PRIVILEGED : 0);
+                (!sd_strv_isempty(hr->hashed_password) ? USER_RECORD_PRIVILEGED : 0);
 
         if (ret)
                 *ret = TAKE_PTR(hr);
@@ -299,7 +299,7 @@ int nss_group_to_group_record(
         if (!g->group_name)
                 return -ENOMEM;
 
-        r = strv_extend_strv_utf8_only(&g->members, grp->gr_mem, false);
+        r = sd_sd_strv_extend_strv_utf8_only(&g->members, grp->gr_mem, false);
         if (r < 0)
                 return r;
 
@@ -308,16 +308,16 @@ int nss_group_to_group_record(
 #if ENABLE_GSHADOW
         if (sgrp) {
                 if (looks_like_hashed_password(utf8_only(sgrp->sg_passwd))) {
-                        g->hashed_password = strv_new(sgrp->sg_passwd);
+                        g->hashed_password = sd_strv_new(sgrp->sg_passwd);
                         if (!g->hashed_password)
                                 return -ENOMEM;
                 }
 
-                r = strv_extend_strv_utf8_only(&g->members, sgrp->sg_mem, true);
+                r = sd_sd_strv_extend_strv_utf8_only(&g->members, sgrp->sg_mem, true);
                 if (r < 0)
                         return r;
 
-                r = strv_extend_strv_utf8_only(&g->administrators, sgrp->sg_adm, false);
+                r = sd_sd_strv_extend_strv_utf8_only(&g->administrators, sgrp->sg_adm, false);
                 if (r < 0)
                         return r;
         }
@@ -326,14 +326,14 @@ int nss_group_to_group_record(
         r = json_build(&g->json, JSON_BUILD_OBJECT(
                                        JSON_BUILD_PAIR("groupName", JSON_BUILD_STRING(g->group_name)),
                                        JSON_BUILD_PAIR("gid", JSON_BUILD_UNSIGNED(g->gid)),
-                                       JSON_BUILD_PAIR_CONDITION(!strv_isempty(g->members), "members", JSON_BUILD_STRV(g->members)),
-                                       JSON_BUILD_PAIR_CONDITION(!strv_isempty(g->hashed_password), "privileged", JSON_BUILD_OBJECT(JSON_BUILD_PAIR("hashedPassword", JSON_BUILD_STRV(g->hashed_password)))),
-                                       JSON_BUILD_PAIR_CONDITION(!strv_isempty(g->administrators), "administrators", JSON_BUILD_STRV(g->administrators))));
+                                       JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(g->members), "members", JSON_BUILD_STRV(g->members)),
+                                       JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(g->hashed_password), "privileged", JSON_BUILD_OBJECT(JSON_BUILD_PAIR("hashedPassword", JSON_BUILD_STRV(g->hashed_password)))),
+                                       JSON_BUILD_PAIR_CONDITION(!sd_strv_isempty(g->administrators), "administrators", JSON_BUILD_STRV(g->administrators))));
         if (r < 0)
                 return r;
 
         g->mask = USER_RECORD_REGULAR |
-                (!strv_isempty(g->hashed_password) ? USER_RECORD_PRIVILEGED : 0);
+                (!sd_strv_isempty(g->hashed_password) ? USER_RECORD_PRIVILEGED : 0);
 
         if (ret)
                 *ret = TAKE_PTR(g);
diff '--color=auto' -Nurp a/src/shared/user-record-show.c b/src/shared/user-record-show.c
--- a/src/shared/user-record-show.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/user-record-show.c	2025-06-30 18:37:25.000000000 +0000
@@ -29,7 +29,7 @@ const char *user_record_state_color(cons
 }
 
 void user_record_show(UserRecord *hr, bool show_full_group_info) {
-        _cleanup_strv_free_ char **langs = NULL;
+        _cleanup_sd_strv_free_ char **langs = NULL;
         const char *hd, *ip, *shell;
         UserStorage storage;
         usec_t t;
@@ -140,7 +140,7 @@ void user_record_show(UserRecord *hr, bo
                         break;
                 }
 
-                if (strv_isempty(hr->hashed_password)) {
+                if (sd_strv_isempty(hr->hashed_password)) {
                         if (hr->incomplete) /* Record might be incomplete, due to privs */
                                 break;
                         printf(" Password OK: %sno%s (none set)\n", ansi_highlight(), ansi_normal());
@@ -291,7 +291,7 @@ void user_record_show(UserRecord *hr, bo
         if (r < 0) {
                 errno = -r;
                 printf("   Languages: (can't acquire: %m)\n");
-        } else if (!strv_isempty(langs)) {
+        } else if (!sd_strv_isempty(langs)) {
                 STRV_FOREACH(i, langs)
                         printf(i == langs ? "   Languages: %s" : ", %s", *i);
                 printf("\n");
@@ -544,10 +544,10 @@ void user_record_show(UserRecord *hr, bo
                         printf("   Rebalance: weight %" PRIu64 "\n", rb);
         }
 
-        if (!strv_isempty(hr->ssh_authorized_keys))
-                printf("SSH Pub. Key: %zu\n", strv_length(hr->ssh_authorized_keys));
+        if (!sd_strv_isempty(hr->ssh_authorized_keys))
+                printf("SSH Pub. Key: %zu\n", sd_strv_length(hr->ssh_authorized_keys));
 
-        if (!strv_isempty(hr->pkcs11_token_uri))
+        if (!sd_strv_isempty(hr->pkcs11_token_uri))
                 STRV_FOREACH(i, hr->pkcs11_token_uri)
                         printf(i == hr->pkcs11_token_uri ?
                                "PKCS11 Token: %s\n" :
@@ -556,10 +556,10 @@ void user_record_show(UserRecord *hr, bo
         if (hr->n_fido2_hmac_credential > 0)
                 printf(" FIDO2 Token: %zu\n", hr->n_fido2_hmac_credential);
 
-        if (!strv_isempty(hr->recovery_key_type))
-                printf("Recovery Key: %zu\n", strv_length(hr->recovery_key_type));
+        if (!sd_strv_isempty(hr->recovery_key_type))
+                printf("Recovery Key: %zu\n", sd_strv_length(hr->recovery_key_type));
 
-        k = strv_length(hr->hashed_password);
+        k = sd_strv_length(hr->hashed_password);
         if (k == 0)
                 printf("   Passwords: %snone%s\n",
                        user_record_disposition(hr) == USER_REGULAR ? ansi_highlight_yellow() : ansi_normal(), ansi_normal());
@@ -636,7 +636,7 @@ void group_record_show(GroupRecord *gr,
                 }
         }
 
-        if (!strv_isempty(gr->administrators)) {
+        if (!sd_strv_isempty(gr->administrators)) {
                 const char *prefix = "      Admins:";
 
                 STRV_FOREACH(i, gr->administrators) {
@@ -648,8 +648,8 @@ void group_record_show(GroupRecord *gr,
         if (gr->description && !streq(gr->description, gr->group_name))
                 printf(" Description: %s\n", gr->description);
 
-        if (!strv_isempty(gr->hashed_password))
-                printf("   Passwords: %zu\n", strv_length(gr->hashed_password));
+        if (!sd_strv_isempty(gr->hashed_password))
+                printf("   Passwords: %zu\n", sd_strv_length(gr->hashed_password));
 
         if (gr->service)
                 printf("     Service: %s\n", gr->service);
diff '--color=auto' -Nurp a/src/shared/user-record.c b/src/shared/user-record.c
--- a/src/shared/user-record.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/user-record.c	2025-06-30 18:37:25.000000000 +0000
@@ -149,18 +149,18 @@ static UserRecord* user_record_free(User
 
         free(h->shell);
 
-        strv_free(h->environment);
+        sd_strv_free(h->environment);
         free(h->time_zone);
         free(h->preferred_language);
-        strv_free(h->additional_languages);
+        sd_strv_free(h->additional_languages);
         rlimit_free_all(h->rlimits);
 
         free(h->skeleton_directory);
 
-        strv_free_erase(h->hashed_password);
-        strv_free_erase(h->ssh_authorized_keys);
-        strv_free_erase(h->password);
-        strv_free_erase(h->token_pin);
+        sd_strv_free_erase(h->hashed_password);
+        sd_strv_free_erase(h->ssh_authorized_keys);
+        sd_strv_free_erase(h->password);
+        sd_strv_free_erase(h->token_pin);
 
         free(h->cifs_service);
         free(h->cifs_user_name);
@@ -175,9 +175,9 @@ static UserRecord* user_record_free(User
         free(h->fallback_shell);
         free(h->fallback_home_directory);
 
-        strv_free(h->member_of);
-        strv_free(h->capability_bounding_set);
-        strv_free(h->capability_ambient_set);
+        sd_strv_free(h->member_of);
+        sd_strv_free(h->capability_bounding_set);
+        sd_strv_free(h->capability_ambient_set);
 
         free(h->file_system_type);
         free(h->luks_cipher);
@@ -192,7 +192,7 @@ static UserRecord* user_record_free(User
         free(h->preferred_session_type);
         free(h->preferred_session_launcher);
 
-        strv_free(h->pkcs11_token_uri);
+        sd_strv_free(h->pkcs11_token_uri);
         for (size_t i = 0; i < h->n_pkcs11_encrypted_key; i++)
                 pkcs11_encrypted_key_done(h->pkcs11_encrypted_key + i);
         free(h->pkcs11_encrypted_key);
@@ -202,7 +202,7 @@ static UserRecord* user_record_free(User
         for (size_t i = 0; i < h->n_fido2_hmac_salt; i++)
                 fido2_hmac_salt_done(h->fido2_hmac_salt + i);
 
-        strv_free(h->recovery_key_type);
+        sd_strv_free(h->recovery_key_type);
         for (size_t i = 0; i < h->n_recovery_key; i++)
                 recovery_key_done(h->recovery_key + i);
 
@@ -515,12 +515,12 @@ static int json_dispatch_access_mode(con
 }
 
 static int json_dispatch_environment(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
-        _cleanup_strv_free_ char **n = NULL;
+        _cleanup_sd_strv_free_ char **n = NULL;
         char ***l = userdata;
         int r;
 
         if (json_variant_is_null(variant)) {
-                *l = strv_free(*l);
+                *l = sd_strv_free(*l);
                 return 0;
         }
 
@@ -545,7 +545,7 @@ static int json_dispatch_environment(con
                         return json_log_oom(variant, flags);
         }
 
-        return strv_free_and_replace(*l, n);
+        return sd_strv_free_and_replace(*l, n);
 }
 
 static int json_dispatch_locale(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
@@ -574,14 +574,14 @@ static int json_dispatch_locale(const ch
 }
 
 static int json_dispatch_locales(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
-        _cleanup_strv_free_ char **n = NULL;
+        _cleanup_sd_strv_free_ char **n = NULL;
         char ***l = userdata;
         const char *locale;
         JsonVariant *e;
         int r;
 
         if (json_variant_is_null(variant)) {
-                *l = strv_free(*l);
+                *l = sd_strv_free(*l);
                 return 0;
         }
 
@@ -596,12 +596,12 @@ static int json_dispatch_locales(const c
                 if (!locale_is_valid(locale))
                         return json_log(variant, flags, SYNTHETIC_ERRNO(EINVAL), "JSON field '%s' is not an array of valid locales.", strna(name));
 
-                r = strv_extend(&n, locale);
+                r = sd_strv_extend(&n, locale);
                 if (r < 0)
                         return json_log_oom(variant, flags);
         }
 
-        return strv_free_and_replace(*l, n);
+        return sd_strv_free_and_replace(*l, n);
 }
 
 JSON_DISPATCH_ENUM_DEFINE(json_dispatch_user_disposition, UserDisposition, user_disposition_from_string);
@@ -651,7 +651,7 @@ static int json_dispatch_weight(const ch
 }
 
 int json_dispatch_user_group_list(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         char ***list = userdata;
         JsonVariant *e;
         int r;
@@ -667,12 +667,12 @@ int json_dispatch_user_group_list(const
                 if (!valid_user_group_name(json_variant_string(e), FLAGS_SET(flags, JSON_RELAX) ? VALID_USER_RELAX : 0))
                         return json_log(e, flags, SYNTHETIC_ERRNO(EINVAL), "JSON array element is not a valid user/group name: %s", json_variant_string(e));
 
-                r = strv_extend(&l, json_variant_string(e));
+                r = sd_strv_extend(&l, json_variant_string(e));
                 if (r < 0)
                         return json_log(e, flags, r, "Failed to append array element: %m");
         }
 
-        r = strv_extend_strv(list, l, true);
+        r = sd_sd_strv_extend_strv(list, l, true);
         if (r < 0)
                 return json_log(variant, flags, r, "Failed to merge user/group arrays: %m");
 
@@ -719,13 +719,13 @@ static int dispatch_pkcs11_uri(const cha
 }
 
 static int dispatch_pkcs11_uri_array(const char *name, JsonVariant *variant, JsonDispatchFlags flags, void *userdata) {
-        _cleanup_strv_free_ char **z = NULL;
+        _cleanup_sd_strv_free_ char **z = NULL;
         char ***l = userdata;
         JsonVariant *e;
         int r;
 
         if (json_variant_is_null(variant)) {
-                *l = strv_free(*l);
+                *l = sd_strv_free(*l);
                 return 0;
         }
 
@@ -736,7 +736,7 @@ static int dispatch_pkcs11_uri_array(con
                 if (!pkcs11_uri_valid(n))
                         return json_log(variant, flags, SYNTHETIC_ERRNO(EINVAL), "JSON field '%s' is not a valid RFC7512 PKCS#11 URI.", strna(name));
 
-                z = strv_new(n);
+                z = sd_strv_new(n);
                 if (!z)
                         return log_oom();
 
@@ -755,13 +755,13 @@ static int dispatch_pkcs11_uri_array(con
                         if (!pkcs11_uri_valid(n))
                                 return json_log(variant, flags, SYNTHETIC_ERRNO(EINVAL), "JSON array element in '%s' is not a valid RFC7512 PKCS#11 URI: %s", strna(name), n);
 
-                        r = strv_extend(&z, n);
+                        r = sd_strv_extend(&z, n);
                         if (r < 0)
                                 return log_oom();
                 }
         }
 
-        strv_free_and_replace(*l, z);
+        sd_strv_free_and_replace(*l, z);
         return 0;
 }
 
@@ -2121,7 +2121,7 @@ bool user_record_can_authenticate(UserRe
         if (h->n_fido2_hmac_salt > 0)
                 return true;
 
-        return !strv_isempty(h->hashed_password);
+        return !sd_strv_isempty(h->hashed_password);
 }
 
 bool user_record_drop_caches(UserRecord *h) {
@@ -2190,19 +2190,19 @@ uint64_t user_record_capability_ambient_
 }
 
 int user_record_languages(UserRecord *h, char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(h);
         assert(ret);
 
         if (h->preferred_language) {
-                l = strv_new(h->preferred_language);
+                l = sd_strv_new(h->preferred_language);
                 if (!l)
                         return -ENOMEM;
         }
 
-        r = strv_extend_strv(&l, h->additional_languages, /* filter_duplicates= */ true);
+        r = sd_sd_strv_extend_strv(&l, h->additional_languages, /* filter_duplicates= */ true);
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/shared/userdb.c b/src/shared/userdb.c
--- a/src/shared/userdb.c	2025-06-30 18:55:45.299159936 +0000
+++ b/src/shared/userdb.c	2025-06-30 18:37:42.000000000 +0000
@@ -57,7 +57,7 @@ UserDBIterator* userdb_iterator_free(Use
                 return NULL;
 
         set_free(iterator->links);
-        strv_free(iterator->dropins);
+        sd_strv_free(iterator->dropins);
 
         switch (iterator->what) {
 
@@ -80,7 +80,7 @@ UserDBIterator* userdb_iterator_free(Use
         case LOOKUP_MEMBERSHIP:
                 free(iterator->found_user_name);
                 free(iterator->found_group_name);
-                strv_free(iterator->members_of_group);
+                sd_strv_free(iterator->members_of_group);
                 free(iterator->filter_user_name);
                 free(iterator->filter_group_name);
 
@@ -395,7 +395,7 @@ static int userdb_start_query(
                 JsonVariant *query,
                 UserDBFlags flags) {
 
-        _cleanup_strv_free_ char **except = NULL, **only = NULL;
+        _cleanup_sd_strv_free_ char **except = NULL, **only = NULL;
         _cleanup_closedir_ DIR *d = NULL;
         const char *e;
         int r, ret = 0;
@@ -412,7 +412,7 @@ static int userdb_start_query(
                 if (r > 0)
                         return -ENOLINK;
                 if (r < 0) {
-                        except = strv_split(e, ":");
+                        except = sd_strv_split(e, ":");
                         if (!except)
                                 return -ENOMEM;
                 }
@@ -420,7 +420,7 @@ static int userdb_start_query(
 
         e = getenv("SYSTEMD_ONLY_USERDB");
         if (e) {
-                only = strv_split(e, ":");
+                only = sd_strv_split(e, ":");
                 if (!only)
                         return -ENOMEM;
         }
@@ -748,7 +748,7 @@ int userdb_all(UserDBFlags flags, UserDB
         /* propagate IPC error, but only if there are no drop-ins */
         if (qr < 0 &&
             !iterator->nss_iterating &&
-            strv_isempty(iterator->dropins))
+            sd_strv_isempty(iterator->dropins))
                 return qr;
 
         *ret = TAKE_PTR(iterator);
@@ -1018,7 +1018,7 @@ int groupdb_all(UserDBFlags flags, UserD
 
         if (qr < 0 &&
             !iterator->nss_iterating &&
-            strv_isempty(iterator->dropins))
+            sd_strv_isempty(iterator->dropins))
                 return qr;
 
         *ret = TAKE_PTR(iterator);
@@ -1184,7 +1184,7 @@ int membershipdb_by_user(const char *nam
 
         if (qr < 0 &&
             !iterator->nss_iterating &&
-            strv_isempty(iterator->dropins))
+            sd_strv_isempty(iterator->dropins))
                 return qr;
 
         *ret = TAKE_PTR(iterator);
@@ -1226,7 +1226,7 @@ int membershipdb_by_group(const char *na
                 /* We ignore all errors here, since the group might be defined by a userdb native service, and we queried them already above. */
                 (void) nss_group_record_by_name(name, false, &gr);
                 if (gr) {
-                        iterator->members_of_group = strv_copy(gr->members);
+                        iterator->members_of_group = sd_strv_copy(gr->members);
                         if (!iterator->members_of_group)
                                 return -ENOMEM;
 
@@ -1242,8 +1242,8 @@ int membershipdb_by_group(const char *na
                 discover_membership_dropins(iterator, flags);
 
         if (qr < 0 &&
-            strv_isempty(iterator->members_of_group) &&
-            strv_isempty(iterator->dropins))
+            sd_strv_isempty(iterator->members_of_group) &&
+            sd_strv_isempty(iterator->dropins))
                 return qr;
 
         *ret = TAKE_PTR(iterator);
@@ -1276,7 +1276,7 @@ int membershipdb_all(UserDBFlags flags,
 
         if (qr < 0 &&
             !iterator->nss_iterating &&
-            strv_isempty(iterator->dropins))
+            sd_strv_isempty(iterator->dropins))
                 return qr;
 
         *ret = TAKE_PTR(iterator);
@@ -1311,7 +1311,7 @@ int membershipdb_iterator_get(
                                 }
 
                         } while (iterator->filter_user_name ? !strv_contains(g->gr_mem, iterator->filter_user_name) :
-                                                              strv_isempty(g->gr_mem));
+                                                              sd_strv_isempty(g->gr_mem));
 
                         if (g) {
                                 r = free_and_strdup(&iterator->found_group_name, g->gr_name);
@@ -1319,9 +1319,9 @@ int membershipdb_iterator_get(
                                         return r;
 
                                 if (iterator->filter_user_name)
-                                        iterator->members_of_group = strv_new(iterator->filter_user_name);
+                                        iterator->members_of_group = sd_strv_new(iterator->filter_user_name);
                                 else
-                                        iterator->members_of_group = strv_copy(g->gr_mem);
+                                        iterator->members_of_group = sd_strv_copy(g->gr_mem);
                                 if (!iterator->members_of_group)
                                         return -ENOMEM;
 
@@ -1362,7 +1362,7 @@ int membershipdb_iterator_get(
                         return 0;
                 }
 
-                iterator->members_of_group = strv_free(iterator->members_of_group);
+                iterator->members_of_group = sd_strv_free(iterator->members_of_group);
                 iterator->found_group_name = mfree(iterator->found_group_name);
         }
 
@@ -1417,7 +1417,7 @@ int membershipdb_iterator_get(
 
 int membershipdb_by_group_strv(const char *name, UserDBFlags flags, char ***ret) {
         _cleanup_(userdb_iterator_freep) UserDBIterator *iterator = NULL;
-        _cleanup_strv_free_ char **members = NULL;
+        _cleanup_sd_strv_free_ char **members = NULL;
         int r;
 
         assert(name);
@@ -1436,7 +1436,7 @@ int membershipdb_by_group_strv(const cha
                 if (r < 0)
                         return r;
 
-                r = strv_consume(&members, TAKE_PTR(user_name));
+                r = sd_strv_consume(&members, TAKE_PTR(user_name));
                 if (r < 0)
                         return r;
         }
diff '--color=auto' -Nurp a/src/shared/varlink.c b/src/shared/varlink.c
--- a/src/shared/varlink.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/varlink.c	2025-06-30 18:37:25.000000000 +0000
@@ -390,7 +390,7 @@ int varlink_connect_exec(Varlink **ret,
         _cleanup_close_pair_ int pair[2] = EBADF_PAIR;
         _cleanup_(sigkill_waitp) pid_t pid = 0;
         _cleanup_free_ char *command = NULL;
-        _cleanup_strv_free_ char **argv = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL;
         int r;
 
         assert_return(ret, -EINVAL);
@@ -402,10 +402,10 @@ int varlink_connect_exec(Varlink **ret,
         if (!command)
                 return -ENOMEM;
 
-        if (strv_isempty(_argv))
-                argv = strv_new(command);
+        if (sd_strv_isempty(_argv))
+                argv = sd_strv_new(command);
         else
-                argv = strv_copy(_argv);
+                argv = sd_strv_copy(_argv);
         if (!argv)
                 return -ENOMEM;
 
@@ -1245,7 +1245,7 @@ static int generic_method_get_info(
                 VarlinkMethodFlags flags,
                 void *userdata) {
 
-        _cleanup_strv_free_ char **interfaces = NULL;
+        _cleanup_sd_strv_free_ char **interfaces = NULL;
         _cleanup_free_ char *product = NULL;
         int r;
 
@@ -1260,7 +1260,7 @@ static int generic_method_get_info(
 
         VarlinkInterface *interface;
         HASHMAP_FOREACH(interface, ASSERT_PTR(link->server)->interfaces) {
-                r = strv_extend(&interfaces, interface->name);
+                r = sd_strv_extend(&interfaces, interface->name);
                 if (r < 0)
                         return r;
         }
@@ -3553,7 +3553,7 @@ int varlink_server_listen_address(Varlin
 }
 
 int varlink_server_listen_auto(VarlinkServer *s) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int r, n = 0;
 
         assert_return(s, -EINVAL);
@@ -4039,7 +4039,7 @@ int varlink_server_deserialize_one(Varli
 }
 
 int varlink_invocation(VarlinkInvocationFlags flags) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int r, b;
         socklen_t l = sizeof(b);
 
diff '--color=auto' -Nurp a/src/shared/vpick.c b/src/shared/vpick.c
--- a/src/shared/vpick.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/vpick.c	2025-06-30 18:37:25.000000000 +0000
@@ -34,7 +34,7 @@ static int format_fname(
 
         if (FLAGS_SET(flags, PICK_TRIES) || !filter->version) /* Underspecified? */
                 return -ENOEXEC;
-        if (strv_length(filter->suffix) > 1) /* suffix is not deterministic? */
+        if (sd_strv_length(filter->suffix) > 1) /* suffix is not deterministic? */
                 return -ENOEXEC;
 
         /* The format for names we match goes like this:
@@ -87,7 +87,7 @@ static int format_fname(
                         return -ENOMEM;
         }
 
-        if (!strv_isempty(filter->suffix))
+        if (!sd_strv_isempty(filter->suffix))
                 if (!strextend(&fn, filter->suffix[0]))
                         return -ENOMEM;
 
@@ -352,7 +352,7 @@ static int make_choice(
                 } else
                         e = dname;
 
-                if (!strv_isempty(filter->suffix)) {
+                if (!sd_strv_isempty(filter->suffix)) {
                         char *sfx = endswith_strv(e, filter->suffix);
                         if (!sfx)
                                 continue;
diff '--color=auto' -Nurp a/src/shared/wall.c b/src/shared/wall.c
--- a/src/shared/wall.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/shared/wall.c	2025-06-30 18:33:48.000000000 +0000
@@ -99,7 +99,7 @@ static int wall_logind(
         void *userdata) {
 
 #if ENABLE_LOGIND
-        _cleanup_strv_free_ char **sessions = NULL;
+        _cleanup_sd_strv_free_ char **sessions = NULL;
         int r;
 
         assert(message);
diff '--color=auto' -Nurp a/src/sleep/sleep.c b/src/sleep/sleep.c
--- a/src/sleep/sleep.c	2025-06-30 18:55:45.271159937 +0000
+++ b/src/sleep/sleep.c	2025-06-30 18:37:25.000000000 +0000
@@ -227,7 +227,7 @@ static int execute(
         assert(operation >= 0);
         assert(operation < _SLEEP_OPERATION_CONFIG_MAX); /* Others are handled by execute_s2h() instead */
 
-        if (strv_isempty(sleep_config->states[operation]))
+        if (sd_strv_isempty(sleep_config->states[operation]))
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "No sleep states configured for sleep operation %s, can't sleep.",
                                        sleep_operation_to_string(operation));
diff '--color=auto' -Nurp a/src/socket-activate/socket-activate.c b/src/socket-activate/socket-activate.c
--- a/src/socket-activate/socket-activate.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/socket-activate/socket-activate.c	2025-06-30 18:37:55.000000000 +0000
@@ -125,7 +125,7 @@ static int open_sockets(int *ret_epoll_f
 }
 
 static int exec_process(const char *name, char **argv, int start_fd, size_t n_fds) {
-        _cleanup_strv_free_ char **envp = NULL;
+        _cleanup_sd_strv_free_ char **envp = NULL;
         int r;
 
         if (arg_inetd && n_fds != 1)
@@ -139,7 +139,7 @@ static int exec_process(const char *name
                 if (!n)
                         continue;
 
-                r = strv_extend(&envp, n);
+                r = sd_strv_extend(&envp, n);
                 if (r < 0)
                         return r;
         }
@@ -161,11 +161,11 @@ static int exec_process(const char *name
                         safe_close(start_fd);
                 }
 
-                r = strv_extendf(&envp, "LISTEN_FDS=%zu", n_fds);
+                r = sd_sd_strv_extendf(&envp, "LISTEN_FDS=%zu", n_fds);
                 if (r < 0)
                         return r;
 
-                r = strv_extendf(&envp, "LISTEN_PID=" PID_FMT, getpid_cached());
+                r = sd_sd_strv_extendf(&envp, "LISTEN_PID=" PID_FMT, getpid_cached());
                 if (r < 0)
                         return r;
 
@@ -173,17 +173,17 @@ static int exec_process(const char *name
                         _cleanup_free_ char *names = NULL;
                         size_t len;
 
-                        len = strv_length(arg_fdnames);
+                        len = sd_strv_length(arg_fdnames);
                         if (len == 1)
                                 for (size_t i = 1; i < n_fds; i++) {
-                                        r = strv_extend(&arg_fdnames, arg_fdnames[0]);
+                                        r = sd_strv_extend(&arg_fdnames, arg_fdnames[0]);
                                         if (r < 0)
                                                 return log_oom();
                                 }
                         else if (len != n_fds)
                                 log_warning("The number of fd names is different than number of fds: %zu vs %zu", len, n_fds);
 
-                        names = strv_join(arg_fdnames, ":");
+                        names = sd_strv_join(arg_fdnames, ":");
                         if (!names)
                                 return log_oom();
 
@@ -191,7 +191,7 @@ static int exec_process(const char *name
                         if (!t)
                                 return log_oom();
 
-                        r = strv_consume(&envp, t);
+                        r = sd_strv_consume(&envp, t);
                         if (r < 0)
                                 return r;
                 }
@@ -203,7 +203,7 @@ static int exec_process(const char *name
                         return r;
         }
 
-        _cleanup_free_ char *joined = strv_join(argv, " ");
+        _cleanup_free_ char *joined = sd_strv_join(argv, " ");
         if (!joined)
                 return log_oom();
 
@@ -218,7 +218,7 @@ static int fork_and_exec_process(const c
         pid_t child_pid;
         int r;
 
-        joined = strv_join(argv, " ");
+        joined = sd_strv_join(argv, " ");
         if (!joined)
                 return log_oom();
 
@@ -359,7 +359,7 @@ static int parse_argv(int argc, char *ar
                         return version();
 
                 case 'l':
-                        r = strv_extend(&arg_listen, optarg);
+                        r = sd_strv_extend(&arg_listen, optarg);
                         if (r < 0)
                                 return log_oom();
 
@@ -392,9 +392,9 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_FDNAME: {
-                        _cleanup_strv_free_ char **names = NULL;
+                        _cleanup_sd_strv_free_ char **names = NULL;
 
-                        names = strv_split(optarg, ":");
+                        names = sd_strv_split(optarg, ":");
                         if (!names)
                                 return log_oom();
 
@@ -407,11 +407,11 @@ static int parse_argv(int argc, char *ar
                                 }
 
                         /* Empty optargs means one empty name */
-                        r = strv_extend_strv(&arg_fdnames,
-                                             strv_isempty(names) ? STRV_MAKE("") : names,
+                        r = sd_sd_strv_extend_strv(&arg_fdnames,
+                                             sd_strv_isempty(names) ? STRV_MAKE("") : names,
                                              false);
                         if (r < 0)
-                                return log_error_errno(r, "strv_extend_strv: %m");
+                                return log_error_errno(r, "sd_sd_strv_extend_strv: %m");
                         break;
                 }
 
@@ -443,7 +443,7 @@ static int parse_argv(int argc, char *ar
 
 static int run(int argc, char **argv) {
         _cleanup_close_ int epoll_fd = -EBADF;
-        _cleanup_strv_free_ char **exec_argv = NULL;
+        _cleanup_sd_strv_free_ char **exec_argv = NULL;
         int r, n;
 
         log_setup();
@@ -452,11 +452,11 @@ static int run(int argc, char **argv) {
         if (r <= 0)
                 return r;
 
-        exec_argv = strv_copy(arg_args);
+        exec_argv = sd_strv_copy(arg_args);
         if (!exec_argv)
                 return log_oom();
 
-        assert(!strv_isempty(exec_argv));
+        assert(!sd_strv_isempty(exec_argv));
 
         r = install_chld_handler();
         if (r < 0)
diff '--color=auto' -Nurp a/src/ssh-generator/ssh-generator.c b/src/ssh-generator/ssh-generator.c
--- a/src/ssh-generator/ssh-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/ssh-generator/ssh-generator.c	2025-06-30 18:37:25.000000000 +0000
@@ -60,7 +60,7 @@ static int parse_proc_cmdline_item(const
                         if (r < 0)
                                 return log_error_errno(r, "Failed to format socket address: %m");
 
-                        if (strv_consume(&arg_listen_extra, TAKE_PTR(s)) < 0)
+                        if (sd_strv_consume(&arg_listen_extra, TAKE_PTR(s)) < 0)
                                 return log_oom();
                 }
         }
@@ -355,7 +355,7 @@ static int add_extra_sockets(
         assert(sshd_binary);
         assert(generated_sshd_template_unit);
 
-        if (strv_isempty(arg_listen_extra))
+        if (sd_strv_isempty(arg_listen_extra))
                 return 0;
 
         STRV_FOREACH(i, arg_listen_extra) {
@@ -434,7 +434,7 @@ static int parse_credentials(void) {
                 if (r < 0)
                         return log_error_errno(r, "Failed to format socket address: %m");
 
-                if (strv_consume(&arg_listen_extra, TAKE_PTR(s)) < 0)
+                if (sd_strv_consume(&arg_listen_extra, TAKE_PTR(s)) < 0)
                         return log_oom();
         }
 
@@ -455,7 +455,7 @@ static int run(const char *dest, const c
         strv_sort(arg_listen_extra);
         strv_uniq(arg_listen_extra);
 
-        if (!arg_auto && strv_isempty(arg_listen_extra)) {
+        if (!arg_auto && sd_strv_isempty(arg_listen_extra)) {
                 log_debug("Disabling SSH generator logic, because as it has been turned off explicitly.");
                 return 0;
         }
diff '--color=auto' -Nurp a/src/storagetm/storagetm.c b/src/storagetm/storagetm.c
--- a/src/storagetm/storagetm.c	2025-06-30 18:55:45.271159937 +0000
+++ b/src/storagetm/storagetm.c	2025-06-30 18:34:43.000000000 +0000
@@ -33,7 +33,7 @@ static char **arg_devices = NULL;
 static char *arg_nqn = NULL;
 static int arg_all = 0;
 
-STATIC_DESTRUCTOR_REGISTER(arg_devices, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_devices, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_nqn, freep);
 
 static int help(void) {
@@ -120,7 +120,7 @@ static int parse_argv(int argc, char *ar
                         if (!path_is_valid(argv[i]))
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Invalid path: %s", argv[i]);
 
-                arg_devices = strv_copy(argv + optind);
+                arg_devices = sd_strv_copy(argv + optind);
         }
 
         if (!arg_nqn) {
diff '--color=auto' -Nurp a/src/sysctl/sysctl.c b/src/sysctl/sysctl.c
--- a/src/sysctl/sysctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysctl/sysctl.c	2025-06-30 18:37:25.000000000 +0000
@@ -32,7 +32,7 @@ static CatFlags arg_cat_flags = CAT_CONF
 static bool arg_strict = false;
 static PagerFlags arg_pager_flags = 0;
 
-STATIC_DESTRUCTOR_REGISTER(arg_prefixes, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_prefixes, sd_strv_freep);
 
 typedef struct Option {
         char *key;
@@ -54,7 +54,7 @@ DEFINE_TRIVIAL_CLEANUP_FUNC(Option*, opt
 DEFINE_HASH_OPS_WITH_VALUE_DESTRUCTOR(option_hash_ops, char, string_hash_func, string_compare_func, Option, option_free);
 
 static bool test_prefix(const char *p) {
-        if (strv_isempty(arg_prefixes))
+        if (sd_strv_isempty(arg_prefixes))
                 return true;
 
         return path_startswith_strv(p, arg_prefixes);
@@ -111,7 +111,7 @@ static int sysctl_write_or_warn(const ch
 }
 
 static int apply_glob_option_with_prefix(OrderedHashmap *sysctl_options, Option *option, const char *prefix) {
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         _cleanup_free_ char *pattern = NULL;
         int r;
 
@@ -185,7 +185,7 @@ static int apply_glob_option_with_prefix
 static int apply_glob_option(OrderedHashmap *sysctl_options, Option *option) {
         int r = 0;
 
-        if (strv_isempty(arg_prefixes))
+        if (sd_strv_isempty(arg_prefixes))
                 return apply_glob_option_with_prefix(sysctl_options, option, NULL);
 
         STRV_FOREACH(i, arg_prefixes)
@@ -420,7 +420,7 @@ static int parse_argv(int argc, char *ar
                         if (!p)
                                 return log_oom();
 
-                        if (strv_consume(&arg_prefixes, p) < 0)
+                        if (sd_strv_consume(&arg_prefixes, p) < 0)
                                 return log_oom();
 
                         break;
@@ -467,7 +467,7 @@ static int run(int argc, char *argv[]) {
                         RET_GATHER(r, parse_file(&sysctl_options, argv[i], false));
 
         } else {
-                _cleanup_strv_free_ char **files = NULL;
+                _cleanup_sd_strv_free_ char **files = NULL;
 
                 r = conf_files_list_strv(&files, ".conf", NULL, 0, (const char**) CONF_PATHS_STRV("sysctl.d"));
                 if (r < 0)
diff '--color=auto' -Nurp a/src/sysext/sysext.c b/src/sysext/sysext.c
--- a/src/sysext/sysext.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysext/sysext.c	2025-06-30 18:37:55.000000000 +0000
@@ -91,7 +91,7 @@ static ImageClass arg_image_class = IMAG
 
 #define MUTABLE_EXTENSIONS_BASE_DIR "/var/lib/extensions.mutable"
 
-STATIC_DESTRUCTOR_REGISTER(arg_hierarchies, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_hierarchies, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
 
@@ -213,7 +213,7 @@ static int need_reload(
 
         STRV_FOREACH(p, hierarchies) {
                 _cleanup_free_ char *f = NULL, *buf = NULL, *resolved = NULL;
-                _cleanup_strv_free_ char **mounted_extensions = NULL;
+                _cleanup_sd_strv_free_ char **mounted_extensions = NULL;
 
                 r = chase(*p, arg_root, CHASE_PREFIX_ROOT, &resolved, NULL);
                 if (r == -ENOENT) {
@@ -239,12 +239,12 @@ static int need_reload(
                 if (r < 0)
                         return log_error_errno(r, "Failed to open '%s': %m", f);
 
-                mounted_extensions = strv_split_newlines(buf);
+                mounted_extensions = sd_strv_split_newlines(buf);
                 if (!mounted_extensions)
                         return log_oom();
 
                 STRV_FOREACH(extension, mounted_extensions) {
-                        _cleanup_strv_free_ char **extension_release = NULL;
+                        _cleanup_sd_strv_free_ char **extension_release = NULL;
                         const char *extension_reload_manager = NULL;
                         int b;
 
@@ -412,7 +412,7 @@ static int verb_unmerge(int argc, char *
 }
 
 static int parse_image_class_parameter(Varlink *link, const char *value, ImageClass *image_class, char ***hierarchies) {
-        _cleanup_strv_free_ char **h = NULL;
+        _cleanup_sd_strv_free_ char **h = NULL;
         ImageClass c;
         int r;
 
@@ -431,7 +431,7 @@ static int parse_image_class_parameter(V
                 if (r < 0)
                         return log_error_errno(r, "Failed to parse environment variable: %m");
 
-                strv_free_and_replace(*hierarchies, h);
+                sd_strv_free_and_replace(*hierarchies, h);
         }
 
         *image_class = c;
@@ -453,7 +453,7 @@ static int vl_method_unmerge(Varlink *li
         MethodUnmergeParameters p = {
                 .no_reload = -1,
         };
-        _cleanup_strv_free_ char **hierarchies = NULL;
+        _cleanup_sd_strv_free_ char **hierarchies = NULL;
         ImageClass image_class = arg_image_class;
         int r;
 
@@ -488,7 +488,7 @@ static int verb_status(int argc, char **
 
         STRV_FOREACH(p, arg_hierarchies) {
                 _cleanup_free_ char *resolved = NULL, *f = NULL, *buf = NULL;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 struct stat st;
 
                 r = chase(*p, arg_root, CHASE_PREFIX_ROOT, &resolved, NULL);
@@ -525,7 +525,7 @@ static int verb_status(int argc, char **
                 if (r < 0)
                         return log_error_errno(r, "Failed to open '%s': %m", f);
 
-                l = strv_split_newlines(buf);
+                l = sd_strv_split_newlines(buf);
                 if (!l)
                         return log_oom();
 
@@ -739,7 +739,7 @@ static OverlayFSPaths *overlayfs_paths_f
 
         free(op->upper_dir);
         free(op->work_dir);
-        strv_free(op->lower_dirs);
+        sd_strv_free(op->lower_dirs);
 
         return mfree(op);
 }
@@ -898,7 +898,7 @@ static int overlayfs_paths_new(const cha
 }
 
 static int determine_used_extensions(const char *hierarchy, char **paths, char ***ret_used_paths, size_t *ret_extensions_used) {
-        _cleanup_strv_free_ char **used_paths = NULL;
+        _cleanup_sd_strv_free_ char **used_paths = NULL;
         size_t n = 0;
         int r;
 
@@ -926,7 +926,7 @@ static int determine_used_extensions(con
                         continue;
                 }
 
-                r = strv_consume_with_size (&used_paths, &n, TAKE_PTR(resolved));
+                r = sd_strv_consume_with_size (&used_paths, &n, TAKE_PTR(resolved));
                 if (r < 0)
                         return log_oom();
         }
@@ -953,7 +953,7 @@ static int maybe_import_mutable_director
         if (r > 0)
                 return log_error_errno(SYNTHETIC_ERRNO(ELOOP), "Not importing mutable directory for hierarchy %s as a lower dir, because it points to the hierarchy itself", op->hierarchy);
 
-        r = strv_extend(&op->lower_dirs, op->resolved_mutable_directory);
+        r = sd_strv_extend(&op->lower_dirs, op->resolved_mutable_directory);
         if (r < 0)
                 return log_oom();
 
@@ -994,7 +994,7 @@ static int maybe_import_ignored_mutable_
         if (r > 0)
                 return log_error_errno(SYNTHETIC_ERRNO(ELOOP), "Not importing mutable directory for hierarchy %s as a lower dir, because it points to the hierarchy itself", op->hierarchy);
 
-        r = strv_consume(&op->lower_dirs, TAKE_PTR(resolved_path));
+        r = sd_strv_consume(&op->lower_dirs, TAKE_PTR(resolved_path));
         if (r < 0)
                 return log_oom();
 
@@ -1008,7 +1008,7 @@ static int determine_top_lower_dirs(Over
         assert(meta_path);
 
         /* Put the meta path (i.e. our synthesized stuff) at the top of the layer stack */
-        r = strv_extend(&op->lower_dirs, meta_path);
+        r = sd_strv_extend(&op->lower_dirs, meta_path);
         if (r < 0)
                 return log_oom();
 
@@ -1030,7 +1030,7 @@ static int determine_middle_lower_dirs(O
         assert(paths);
 
         /* The paths were already determined in determine_used_extensions, so we just take them as is. */
-        r = strv_extend_strv(&op->lower_dirs, paths, false);
+        r = sd_sd_strv_extend_strv(&op->lower_dirs, paths, false);
         if (r < 0)
                 return log_oom ();
 
@@ -1092,7 +1092,7 @@ static int determine_bottom_lower_dirs(O
         if (r < 0)
                 return r;
         if (!r) {
-                r = strv_extend(&op->lower_dirs, op->resolved_hierarchy);
+                r = sd_strv_extend(&op->lower_dirs, op->resolved_hierarchy);
                 if (r < 0)
                         return log_oom();
         }
@@ -1205,7 +1205,7 @@ static int mount_overlayfs_with_op(
                         return log_error_errno(r, "Failed to make directory '%s': %m", op->work_dir);
                 top_layer = op->upper_dir;
         } else {
-                assert(!strv_isempty(op->lower_dirs));
+                assert(!sd_strv_isempty(op->lower_dirs));
                 top_layer = op->lower_dirs[0];
         }
 
@@ -1237,7 +1237,7 @@ static int write_extensions_file(ImageCl
         if (!f)
                 return log_oom();
 
-        buf = strv_join(extensions, "\n");
+        buf = sd_strv_join(extensions, "\n");
         if (!buf)
                 return log_oom();
 
@@ -1388,7 +1388,7 @@ static int merge_hierarchy(
                 const char *workspace_path) {
 
         _cleanup_(overlayfs_paths_freep) OverlayFSPaths *op = NULL;
-        _cleanup_strv_free_ char **used_paths = NULL;
+        _cleanup_sd_strv_free_ char **used_paths = NULL;
         size_t extensions_used = 0;
         int r;
 
@@ -1477,7 +1477,7 @@ static int merge_subprocess(
                 const char *workspace) {
 
         _cleanup_free_ char *host_os_release_id = NULL, *host_os_release_version_id = NULL, *host_os_release_api_level = NULL, *buf = NULL;
-        _cleanup_strv_free_ char **extensions = NULL, **paths = NULL;
+        _cleanup_sd_strv_free_ char **extensions = NULL, **paths = NULL;
         size_t n_extensions = 0;
         unsigned n_ignored = 0;
         Image *img;
@@ -1654,7 +1654,7 @@ static int merge_subprocess(
                 }
 
                 /* Nice! This one is an extension we want. */
-                r = strv_extend(&extensions, img->name);
+                r = sd_strv_extend(&extensions, img->name);
                 if (r < 0)
                         return log_oom();
 
@@ -1673,7 +1673,7 @@ static int merge_subprocess(
         /* Order by version sort with strverscmp_improved() */
         typesafe_qsort(extensions, n_extensions, strverscmp_improvedp);
 
-        buf = strv_join(extensions, "', '");
+        buf = sd_strv_join(extensions, "', '");
         if (!buf)
                 return log_oom();
 
@@ -1940,7 +1940,7 @@ static int vl_method_merge(Varlink *link
                 .no_reload = -1,
                 .noexec = -1,
         };
-        _cleanup_strv_free_ char **hierarchies = NULL;
+        _cleanup_sd_strv_free_ char **hierarchies = NULL;
         ImageClass image_class = arg_image_class;
         int r;
 
@@ -2043,7 +2043,7 @@ static int vl_method_refresh(Varlink *li
                 .no_reload = -1,
                 .noexec = -1,
         };
-        _cleanup_strv_free_ char **hierarchies = NULL;
+        _cleanup_sd_strv_free_ char **hierarchies = NULL;
         ImageClass image_class = arg_image_class;
         int r;
 
diff '--color=auto' -Nurp a/src/systemctl/fuzz-systemctl-parse-argv.c b/src/systemctl/fuzz-systemctl-parse-argv.c
--- a/src/systemctl/fuzz-systemctl-parse-argv.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/fuzz-systemctl-parse-argv.c	2025-06-30 18:35:00.000000000 +0000
@@ -15,12 +15,12 @@
 #include "systemctl-util.h"
 
 int LLVMFuzzerTestOneInput(const uint8_t *data, size_t size) {
-        _cleanup_strv_free_ char **argv = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL;
         _cleanup_close_ int orig_stdout_fd = -EBADF;
         int r;
 
         if (size > 16*1024)
-                return 0; /* See the comment below about the limit for strv_length(). */
+                return 0; /* See the comment below about the limit for sd_strv_length(). */
 
         fuzz_setup_logging();
 
@@ -32,7 +32,7 @@ int LLVMFuzzerTestOneInput(const uint8_t
 
         if (!argv[0])
                 return 0; /* argv[0] should always be present, but may be zero-length. */
-        if (strv_length(argv) > 1024)
+        if (sd_strv_length(argv) > 1024)
                 return 0; /* oss-fuzz reports timeouts which are caused by appending to a very long strv.
                            * The code is indeed not very efficient, but it's designed for normal command-line
                            * use, where we don't expect more than a dozen of entries. The fact that it is
@@ -55,7 +55,7 @@ int LLVMFuzzerTestOneInput(const uint8_t
         optind = 0; /* this tells the getopt machinery to reinitialize */
         arg_transport = BUS_TRANSPORT_LOCAL;
 
-        r = systemctl_dispatch_parse_argv(strv_length(argv), argv);
+        r = systemctl_dispatch_parse_argv(sd_strv_length(argv), argv);
         if (r < 0)
                 log_error_errno(r, "Failed to parse args: %m");
         else
diff '--color=auto' -Nurp a/src/systemctl/systemctl-add-dependency.c b/src/systemctl/systemctl-add-dependency.c
--- a/src/systemctl/systemctl-add-dependency.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-add-dependency.c	2025-06-30 18:33:48.000000000 +0000
@@ -8,7 +8,7 @@
 #include "systemctl.h"
 
 int verb_add_dependency(int argc, char *argv[], void *userdata) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         _cleanup_free_ char *target = NULL;
         const char *verb = argv[0];
         UnitDependency dep;
diff '--color=auto' -Nurp a/src/systemctl/systemctl-clean-or-freeze.c b/src/systemctl/systemctl-clean-or-freeze.c
--- a/src/systemctl/systemctl-clean-or-freeze.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-clean-or-freeze.c	2025-06-30 18:37:06.000000000 +0000
@@ -9,7 +9,7 @@
 
 int verb_clean_or_freeze(int argc, char *argv[], void *userdata) {
         _cleanup_(bus_wait_for_units_freep) BusWaitForUnits *w = NULL;
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int r, ret = EXIT_SUCCESS;
         const char *method;
         sd_bus *bus;
@@ -21,7 +21,7 @@ int verb_clean_or_freeze(int argc, char
         polkit_agent_open_maybe();
 
         if (!arg_clean_what) {
-                arg_clean_what = strv_new("cache", "runtime", "fdstore");
+                arg_clean_what = sd_strv_new("cache", "runtime", "fdstore");
                 if (!arg_clean_what)
                         return log_oom();
         }
diff '--color=auto' -Nurp a/src/systemctl/systemctl-compat-shutdown.c b/src/systemctl/systemctl-compat-shutdown.c
--- a/src/systemctl/systemctl-compat-shutdown.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-compat-shutdown.c	2025-06-30 18:34:43.000000000 +0000
@@ -147,10 +147,10 @@ int shutdown_parse_argv(int argc, char *
                 wall = argv + optind + 1;
 
         if (wall) {
-                char **copy = strv_copy(wall);
+                char **copy = sd_strv_copy(wall);
                 if (!copy)
                         return log_oom();
-                strv_free_and_replace(arg_wall, copy);
+                sd_strv_free_and_replace(arg_wall, copy);
         }
 
         optind = argc;
diff '--color=auto' -Nurp a/src/systemctl/systemctl-edit.c b/src/systemctl/systemctl-edit.c
--- a/src/systemctl/systemctl-edit.c	2025-06-30 18:55:45.447159933 +0000
+++ b/src/systemctl/systemctl-edit.c	2025-06-30 18:37:25.000000000 +0000
@@ -18,13 +18,13 @@
 int verb_cat(int argc, char *argv[], void *userdata) {
         _cleanup_hashmap_free_ Hashmap *cached_id_map = NULL, *cached_name_map = NULL;
         _cleanup_(lookup_paths_done) LookupPaths lp = {};
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         sd_bus *bus;
         bool first = true;
         int r, rc = 0;
 
         /* Include all units by default ‚Äî i.e. continue as if the --all option was used */
-        if (strv_isempty(arg_states))
+        if (sd_strv_isempty(arg_states))
                 arg_all = true;
 
         if (arg_transport != BUS_TRANSPORT_LOCAL)
@@ -50,7 +50,7 @@ int verb_cat(int argc, char *argv[], voi
 
         STRV_FOREACH(name, names) {
                 _cleanup_free_ char *fragment_path = NULL;
-                _cleanup_strv_free_ char **dropin_paths = NULL;
+                _cleanup_sd_strv_free_ char **dropin_paths = NULL;
 
                 r = unit_find_paths(bus, *name, &lp, false, &cached_id_map, &cached_name_map, &fragment_path, &dropin_paths);
                 if (r == -ERFKILL) {
@@ -233,7 +233,7 @@ static int find_paths_to_edit(
 
         STRV_FOREACH(name, names) {
                 _cleanup_free_ char *path = NULL;
-                _cleanup_strv_free_ char **unit_paths = NULL;
+                _cleanup_sd_strv_free_ char **unit_paths = NULL;
 
                 r = unit_find_paths(bus, *name, &lp, /* force_client_side= */ false, &cached_id_map, &cached_name_map, &path, &unit_paths);
                 if (r == -EKEYREJECTED) {
@@ -320,7 +320,7 @@ int verb_edit(int argc, char *argv[], vo
                 .overwrite_with_origin = true,
                 .stdin = arg_stdin,
         };
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         sd_bus *bus;
         int r;
 
@@ -341,10 +341,10 @@ int verb_edit(int argc, char *argv[], vo
         r = expand_unit_names(bus, strv_skip(argv, 1), NULL, &names, NULL);
         if (r < 0)
                 return log_error_errno(r, "Failed to expand names: %m");
-        if (strv_isempty(names))
+        if (sd_strv_isempty(names))
                 return log_error_errno(SYNTHETIC_ERRNO(ENOENT), "No units matched the specified patterns.");
 
-        if (arg_stdin && arg_full && strv_length(names) != 1)
+        if (arg_stdin && arg_full && sd_strv_length(names) != 1)
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "With 'edit --stdin --full', exactly one unit for editing must be specified.");
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl-enable.c b/src/systemctl/systemctl-enable.c
--- a/src/systemctl/systemctl-enable.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-enable.c	2025-06-30 18:37:55.000000000 +0000
@@ -62,7 +62,7 @@ static int normalize_names(char **names)
 }
 
 int verb_enable(int argc, char *argv[], void *userdata) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         const char *verb = argv[0];
         int carries_install_info = -1;
         bool ignore_carries_install_info = arg_quiet || arg_no_warn;
@@ -82,7 +82,7 @@ int verb_enable(int argc, char *argv[],
                 return r;
 
         /* If the operation was fully executed by the SysV compat, let's finish early */
-        if (strv_isempty(names)) {
+        if (sd_strv_isempty(names)) {
                 if (arg_no_reload || install_client_side())
                         return 0;
 
@@ -279,7 +279,7 @@ int verb_enable(int argc, char *argv[],
                 /* If some of the units are disabled in user scope but still enabled in global scope,
                  * we emit a warning for that. */
 
-                /* No strv_free here, strings are owned by 'names' */
+                /* No sd_strv_free here, strings are owned by 'names' */
                 _cleanup_free_ char **enabled_in_global_scope = NULL;
 
                 STRV_FOREACH(name, names) {
@@ -292,16 +292,16 @@ int verb_enable(int argc, char *argv[],
                                 return log_error_errno(r, "Failed to get unit file state for %s: %m", *name);
 
                         if (IN_SET(state, UNIT_FILE_ENABLED, UNIT_FILE_ENABLED_RUNTIME)) {
-                                r = strv_push(&enabled_in_global_scope, *name);
+                                r = sd_strv_push(&enabled_in_global_scope, *name);
                                 if (r < 0)
                                         return log_oom();
                         }
                 }
 
-                if (!strv_isempty(enabled_in_global_scope)) {
+                if (!sd_strv_isempty(enabled_in_global_scope)) {
                         _cleanup_free_ char *joined = NULL;
 
-                        joined = strv_join(enabled_in_global_scope, ", ");
+                        joined = sd_strv_join(enabled_in_global_scope, ", ");
                         if (!joined)
                                 return log_oom();
 
@@ -314,7 +314,7 @@ int verb_enable(int argc, char *argv[],
         }
 
         if (arg_now) {
-                _cleanup_strv_free_ char **new_args = NULL;
+                _cleanup_sd_strv_free_ char **new_args = NULL;
 
                 if (!STR_IN_SET(verb, "enable", "disable", "mask"))
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
@@ -326,7 +326,7 @@ int verb_enable(int argc, char *argv[],
 
                 assert(bus);
 
-                if (strv_extend(&new_args, streq(verb, "enable") ? "start" : "stop") < 0)
+                if (sd_strv_extend(&new_args, streq(verb, "enable") ? "start" : "stop") < 0)
                         return log_oom();
 
                 STRV_FOREACH(name, names) {
@@ -342,7 +342,7 @@ int verb_enable(int argc, char *argv[],
                                 if (r < 0)
                                         return log_error_errno(r, "Failed to extract filename of '%s': %m", *name);
 
-                                r = strv_consume(&new_args, fn);
+                                r = sd_strv_consume(&new_args, fn);
                         } else if (unit_name_is_valid(*name, UNIT_NAME_TEMPLATE)) {
                                 char *globbed;
 
@@ -350,14 +350,14 @@ int verb_enable(int argc, char *argv[],
                                 if (r < 0)
                                         return log_error_errno(r, "Failed to glob unit name '%s': %m", *name);
 
-                                r = strv_consume(&new_args, globbed);
+                                r = sd_strv_consume(&new_args, globbed);
                         } else
-                                r = strv_extend(&new_args, *name);
+                                r = sd_strv_extend(&new_args, *name);
                         if (r < 0)
                                 return log_oom();
                 }
 
-                return verb_start(strv_length(new_args), new_args, userdata);
+                return verb_start(sd_strv_length(new_args), new_args, userdata);
         }
 
         return 0;
diff '--color=auto' -Nurp a/src/systemctl/systemctl-is-active.c b/src/systemctl/systemctl-is-active.c
--- a/src/systemctl/systemctl-is-active.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-is-active.c	2025-06-30 18:33:48.000000000 +0000
@@ -10,7 +10,7 @@
 #include "systemctl.h"
 
 static int check_unit_generic(int code, const UnitActiveState good_states[], size_t nb_states, char **args) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         UnitActiveState active_state;
         sd_bus *bus;
         bool not_found = true, ok = false;
diff '--color=auto' -Nurp a/src/systemctl/systemctl-is-enabled.c b/src/systemctl/systemctl-is-enabled.c
--- a/src/systemctl/systemctl-is-enabled.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-is-enabled.c	2025-06-30 18:33:48.000000000 +0000
@@ -59,7 +59,7 @@ static int show_installation_targets(sd_
 }
 
 int verb_is_enabled(int argc, char *argv[], void *userdata) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         bool not_found, enabled;
         int r;
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl-kill.c b/src/systemctl/systemctl-kill.c
--- a/src/systemctl/systemctl-kill.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-kill.c	2025-06-30 18:33:48.000000000 +0000
@@ -9,7 +9,7 @@
 
 int verb_kill(int argc, char *argv[], void *userdata) {
         _cleanup_(bus_wait_for_units_freep) BusWaitForUnits *w = NULL;
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         const char *kill_whom;
         sd_bus *bus;
         int r, q;
diff '--color=auto' -Nurp a/src/systemctl/systemctl-list-dependencies.c b/src/systemctl/systemctl-list-dependencies.c
--- a/src/systemctl/systemctl-list-dependencies.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-list-dependencies.c	2025-06-30 18:37:25.000000000 +0000
@@ -86,7 +86,7 @@ static int list_dependencies_one(
                 char ***units,
                 unsigned branches) {
 
-        _cleanup_strv_free_ char **deps = NULL;
+        _cleanup_sd_strv_free_ char **deps = NULL;
         int r;
         bool circular = false;
 
@@ -94,7 +94,7 @@ static int list_dependencies_one(
         assert(name);
         assert(units);
 
-        r = strv_extend(units, name);
+        r = sd_strv_extend(units, name);
         if (r < 0)
                 return log_oom();
 
@@ -102,7 +102,7 @@ static int list_dependencies_one(
         if (r < 0)
                 return r;
 
-        typesafe_qsort(deps, strv_length(deps), list_dependencies_compare);
+        typesafe_qsort(deps, sd_strv_length(deps), list_dependencies_compare);
 
         STRV_FOREACH(c, deps) {
                 _cleanup_free_ char *load_state = NULL, *sub_state = NULL;
@@ -151,13 +151,13 @@ static int list_dependencies_one(
         }
 
         if (!arg_plain)
-                strv_remove(*units, name);
+                sd_strv_remove(*units, name);
 
         return 0;
 }
 
 int verb_list_dependencies(int argc, char *argv[], void *userdata) {
-        _cleanup_strv_free_ char **units = NULL, **done = NULL;
+        _cleanup_sd_strv_free_ char **units = NULL, **done = NULL;
         char **patterns;
         sd_bus *bus;
         int r;
@@ -170,8 +170,8 @@ int verb_list_dependencies(int argc, cha
                 return r;
 
         patterns = strv_skip(argv, 1);
-        if (strv_isempty(patterns)) {
-                units = strv_new(SPECIAL_DEFAULT_TARGET);
+        if (sd_strv_isempty(patterns)) {
+                units = sd_strv_new(SPECIAL_DEFAULT_TARGET);
                 if (!units)
                         return log_oom();
         } else {
diff '--color=auto' -Nurp a/src/systemctl/systemctl-list-machines.c b/src/systemctl/systemctl-list-machines.c
--- a/src/systemctl/systemctl-list-machines.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-list-machines.c	2025-06-30 18:33:48.000000000 +0000
@@ -97,7 +97,7 @@ static int get_machine_list(
                 char **patterns) {
 
         struct machine_info *machine_infos = NULL;
-        _cleanup_strv_free_ char **m = NULL;
+        _cleanup_sd_strv_free_ char **m = NULL;
         _cleanup_free_ char *hn = NULL;
         int c = 0, r;
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl-list-unit-files.c b/src/systemctl/systemctl-list-unit-files.c
--- a/src/systemctl/systemctl-list-unit-files.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-list-unit-files.c	2025-06-30 18:37:25.000000000 +0000
@@ -31,7 +31,7 @@ static bool output_show_unit_file(const
         if (!strv_fnmatch_or_empty(patterns, basename(u->path), FNM_NOESCAPE))
                 return false;
 
-        if (!strv_isempty(arg_types)) {
+        if (!sd_strv_isempty(arg_types)) {
                 const char *dot;
 
                 dot = strrchr(u->path, '.');
@@ -42,7 +42,7 @@ static bool output_show_unit_file(const
                         return false;
         }
 
-        if (!strv_isempty(states) &&
+        if (!sd_strv_isempty(states) &&
             !strv_contains(states, unit_file_state_to_string(u->state)))
                 return false;
 
@@ -194,7 +194,7 @@ int verb_list_unit_files(int argc, char
                         return bus_log_create_error(r);
 
                 if (arg_with_dependencies) {
-                        _cleanup_strv_free_ char **names_with_deps = NULL;
+                        _cleanup_sd_strv_free_ char **names_with_deps = NULL;
 
                         r = append_unit_dependencies(bus, strv_skip(argv, 1), &names_with_deps);
                         if (r < 0)
diff '--color=auto' -Nurp a/src/systemctl/systemctl-list-units.c b/src/systemctl/systemctl-list-units.c
--- a/src/systemctl/systemctl-list-units.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-list-units.c	2025-06-30 18:37:25.000000000 +0000
@@ -38,7 +38,7 @@ static int get_unit_list_recursive(
                 return log_oom();
 
         if (arg_recursive) {
-                _cleanup_strv_free_ char **machines = NULL;
+                _cleanup_sd_strv_free_ char **machines = NULL;
 
                 r = sd_get_machine_names(&machines);
                 if (r < 0)
@@ -88,9 +88,9 @@ static void output_legend(const char *ty
 static int table_add_triggered(Table *table, char **triggered) {
         assert(table);
 
-        if (strv_isempty(triggered))
+        if (sd_strv_isempty(triggered))
                 return table_add_cell(table, NULL, TABLE_EMPTY, NULL);
-        else if (strv_length(triggered) == 1)
+        else if (sd_strv_length(triggered) == 1)
                 return table_add_cell(table, NULL, TABLE_STRING, triggered[0]);
         else
                 /* This should never happen, currently our socket units can only trigger a
@@ -262,7 +262,7 @@ int verb_list_units(int argc, char *argv
         pager_open(arg_pager_flags);
 
         if (arg_with_dependencies) {
-                _cleanup_strv_free_ char **names = NULL;
+                _cleanup_sd_strv_free_ char **names = NULL;
 
                 r = append_unit_dependencies(bus, strv_skip(argv, 1), &names);
                 if (r < 0)
@@ -325,7 +325,7 @@ static void socket_info_array_free(Socke
         FOREACH_ARRAY(s, sockets, n_sockets) {
                 free(s->type);
                 free(s->path);
-                strv_free(s->triggered);
+                sd_strv_free(s->triggered);
         }
 
         free(sockets);
@@ -360,7 +360,7 @@ static int socket_info_add(
 
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
-        _cleanup_strv_free_ char **triggered = NULL;
+        _cleanup_sd_strv_free_ char **triggered = NULL;
         const char *type, *path;
         int r;
 
@@ -394,7 +394,7 @@ static int socket_info_add(
 
         while ((r = sd_bus_message_read(reply, "(ss)", &type, &path)) > 0) {
                 _cleanup_free_ char *type_dup = NULL, *path_dup = NULL;
-                _cleanup_strv_free_ char **triggered_dup = NULL;
+                _cleanup_sd_strv_free_ char **triggered_dup = NULL;
 
                 type_dup = strdup(type);
                 if (!type_dup)
@@ -404,7 +404,7 @@ static int socket_info_add(
                 if (!path_dup)
                         return log_oom();
 
-                triggered_dup = strv_copy(triggered);
+                triggered_dup = sd_strv_copy(triggered);
                 if (!triggered_dup)
                         return log_oom();
 
@@ -483,7 +483,7 @@ static int output_sockets_list(const Soc
 
 int verb_list_sockets(int argc, char *argv[], void *userdata) {
         _cleanup_set_free_ Set *replies = NULL;
-        _cleanup_strv_free_ char **sockets_with_suffix = NULL;
+        _cleanup_sd_strv_free_ char **sockets_with_suffix = NULL;
         _cleanup_free_ UnitInfo *unit_infos = NULL;
         SocketInfo *sockets = NULL;
         size_t n_sockets = 0;
@@ -616,7 +616,7 @@ static void timer_info_array_free(TimerI
         assert(timers || n_timers == 0);
 
         FOREACH_ARRAY(t, timers, n_timers)
-                strv_free(t->triggered);
+                sd_strv_free(t->triggered);
 
         free(timers);
 }
@@ -720,7 +720,7 @@ static int add_timer_info(
                 TimerInfo **timers,
                 size_t *n_timers) {
 
-        _cleanup_strv_free_ char **triggered = NULL;
+        _cleanup_sd_strv_free_ char **triggered = NULL;
         dual_timestamp next, last;
         usec_t m;
         int r;
@@ -764,7 +764,7 @@ static int add_timer_info(
 
 int verb_list_timers(int argc, char *argv[], void *userdata) {
         _cleanup_set_free_ Set *replies = NULL;
-        _cleanup_strv_free_ char **timers_with_suffix = NULL;
+        _cleanup_sd_strv_free_ char **timers_with_suffix = NULL;
         _cleanup_free_ UnitInfo *unit_infos = NULL;
         TimerInfo *timers = NULL;
         size_t n_timers = 0;
@@ -963,7 +963,7 @@ static int output_automounts_list(const
 
 int verb_list_automounts(int argc, char *argv[], void *userdata) {
         _cleanup_set_free_ Set *replies = NULL;
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         _cleanup_free_ UnitInfo *unit_infos = NULL;
         AutomountInfo *automounts = NULL;
         size_t n_automounts = 0;
@@ -1042,7 +1042,7 @@ static void path_info_array_free(PathInf
         FOREACH_ARRAY(p, paths, n_paths) {
                 free(p->condition);
                 free(p->path);
-                strv_free(p->triggered);
+                sd_strv_free(p->triggered);
         }
 
         free(paths);
@@ -1056,7 +1056,7 @@ static int path_info_add(
 
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
-        _cleanup_strv_free_ char **triggered = NULL;
+        _cleanup_sd_strv_free_ char **triggered = NULL;
         const char *condition, *path;
         int r;
 
@@ -1089,7 +1089,7 @@ static int path_info_add(
 
         while ((r = sd_bus_message_read(reply, "(ss)", &condition, &path)) > 0) {
                 _cleanup_free_ char *condition_dup = NULL, *path_dup = NULL;
-                _cleanup_strv_free_ char **triggered_dup = NULL;
+                _cleanup_sd_strv_free_ char **triggered_dup = NULL;
 
                 condition_dup = strdup(condition);
                 if (!condition_dup)
@@ -1099,7 +1099,7 @@ static int path_info_add(
                 if (!path_dup)
                         return log_oom();
 
-                triggered_dup = strv_copy(triggered);
+                triggered_dup = sd_strv_copy(triggered);
                 if (!triggered_dup)
                         return log_oom();
 
@@ -1171,7 +1171,7 @@ static int output_paths_list(const PathI
 
 int verb_list_paths(int argc, char *argv[], void *userdata) {
         _cleanup_set_free_ Set *replies = NULL;
-        _cleanup_strv_free_ char **units = NULL;
+        _cleanup_sd_strv_free_ char **units = NULL;
         _cleanup_free_ UnitInfo *unit_infos = NULL;
         PathInfo *paths = NULL;
         size_t n_paths = 0;
diff '--color=auto' -Nurp a/src/systemctl/systemctl-logind.c b/src/systemctl/systemctl-logind.c
--- a/src/systemctl/systemctl-logind.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-logind.c	2025-06-30 18:37:55.000000000 +0000
@@ -24,7 +24,7 @@ static int logind_set_wall_message(sd_bu
 
         assert(bus);
 
-        m = strv_join(arg_wall, " ");
+        m = sd_strv_join(arg_wall, " ");
         if (!m)
                 return log_oom();
 
@@ -128,7 +128,7 @@ int logind_reboot(enum action a) {
 int logind_check_inhibitors(enum action a) {
 #if ENABLE_LOGIND
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
-        _cleanup_strv_free_ char **sessions = NULL;
+        _cleanup_sd_strv_free_ char **sessions = NULL;
         const char *what, *who, *why, *mode;
         uint32_t uid, pid;
         sd_bus *bus;
@@ -170,12 +170,12 @@ int logind_check_inhibitors(enum action
 
         while ((r = sd_bus_message_read(reply, "(ssssuu)", &what, &who, &why, &mode, &uid, &pid)) > 0) {
                 _cleanup_free_ char *comm = NULL, *user = NULL;
-                _cleanup_strv_free_ char **sv = NULL;
+                _cleanup_sd_strv_free_ char **sv = NULL;
 
                 if (!streq(mode, "block"))
                         continue;
 
-                sv = strv_split(what, ":");
+                sv = sd_strv_split(what, ":");
                 if (!sv)
                         return log_oom();
 
@@ -428,7 +428,7 @@ int logind_show_shutdown(void) {
 int help_boot_loader_entry(void) {
 #if ENABLE_LOGIND
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         sd_bus *bus;
         int r;
 
@@ -448,7 +448,7 @@ int help_boot_loader_entry(void) {
         if (r < 0)
                 return log_error_errno(r, "Failed to enumerate boot loader entries: %s", bus_error_message(&error, r));
 
-        if (strv_isempty(l))
+        if (sd_strv_isempty(l))
                 return log_error_errno(SYNTHETIC_ERRNO(ENODATA), "No boot loader entries discovered.");
 
         STRV_FOREACH(i, l)
diff '--color=auto' -Nurp a/src/systemctl/systemctl-reset-failed.c b/src/systemctl/systemctl-reset-failed.c
--- a/src/systemctl/systemctl-reset-failed.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-reset-failed.c	2025-06-30 18:33:48.000000000 +0000
@@ -8,7 +8,7 @@
 #include "systemctl.h"
 
 int verb_reset_failed(int argc, char *argv[], void *userdata) {
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         sd_bus *bus;
         int r, q;
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl-set-environment.c b/src/systemctl/systemctl-set-environment.c
--- a/src/systemctl/systemctl-set-environment.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-set-environment.c	2025-06-30 18:34:43.000000000 +0000
@@ -165,7 +165,7 @@ int verb_import_environment(int argc, ch
         if (argc < 2) {
                 log_warning("Calling import-environment without a list of variable names is deprecated.");
 
-                _cleanup_strv_free_ char **copy = strv_copy(environ);
+                _cleanup_sd_strv_free_ char **copy = sd_strv_copy(environ);
                 if (!copy)
                         return log_oom();
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl-set-property.c b/src/systemctl/systemctl-set-property.c
--- a/src/systemctl/systemctl-set-property.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-set-property.c	2025-06-30 18:33:48.000000000 +0000
@@ -45,7 +45,7 @@ static int set_property_one(sd_bus *bus,
 
 int verb_set_property(int argc, char *argv[], void *userdata) {
         sd_bus *bus;
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
         int r;
 
         r = acquire_bus(BUS_MANAGER, &bus);
diff '--color=auto' -Nurp a/src/systemctl/systemctl-show.c b/src/systemctl/systemctl-show.c
--- a/src/systemctl/systemctl-show.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-show.c	2025-06-30 18:37:55.000000000 +0000
@@ -74,12 +74,12 @@ static void exec_status_info_free(ExecSt
 
         free(i->name);
         free(i->path);
-        strv_free(i->argv);
+        sd_strv_free(i->argv);
         free(i);
 }
 
 static int exec_status_info_deserialize(sd_bus_message *m, ExecStatusInfo *i, bool is_ex_prop) {
-        _cleanup_strv_free_ char **ex_opts = NULL;
+        _cleanup_sd_strv_free_ char **ex_opts = NULL;
         uint64_t start_timestamp, exit_timestamp, start_timestamp_monotonic, exit_timestamp_monotonic;
         const char *path;
         uint32_t pid;
@@ -285,11 +285,11 @@ typedef struct UnitStatusInfo {
 } UnitStatusInfo;
 
 static void unit_status_info_done(UnitStatusInfo *info) {
-        strv_free(info->documentation);
-        strv_free(info->dropin_paths);
-        strv_free(info->triggered_by);
-        strv_free(info->triggers);
-        strv_free(info->listen);
+        sd_strv_free(info->documentation);
+        sd_strv_free(info->dropin_paths);
+        sd_strv_free(info->triggered_by);
+        sd_strv_free(info->triggers);
+        sd_strv_free(info->listen);
 
         LIST_CLEAR(conditions, info->conditions, unit_condition_free);
         LIST_CLEAR(exec_status_info_list, info->exec_status_info_list, exec_status_info_free);
@@ -387,7 +387,7 @@ static void print_status_info(
         if (i->transient)
                 printf("  Transient: yes\n");
 
-        if (!strv_isempty(i->dropin_paths)) {
+        if (!sd_strv_isempty(i->dropin_paths)) {
                 _cleanup_free_ char *dir = NULL;
                 bool last = false;
 
@@ -590,7 +590,7 @@ static void print_status_info(
                 if (endswith(p->name, "Ex"))
                         continue;
 
-                argv = strv_join(p->argv, " ");
+                argv = sd_strv_join(p->argv, " ");
                 printf("    Process: "PID_FMT" %s=%s ", p->pid, p->name, strna(argv));
 
                 good = is_clean_exit(p->code, p->status, EXIT_CLEAN_DAEMON, NULL);
@@ -934,7 +934,7 @@ static int map_listen(sd_bus *bus, const
 
         while ((r = sd_bus_message_read(m, "(ss)", &type, &path)) > 0) {
 
-                r = strv_extend_many(p, type, path);
+                r = sd_strv_extend_many(p, type, path);
                 if (r < 0)
                         return r;
         }
@@ -1157,7 +1157,7 @@ static int print_property(const char *na
                         return 1;
 
                 } else if (STR_IN_SET(name, "SystemCallFilter", "SystemCallLog", "RestrictAddressFamilies", "RestrictNetworkInterfaces", "RestrictFileSystems")) {
-                        _cleanup_strv_free_ char **l = NULL;
+                        _cleanup_sd_strv_free_ char **l = NULL;
                         int allow_list;
 
                         r = sd_bus_message_enter_container(m, 'r', "bas");
@@ -1176,7 +1176,7 @@ static int print_property(const char *na
                         if (r < 0)
                                 return bus_log_parse_error(r);
 
-                        if (FLAGS_SET(flags, BUS_PRINT_PROPERTY_SHOW_EMPTY) || allow_list || !strv_isempty(l)) {
+                        if (FLAGS_SET(flags, BUS_PRINT_PROPERTY_SHOW_EMPTY) || allow_list || !sd_strv_isempty(l)) {
                                 bool first = true;
 
                                 if (!FLAGS_SET(flags, BUS_PRINT_PROPERTY_ONLY_VALUE)) {
@@ -1388,17 +1388,17 @@ static int print_property(const char *na
                                 return bus_log_parse_error(r);
 
                         while ((r = exec_status_info_deserialize(m, &info, is_ex_prop)) > 0) {
-                                _cleanup_strv_free_ char **optv = NULL;
+                                _cleanup_sd_strv_free_ char **optv = NULL;
                                 _cleanup_free_ char *tt = NULL, *o = NULL;
 
-                                tt = strv_join(info.argv, " ");
+                                tt = sd_strv_join(info.argv, " ");
 
                                 if (is_ex_prop) {
                                         r = exec_command_flags_to_strv(info.flags, &optv);
                                         if (r < 0)
                                                 return log_error_errno(r, "Failed to convert ExecCommandFlags to strv: %m");
 
-                                        o = strv_join(optv, " ");
+                                        o = sd_strv_join(optv, " ");
 
                                         bus_print_property_valuef(name, expected_value, flags,
                                                                   "{ path=%s ; argv[]=%s ; flags=%s ; start_time=[%s] ; stop_time=[%s] ; pid="PID_FMT" ; code=%s ; status=%i%s%s }",
@@ -1427,7 +1427,7 @@ static int print_property(const char *na
                                                                   strempty(info.code == CLD_EXITED ? NULL : signal_to_string(info.status)));
 
                                 free(info.path);
-                                strv_free(info.argv);
+                                sd_strv_free(info.argv);
                                 zero(info);
                         }
 
@@ -2386,7 +2386,7 @@ int verb_show(int argc, char *argv[], vo
                         uint32_t id;
 
                         if (safe_atou32(*name, &id) < 0) {
-                                if (strv_push(&patterns, *name) < 0)
+                                if (sd_strv_push(&patterns, *name) < 0)
                                         return log_oom();
 
                                 continue;
@@ -2411,8 +2411,8 @@ int verb_show(int argc, char *argv[], vo
                                 ret = r;
                 }
 
-                if (!strv_isempty(patterns)) {
-                        _cleanup_strv_free_ char **names = NULL;
+                if (!sd_strv_isempty(patterns)) {
+                        _cleanup_sd_strv_free_ char **names = NULL;
 
                         r = expand_unit_names(bus, patterns, NULL, &names, NULL);
                         if (r < 0)
diff '--color=auto' -Nurp a/src/systemctl/systemctl-start-special.c b/src/systemctl/systemctl-start-special.c
--- a/src/systemctl/systemctl-start-special.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-start-special.c	2025-06-30 18:37:55.000000000 +0000
@@ -57,7 +57,7 @@ static int load_kexec_kernel(void) {
         if (!e->kernel)
                 return log_error_errno(SYNTHETIC_ERRNO(EOPNOTSUPP),
                                        "Boot entry does not refer to Linux kernel, which is not supported currently.");
-        if (strv_length(e->initrd) > 1)
+        if (sd_strv_length(e->initrd) > 1)
                 return log_error_errno(SYNTHETIC_ERRNO(EOPNOTSUPP),
                                        "Boot entry specifies multiple initrds, which is not supported currently.");
 
@@ -65,13 +65,13 @@ static int load_kexec_kernel(void) {
         if (!kernel)
                 return log_oom();
 
-        if (!strv_isempty(e->initrd)) {
+        if (!sd_strv_isempty(e->initrd)) {
                 initrd = path_join(e->root, e->initrd[0]);
                 if (!initrd)
                         return log_oom();
         }
 
-        options = strv_join(e->options, " ");
+        options = sd_strv_join(e->options, " ");
         if (!options)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl-start-unit.c b/src/systemctl/systemctl-start-unit.c
--- a/src/systemctl/systemctl-start-unit.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-start-unit.c	2025-06-30 18:37:06.000000000 +0000
@@ -206,7 +206,7 @@ static int enqueue_marked_jobs(
         if (r < 0)
                 return log_error_errno(r, "Failed to start jobs: %s", bus_error_message(&error, r));
 
-        _cleanup_strv_free_ char **paths = NULL;
+        _cleanup_sd_strv_free_ char **paths = NULL;
         r = sd_bus_message_read_strv(reply, &paths);
         if (r < 0)
                 return bus_log_parse_error(r);
@@ -293,8 +293,8 @@ int verb_start(int argc, char *argv[], v
         _cleanup_(bus_wait_for_units_freep) BusWaitForUnits *wu = NULL;
         _cleanup_(bus_wait_for_jobs_freep) BusWaitForJobs *w = NULL;
         const char *method, *job_type, *mode, *one_name, *suffix = NULL;
-        _cleanup_free_ char **stopped_units = NULL; /* Do not use _cleanup_strv_free_ */
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_free_ char **stopped_units = NULL; /* Do not use _cleanup_sd_strv_free_ */
+        _cleanup_sd_strv_free_ char **names = NULL;
         int r, ret = EXIT_SUCCESS;
         sd_bus *bus;
 
@@ -354,7 +354,7 @@ int verb_start(int argc, char *argv[], v
         }
 
         if (one_name) {
-                names = strv_new(one_name);
+                names = sd_strv_new(one_name);
                 if (!names)
                         return log_oom();
         } else if (!arg_marked) {
@@ -397,7 +397,7 @@ int verb_start(int argc, char *argv[], v
                                 ret = translate_bus_error_to_exit_status(r, &error);
 
                         if (r >= 0 && streq(method, "StopUnit")) {
-                                r = strv_push(&stopped_units, *name);
+                                r = sd_strv_push(&stopped_units, *name);
                                 if (r < 0)
                                         return log_oom();
                         }
diff '--color=auto' -Nurp a/src/systemctl/systemctl-sysv-compat.c b/src/systemctl/systemctl-sysv-compat.c
--- a/src/systemctl/systemctl-sysv-compat.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-sysv-compat.c	2025-06-30 18:37:55.000000000 +0000
@@ -203,7 +203,7 @@ int enable_sysv_units(const char *verb,
                 argv[c++] = basename(p);
                 argv[c] = NULL;
 
-                l = strv_join((char**)argv, " ");
+                l = sd_strv_join((char**)argv, " ");
                 if (!l)
                         return log_oom();
 
@@ -245,7 +245,7 @@ int enable_sysv_units(const char *verb,
                 assert(f > 0);
                 f--;
                 assert(args[f] == name);
-                strv_remove(args + f, name);
+                sd_strv_remove(args + f, name);
         }
 
         if (streq(verb, "is-enabled"))
diff '--color=auto' -Nurp a/src/systemctl/systemctl-util.c b/src/systemctl/systemctl-util.c
--- a/src/systemctl/systemctl-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -269,7 +269,7 @@ int expand_unit_names(
                 char ***ret,
                 bool *ret_expanded) {
 
-        _cleanup_strv_free_ char **mangled = NULL, **globs = NULL;
+        _cleanup_sd_strv_free_ char **mangled = NULL, **globs = NULL;
         int r;
 
         assert(bus);
@@ -284,15 +284,15 @@ int expand_unit_names(
                         return log_error_errno(r, "Failed to mangle name: %m");
 
                 if (string_is_glob(t))
-                        r = strv_consume(&globs, t);
+                        r = sd_strv_consume(&globs, t);
                 else
-                        r = strv_consume(&mangled, t);
+                        r = sd_strv_consume(&mangled, t);
                 if (r < 0)
                         return log_oom();
         }
 
         /* Query the manager only if any of the names are a glob, since this is fairly expensive */
-        bool expanded = !strv_isempty(globs);
+        bool expanded = !sd_strv_isempty(globs);
         if (expanded) {
                 _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
                 _cleanup_free_ UnitInfo *unit_infos = NULL;
@@ -302,7 +302,7 @@ int expand_unit_names(
                         return r;
 
                 FOREACH_ARRAY(info, unit_infos, r)
-                        if (strv_extend(&mangled, info->id) < 0)
+                        if (sd_strv_extend(&mangled, info->id) < 0)
                                 return log_oom();
         }
 
@@ -315,7 +315,7 @@ int expand_unit_names(
 
 int get_active_triggering_units(sd_bus *bus, const char *unit, bool ignore_masked, char ***ret) {
         _cleanup_(sd_bus_error_free) sd_bus_error error = SD_BUS_ERROR_NULL;
-        _cleanup_strv_free_ char **triggered_by = NULL, **active = NULL;
+        _cleanup_sd_strv_free_ char **triggered_by = NULL, **active = NULL;
         _cleanup_free_ char *name = NULL, *dbus_path = NULL;
         int r;
 
@@ -364,7 +364,7 @@ int get_active_triggering_units(sd_bus *
                 if (!IN_SET(active_state, UNIT_ACTIVE, UNIT_RELOADING))
                         continue;
 
-                r = strv_extend(&active, *i);
+                r = sd_strv_extend(&active, *i);
                 if (r < 0)
                         return r;
         }
@@ -378,7 +378,7 @@ skip:
 }
 
 void warn_triggering_units(sd_bus *bus, const char *unit, const char *operation, bool ignore_masked) {
-        _cleanup_strv_free_ char **triggered_by = NULL;
+        _cleanup_sd_strv_free_ char **triggered_by = NULL;
         _cleanup_free_ char *joined = NULL;
         int r;
 
@@ -393,10 +393,10 @@ void warn_triggering_units(sd_bus *bus,
                 return;
         }
 
-        if (strv_isempty(triggered_by))
+        if (sd_strv_isempty(triggered_by))
                 return;
 
-        joined = strv_join(triggered_by, ", ");
+        joined = sd_strv_join(triggered_by, ", ");
         if (!joined)
                 return (void) log_oom();
 
@@ -491,7 +491,7 @@ int unit_find_paths(
                 char **ret_fragment_path,
                 char ***ret_dropin_paths) {
 
-        _cleanup_strv_free_ char **dropins = NULL;
+        _cleanup_sd_strv_free_ char **dropins = NULL;
         _cleanup_free_ char *path = NULL;
         int r;
 
@@ -606,7 +606,7 @@ int unit_find_paths(
         }
 
         if (ret_dropin_paths) {
-                if (!strv_isempty(dropins)) {
+                if (!sd_strv_isempty(dropins)) {
                         *ret_dropin_paths = TAKE_PTR(dropins);
                         r = 1;
                 } else
@@ -733,20 +733,20 @@ int unit_exists(LookupPaths *lp, const c
 
 
 int append_unit_dependencies(sd_bus *bus, char **names, char ***ret) {
-        _cleanup_strv_free_ char **with_deps = NULL;
+        _cleanup_sd_strv_free_ char **with_deps = NULL;
 
         assert(bus);
         assert(ret);
 
         STRV_FOREACH(name, names) {
-                _cleanup_strv_free_ char **deps = NULL;
+                _cleanup_sd_strv_free_ char **deps = NULL;
 
-                if (strv_extend(&with_deps, *name) < 0)
+                if (sd_strv_extend(&with_deps, *name) < 0)
                         return log_oom();
 
                 (void) unit_get_dependencies(bus, *name, &deps);
 
-                if (strv_extend_strv(&with_deps, deps, true) < 0)
+                if (sd_sd_strv_extend_strv(&with_deps, deps, true) < 0)
                         return log_oom();
         }
 
@@ -756,7 +756,7 @@ int append_unit_dependencies(sd_bus *bus
 }
 
 int maybe_extend_with_unit_dependencies(sd_bus *bus, char ***list) {
-        _cleanup_strv_free_ char **list_with_deps = NULL;
+        _cleanup_sd_strv_free_ char **list_with_deps = NULL;
         int r;
 
         assert(bus);
@@ -769,11 +769,11 @@ int maybe_extend_with_unit_dependencies(
         if (r < 0)
                 return log_error_errno(r, "Failed to append unit dependencies: %m");
 
-        return strv_free_and_replace(*list, list_with_deps);
+        return sd_strv_free_and_replace(*list, list_with_deps);
 }
 
 int unit_get_dependencies(sd_bus *bus, const char *name, char ***ret) {
-        _cleanup_strv_free_ char **deps = NULL;
+        _cleanup_sd_strv_free_ char **deps = NULL;
 
         static const struct bus_properties_map map[_DEPENDENCY_MAX][7] = {
                 [DEPENDENCY_FORWARD] = {
@@ -861,7 +861,7 @@ bool output_show_unit(const UnitInfo *u,
         if (!isempty(u->following))
                 return false;
 
-        if (!strv_isempty(arg_states))
+        if (!sd_strv_isempty(arg_states))
                 return true;
 
         /* By default show all units except the ones in inactive state and with no pending job */
@@ -926,7 +926,7 @@ UnitFileFlags unit_file_flags_from_args(
 }
 
 int mangle_names(const char *operation, char * const *original_names, char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int r;
 
         assert(operation);
@@ -945,7 +945,7 @@ int mangle_names(const char *operation,
                 if (r < 0)
                         return log_error_errno(r, "Failed to mangle unit name or path '%s': %m", *name);
 
-                if (strv_consume(&l, mangled) < 0)
+                if (sd_strv_consume(&l, mangled) < 0)
                         return log_oom();
         }
 
diff '--color=auto' -Nurp a/src/systemctl/systemctl.c b/src/systemctl/systemctl.c
--- a/src/systemctl/systemctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemctl/systemctl.c	2025-06-30 18:36:37.000000000 +0000
@@ -127,18 +127,18 @@ bool arg_marked = false;
 const char *arg_drop_in = NULL;
 ImagePolicy *arg_image_policy = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_types, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_states, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_properties, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_types, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_states, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_properties, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(_arg_job_mode, unsetp);
-STATIC_DESTRUCTOR_REGISTER(arg_wall, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_wall, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_kill_whom, unsetp);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_reboot_argument, unsetp);
 STATIC_DESTRUCTOR_REGISTER(arg_host, unsetp);
 STATIC_DESTRUCTOR_REGISTER(arg_boot_loader_entry, unsetp);
-STATIC_DESTRUCTOR_REGISTER(arg_clean_what, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_clean_what, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_drop_in, unsetp);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
 
@@ -584,7 +584,7 @@ static int systemctl_parse_argv(int argc
                                 }
 
                                 if (unit_type_from_string(type) >= 0) {
-                                        if (strv_consume(&arg_types, TAKE_PTR(type)) < 0)
+                                        if (sd_strv_consume(&arg_types, TAKE_PTR(type)) < 0)
                                                 return log_oom();
                                         continue;
                                 }
@@ -592,7 +592,7 @@ static int systemctl_parse_argv(int argc
                                 /* It's much nicer to use --state= for load states, but let's support this in
                                  * --types= too for compatibility with old versions */
                                 if (unit_load_state_from_string(type) >= 0) {
-                                        if (strv_consume(&arg_states, TAKE_PTR(type)) < 0)
+                                        if (sd_strv_consume(&arg_states, TAKE_PTR(type)) < 0)
                                                 return log_oom();
                                         continue;
                                 }
@@ -625,7 +625,7 @@ static int systemctl_parse_argv(int argc
                                         if (r == 0)
                                                 break;
 
-                                        if (strv_consume(&arg_properties, TAKE_PTR(prop)) < 0)
+                                        if (sd_strv_consume(&arg_properties, TAKE_PTR(prop)) < 0)
                                                 return log_oom();
                                 }
 
@@ -751,7 +751,7 @@ static int systemctl_parse_argv(int argc
                         break;
 
                 case ARG_FAILED:
-                        if (strv_extend(&arg_states, "failed") < 0)
+                        if (sd_strv_extend(&arg_states, "failed") < 0)
                                 return log_oom();
 
                         break;
@@ -911,7 +911,7 @@ static int systemctl_parse_argv(int argc
                                         return 0;
                                 }
 
-                                if (strv_consume(&arg_states, TAKE_PTR(s)) < 0)
+                                if (sd_strv_consume(&arg_states, TAKE_PTR(s)) < 0)
                                         return log_oom();
                         }
                         break;
@@ -942,7 +942,7 @@ static int systemctl_parse_argv(int argc
                         break;
 
                 case ARG_MESSAGE:
-                        if (strv_extend(&arg_wall, optarg) < 0)
+                        if (sd_strv_extend(&arg_wall, optarg) < 0)
                                 return log_oom();
                         break;
 
@@ -977,7 +977,7 @@ static int systemctl_parse_argv(int argc
                                         return 0;
                                 }
 
-                                r = strv_consume(&arg_clean_what, TAKE_PTR(k));
+                                r = sd_strv_consume(&arg_clean_what, TAKE_PTR(k));
                                 if (r < 0)
                                         return log_oom();
                         }
diff '--color=auto' -Nurp a/src/systemd/sd-bus.h b/src/systemd/sd-bus.h
--- a/src/systemd/sd-bus.h	2025-03-06 14:40:12.000000000 +0000
+++ b/src/systemd/sd-bus.h	2025-06-30 18:35:42.000000000 +0000
@@ -333,7 +333,7 @@ int sd_bus_message_readv(sd_bus_message
 int sd_bus_message_read_basic(sd_bus_message *m, char type, void *p);
 int sd_bus_message_read_array(sd_bus_message *m, char type, const void **ptr, size_t *size);
 int sd_bus_message_read_strv(sd_bus_message *m, char ***l); /* free the result! */
-int sd_bus_message_read_strv_extend(sd_bus_message *m, char ***l);
+int sd_bus_message_read_sd_strv_extend(sd_bus_message *m, char ***l);
 int sd_bus_message_skip(sd_bus_message *m, const char *types);
 int sd_bus_message_enter_container(sd_bus_message *m, char type, const char *contents);
 int sd_bus_message_exit_container(sd_bus_message *m);
diff '--color=auto' -Nurp a/src/sysupdate/sysupdate-resource.c b/src/sysupdate/sysupdate-resource.c
--- a/src/sysupdate/sysupdate-resource.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysupdate/sysupdate-resource.c	2025-06-30 18:33:48.000000000 +0000
@@ -34,7 +34,7 @@ void resource_destroy(Resource *rr) {
         assert(rr);
 
         free(rr->path);
-        strv_free(rr->patterns);
+        sd_strv_free(rr->patterns);
 
         for (size_t i = 0; i < rr->n_instances; i++)
                 instance_free(rr->instances[i]);
diff '--color=auto' -Nurp a/src/sysupdate/sysupdate-transfer.c b/src/sysupdate/sysupdate-transfer.c
--- a/src/sysupdate/sysupdate-transfer.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysupdate/sysupdate-transfer.c	2025-06-30 18:37:25.000000000 +0000
@@ -41,7 +41,7 @@ Transfer *transfer_free(Transfer *t) {
 
         free(t->definition_path);
         free(t->min_version);
-        strv_free(t->protected_versions);
+        sd_strv_free(t->protected_versions);
         free(t->current_symlink);
         free(t->final_path);
 
@@ -120,7 +120,7 @@ static int config_parse_protect_version(
                 return 0;
         }
 
-        r = strv_extend(protected_versions, resolved);
+        r = sd_strv_extend(protected_versions, resolved);
         if (r < 0)
                 return log_oom();
 
@@ -251,7 +251,7 @@ static int config_parse_resource_pattern
         assert(rvalue);
 
         if (isempty(rvalue)) {
-                *patterns = strv_free(*patterns);
+                *patterns = sd_strv_free(*patterns);
                 return 0;
         }
 
@@ -278,7 +278,7 @@ static int config_parse_resource_pattern
                         return log_syntax(unit, LOG_ERR, filename, line, SYNTHETIC_ERRNO(EINVAL),
                                           "MatchPattern= string is not valid, refusing: %s", resolved);
 
-                r = strv_consume(patterns, TAKE_PTR(resolved));
+                r = sd_strv_consume(patterns, TAKE_PTR(resolved));
                 if (r < 0)
                         return log_oom();
         }
@@ -518,7 +518,7 @@ int transfer_read_definition(Transfer *t
                                                   "Source path is not a valid HTTP or HTTPS URL: %s", t->source.path);
         }
 
-        if (strv_isempty(t->source.patterns))
+        if (sd_strv_isempty(t->source.patterns))
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EINVAL),
                                   "Source specification lacks MatchPattern=.");
 
@@ -531,10 +531,10 @@ int transfer_read_definition(Transfer *t
                 return log_syntax(NULL, LOG_ERR, path, 1, SYNTHETIC_ERRNO(EINVAL),
                                   "Target path is not a normalized, absolute path: %s", t->target.path);
 
-        if (strv_isempty(t->target.patterns)) {
+        if (sd_strv_isempty(t->target.patterns)) {
                 log_syntax(NULL, LOG_INFO, path, 1, 0, "Target specification lacks MatchPattern= expression. Assuming same value as in source specification.");
-                strv_free(t->target.patterns);
-                t->target.patterns = strv_copy(t->source.patterns);
+                sd_strv_free(t->target.patterns);
+                t->target.patterns = sd_strv_copy(t->source.patterns);
                 if (!t->target.patterns)
                         return log_oom();
         }
@@ -829,7 +829,7 @@ int transfer_acquire_instance(Transfer *
 
         assert(!t->final_path);
         assert(!t->temporary_path);
-        assert(!strv_isempty(t->target.patterns));
+        assert(!sd_strv_isempty(t->target.patterns));
 
         /* Format the target name using the first pattern specified */
         compile_pattern_fields(t, i, &f);
diff '--color=auto' -Nurp a/src/sysupdate/sysupdate.c b/src/sysupdate/sysupdate.c
--- a/src/sysupdate/sysupdate.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysupdate/sysupdate.c	2025-06-30 18:35:00.000000000 +0000
@@ -97,7 +97,7 @@ static int context_read_definitions(
                 const char *root,
                 const char *node) {
 
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(c);
@@ -105,11 +105,11 @@ static int context_read_definitions(
         if (directory)
                 r = conf_files_list_strv(&files, ".conf", NULL, CONF_FILES_REGULAR|CONF_FILES_FILTER_MASKED, (const char**) STRV_MAKE(directory));
         else if (component) {
-                _cleanup_strv_free_ char **n = NULL;
+                _cleanup_sd_strv_free_ char **n = NULL;
                 char **l = CONF_PATHS_STRV("");
                 size_t k = 0;
 
-                n = new0(char*, strv_length(l) + 1);
+                n = new0(char*, sd_strv_length(l) + 1);
                 if (!n)
                         return log_oom();
 
@@ -1095,7 +1095,7 @@ static int verb_components(int argc, cha
         _cleanup_(loop_device_unrefp) LoopDevice *loop_device = NULL;
         _cleanup_(umount_and_rmdir_and_freep) char *mounted_dir = NULL;
         _cleanup_set_free_ Set *names = NULL;
-        _cleanup_free_ char **z = NULL; /* We use simple free() rather than strv_free() here, since set_free() will free the strings for us */
+        _cleanup_free_ char **z = NULL; /* We use simple free() rather than sd_strv_free() here, since set_free() will free the strings for us */
         char **l = CONF_PATHS_STRV("");
         bool has_default_component = false;
         int r;
diff '--color=auto' -Nurp a/src/sysusers/sysusers.c b/src/sysusers/sysusers.c
--- a/src/sysusers/sysusers.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysusers/sysusers.c	2025-06-30 18:35:42.000000000 +0000
@@ -341,10 +341,10 @@ static int putgrent_with_members(
 
         a = ordered_hashmap_get(c->members, gr->gr_name);
         if (a) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 bool added = false;
 
-                l = strv_copy(gr->gr_mem);
+                l = sd_strv_copy(gr->gr_mem);
                 if (!l)
                         return -ENOMEM;
 
@@ -352,7 +352,7 @@ static int putgrent_with_members(
                         if (strv_contains(l, *i))
                                 continue;
 
-                        r = strv_extend(&l, *i);
+                        r = sd_strv_extend(&l, *i);
                         if (r < 0)
                                 return r;
 
@@ -390,10 +390,10 @@ static int putsgent_with_members(
 
         a = ordered_hashmap_get(c->members, sg->sg_namp);
         if (a) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 bool added = false;
 
-                l = strv_copy(sg->sg_mem);
+                l = sd_strv_copy(sg->sg_mem);
                 if (!l)
                         return -ENOMEM;
 
@@ -401,7 +401,7 @@ static int putsgent_with_members(
                         if (strv_contains(l, *i))
                                 continue;
 
-                        r = strv_extend(&l, *i);
+                        r = sd_strv_extend(&l, *i);
                         if (r < 0)
                                 return r;
 
@@ -1982,7 +1982,7 @@ static int read_config_file(Context *c,
 }
 
 static int cat_config(void) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         r = conf_files_list_with_replacement(arg_root, CONF_PATHS_STRV("sysusers.d"), arg_replace, &files, NULL);
@@ -2165,7 +2165,7 @@ static int parse_arguments(Context *c, c
 }
 
 static int read_config_files(Context *c, char **args) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         _cleanup_free_ char *p = NULL;
         int r;
 
diff '--color=auto' -Nurp a/src/sysv-generator/sysv-generator.c b/src/sysv-generator/sysv-generator.c
--- a/src/sysv-generator/sysv-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/sysv-generator/sysv-generator.c	2025-06-30 18:37:25.000000000 +0000
@@ -72,10 +72,10 @@ static SysvStub* free_sysvstub(SysvStub
         free(s->path);
         free(s->description);
         free(s->pid_file);
-        strv_free(s->before);
-        strv_free(s->after);
-        strv_free(s->wants);
-        strv_free(s->wanted_by);
+        sd_strv_free(s->before);
+        sd_strv_free(s->after);
+        sd_strv_free(s->wants);
+        sd_strv_free(s->wanted_by);
         return mfree(s);
 }
 DEFINE_TRIVIAL_CLEANUP_FUNC(SysvStub*, free_sysvstub);
@@ -351,19 +351,19 @@ static int handle_provides(SysvStub *s,
                          * now available. This is strictly one-way.
                          * The targets do NOT pull in SysV services! */
 
-                        r = strv_extend(&s->before, m);
+                        r = sd_strv_extend(&s->before, m);
                         if (r < 0)
                                 return log_oom();
 
-                        r = strv_extend(&s->wants, m);
+                        r = sd_strv_extend(&s->wants, m);
                         if (r < 0)
                                 return log_oom();
 
                         if (streq(m, SPECIAL_NETWORK_ONLINE_TARGET)) {
-                                r = strv_extend(&s->before, SPECIAL_NETWORK_TARGET);
+                                r = sd_strv_extend(&s->before, SPECIAL_NETWORK_TARGET);
                                 if (r < 0)
                                         return log_oom();
-                                r = strv_extend(&s->wants, SPECIAL_NETWORK_TARGET);
+                                r = sd_strv_extend(&s->wants, SPECIAL_NETWORK_TARGET);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -407,13 +407,13 @@ static int handle_dependencies(SysvStub
 
                 if (streq(m, SPECIAL_NETWORK_ONLINE_TARGET) && !is_before) {
                         /* the network-online target is special, as it needs to be actively pulled in */
-                        r = strv_extend(&s->after, m);
+                        r = sd_strv_extend(&s->after, m);
                         if (r < 0)
                                 return log_oom();
 
-                        r = strv_extend(&s->wants, m);
+                        r = sd_strv_extend(&s->wants, m);
                 } else
-                        r = strv_extend(is_before ? &s->before : &s->after, m);
+                        r = sd_strv_extend(is_before ? &s->before : &s->after, m);
                 if (r < 0)
                         return log_oom();
         }
@@ -658,12 +658,12 @@ static int fix_order(SysvStub *s, Hashma
                         continue;
 
                 if (other->sysv_start_priority < s->sysv_start_priority) {
-                        r = strv_extend(&s->after, other->name);
+                        r = sd_strv_extend(&s->after, other->name);
                         if (r < 0)
                                 return log_oom();
 
                 } else if (other->sysv_start_priority > s->sysv_start_priority) {
-                        r = strv_extend(&s->before, other->name);
+                        r = sd_strv_extend(&s->before, other->name);
                         if (r < 0)
                                 return log_oom();
                 } else
@@ -676,7 +676,7 @@ static int fix_order(SysvStub *s, Hashma
 }
 
 static int acquire_search_path(const char *def, const char *envvar, char ***ret) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *e;
         int r;
 
@@ -690,10 +690,10 @@ static int acquire_search_path(const cha
                         return log_error_errno(r, "Failed to make $%s search path absolute: %m", envvar);
         }
 
-        if (strv_isempty(l)) {
-                strv_free(l);
+        if (sd_strv_isempty(l)) {
+                sd_strv_free(l);
 
-                l = strv_new(def);
+                l = sd_strv_new(def);
                 if (!l)
                         return log_oom();
         }
@@ -707,7 +707,7 @@ static int acquire_search_path(const cha
 }
 
 static int enumerate_sysv(const LookupPaths *lp, Hashmap *all_services) {
-        _cleanup_strv_free_ char **sysvinit_path = NULL;
+        _cleanup_sd_strv_free_ char **sysvinit_path = NULL;
         int r;
 
         assert(lp);
@@ -797,7 +797,7 @@ static int enumerate_sysv(const LookupPa
 
 static int set_dependencies_from_rcnd(const LookupPaths *lp, Hashmap *all_services) {
         Set *runlevel_services[ELEMENTSOF(rcnd_table)] = {};
-        _cleanup_strv_free_ char **sysvrcnd_path = NULL;
+        _cleanup_sd_strv_free_ char **sysvrcnd_path = NULL;
         SysvStub *service;
         int r;
 
@@ -872,12 +872,12 @@ static int set_dependencies_from_rcnd(co
 
         for (unsigned i = 0; i < ELEMENTSOF(rcnd_table); i++)
                 SET_FOREACH(service, runlevel_services[i]) {
-                        r = strv_extend(&service->before, rcnd_table[i].target);
+                        r = sd_strv_extend(&service->before, rcnd_table[i].target);
                         if (r < 0) {
                                 log_oom();
                                 goto finish;
                         }
-                        r = strv_extend(&service->wanted_by, rcnd_table[i].target);
+                        r = sd_strv_extend(&service->wanted_by, rcnd_table[i].target);
                         if (r < 0) {
                                 log_oom();
                                 goto finish;
diff '--color=auto' -Nurp a/src/test/test-ask-password-api.c b/src/test/test-ask-password-api.c
--- a/src/test/test-ask-password-api.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-ask-password-api.c	2025-06-30 18:35:00.000000000 +0000
@@ -5,7 +5,7 @@
 #include "tests.h"
 
 TEST(ask_password) {
-        _cleanup_strv_free_ char **ret = NULL;
+        _cleanup_sd_strv_free_ char **ret = NULL;
         int r;
 
         static const AskPasswordRequest req = {
@@ -18,7 +18,7 @@ TEST(ask_password) {
                 ASSERT_NULL(ret);
         else {
                 ASSERT_OK(r);
-                assert_se(strv_length(ret) == 1);
+                assert_se(sd_strv_length(ret) == 1);
                 log_info("Got \"%s\"", *ret);
         }
 }
diff '--color=auto' -Nurp a/src/test/test-bpf-foreign-programs.c b/src/test/test-bpf-foreign-programs.c
--- a/src/test/test-bpf-foreign-programs.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-bpf-foreign-programs.c	2025-06-30 18:35:42.000000000 +0000
@@ -136,7 +136,7 @@ static char **unlink_paths_and_free(char
         STRV_FOREACH(i, paths)
                 (void) unlink(*i);
 
-        return strv_free(paths);
+        return sd_strv_free(paths);
 }
 
 DEFINE_TRIVIAL_CLEANUP_FUNC(char **, unlink_paths_and_free);
@@ -175,7 +175,7 @@ static int pin_programs(Unit *u, CGroupC
                 if (strv_contains(bpffs_paths, test_suite[i].bpffs_path))
                         continue;
 
-                r = strv_extend(&bpffs_paths, test_suite[i].bpffs_path);
+                r = sd_strv_extend(&bpffs_paths, test_suite[i].bpffs_path);
                 if (r < 0)
                         return log_error_errno(r, "Failed to put path into a vector: %m");
 
diff '--color=auto' -Nurp a/src/test/test-cap-list.c b/src/test/test-cap-list.c
--- a/src/test/test-cap-list.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-cap-list.c	2025-06-30 18:33:48.000000000 +0000
@@ -102,7 +102,7 @@ TEST(capability_set_from_string) {
 }
 
 static void test_capability_set_to_strv_one(uint64_t m, char **l) {
-        _cleanup_strv_free_ char **b = NULL;
+        _cleanup_sd_strv_free_ char **b = NULL;
 
         assert_se(capability_set_to_strv(m, &b) >= 0);
         assert_se(strv_equal(l, b));
diff '--color=auto' -Nurp a/src/test/test-condition.c b/src/test/test-condition.c
--- a/src/test/test-condition.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-condition.c	2025-06-30 18:35:00.000000000 +0000
@@ -347,7 +347,7 @@ TEST(condition_test_firmware_device_tree
                 condition_free(condition);
         } else {
                 _cleanup_free_ char *dtcompat = NULL;
-                _cleanup_strv_free_ char **dtcompatlist = NULL;
+                _cleanup_sd_strv_free_ char **dtcompatlist = NULL;
                 size_t dtcompat_size;
                 int r;
 
@@ -1190,7 +1190,7 @@ TEST(condition_test_environment) {
 }
 
 TEST(condition_test_os_release) {
-        _cleanup_strv_free_ char **os_release_pairs = NULL;
+        _cleanup_sd_strv_free_ char **os_release_pairs = NULL;
         _cleanup_free_ char *version_id = NULL;
         const char *key_value_pair;
         Condition *condition;
@@ -1198,7 +1198,7 @@ TEST(condition_test_os_release) {
         /* Should not happen, but it's a test so we don't know the environment. */
         if (load_os_release_pairs(NULL, &os_release_pairs) < 0)
                 return;
-        if (strv_length(os_release_pairs) < 2)
+        if (sd_strv_length(os_release_pairs) < 2)
                 return;
 
         condition = condition_new(CONDITION_OS_RELEASE, "_THISHOPEFULLYWONTEXIST=01234 56789", false, false);
diff '--color=auto' -Nurp a/src/test/test-conf-files.c b/src/test/test-conf-files.c
--- a/src/test/test-conf-files.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-conf-files.c	2025-06-30 18:33:48.000000000 +0000
@@ -23,7 +23,7 @@
 TEST(conf_files_list) {
         _cleanup_(rm_rf_physical_and_freep) char *t = NULL;
         _cleanup_close_ int tfd = -EBADF;
-        _cleanup_strv_free_ char **result = NULL;
+        _cleanup_sd_strv_free_ char **result = NULL;
         const char *search1, *search2, *search1_a, *search1_b, *search1_c, *search2_aa;
 
         tfd = mkdtemp_open("/tmp/test-conf-files-XXXXXX", O_PATH, &t);
@@ -61,94 +61,94 @@ TEST(conf_files_list) {
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search1_b, search1_c)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list(&result, NULL, t, CONF_FILES_FILTER_MASKED, "/dir1/") >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search1_b, search1_c)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_at(&result, NULL, AT_FDCWD, CONF_FILES_FILTER_MASKED, search1) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search1_b, search1_c)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_at(&result, NULL, tfd, CONF_FILES_FILTER_MASKED, "/dir1/") >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE("dir1/a.conf", "dir1/b.conf", "dir1/c.foo")));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         /* search dir1 with suffix */
         assert_se(conf_files_list(&result, ".conf", NULL, CONF_FILES_FILTER_MASKED, search1) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search1_b)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list(&result, ".conf", t, CONF_FILES_FILTER_MASKED, "/dir1/") >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search1_b)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_at(&result, ".conf", AT_FDCWD, CONF_FILES_FILTER_MASKED, search1) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search1_b)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_at(&result, ".conf", tfd, CONF_FILES_FILTER_MASKED, "/dir1/") >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE("dir1/a.conf", "dir1/b.conf")));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         /* search two dirs */
         assert_se(conf_files_list_strv(&result, ".conf", NULL, CONF_FILES_FILTER_MASKED, STRV_MAKE_CONST(search1, search2)) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search2_aa, search1_b)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_strv(&result, ".conf", t, CONF_FILES_FILTER_MASKED, STRV_MAKE_CONST("/dir1/", "/dir2/")) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search2_aa, search1_b)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_strv_at(&result, ".conf", AT_FDCWD, CONF_FILES_FILTER_MASKED, STRV_MAKE_CONST(search1, search2)) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE(search1_a, search2_aa, search1_b)));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_strv_at(&result, ".conf", tfd, CONF_FILES_FILTER_MASKED, STRV_MAKE_CONST("/dir1/", "/dir2/")) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE("dir1/a.conf", "dir2/aa.conf", "dir1/b.conf")));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         /* filename only */
         assert_se(conf_files_list_strv(&result, ".conf", NULL, CONF_FILES_FILTER_MASKED | CONF_FILES_BASENAME, STRV_MAKE_CONST(search1, search2)) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE("a.conf", "aa.conf", "b.conf")));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_strv(&result, ".conf", t, CONF_FILES_FILTER_MASKED | CONF_FILES_BASENAME, STRV_MAKE_CONST("/dir1/", "/dir2/")) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE("a.conf", "aa.conf", "b.conf")));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_strv_at(&result, ".conf", AT_FDCWD, CONF_FILES_FILTER_MASKED | CONF_FILES_BASENAME, STRV_MAKE_CONST(search1, search2)) >= 0);
         strv_print(result);
         assert_se(strv_equal(result, STRV_MAKE("a.conf", "aa.conf", "b.conf")));
 
-        result = strv_free(result);
+        result = sd_strv_free(result);
 
         assert_se(conf_files_list_strv_at(&result, ".conf", tfd, CONF_FILES_FILTER_MASKED | CONF_FILES_BASENAME, STRV_MAKE_CONST("/dir1/", "/dir2/")) >= 0);
         strv_print(result);
@@ -156,7 +156,7 @@ TEST(conf_files_list) {
 }
 
 static void test_conf_files_insert_one(const char *root) {
-        _cleanup_strv_free_ char **s = NULL;
+        _cleanup_sd_strv_free_ char **s = NULL;
 
         log_info("/* %s root=%s */", __func__, strempty(root));
 
diff '--color=auto' -Nurp a/src/test/test-conf-parser.c b/src/test/test-conf-parser.c
--- a/src/test/test-conf-parser.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-conf-parser.c	2025-06-30 18:35:00.000000000 +0000
@@ -63,7 +63,7 @@ static void test_config_parse_unsigned_o
 }
 
 static void test_config_parse_strv_one(const char *rvalue, char **expected) {
-        _cleanup_strv_free_ char **strv = NULL;
+        _cleanup_sd_strv_free_ char **strv = NULL;
 
         assert_se(config_parse_strv("unit", "filename", 1, "section", 1, "lvalue", 0, rvalue, &strv, NULL) >= 0);
         assert_se(strv_equal(expected, strv));
@@ -420,7 +420,7 @@ TEST(config_parse_standard_file_with_dro
                                        "E=eee", WRITE_STRING_FILE_CREATE) == 0);
 
         _cleanup_free_ char *A = NULL, *B = NULL, *C = NULL, *D = NULL, *E = NULL, *F = NULL;
-        _cleanup_strv_free_ char **dropins = NULL;
+        _cleanup_sd_strv_free_ char **dropins = NULL;
 
         const ConfigTableItem items[] = {
                 { NULL, "A",  config_parse_string,   0, &A},
@@ -454,7 +454,7 @@ TEST(config_parse_standard_file_with_dro
         D = mfree(D);
         E = mfree(E);
 
-        assert_se(strv_length(dropins) == 4);
+        assert_se(sd_strv_length(dropins) == 4);
 
         /* Make sure that we follow symlinks */
         assert_se(mkdir_p_root(root, "/etc/kernel/install2.conf.d", UID_INVALID, GID_INVALID, 0755));
diff '--color=auto' -Nurp a/src/test/test-core-unit.c b/src/test/test-core-unit.c
--- a/src/test/test-core-unit.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-core-unit.c	2025-06-30 18:37:55.000000000 +0000
@@ -69,7 +69,7 @@ static void test_unit_concat_strv_one(
         _cleanup_free_ char *a = NULL, *b = NULL, *c = NULL, *d = NULL,
                 *s_ser = NULL, *s_esc = NULL, *a_esc = NULL, *b_esc = NULL, *c_esc = NULL, *d_esc = NULL;
 
-        assert_se(s_ser = strv_join(s, "_"));
+        assert_se(s_ser = sd_strv_join(s, "_"));
         assert_se(s_esc = cescape(s_ser));
         if (!expected_exec_env)
                 expected_exec_env = expected_none;
diff '--color=auto' -Nurp a/src/test/test-daemon.c b/src/test/test-daemon.c
--- a/src/test/test-daemon.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-daemon.c	2025-06-30 18:33:48.000000000 +0000
@@ -10,7 +10,7 @@
 #include "tests.h"
 
 int main(int argc, char *argv[]) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         int n, i;
         usec_t duration = USEC_PER_SEC / 10;
 
diff '--color=auto' -Nurp a/src/test/test-env-file.c b/src/test/test-env-file.c
--- a/src/test/test-env-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-env-file.c	2025-06-30 18:33:48.000000000 +0000
@@ -63,7 +63,7 @@ TEST(load_env_file_1) {
         _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
         assert_se(write_tmpfile(name, env_file_1) == 0);
 
-        _cleanup_strv_free_ char **data = NULL;
+        _cleanup_sd_strv_free_ char **data = NULL;
         assert_se(load_env_file(NULL, name, &data) == 0);
         ASSERT_STREQ(data[0], "a=a");
         ASSERT_STREQ(data[1], "b=bc");
@@ -78,7 +78,7 @@ TEST(load_env_file_2) {
         _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
         assert_se(write_tmpfile(name, env_file_2) == 0);
 
-        _cleanup_strv_free_ char **data = NULL;
+        _cleanup_sd_strv_free_ char **data = NULL;
         assert_se(load_env_file(NULL, name, &data) == 0);
         ASSERT_STREQ(data[0], "a=a");
         ASSERT_NULL(data[1]);
@@ -88,7 +88,7 @@ TEST(load_env_file_3) {
         _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
         assert_se(write_tmpfile(name, env_file_3) == 0);
 
-        _cleanup_strv_free_ char **data = NULL;
+        _cleanup_sd_strv_free_ char **data = NULL;
         assert_se(load_env_file(NULL, name, &data) == 0);
         ASSERT_STREQ(data[0], "normal1=line111");
         ASSERT_STREQ(data[1], "normal2=line222");
@@ -99,7 +99,7 @@ TEST(load_env_file_4) {
         _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
         assert_se(write_tmpfile(name, env_file_4) == 0);
 
-        _cleanup_strv_free_ char **data = NULL;
+        _cleanup_sd_strv_free_ char **data = NULL;
         assert_se(load_env_file(NULL, name, &data) == 0);
         ASSERT_STREQ(data[0], "HWMON_MODULES=coretemp f71882fg");
         ASSERT_STREQ(data[1], "MODULE_0=coretemp");
@@ -111,7 +111,7 @@ TEST(load_env_file_5) {
         _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
         assert_se(write_tmpfile(name, env_file_5) == 0);
 
-        _cleanup_strv_free_ char **data = NULL;
+        _cleanup_sd_strv_free_ char **data = NULL;
         assert_se(load_env_file(NULL, name, &data) == 0);
         ASSERT_STREQ(data[0], "a=");
         ASSERT_STREQ(data[1], "b=");
@@ -122,7 +122,7 @@ TEST(load_env_file_6) {
         _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
         assert_se(write_tmpfile(name, env_file_6) == 0);
 
-        _cleanup_strv_free_ char **data = NULL;
+        _cleanup_sd_strv_free_ char **data = NULL;
         assert_se(load_env_file(NULL, name, &data) == 0);
         ASSERT_STREQ(data[0], "a= n t x y '");
         ASSERT_STREQ(data[1], "b=$'");
@@ -144,7 +144,7 @@ TEST(load_env_file_invalid_utf8) {
                 _cleanup_(unlink_tempfilep) char name[] = "/tmp/test-load-env-file.XXXXXX";
                 assert_se(write_tmpfile(name, s) == 0);
 
-                _cleanup_strv_free_ char **data = NULL;
+                _cleanup_sd_strv_free_ char **data = NULL;
                 assert_se(load_env_file(NULL, name, &data) == -EINVAL);
                 assert_se(!data);
         }
@@ -164,7 +164,7 @@ TEST(write_and_load_env_file) {
                        "dollar$dollar",
                        "newline\nnewline") {
                 _cleanup_(unlink_and_freep) char *p = NULL;
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
                 _cleanup_free_ char *j = NULL, *w = NULL, *cmd = NULL, *from_shell = NULL;
                 _cleanup_pclose_ FILE *f = NULL;
                 size_t sz;
diff '--color=auto' -Nurp a/src/test/test-env-util.c b/src/test/test-env-util.c
--- a/src/test/test-env-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-env-util.c	2025-06-30 18:37:06.000000000 +0000
@@ -12,15 +12,15 @@
 #include "tests.h"
 
 TEST(strv_env_delete) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL, **c = NULL, **d = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL, **c = NULL, **d = NULL;
 
-        a = strv_new("FOO=BAR", "WALDO=WALDO", "WALDO=", "PIEP", "SCHLUMPF=SMURF");
+        a = sd_strv_new("FOO=BAR", "WALDO=WALDO", "WALDO=", "PIEP", "SCHLUMPF=SMURF");
         assert_se(a);
 
-        b = strv_new("PIEP", "FOO");
+        b = sd_strv_new("PIEP", "FOO");
         assert_se(b);
 
-        c = strv_new("SCHLUMPF");
+        c = sd_strv_new("SCHLUMPF");
         assert_se(c);
 
         d = strv_env_delete(a, 2, b, c);
@@ -28,7 +28,7 @@ TEST(strv_env_delete) {
 
         ASSERT_STREQ(d[0], "WALDO=WALDO");
         ASSERT_STREQ(d[1], "WALDO=");
-        assert_se(strv_length(d) == 2);
+        assert_se(sd_strv_length(d) == 2);
 }
 
 TEST(strv_env_get) {
@@ -49,23 +49,23 @@ TEST(strv_env_pairs_get) {
 }
 
 TEST(strv_env_unset) {
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
-        l = strv_new("PIEP", "SCHLUMPF=SMURFF", "NANANANA=YES");
+        l = sd_strv_new("PIEP", "SCHLUMPF=SMURFF", "NANANANA=YES");
         assert_se(l);
 
         assert_se(strv_env_unset(l, "SCHLUMPF") == l);
 
         ASSERT_STREQ(l[0], "PIEP");
         ASSERT_STREQ(l[1], "NANANANA=YES");
-        assert_se(strv_length(l) == 2);
+        assert_se(sd_strv_length(l) == 2);
 }
 
 TEST(strv_env_merge) {
         char **a = STRV_MAKE("FOO=BAR", "WALDO=WALDO", "WALDO=", "PIEP", "SCHLUMPF=SMURF", "EQ===");
         char **b = STRV_MAKE("FOO=KKK", "FOO=", "PIEP=", "SCHLUMPF=SMURFF", "NANANANA=YES");
 
-        _cleanup_strv_free_ char **r = strv_env_merge(NULL, a, NULL, b, NULL, a, b, b, NULL);
+        _cleanup_sd_strv_free_ char **r = strv_env_merge(NULL, a, NULL, b, NULL, a, b, b, NULL);
         assert_se(r);
         ASSERT_STREQ(r[0], "FOO=");
         ASSERT_STREQ(r[1], "WALDO=");
@@ -74,7 +74,7 @@ TEST(strv_env_merge) {
         ASSERT_STREQ(r[4], "EQ===");
         ASSERT_STREQ(r[5], "PIEP=");
         ASSERT_STREQ(r[6], "NANANANA=YES");
-        assert_se(strv_length(r) == 7);
+        assert_se(sd_strv_length(r) == 7);
 
         assert_se(strv_env_clean(r) == r);
         ASSERT_STREQ(r[0], "FOO=");
@@ -83,25 +83,25 @@ TEST(strv_env_merge) {
         ASSERT_STREQ(r[3], "EQ===");
         ASSERT_STREQ(r[4], "PIEP=");
         ASSERT_STREQ(r[5], "NANANANA=YES");
-        assert_se(strv_length(r) == 6);
+        assert_se(sd_strv_length(r) == 6);
 }
 
 TEST(strv_env_replace_strdup) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
         assert_se(strv_env_replace_strdup(&a, "a=a") == 1);
         assert_se(strv_env_replace_strdup(&a, "b=b") == 1);
         assert_se(strv_env_replace_strdup(&a, "a=A") == 0);
         assert_se(strv_env_replace_strdup(&a, "c") == -EINVAL);
 
-        assert_se(strv_length(a) == 2);
+        assert_se(sd_strv_length(a) == 2);
         strv_sort(a);
         ASSERT_STREQ(a[0], "a=A");
         ASSERT_STREQ(a[1], "b=b");
 }
 
 TEST(strv_env_replace_strdup_passthrough) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
         assert_se(putenv((char*) "a=a") == 0);
         assert_se(putenv((char*) "b=") == 0);
@@ -113,14 +113,14 @@ TEST(strv_env_replace_strdup_passthrough
         assert_se(strv_env_replace_strdup_passthrough(&a, "a") == 0);
         assert_se(strv_env_replace_strdup_passthrough(&a, "$a") == -EINVAL);
 
-        assert_se(strv_length(a) == 3);
+        assert_se(sd_strv_length(a) == 3);
         ASSERT_STREQ(a[0], "a=a");
         ASSERT_STREQ(a[1], "b=");
         ASSERT_STREQ(a[2], "c=");
 }
 
 TEST(strv_env_assign) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
         assert_se(strv_env_assign(&a, "a", "a") == 1);
         assert_se(strv_env_assign(&a, "b", "b") == 1);
@@ -129,18 +129,18 @@ TEST(strv_env_assign) {
 
         assert_se(strv_env_assign(&a, "a=", "B") == -EINVAL);
 
-        assert_se(strv_length(a) == 1);
+        assert_se(sd_strv_length(a) == 1);
         ASSERT_STREQ(a[0], "a=A");
 }
 
 TEST(strv_env_assignf) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
         assert_se(strv_env_assignf(&a, "a", "a") > 0);
         assert_se(strv_env_assignf(&a, "a", "%c", 'a') == 0);
 
         assert_se(strv_env_assignf(&a, "c", "xxx%iyyy", 5) > 0);
-        assert_se(strv_length(a) == 2);
+        assert_se(sd_strv_length(a) == 2);
         assert_se(strv_equal(a, STRV_MAKE("a=a", "c=xxx5yyy")));
         assert_se(strv_env_assignf(&a, "c", NULL) == 0);
 
@@ -150,32 +150,32 @@ TEST(strv_env_assignf) {
 
         assert_se(strv_env_assignf(&a, "a=", "B") == -EINVAL);
 
-        assert_se(strv_length(a) == 1);
+        assert_se(sd_strv_length(a) == 1);
         ASSERT_STREQ(a[0], "a=A");
 }
 
 TEST(strv_env_assign_many) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
         assert_se(strv_env_assign_many(&a, "a", "a", "b", "b") >= 0);
 
-        assert_se(strv_length(a) == 2);
+        assert_se(sd_strv_length(a) == 2);
         assert_se(strv_contains(a, "a=a"));
         assert_se(strv_contains(a, "b=b"));
 
         assert_se(strv_env_assign_many(&a, "a", "A", "b", "b", "c", "c") >= 0);
-        assert_se(strv_length(a) == 3);
+        assert_se(sd_strv_length(a) == 3);
         assert_se(strv_contains(a, "a=A"));
         assert_se(strv_contains(a, "b=b"));
         assert_se(strv_contains(a, "c=c"));
 
         assert_se(strv_env_assign_many(&a, "b", NULL, "c", "C") >= 0);
-        assert_se(strv_length(a) == 2);
+        assert_se(sd_strv_length(a) == 2);
         assert_se(strv_contains(a, "a=A"));
         assert_se(strv_contains(a, "c=C"));
 
         assert_se(strv_env_assign_many(&a, "a=", "B") == -EINVAL);
-        assert_se(strv_length(a) == 2);
+        assert_se(sd_strv_length(a) == 2);
         assert_se(strv_contains(a, "a=A"));
         assert_se(strv_contains(a, "c=C"));
 }
@@ -303,7 +303,7 @@ TEST(replace_env_argv) {
                 "${FOO:+|${BAR}{|}",
                 NULL
         };
-        _cleanup_strv_free_ char **r = NULL;
+        _cleanup_sd_strv_free_ char **r = NULL;
 
         assert_se(replace_env_argv((char**) line, (char**) env, &r, NULL, NULL) >= 0);
         assert_se(r);
@@ -324,7 +324,7 @@ TEST(replace_env_argv) {
         ASSERT_STREQ(r[14], "${QUUX:+waldo}");
         ASSERT_STREQ(r[15], "${FOO:+|waldo|}}");
         ASSERT_STREQ(r[16], "${FOO:+|waldo{|}");
-        assert_se(strv_length(r) == 17);
+        assert_se(sd_strv_length(r) == 17);
 }
 
 TEST(replace_env_argv_bad) {
@@ -346,7 +346,7 @@ TEST(replace_env_argv_bad) {
                 NULL
         };
 
-        _cleanup_strv_free_ char **bad = NULL, **unset = NULL, **replaced = NULL;
+        _cleanup_sd_strv_free_ char **bad = NULL, **unset = NULL, **replaced = NULL;
 
         assert_se(replace_env_argv((char**) line, (char**) env, &replaced, &unset, &bad) >= 0);
 
@@ -369,7 +369,7 @@ TEST(replace_env_argv_bad) {
 }
 
 TEST(env_clean) {
-        _cleanup_strv_free_ char **e = strv_new("FOOBAR=WALDO",
+        _cleanup_sd_strv_free_ char **e = sd_strv_new("FOOBAR=WALDO",
                                                 "FOOBAR=WALDO",
                                                 "FOOBAR",
                                                 "F",
@@ -498,14 +498,14 @@ TEST(getenv_steal_erase) {
 
         r = safe_fork("(sd-getenvstealerase)", FORK_DEATHSIG_SIGTERM|FORK_LOG|FORK_WAIT, NULL);
         if (r == 0) {
-                _cleanup_strv_free_ char **l = NULL;
+                _cleanup_sd_strv_free_ char **l = NULL;
 
                 /* child */
 
                 assert_se(getenv_steal_erase("thisenvvardefinitelywontexist", NULL) == 0);
 
-                l = strv_new("FOO=BAR", "QUUX=PIFF", "ONE=TWO", "A=B");
-                assert_se(strv_length(l) == 4);
+                l = sd_strv_new("FOO=BAR", "QUUX=PIFF", "ONE=TWO", "A=B");
+                assert_se(sd_strv_length(l) == 4);
 
                 environ = l;
 
@@ -532,7 +532,7 @@ TEST(getenv_steal_erase) {
                 }
 
                 environ = NULL;
-                l = strv_free(l);
+                l = sd_strv_free(l);
 
                 _exit(EXIT_SUCCESS);
         }
@@ -547,7 +547,7 @@ TEST(strv_env_name_is_valid) {
 }
 
 TEST(getenv_path_list) {
-        _cleanup_strv_free_ char **path_list = NULL;
+        _cleanup_sd_strv_free_ char **path_list = NULL;
 
         /* Empty paths */
         FOREACH_STRING(s, "", ":", ":::::", " : ::: :: :") {
diff '--color=auto' -Nurp a/src/test/test-exec-util.c b/src/test/test-exec-util.c
--- a/src/test/test-exec-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-exec-util.c	2025-06-30 18:37:06.000000000 +0000
@@ -207,7 +207,7 @@ static int gather_stdout_one(int fd, voi
         safe_close(fd);
 
         assert_se(t = strndup(buf, sizeof buf));
-        assert_se(strv_push(s, t) >= 0);
+        assert_se(sd_strv_push(s, t) >= 0);
 
         return 0;
 }
@@ -288,7 +288,7 @@ TEST(environment_gathering) {
         int r;
 
         char **tmp = NULL; /* this is only used in the forked process, no cleanup here */
-        _cleanup_strv_free_ char **env = NULL;
+        _cleanup_sd_strv_free_ char **env = NULL;
 
         void* const args[] = { &tmp, &tmp, &env };
 
@@ -352,8 +352,8 @@ TEST(environment_gathering) {
         ASSERT_STREQ(strv_env_get(env, "PATH"), "no-sh-built-in-path:/no/such/file");
 
         /* Now retest with some "default" path passed. */
-        env = strv_free(env);
-        env = strv_new("PATH=" DEFAULT_PATH_WITHOUT_SBIN);
+        env = sd_strv_free(env);
+        env = sd_strv_new("PATH=" DEFAULT_PATH_WITHOUT_SBIN);
         assert_se(env);
 
         r = execute_directories(dirs, DEFAULT_TIMEOUT_USEC, gather_environment, args, NULL, env, EXEC_DIR_PARALLEL | EXEC_DIR_IGNORE_ERRORS);
@@ -429,7 +429,7 @@ TEST(exec_command_flags_from_strv) {
 }
 
 TEST(exec_command_flags_to_strv) {
-        _cleanup_strv_free_ char **opts = NULL, **empty_opts = NULL, **invalid_opts = NULL;
+        _cleanup_sd_strv_free_ char **opts = NULL, **empty_opts = NULL, **invalid_opts = NULL;
         ExecCommandFlags flags = 0;
         int r;
 
diff '--color=auto' -Nurp a/src/test/test-execute.c b/src/test/test-execute.c
--- a/src/test/test-execute.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-execute.c	2025-06-30 18:37:42.000000000 +0000
@@ -674,7 +674,7 @@ static int find_libraries(const char *ex
         _cleanup_(sd_event_source_unrefp) sd_event_source *stdout_source = NULL;
         _cleanup_(sd_event_source_unrefp) sd_event_source *stderr_source = NULL;
         _cleanup_close_pair_ int outpipe[2] = EBADF_PAIR, errpipe[2] = EBADF_PAIR;
-        _cleanup_strv_free_ char **libraries = NULL;
+        _cleanup_sd_strv_free_ char **libraries = NULL;
         _cleanup_free_ char *result = NULL;
         pid_t pid;
         int r;
@@ -714,8 +714,8 @@ static int find_libraries(const char *ex
 
         ASSERT_OK(sd_event_loop(e));
 
-        _cleanup_strv_free_ char **v = NULL;
-        ASSERT_OK(strv_split_newlines_full(&v, result, 0));
+        _cleanup_sd_strv_free_ char **v = NULL;
+        ASSERT_OK(sd_strv_split_newlines_full(&v, result, 0));
 
         STRV_FOREACH(q, v) {
                 _cleanup_free_ char *word = NULL;
@@ -727,7 +727,7 @@ static int find_libraries(const char *ex
                         continue;
 
                 if (path_is_absolute(word)) {
-                        ASSERT_OK(strv_consume(&libraries, TAKE_PTR(word)));
+                        ASSERT_OK(sd_strv_consume(&libraries, TAKE_PTR(word)));
                         continue;
                 }
 
@@ -747,7 +747,7 @@ static int find_libraries(const char *ex
                         continue;
 
                 if (path_is_absolute(word)) {
-                        ASSERT_OK(strv_consume(&libraries, TAKE_PTR(word)));
+                        ASSERT_OK(sd_strv_consume(&libraries, TAKE_PTR(word)));
                         continue;
                 }
         }
@@ -760,7 +760,7 @@ static int find_libraries(const char *ex
 static void test_exec_mount_apivfs(Manager *m) {
 #if !HAS_FEATURE_ADDRESS_SANITIZER
         _cleanup_free_ char *fullpath_touch = NULL, *fullpath_test = NULL, *data = NULL;
-        _cleanup_strv_free_ char **libraries = NULL, **libraries_test = NULL;
+        _cleanup_sd_strv_free_ char **libraries = NULL, **libraries_test = NULL;
         int r;
 
         ASSERT_NOT_NULL(user_runtime_unit_dir);
@@ -786,7 +786,7 @@ static void test_exec_mount_apivfs(Manag
 
         ASSERT_OK(find_libraries(fullpath_touch, &libraries));
         ASSERT_OK(find_libraries(fullpath_test, &libraries_test));
-        ASSERT_OK(strv_extend_strv(&libraries, libraries_test, true));
+        ASSERT_OK(sd_sd_strv_extend_strv(&libraries, libraries_test, true));
 
         ASSERT_NOT_NULL(strextend(&data, "[Service]\n"));
         ASSERT_NOT_NULL(strextend(&data, "ExecStart=", fullpath_touch, " /aaa\n"));
@@ -1510,13 +1510,13 @@ static int prepare_ns(const char *proces
 }
 
 TEST(run_tests_root) {
-        _cleanup_strv_free_ char **filters = NULL;
+        _cleanup_sd_strv_free_ char **filters = NULL;
 
         if (!have_namespaces())
                 return (void) log_tests_skipped("unshare() is disabled");
 
         /* safe_fork() clears saved_argv in the child process. Let's copy it. */
-        ASSERT_NOT_NULL(filters = strv_copy(strv_skip(saved_argv, 1)));
+        ASSERT_NOT_NULL(filters = sd_strv_copy(strv_skip(saved_argv, 1)));
 
         if (prepare_ns("(test-execute-root)") == 0) {
                 can_unshare = true;
@@ -1534,7 +1534,7 @@ TEST(run_tests_without_unshare) {
         }
 
 #if HAVE_SECCOMP
-        _cleanup_strv_free_ char **filters = NULL;
+        _cleanup_sd_strv_free_ char **filters = NULL;
         int r;
 
         /* The following tests are for 1beab8b0d0ff2d7d1436b52d4a0c3d56dc908962. */
@@ -1542,7 +1542,7 @@ TEST(run_tests_without_unshare) {
                 return (void) log_tests_skipped("Seccomp not available, cannot run unshare() filtered tests");
 
         /* safe_fork() clears saved_argv in the child process. Let's copy it. */
-        ASSERT_NOT_NULL(filters = strv_copy(strv_skip(saved_argv, 1)));
+        ASSERT_NOT_NULL(filters = sd_strv_copy(strv_skip(saved_argv, 1)));
 
         if (prepare_ns("(test-execute-without-unshare)") == 0) {
                 _cleanup_hashmap_free_ Hashmap *s = NULL;
@@ -1565,13 +1565,13 @@ TEST(run_tests_without_unshare) {
 }
 
 TEST(run_tests_unprivileged) {
-        _cleanup_strv_free_ char **filters = NULL;
+        _cleanup_sd_strv_free_ char **filters = NULL;
 
         if (!have_namespaces())
                 return (void) log_tests_skipped("unshare() is disabled");
 
         /* safe_fork() clears saved_argv in the child process. Let's copy it. */
-        ASSERT_NOT_NULL(filters = strv_copy(strv_skip(saved_argv, 1)));
+        ASSERT_NOT_NULL(filters = sd_strv_copy(strv_skip(saved_argv, 1)));
 
         if (prepare_ns("(test-execute-unprivileged)") == 0) {
                 ASSERT_OK(capability_bounding_set_drop(0, /* right_now = */ true));
diff '--color=auto' -Nurp a/src/test/test-execve.c b/src/test/test-execve.c
--- a/src/test/test-execve.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-execve.c	2025-06-30 18:37:25.000000000 +0000
@@ -26,7 +26,7 @@ static int run(int argc, char **argv) {
 
         test_setup_logging(LOG_DEBUG);
 
-        args = !strv_isempty(args) ? args : STRV_MAKE("/bin/true");
+        args = !sd_strv_isempty(args) ? args : STRV_MAKE("/bin/true");
 
         fd = open(args[0], O_RDONLY | O_CLOEXEC);
         if (fd < 0)
diff '--color=auto' -Nurp a/src/test/test-fileio.c b/src/test/test-fileio.c
--- a/src/test/test-fileio.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-fileio.c	2025-06-30 18:37:25.000000000 +0000
@@ -34,7 +34,7 @@ TEST(parse_env_file) {
         _cleanup_free_ char *one = NULL, *two = NULL, *three = NULL, *four = NULL, *five = NULL,
                         *six = NULL, *seven = NULL, *eight = NULL, *nine = NULL, *ten = NULL,
                         *eleven = NULL, *twelve = NULL, *thirteen = NULL;
-        _cleanup_strv_free_ char **a = NULL, **b = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;
         unsigned k;
         int r;
 
@@ -169,7 +169,7 @@ TEST(parse_multiline_env_file) {
                 t[] = "/tmp/test-fileio-in-XXXXXX",
                 p[] = "/tmp/test-fileio-out-XXXXXX";
         FILE *f;
-        _cleanup_strv_free_ char **a = NULL, **b = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;
         int r;
 
         assert_se(fmkostemp_safe(t, "w", &f) == 0);
@@ -218,7 +218,7 @@ TEST(parse_multiline_env_file) {
 TEST(merge_env_file) {
         _cleanup_(unlink_tempfilep) char t[] = "/tmp/test-fileio-XXXXXX";
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         int r;
 
         assert_se(fmkostemp_safe(t, "w", &f) == 0);
@@ -281,7 +281,7 @@ TEST(merge_env_file) {
 TEST(merge_env_file_invalid) {
         _cleanup_(unlink_tempfilep) char t[] = "/tmp/test-fileio-XXXXXX";
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         int r;
 
         assert_se(fmkostemp_safe(t, "w", &f) == 0);
@@ -308,7 +308,7 @@ TEST(merge_env_file_invalid) {
         STRV_FOREACH(i, a)
                 log_info("Got: <%s>", *i);
 
-        assert_se(strv_isempty(a));
+        assert_se(sd_strv_isempty(a));
 }
 
 TEST(executable_is_script) {
@@ -510,7 +510,7 @@ TEST(write_string_file_verify) {
 
 static void check_file_pairs_one(char **l) {
         assert_se(l);
-        assert_se(strv_length(l) == 14);
+        assert_se(sd_strv_length(l) == 14);
 
         STRV_FOREACH_PAIR(k, v, l) {
                 assert_se(STR_IN_SET(*k, "NAME", "ID", "PRETTY_NAME", "ANSI_COLOR", "HOME_URL", "SUPPORT_URL", "BUG_REPORT_URL"));
@@ -529,7 +529,7 @@ TEST(load_env_file_pairs) {
         _cleanup_(unlink_tempfilep) char fn[] = "/tmp/test-load_env_file_pairs-XXXXXX";
         int fd, r;
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
         fd = mkostemp_safe(fn);
         assert_se(fd >= 0);
@@ -548,7 +548,7 @@ TEST(load_env_file_pairs) {
         r = load_env_file_pairs_fd(fd, fn, &l);
         assert_se(r >= 0);
         check_file_pairs_one(l);
-        l = strv_free(l);
+        l = sd_strv_free(l);
 
         f = fdopen(fd, "r");
         assert_se(f);
diff '--color=auto' -Nurp a/src/test/test-fs-util.c b/src/test/test-fs-util.c
--- a/src/test/test-fs-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-fs-util.c	2025-06-30 18:33:48.000000000 +0000
@@ -63,7 +63,7 @@ TEST(readlink_and_make_absolute) {
 }
 
 TEST(get_files_in_directory) {
-        _cleanup_strv_free_ char **l = NULL, **t = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL, **t = NULL;
 
         assert_se(get_files_in_directory(arg_test_dir ?: "/tmp", &l) >= 0);
         assert_se(get_files_in_directory(".", &t) >= 0);
diff '--color=auto' -Nurp a/src/test/test-fstab-util.c b/src/test/test-fstab-util.c
--- a/src/test/test-fstab-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-fstab-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -30,7 +30,7 @@ static void do_fstab_filter_options(cons
         int r;
         const char *name;
         _cleanup_free_ char *value = NULL, *filtered = NULL, *joined = NULL;
-        _cleanup_strv_free_ char **values = NULL;
+        _cleanup_sd_strv_free_ char **values = NULL;
 
         /* test mode which returns the last value */
 
@@ -46,7 +46,7 @@ static void do_fstab_filter_options(cons
         /* test mode which returns all the values */
 
         r = fstab_filter_options(opts, remove, &name, NULL, &values, NULL);
-        assert_se(joined = strv_join(values, ":"));
+        assert_se(joined = sd_strv_join(values, ":"));
         log_info("2: \"%s\" ‚Üí %d, \"%s\", \"%s\", expected %d, \"%s\", \"%s\"",
                  opts, r, strnull(name), joined,
                  r_values_expected, strnull(name_expected), strnull(values_expected));
diff '--color=auto' -Nurp a/src/test/test-hashmap-plain.c b/src/test/test-hashmap-plain.c
--- a/src/test/test-hashmap-plain.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-hashmap-plain.c	2025-06-30 18:33:48.000000000 +0000
@@ -84,7 +84,7 @@ TEST(hashmap_copy) {
 
 TEST(hashmap_get_strv) {
         _cleanup_hashmap_free_ Hashmap *m = NULL;
-        _cleanup_strv_free_ char **strv = NULL;
+        _cleanup_sd_strv_free_ char **strv = NULL;
         char *val1, *val2, *val3, *val4;
 
         val1 = strdup("val1");
diff '--color=auto' -Nurp a/src/test/test-kbd-util.c b/src/test/test-kbd-util.c
--- a/src/test/test-kbd-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-kbd-util.c	2025-06-30 18:33:48.000000000 +0000
@@ -6,7 +6,7 @@
 #include "tests.h"
 
 int main(int argc, char *argv[]) {
-        _cleanup_strv_free_ char **maps = NULL;
+        _cleanup_sd_strv_free_ char **maps = NULL;
         int r;
 
         log_show_color(true);
diff '--color=auto' -Nurp a/src/test/test-load-fragment.c b/src/test/test-load-fragment.c
--- a/src/test/test-load-fragment.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-load-fragment.c	2025-06-30 18:37:25.000000000 +0000
@@ -76,7 +76,7 @@ static void check_execcommand(ExecComman
         assert_se(c);
         log_info("expect: \"%s\" [\"%s\" \"%s\" \"%s\"]",
                  path, argv0 ?: path, strnull(argv1), strnull(argv2));
-        n = strv_length(c->argv);
+        n = sd_strv_length(c->argv);
         log_info("actual: \"%s\" [\"%s\" \"%s\" \"%s\"]",
                  c->path, c->argv[0], n > 0 ? c->argv[1] : "(null)", n > 1 ? c->argv[2] : "(null)");
         ASSERT_STREQ(c->path, path);
@@ -787,13 +787,13 @@ TEST(config_parse_pass_environ) {
                  void *data,
                  void *userdata) */
         int r;
-        _cleanup_strv_free_ char **passenv = NULL;
+        _cleanup_sd_strv_free_ char **passenv = NULL;
 
         r = config_parse_pass_environ(NULL, "fake", 1, "section", 1,
                                       "PassEnvironment", 0, "A B",
                                       &passenv, NULL);
         assert_se(r >= 0);
-        assert_se(strv_length(passenv) == 2);
+        assert_se(sd_strv_length(passenv) == 2);
         ASSERT_STREQ(passenv[0], "A");
         ASSERT_STREQ(passenv[1], "B");
 
@@ -801,13 +801,13 @@ TEST(config_parse_pass_environ) {
                                       "PassEnvironment", 0, "",
                                       &passenv, NULL);
         assert_se(r >= 0);
-        assert_se(strv_isempty(passenv));
+        assert_se(sd_strv_isempty(passenv));
 
         r = config_parse_pass_environ(NULL, "fake", 1, "section", 1,
                                       "PassEnvironment", 0, "'invalid name' 'normal_name' A=1 'special_name$$' \\",
                                       &passenv, NULL);
         assert_se(r >= 0);
-        assert_se(strv_length(passenv) == 1);
+        assert_se(sd_strv_length(passenv) == 1);
         ASSERT_STREQ(passenv[0], "normal_name");
 }
 
@@ -826,7 +826,7 @@ TEST(config_parse_unit_env_file) {
 
         _cleanup_(manager_freep) Manager *m = NULL;
         Unit *u;
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         r = manager_new(RUNTIME_SCOPE_USER, MANAGER_TEST_RUN_MINIMAL, &m);
@@ -845,19 +845,19 @@ TEST(config_parse_unit_env_file) {
                                       "EnvironmentFile", 0, "not-absolute",
                                        &files, u);
         assert_se(r == 0);
-        assert_se(strv_isempty(files));
+        assert_se(sd_strv_isempty(files));
 
         r = config_parse_unit_env_file(u->id, "fake", 1, "section", 1,
                                       "EnvironmentFile", 0, "/absolute1",
                                        &files, u);
         assert_se(r == 0);
-        assert_se(strv_length(files) == 1);
+        assert_se(sd_strv_length(files) == 1);
 
         r = config_parse_unit_env_file(u->id, "fake", 1, "section", 1,
                                       "EnvironmentFile", 0, "/absolute2",
                                        &files, u);
         assert_se(r == 0);
-        assert_se(strv_length(files) == 2);
+        assert_se(sd_strv_length(files) == 2);
         ASSERT_STREQ(files[0], "/absolute1");
         ASSERT_STREQ(files[1], "/absolute2");
 
@@ -865,13 +865,13 @@ TEST(config_parse_unit_env_file) {
                                        "EnvironmentFile", 0, "",
                                        &files, u);
         assert_se(r == 0);
-        assert_se(strv_isempty(files));
+        assert_se(sd_strv_isempty(files));
 
         r = config_parse_unit_env_file(u->id, "fake", 1, "section", 1,
                                        "EnvironmentFile", 0, "/path/%n.conf",
                                        &files, u);
         assert_se(r == 0);
-        assert_se(strv_length(files) == 1);
+        assert_se(sd_strv_length(files) == 1);
         ASSERT_STREQ(files[0], "/path/foobar.service.conf");
 }
 
diff '--color=auto' -Nurp a/src/test/test-locale-util.c b/src/test/test-locale-util.c
--- a/src/test/test-locale-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-locale-util.c	2025-06-30 18:33:48.000000000 +0000
@@ -8,7 +8,7 @@
 #include "tests.h"
 
 TEST(get_locales) {
-        _cleanup_strv_free_ char **locales = NULL;
+        _cleanup_sd_strv_free_ char **locales = NULL;
         int r;
 
         r = get_locales(&locales);
@@ -55,7 +55,7 @@ TEST(locale_is_installed) {
 }
 
 TEST(keymaps) {
-        _cleanup_strv_free_ char **kmaps = NULL;
+        _cleanup_sd_strv_free_ char **kmaps = NULL;
         int r;
 
         assert_se(!keymap_is_valid(""));
diff '--color=auto' -Nurp a/src/test/test-log.c b/src/test/test-log.c
--- a/src/test/test-log.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-log.c	2025-06-30 18:37:06.000000000 +0000
@@ -148,7 +148,7 @@ static void test_log_context(void) {
         {
                 char **strv = NULL;
 
-                assert_se(strv = strv_new("ABC", "DEF"));
+                assert_se(strv = sd_strv_new("ABC", "DEF"));
                 LOG_CONTEXT_CONSUME_STRV(strv);
 
                 assert_se(log_context_num_contexts() == 1);
diff '--color=auto' -Nurp a/src/test/test-mount-util.c b/src/test/test-mount-util.c
--- a/src/test/test-mount-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-mount-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -388,7 +388,7 @@ TEST(umount_recursive) {
                                 _exit(EXIT_FAILURE);
                         }
 
-                        assert_se(k = strv_join((char**) t->keep, " "));
+                        assert_se(k = sd_strv_join((char**) t->keep, " "));
                         log_info("detaching just %s (keep: %s)", strna(t->prefix), strna(empty_to_null(k)));
 
                         assert_se(umount_recursive_full(t->prefix, MNT_DETACH, (char**) t->keep) >= 0);
diff '--color=auto' -Nurp a/src/test/test-nss-hosts.c b/src/test/test-nss-hosts.c
--- a/src/test/test-nss-hosts.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-nss-hosts.c	2025-06-30 18:37:06.000000000 +0000
@@ -402,7 +402,7 @@ static int parse_argv(int argc, char **a
                       char ***the_names,
                       struct local_address **the_addresses, int *n_addresses) {
 
-        _cleanup_strv_free_ char **modules = NULL, **names = NULL;
+        _cleanup_sd_strv_free_ char **modules = NULL, **names = NULL;
         _cleanup_free_ struct local_address *addrs = NULL;
         const char *p;
         int r, n = 0;
@@ -415,9 +415,9 @@ static int parse_argv(int argc, char **a
         }
 
         if (argc > 1)
-                modules = strv_new(argv[1]);
+                modules = sd_strv_new(argv[1]);
         else
-                modules = strv_new(
+                modules = sd_strv_new(
 #if ENABLE_NSS_MYHOSTNAME
                                 "myhostname",
 #endif
@@ -438,7 +438,7 @@ static int parse_argv(int argc, char **a
                         r = in_addr_from_string_auto(*name, &family, &address);
                         if (r < 0) {
                                 /* assume this is a name */
-                                r = strv_extend(&names, *name);
+                                r = sd_strv_extend(&names, *name);
                                 if (r < 0)
                                         return r;
                         } else {
@@ -451,7 +451,7 @@ static int parse_argv(int argc, char **a
         } else {
                 _cleanup_free_ char *hostname = NULL;
                 assert_se(hostname = gethostname_malloc());
-                assert_se(names = strv_new("localhost",
+                assert_se(names = sd_strv_new("localhost",
                                            "_gateway",
                                            "_outbound",
                                            hostname,
@@ -470,7 +470,7 @@ static int parse_argv(int argc, char **a
 
 static int run(int argc, char **argv) {
         _cleanup_free_ char *dir = NULL;
-        _cleanup_strv_free_ char **modules = NULL, **names = NULL;
+        _cleanup_sd_strv_free_ char **modules = NULL, **names = NULL;
         _cleanup_free_ struct local_address *addresses = NULL;
         int n_addresses = 0;
         int r;
diff '--color=auto' -Nurp a/src/test/test-nss-users.c b/src/test/test-nss-users.c
--- a/src/test/test-nss-users.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-nss-users.c	2025-06-30 18:37:55.000000000 +0000
@@ -39,7 +39,7 @@ static void print_struct_group(const str
                  gr->gr_name, gr->gr_gid);
         log_info("        passwd=\"%s\"", gr->gr_passwd);
 
-        assert_se(members = strv_join(gr->gr_mem, ", "));
+        assert_se(members = sd_strv_join(gr->gr_mem, ", "));
         // FIXME: use shell_maybe_quote(SHELL_ESCAPE_EMPTY) when it becomes available
         log_info("        members=%s", members);
 }
@@ -192,7 +192,7 @@ static int parse_argv(int argc, char **a
                       char ***the_modules,
                       char ***the_names) {
 
-        _cleanup_strv_free_ char **modules = NULL, **names = NULL;
+        _cleanup_sd_strv_free_ char **modules = NULL, **names = NULL;
         const char *p;
         int r;
 
@@ -204,9 +204,9 @@ static int parse_argv(int argc, char **a
         }
 
         if (argc > 1)
-                modules = strv_new(argv[1]);
+                modules = sd_strv_new(argv[1]);
         else
-                modules = strv_new(
+                modules = sd_strv_new(
 #if ENABLE_NSS_SYSTEMD
                                 "systemd",
 #endif
@@ -217,9 +217,9 @@ static int parse_argv(int argc, char **a
         assert_se(modules);
 
         if (argc > 2)
-                names = strv_copy(strv_skip(argv, 2));
+                names = sd_strv_copy(strv_skip(argv, 2));
         else
-                names = strv_new("root",
+                names = sd_strv_new("root",
                                  NOBODY_USER_NAME,
                                  "foo_no_such_user",
                                  "0",
@@ -233,7 +233,7 @@ static int parse_argv(int argc, char **a
 
 static int run(int argc, char **argv) {
         _cleanup_free_ char *dir = NULL;
-        _cleanup_strv_free_ char **modules = NULL, **names = NULL;
+        _cleanup_sd_strv_free_ char **modules = NULL, **names = NULL;
         int r;
 
         test_setup_logging(LOG_INFO);
diff '--color=auto' -Nurp a/src/test/test-nulstr-util.c b/src/test/test-nulstr-util.c
--- a/src/test/test-nulstr-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-nulstr-util.c	2025-06-30 18:37:42.000000000 +0000
@@ -6,11 +6,11 @@
 #include "strv.h"
 #include "tests.h"
 
-TEST(strv_split_nulstr) {
-        _cleanup_strv_free_ char **l = NULL;
+TEST(sd_strv_split_nulstr) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char nulstr[] = "str0\0str1\0str2\0str3\0";
 
-        l = strv_split_nulstr(nulstr);
+        l = sd_strv_split_nulstr(nulstr);
         assert_se(l);
 
         ASSERT_STREQ(l[0], "str0");
@@ -21,7 +21,7 @@ TEST(strv_split_nulstr) {
 
 #define strv_parse_nulstr_full_one(s, n, e0, e1)                        \
         ({                                                              \
-                _cleanup_strv_free_ char **v0 = NULL, **v1 = NULL;      \
+                _cleanup_sd_strv_free_ char **v0 = NULL, **v1 = NULL;      \
                                                                         \
                 assert_se(v0 = strv_parse_nulstr_full(s, n, false));    \
                 assert_se(strv_equal(v0, e0));                          \
@@ -83,7 +83,7 @@ TEST(strv_parse_nulstr_full) {
 
 static void test_strv_make_nulstr_one(char **l) {
         _cleanup_free_ char *b = NULL, *c = NULL;
-        _cleanup_strv_free_ char **q = NULL;
+        _cleanup_sd_strv_free_ char **q = NULL;
         size_t n, m;
         unsigned i = 0;
 
@@ -98,7 +98,7 @@ static void test_strv_make_nulstr_one(ch
 
         NULSTR_FOREACH(s, b)
                 ASSERT_STREQ(s, l[i++]);
-        assert_se(i == strv_length(l));
+        assert_se(i == sd_strv_length(l));
 }
 
 TEST(strv_make_nulstr) {
@@ -154,7 +154,7 @@ TEST(set_make_nulstr) {
 }
 
 static void test_strv_make_nulstr_binary_one(char **l, const char *b, size_t n) {
-        _cleanup_strv_free_ char **z = NULL;
+        _cleanup_sd_strv_free_ char **z = NULL;
         _cleanup_free_ char *a = NULL;
         size_t m;
 
diff '--color=auto' -Nurp a/src/test/test-os-util.c b/src/test/test-os-util.c
--- a/src/test/test-os-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-os-util.c	2025-06-30 18:33:48.000000000 +0000
@@ -113,7 +113,7 @@ TEST(load_os_release_pairs) {
 
         ASSERT_EQ(setenv("SYSTEMD_OS_RELEASE", tmpfile, 1), 0);
 
-        _cleanup_strv_free_ char **pairs = NULL;
+        _cleanup_sd_strv_free_ char **pairs = NULL;
         ASSERT_EQ(load_os_release_pairs(NULL, &pairs), 0);
         assert_se(strv_equal(pairs, STRV_MAKE("ID", "the-id",
                                               "NAME", "the-name")));
diff '--color=auto' -Nurp a/src/test/test-path-lookup.c b/src/test/test-path-lookup.c
--- a/src/test/test-path-lookup.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-path-lookup.c	2025-06-30 18:37:25.000000000 +0000
@@ -21,13 +21,13 @@ static void test_paths_one(RuntimeScope
 
         assert_se(unsetenv("SYSTEMD_UNIT_PATH") == 0);
         assert_se(lookup_paths_init(&lp_without_env, scope, 0, NULL) >= 0);
-        assert_se(!strv_isempty(lp_without_env.search_path));
+        assert_se(!sd_strv_isempty(lp_without_env.search_path));
         lookup_paths_log(&lp_without_env);
 
         systemd_unit_path = strjoina(tmp, "/systemd-unit-path");
         assert_se(setenv("SYSTEMD_UNIT_PATH", systemd_unit_path, 1) == 0);
         assert_se(lookup_paths_init(&lp_with_env, scope, 0, NULL) == 0);
-        assert_se(strv_length(lp_with_env.search_path) == 1);
+        assert_se(sd_strv_length(lp_with_env.search_path) == 1);
         ASSERT_STREQ(lp_with_env.search_path[0], systemd_unit_path);
         lookup_paths_log(&lp_with_env);
         assert_se(strv_equal(lp_with_env.search_path, STRV_MAKE(systemd_unit_path)));
@@ -72,10 +72,10 @@ TEST(user_and_global_paths) {
 
 static void test_generator_binary_paths_one(RuntimeScope scope) {
         _cleanup_(rm_rf_physical_and_freep) char *tmp = NULL;
-        _cleanup_strv_free_ char **gp_without_env = NULL;
-        _cleanup_strv_free_ char **env_gp_without_env = NULL;
-        _cleanup_strv_free_ char **gp_with_env = NULL;
-        _cleanup_strv_free_ char **env_gp_with_env = NULL;
+        _cleanup_sd_strv_free_ char **gp_without_env = NULL;
+        _cleanup_sd_strv_free_ char **env_gp_without_env = NULL;
+        _cleanup_sd_strv_free_ char **gp_with_env = NULL;
+        _cleanup_sd_strv_free_ char **env_gp_with_env = NULL;
         char *systemd_generator_path = NULL;
         char *systemd_env_generator_path = NULL;
 
@@ -95,8 +95,8 @@ static void test_generator_binary_paths_
         STRV_FOREACH(dir, env_gp_without_env)
                 log_info("        %s", *dir);
 
-        assert_se(!strv_isempty(gp_without_env));
-        assert_se(!strv_isempty(env_gp_without_env));
+        assert_se(!sd_strv_isempty(gp_without_env));
+        assert_se(!sd_strv_isempty(env_gp_without_env));
 
         systemd_generator_path = strjoina(tmp, "/systemd-generator-path");
         systemd_env_generator_path = strjoina(tmp, "/systemd-environment-generator-path");
diff '--color=auto' -Nurp a/src/test/test-path-util.c b/src/test/test-path-util.c
--- a/src/test/test-path-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-path-util.c	2025-06-30 18:37:25.000000000 +0000
@@ -684,17 +684,17 @@ TEST(path_make_relative_parent) {
 
 TEST(path_strv_resolve) {
         char tmp_dir[] = "/tmp/test-path-util-XXXXXX";
-        _cleanup_strv_free_ char **search_dirs = NULL;
-        _cleanup_strv_free_ char **absolute_dirs = NULL;
+        _cleanup_sd_strv_free_ char **search_dirs = NULL;
+        _cleanup_sd_strv_free_ char **absolute_dirs = NULL;
 
         ASSERT_NOT_NULL(mkdtemp(tmp_dir));
 
-        search_dirs = strv_new("/dir1", "/dir2", "/dir3");
+        search_dirs = sd_strv_new("/dir1", "/dir2", "/dir3");
         assert_se(search_dirs);
         STRV_FOREACH(d, search_dirs) {
                 char *p = path_join(tmp_dir, *d);
                 assert_se(p);
-                assert_se(strv_push(&absolute_dirs, p) == 0);
+                assert_se(sd_strv_push(&absolute_dirs, p) == 0);
         }
 
         assert_se(mkdir(absolute_dirs[0], 0700) == 0);
@@ -830,7 +830,7 @@ static void test_path_find_first_compone
                                 assert_se(!e);
                         }
                         assert_se(r == ret);
-                        assert_se(strv_isempty(expected));
+                        assert_se(sd_strv_isempty(expected));
                         return;
                 }
 
@@ -918,7 +918,7 @@ static void test_path_find_last_componen
                                 assert_se(!e);
                         }
                         assert_se(r == ret);
-                        assert_se(strv_isempty(expected));
+                        assert_se(sd_strv_isempty(expected));
                         return;
                 }
 
diff '--color=auto' -Nurp a/src/test/test-proc-cmdline.c b/src/test/test-proc-cmdline.c
--- a/src/test/test-proc-cmdline.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-proc-cmdline.c	2025-06-30 18:33:48.000000000 +0000
@@ -30,7 +30,7 @@ TEST(proc_cmdline_parse) {
 
 TEST(proc_cmdline_override) {
         _cleanup_free_ char *line = NULL, *value = NULL;
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
 
         assert_se(putenv((char*) "SYSTEMD_PROC_CMDLINE=foo_bar=quux wuff-piep=tuet zumm some_arg_with_space='foo bar' and_one_more=\"zzz aaa\"") == 0);
         assert_se(putenv((char*) "SYSTEMD_EFI_OPTIONS=different") == 0);
@@ -41,7 +41,7 @@ TEST(proc_cmdline_override) {
         line = mfree(line);
         assert_se(proc_cmdline_strv(&args) >= 0);
         assert_se(strv_equal(args, STRV_MAKE("foo_bar=quux", "wuff-piep=tuet", "zumm", "some_arg_with_space=foo bar", "and_one_more=zzz aaa")));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
         /* Test if parsing makes uses of the override */
         assert_se(proc_cmdline_get_key("foo_bar", 0, &value) > 0 && streq_ptr(value, "quux"));
@@ -61,7 +61,7 @@ TEST(proc_cmdline_override) {
         line = mfree(line);
         assert_se(proc_cmdline_strv(&args) >= 0);
         assert_se(strv_equal(args, STRV_MAKE("hoge")));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
 #if ENABLE_EFI
         assert_se(proc_cmdline_get_key("foo_bar", 0, &value) > 0 && streq_ptr(value, "quux"));
@@ -271,7 +271,7 @@ TEST(proc_cmdline_key_startswith) {
 
 #define test_proc_cmdline_filter_pid1_args_one(nulstr, expected)        \
         ({                                                              \
-                _cleanup_strv_free_ char **a = NULL, **b = NULL;        \
+                _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;        \
                 const char s[] = (nulstr);                              \
                                                                         \
                 /* This emulates pid_get_cmdline_strv(). */         \
diff '--color=auto' -Nurp a/src/test/test-process-util.c b/src/test/test-process-util.c
--- a/src/test/test-process-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-process-util.c	2025-06-30 18:37:55.000000000 +0000
@@ -113,7 +113,7 @@ TEST(pid_get_comm) {
 
 static void test_pid_get_cmdline_one(pid_t pid) {
         _cleanup_free_ char *c = NULL, *d = NULL, *e = NULL, *f = NULL, *g = NULL, *h = NULL, *joined = NULL;
-        _cleanup_strv_free_ char **strv_a = NULL, **strv_b = NULL;
+        _cleanup_sd_strv_free_ char **strv_a = NULL, **strv_b = NULL;
         int r;
 
         r = pid_get_cmdline(pid, SIZE_MAX, 0, &c);
@@ -136,14 +136,14 @@ static void test_pid_get_cmdline_one(pid
 
         r = pid_get_cmdline_strv(pid, 0, &strv_a);
         if (r >= 0)
-                assert_se(joined = strv_join(strv_a, "\", \""));
+                assert_se(joined = sd_strv_join(strv_a, "\", \""));
         log_info("      \"%s\"", r >= 0 ? joined : errno_to_name(r));
 
         joined = mfree(joined);
 
         r = pid_get_cmdline_strv(pid, PROCESS_CMDLINE_COMM_FALLBACK, &strv_b);
         if (r >= 0)
-                assert_se(joined = strv_join(strv_b, "\", \""));
+                assert_se(joined = sd_strv_join(strv_b, "\", \""));
         log_info("      \"%s\"", r >= 0 ? joined : errno_to_name(r));
 }
 
@@ -258,7 +258,7 @@ TEST(pid_get_cmdline_harder) {
         char path[] = "/tmp/test-cmdlineXXXXXX";
         _cleanup_close_ int fd = -EBADF;
         _cleanup_free_ char *line = NULL;
-        _cleanup_strv_free_ char **args = NULL;
+        _cleanup_sd_strv_free_ char **args = NULL;
         pid_t pid;
         int r;
 
@@ -375,7 +375,7 @@ TEST(pid_get_cmdline_harder) {
 
         assert_se(pid_get_cmdline_strv(0, PROCESS_CMDLINE_COMM_FALLBACK, &args) >= 0);
         assert_se(strv_equal(args, STRV_MAKE("[testa]")));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
         /* Test with multiple arguments that don't require quoting */
 
@@ -392,7 +392,7 @@ TEST(pid_get_cmdline_harder) {
 
         assert_se(pid_get_cmdline_strv(0, PROCESS_CMDLINE_COMM_FALLBACK, &args) >= 0);
         assert_se(strv_equal(args, STRV_MAKE("foo", "bar")));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
         assert_se(write(fd, "quux", 4) == 4);
         assert_se(pid_get_cmdline(0, SIZE_MAX, 0, &line) >= 0);
@@ -482,7 +482,7 @@ TEST(pid_get_cmdline_harder) {
 
         assert_se(pid_get_cmdline_strv(0, PROCESS_CMDLINE_COMM_FALLBACK, &args) >= 0);
         assert_se(strv_equal(args, STRV_MAKE("foo", "bar", "quux")));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
         assert_se(ftruncate(fd, 0) >= 0);
         assert_se(prctl(PR_SET_NAME, "aaaa bbbb cccc") >= 0);
@@ -511,7 +511,7 @@ TEST(pid_get_cmdline_harder) {
 
         assert_se(pid_get_cmdline_strv(0, PROCESS_CMDLINE_COMM_FALLBACK, &args) >= 0);
         assert_se(strv_equal(args, STRV_MAKE("[aaaa bbbb cccc]")));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
         /* Test with multiple arguments that do require quoting */
 
@@ -538,7 +538,7 @@ TEST(pid_get_cmdline_harder) {
 
         assert_se(pid_get_cmdline_strv(0, 0, &args) >= 0);
         assert_se(strv_equal(args, EXPECT1v));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
 #define CMDLINE2 "foo\0\1\2\3\0\0"
 #define EXPECT2  "foo \"\\001\\002\\003\""
@@ -563,7 +563,7 @@ TEST(pid_get_cmdline_harder) {
 
         assert_se(pid_get_cmdline_strv(0, 0, &args) >= 0);
         assert_se(strv_equal(args, EXPECT2v));
-        args = strv_free(args);
+        args = sd_strv_free(args);
 
         safe_close(fd);
         _exit(EXIT_SUCCESS);
diff '--color=auto' -Nurp a/src/test/test-recurse-dir.c b/src/test/test-recurse-dir.c
--- a/src/test/test-recurse-dir.c	2025-06-30 18:55:45.147159939 +0000
+++ b/src/test/test-recurse-dir.c	2025-06-30 18:36:07.000000000 +0000
@@ -25,7 +25,7 @@ static int nftw_cb(
 
         case FTW_F:
                 log_debug("ftw found %s", fpath);
-                assert_se(strv_extend(&list_nftw, fpath) >= 0);
+                assert_se(sd_strv_extend(&list_nftw, fpath) >= 0);
                 break;
 
         case FTW_SL:
@@ -34,7 +34,7 @@ static int nftw_cb(
 
         case FTW_D:
                 log_debug("ftw entering %s", fpath);
-                assert_se(strv_extendf(&list_nftw, "%s/", fpath) >= 0);
+                assert_se(sd_sd_strv_extendf(&list_nftw, "%s/", fpath) >= 0);
                 break;
 
         case FTW_DNR:
@@ -77,14 +77,14 @@ static int recurse_dir_callback(
                           de->d_type == DT_LNK ? ", ignoring." : "");
 
                 if (de->d_type != DT_LNK)
-                        assert_se(strv_extend(l, path) >= 0);
+                        assert_se(sd_strv_extend(l, path) >= 0);
                 break;
 
         case RECURSE_DIR_ENTER:
                 assert_se(de->d_type == DT_DIR);
 
                 log_debug("entering %s", path);
-                assert_se(strv_extendf(l, "%s/", path) >= 0);
+                assert_se(sd_sd_strv_extendf(l, "%s/", path) >= 0);
                 break;
 
         case RECURSE_DIR_LEAVE:
@@ -119,7 +119,7 @@ static int recurse_dir_callback(
 }
 
 int main(int argc, char *argv[]) {
-        _cleanup_strv_free_ char **list_recurse_dir = NULL;
+        _cleanup_sd_strv_free_ char **list_recurse_dir = NULL;
         const char *p;
         usec_t t1, t2, t3, t4;
         _cleanup_close_ int fd = -EBADF;
@@ -173,6 +173,6 @@ int main(int argc, char *argv[]) {
                         break;
         }
 
-        list_nftw = strv_free(list_nftw);
+        list_nftw = sd_strv_free(list_nftw);
         return 0;
 }
diff '--color=auto' -Nurp a/src/test/test-sd-path.c b/src/test/test-sd-path.c
--- a/src/test/test-sd-path.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-sd-path.c	2025-06-30 18:33:48.000000000 +0000
@@ -31,7 +31,7 @@ TEST(sd_path_lookup) {
 
 TEST(sd_path_lookup_strv) {
         for (uint64_t i = 0; i < _SD_PATH_MAX; i++) {
-                _cleanup_strv_free_ char **t = NULL, **s = NULL;
+                _cleanup_sd_strv_free_ char **t = NULL, **s = NULL;
                 int r;
 
                 r = sd_path_lookup_strv(i, NULL, &t);
diff '--color=auto' -Nurp a/src/test/test-secure-bits.c b/src/test/test-secure-bits.c
--- a/src/test/test-secure-bits.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-secure-bits.c	2025-06-30 18:37:55.000000000 +0000
@@ -35,7 +35,7 @@ TEST(secure_bits_basic) {
         }
 
         /* Ditto, but with all bits at once */
-        joined = strv_join((char**)string_bits, " ");
+        joined = sd_strv_join((char**)string_bits, " ");
         assert_se(joined);
         r = secure_bits_from_string(joined);
         assert_se(r > 0);
diff '--color=auto' -Nurp a/src/test/test-serialize.c b/src/test/test-serialize.c
--- a/src/test/test-serialize.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-serialize.c	2025-06-30 18:37:06.000000000 +0000
@@ -116,7 +116,7 @@ TEST(serialize_strv) {
 
         rewind(f);
 
-        _cleanup_strv_free_ char **strv2 = NULL;
+        _cleanup_sd_strv_free_ char **strv2 = NULL;
         for (;;) {
                 _cleanup_free_ char *line = NULL;
                 int r;
@@ -135,9 +135,9 @@ TEST(serialize_strv) {
 }
 
 TEST(deserialize_environment) {
-        _cleanup_strv_free_ char **env;
+        _cleanup_sd_strv_free_ char **env;
 
-        assert_se(env = strv_new("A=1"));
+        assert_se(env = sd_strv_new("A=1"));
 
         assert_se(deserialize_environment("B=2", &env) >= 0);
         assert_se(deserialize_environment("FOO%%=a\\177b\\nc\\td e", &env) >= 0);
@@ -149,7 +149,7 @@ TEST(deserialize_environment) {
 }
 
 TEST(serialize_environment) {
-        _cleanup_strv_free_ char **env = NULL, **env2 = NULL;
+        _cleanup_sd_strv_free_ char **env = NULL, **env2 = NULL;
         _cleanup_(unlink_tempfilep) char fn[] = "/tmp/test-env-util.XXXXXXX";
         _cleanup_fclose_ FILE *f = NULL;
         int r;
@@ -157,7 +157,7 @@ TEST(serialize_environment) {
         assert_se(fmkostemp_safe(fn, "r+", &f) == 0);
         log_info("/* %s (%s) */", __func__, fn);
 
-        assert_se(env = strv_new("A=1",
+        assert_se(env = sd_strv_new("A=1",
                                  "B=2",
                                  "C=ƒÖƒô√≥≈Ç≈Ñ",
                                  "D=D=a\\x0Ab",
diff '--color=auto' -Nurp a/src/test/test-set.c b/src/test/test-set.c
--- a/src/test/test-set.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-set.c	2025-06-30 18:35:00.000000000 +0000
@@ -83,7 +83,7 @@ TEST(set_put) {
         assert_se(strv_contains(t, "1"));
         assert_se(strv_contains(t, "22"));
         assert_se(strv_contains(t, "333"));
-        assert_se(strv_length(t) == 3);
+        assert_se(sd_strv_length(t) == 3);
 }
 
 TEST(set_put_strndup) {
diff '--color=auto' -Nurp a/src/test/test-sleep-config.c b/src/test/test-sleep-config.c
--- a/src/test/test-sleep-config.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-sleep-config.c	2025-06-30 18:37:55.000000000 +0000
@@ -16,12 +16,12 @@ TEST(parse_sleep_config) {
 
         _cleanup_free_ char *sum = NULL, *sus = NULL, *him = NULL, *his = NULL, *hym = NULL, *hys = NULL;
 
-        sum = strv_join(sleep_config->modes[SLEEP_SUSPEND], ", ");
-        sus = strv_join(sleep_config->states[SLEEP_SUSPEND], ", ");
-        him = strv_join(sleep_config->modes[SLEEP_HIBERNATE], ", ");
-        his = strv_join(sleep_config->states[SLEEP_HIBERNATE], ", ");
-        hym = strv_join(sleep_config->modes[SLEEP_HYBRID_SLEEP], ", ");
-        hys = strv_join(sleep_config->states[SLEEP_HYBRID_SLEEP], ", ");
+        sum = sd_strv_join(sleep_config->modes[SLEEP_SUSPEND], ", ");
+        sus = sd_strv_join(sleep_config->states[SLEEP_SUSPEND], ", ");
+        him = sd_strv_join(sleep_config->modes[SLEEP_HIBERNATE], ", ");
+        his = sd_strv_join(sleep_config->states[SLEEP_HIBERNATE], ", ");
+        hym = sd_strv_join(sleep_config->modes[SLEEP_HYBRID_SLEEP], ", ");
+        hys = sd_strv_join(sleep_config->states[SLEEP_HYBRID_SLEEP], ", ");
         log_debug("  allow_suspend: %s", yes_no(sleep_config->allow[SLEEP_SUSPEND]));
         log_debug("  allow_hibernate: %s", yes_no(sleep_config->allow[SLEEP_HIBERNATE]));
         log_debug("  allow_s2h: %s", yes_no(sleep_config->allow[SLEEP_SUSPEND_THEN_HIBERNATE]));
@@ -35,15 +35,15 @@ TEST(parse_sleep_config) {
 }
 
 TEST(sleep_supported) {
-        _cleanup_strv_free_ char
-                **standby = strv_new("standby"),
-                **mem = strv_new("mem"),
-                **disk = strv_new("disk"),
-                **suspend = strv_new("suspend"),
-                **reboot = strv_new("reboot"),
-                **platform = strv_new("platform"),
-                **shutdown = strv_new("shutdown"),
-                **freeze = strv_new("freeze");
+        _cleanup_sd_strv_free_ char
+                **standby = sd_strv_new("standby"),
+                **mem = sd_strv_new("mem"),
+                **disk = sd_strv_new("disk"),
+                **suspend = sd_strv_new("suspend"),
+                **reboot = sd_strv_new("reboot"),
+                **platform = sd_strv_new("platform"),
+                **shutdown = sd_strv_new("shutdown"),
+                **freeze = sd_strv_new("freeze");
         int r;
 
         printf("Secure boot: %sd\n", enable_disable(is_efi_secure_boot()));
diff '--color=auto' -Nurp a/src/test/test-specifier.c b/src/test/test-specifier.c
--- a/src/test/test-specifier.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-specifier.c	2025-06-30 18:33:48.000000000 +0000
@@ -29,7 +29,7 @@ TEST(specifier_escape) {
 }
 
 static void test_specifier_escape_strv_one(char **a, char **b) {
-        _cleanup_strv_free_ char **x = NULL;
+        _cleanup_sd_strv_free_ char **x = NULL;
 
         assert_se(specifier_escape_strv(a, &x) >= 0);
         assert_se(strv_equal(x, b));
diff '--color=auto' -Nurp a/src/test/test-static-destruct.c b/src/test/test-static-destruct.c
--- a/src/test/test-static-destruct.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-static-destruct.c	2025-06-30 18:37:06.000000000 +0000
@@ -22,7 +22,7 @@ static void test_strings_destroy(char **
         assert_se(n == 3);
         assert_se(strv_equal(array, STRV_MAKE("a", "bbb", "ccc")));
 
-        strv_free(array);
+        sd_strv_free(array);
 }
 
 static void test_integers_destroy(int *array, size_t n) {
@@ -47,8 +47,8 @@ STATIC_ARRAY_DESTRUCTOR_REGISTER(integer
 TEST(static_destruct) {
         assert_se(foo == 0 && bar == 0 && baz == 0);
         assert_se(memory = strdup("hallo"));
-        assert_se(strings = strv_new("a", "bbb", "ccc"));
-        n_strings = strv_length(strings);
+        assert_se(strings = sd_strv_new("a", "bbb", "ccc"));
+        n_strings = sd_strv_length(strings);
         n_integers = 10;
         assert_se(integers = new(int, n_integers));
         for (size_t i = 0; i < n_integers; i++)
diff '--color=auto' -Nurp a/src/test/test-strbuf.c b/src/test/test-strbuf.c
--- a/src/test/test-strbuf.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-strbuf.c	2025-06-30 18:33:48.000000000 +0000
@@ -14,7 +14,7 @@ static ssize_t add_string(struct strbuf
 
 TEST(strbuf) {
         _cleanup_(strbuf_freep) struct strbuf *sb = NULL;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         ssize_t a, b, c, d, e, f, g, h;
 
         sb = strbuf_new();
diff '--color=auto' -Nurp a/src/test/test-strv.c b/src/test/test-strv.c
--- a/src/test/test-strv.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-strv.c	2025-06-30 18:38:15.000000000 +0000
@@ -122,95 +122,95 @@ TEST(strv_find_startswith) {
         assert_se(!strv_find_startswith((char **)input_table_multiple, "onee"));
 }
 
-TEST(strv_join) {
-        _cleanup_free_ char *p = strv_join((char **)input_table_multiple, ", ");
+TEST(sd_strv_join) {
+        _cleanup_free_ char *p = sd_strv_join((char **)input_table_multiple, ", ");
         assert_se(p);
         ASSERT_STREQ(p, "one, two, three");
 
-        _cleanup_free_ char *q = strv_join((char **)input_table_multiple, ";");
+        _cleanup_free_ char *q = sd_strv_join((char **)input_table_multiple, ";");
         assert_se(q);
         ASSERT_STREQ(q, "one;two;three");
 
-        _cleanup_free_ char *r = strv_join((char **)input_table_multiple, NULL);
+        _cleanup_free_ char *r = sd_strv_join((char **)input_table_multiple, NULL);
         assert_se(r);
         ASSERT_STREQ(r, "one two three");
 
-        _cleanup_free_ char *s = strv_join(STRV_MAKE("1", "2", "3,3"), ",");
+        _cleanup_free_ char *s = sd_strv_join(STRV_MAKE("1", "2", "3,3"), ",");
         assert_se(s);
         ASSERT_STREQ(s, "1,2,3,3");
 
-        _cleanup_free_ char *t = strv_join((char **)input_table_one, ", ");
+        _cleanup_free_ char *t = sd_strv_join((char **)input_table_one, ", ");
         assert_se(t);
         ASSERT_STREQ(t, "one");
 
-        _cleanup_free_ char *u = strv_join((char **)input_table_none, ", ");
+        _cleanup_free_ char *u = sd_strv_join((char **)input_table_none, ", ");
         assert_se(u);
         ASSERT_STREQ(u, "");
 
-        _cleanup_free_ char *v = strv_join((char **)input_table_two_empties, ", ");
+        _cleanup_free_ char *v = sd_strv_join((char **)input_table_two_empties, ", ");
         assert_se(v);
         ASSERT_STREQ(v, ", ");
 
-        _cleanup_free_ char *w = strv_join((char **)input_table_one_empty, ", ");
+        _cleanup_free_ char *w = sd_strv_join((char **)input_table_one_empty, ", ");
         assert_se(w);
         ASSERT_STREQ(w, "");
 }
 
-TEST(strv_join_full) {
-        _cleanup_free_ char *p = strv_join_full((char **)input_table_multiple, ", ", "foo", false);
+TEST(sd_strv_join_full) {
+        _cleanup_free_ char *p = sd_strv_join_full((char **)input_table_multiple, ", ", "foo", false);
         assert_se(p);
         ASSERT_STREQ(p, "fooone, footwo, foothree");
 
-        _cleanup_free_ char *q = strv_join_full((char **)input_table_multiple, ";", "foo", false);
+        _cleanup_free_ char *q = sd_strv_join_full((char **)input_table_multiple, ";", "foo", false);
         assert_se(q);
         ASSERT_STREQ(q, "fooone;footwo;foothree");
 
-        _cleanup_free_ char *r = strv_join_full(STRV_MAKE("a", "a;b", "a:c"), ";", NULL, true);
+        _cleanup_free_ char *r = sd_strv_join_full(STRV_MAKE("a", "a;b", "a:c"), ";", NULL, true);
         assert_se(r);
         ASSERT_STREQ(r, "a;a\\;b;a:c");
 
-        _cleanup_free_ char *s = strv_join_full(STRV_MAKE("a", "a;b", "a;;c", ";", ";x"), ";", NULL, true);
+        _cleanup_free_ char *s = sd_strv_join_full(STRV_MAKE("a", "a;b", "a;;c", ";", ";x"), ";", NULL, true);
         assert_se(s);
         ASSERT_STREQ(s, "a;a\\;b;a\\;\\;c;\\;;\\;x");
 
-        _cleanup_free_ char *t = strv_join_full(STRV_MAKE("a", "a;b", "a:c", ";"), ";", "=", true);
+        _cleanup_free_ char *t = sd_strv_join_full(STRV_MAKE("a", "a;b", "a:c", ";"), ";", "=", true);
         assert_se(t);
         ASSERT_STREQ(t, "=a;=a\\;b;=a:c;=\\;");
         t = mfree(t);
 
-        _cleanup_free_ char *u = strv_join_full((char **)input_table_multiple, NULL, "foo", false);
+        _cleanup_free_ char *u = sd_strv_join_full((char **)input_table_multiple, NULL, "foo", false);
         assert_se(u);
         ASSERT_STREQ(u, "fooone footwo foothree");
 
-        _cleanup_free_ char *v = strv_join_full((char **)input_table_one, ", ", "foo", false);
+        _cleanup_free_ char *v = sd_strv_join_full((char **)input_table_one, ", ", "foo", false);
         assert_se(v);
         ASSERT_STREQ(v, "fooone");
 
-        _cleanup_free_ char *w = strv_join_full((char **)input_table_none, ", ", "foo", false);
+        _cleanup_free_ char *w = sd_strv_join_full((char **)input_table_none, ", ", "foo", false);
         assert_se(w);
         ASSERT_STREQ(w, "");
 
-        _cleanup_free_ char *x = strv_join_full((char **)input_table_two_empties, ", ", "foo", false);
+        _cleanup_free_ char *x = sd_strv_join_full((char **)input_table_two_empties, ", ", "foo", false);
         assert_se(x);
         ASSERT_STREQ(x, "foo, foo");
 
-        _cleanup_free_ char *y = strv_join_full((char **)input_table_one_empty, ", ", "foo", false);
+        _cleanup_free_ char *y = sd_strv_join_full((char **)input_table_one_empty, ", ", "foo", false);
         assert_se(y);
         ASSERT_STREQ(y, "foo");
 }
 
 static void test_strv_unquote_one(const char *quoted, char **list) {
-        _cleanup_strv_free_ char **s = NULL;
+        _cleanup_sd_strv_free_ char **s = NULL;
         _cleanup_free_ char *j = NULL;
         unsigned i = 0;
         int r;
 
         log_info("/* %s */", __func__);
 
-        r = strv_split_full(&s, quoted, WHITESPACE, EXTRACT_UNQUOTE);
-        assert_se(r == (int) strv_length(list));
+        r = sd_strv_split_full(&s, quoted, WHITESPACE, EXTRACT_UNQUOTE);
+        assert_se(r == (int) sd_strv_length(list));
         assert_se(s);
-        j = strv_join(s, " | ");
+        j = sd_strv_join(s, " | ");
         assert_se(j);
         puts(j);
 
@@ -244,7 +244,7 @@ static void test_invalid_unquote_one(con
 
         log_info("/* %s */", __func__);
 
-        r = strv_split_full(&s, quoted, WHITESPACE, EXTRACT_UNQUOTE);
+        r = sd_strv_split_full(&s, quoted, WHITESPACE, EXTRACT_UNQUOTE);
         ASSERT_NULL(s);
         assert_se(r == -EINVAL);
 }
@@ -259,149 +259,149 @@ TEST(invalid_unquote) {
         test_invalid_unquote_one("'x'y'g");
 }
 
-TEST(strv_split) {
-        _cleanup_strv_free_erase_ char **l = NULL;
+TEST(sd_strv_split) {
+        _cleanup_sd_strv_free_erase_ char **l = NULL;
         const char str[] = "one,two,three";
 
-        l = strv_split(str, ",");
+        l = sd_strv_split(str, ",");
         assert_se(l);
         assert_se(strv_equal(l, (char**) input_table_multiple));
 
-        strv_free_erase(l);
+        sd_strv_free_erase(l);
 
-        l = strv_split("    one    two\t three", WHITESPACE);
+        l = sd_strv_split("    one    two\t three", WHITESPACE);
         assert_se(l);
         assert_se(strv_equal(l, (char**) input_table_multiple));
 
-        strv_free_erase(l);
+        sd_strv_free_erase(l);
 
         /* Setting NULL for separator is equivalent to WHITESPACE */
-        l = strv_split("    one    two\t three", NULL);
+        l = sd_strv_split("    one    two\t three", NULL);
         assert_se(l);
         assert_se(strv_equal(l, (char**) input_table_multiple));
 
-        strv_free_erase(l);
+        sd_strv_free_erase(l);
 
-        assert_se(strv_split_full(&l, "    one    two\t three", NULL, 0) == 3);
+        assert_se(sd_strv_split_full(&l, "    one    two\t three", NULL, 0) == 3);
         assert_se(strv_equal(l, (char**) input_table_multiple));
 
-        strv_free_erase(l);
+        sd_strv_free_erase(l);
 
-        assert_se(strv_split_full(&l, "    'one'  \"  two\t three \" ' four  five'", NULL, EXTRACT_UNQUOTE) == 3);
+        assert_se(sd_strv_split_full(&l, "    'one'  \"  two\t three \" ' four  five'", NULL, EXTRACT_UNQUOTE) == 3);
         assert_se(strv_equal(l, (char**) input_table_quoted));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
         /* missing last quote causes extraction to fail. */
-        assert_se(strv_split_full(&l, "    'one'  \"  two\t three \" ' four  five", NULL, EXTRACT_UNQUOTE) == -EINVAL);
+        assert_se(sd_strv_split_full(&l, "    'one'  \"  two\t three \" ' four  five", NULL, EXTRACT_UNQUOTE) == -EINVAL);
         assert_se(!l);
 
         /* missing last quote, but the last element is _not_ ignored with EXTRACT_RELAX. */
-        assert_se(strv_split_full(&l, "    'one'  \"  two\t three \" ' four  five", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 3);
+        assert_se(sd_strv_split_full(&l, "    'one'  \"  two\t three \" ' four  five", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 3);
         assert_se(strv_equal(l, (char**) input_table_quoted));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
         /* missing separator between items */
-        assert_se(strv_split_full(&l, "    'one'  \"  two\t three \"' four  five'", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 2);
+        assert_se(sd_strv_split_full(&l, "    'one'  \"  two\t three \"' four  five'", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 2);
         assert_se(strv_equal(l, (char**) input_table_quoted_joined));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
-        assert_se(strv_split_full(&l, "    'one'  \"  two\t three \"' four  five", NULL,
+        assert_se(sd_strv_split_full(&l, "    'one'  \"  two\t three \"' four  five", NULL,
                                      EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_UNESCAPE_RELAX) == 2);
         assert_se(strv_equal(l, (char**) input_table_quoted_joined));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
-        assert_se(strv_split_full(&l, "\\", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_UNESCAPE_RELAX) == 1);
+        assert_se(sd_strv_split_full(&l, "\\", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_UNESCAPE_RELAX) == 1);
         assert_se(strv_equal(l, STRV_MAKE("\\")));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
-        assert_se(l = strv_split("\\", NULL));
+        assert_se(l = sd_strv_split("\\", NULL));
         assert_se(strv_equal(l, STRV_MAKE("\\")));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
-        assert_se(l = strv_split("aa\\ bb\\", NULL));
+        assert_se(l = sd_strv_split("aa\\ bb\\", NULL));
         assert_se(strv_equal(l, STRV_MAKE("aa\\", "bb\\")));
 
-        l = strv_free_erase(l);
+        l = sd_strv_free_erase(l);
 
-        assert_se(l = strv_split("aa\" bb'", NULL));
+        assert_se(l = sd_strv_split("aa\" bb'", NULL));
         assert_se(strv_equal(l, STRV_MAKE("aa\"", "bb'")));
 }
 
-TEST(strv_split_empty) {
-        _cleanup_strv_free_ char **l = NULL;
+TEST(sd_strv_split_empty) {
+        _cleanup_sd_strv_free_ char **l = NULL;
 
-        l = strv_split("", WHITESPACE);
+        l = sd_strv_split("", WHITESPACE);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(l = strv_split("", NULL));
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(l = sd_strv_split("", NULL));
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "", NULL, 0) == 0);
+        assert_se(sd_strv_split_full(&l, "", NULL, 0) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "", NULL, EXTRACT_UNQUOTE) == 0);
+        assert_se(sd_strv_split_full(&l, "", NULL, EXTRACT_UNQUOTE) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "", WHITESPACE, EXTRACT_UNQUOTE) == 0);
+        assert_se(sd_strv_split_full(&l, "", WHITESPACE, EXTRACT_UNQUOTE) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "", WHITESPACE, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 0);
+        assert_se(sd_strv_split_full(&l, "", WHITESPACE, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        sd_strv_free(l);
 
-        l = strv_split("    ", WHITESPACE);
+        l = sd_strv_split("    ", WHITESPACE);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        sd_strv_free(l);
 
-        l = strv_split("    ", NULL);
+        l = sd_strv_split("    ", NULL);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "    ", NULL, 0) == 0);
+        assert_se(sd_strv_split_full(&l, "    ", NULL, 0) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "    ", WHITESPACE, EXTRACT_UNQUOTE) == 0);
+        assert_se(sd_strv_split_full(&l, "    ", WHITESPACE, EXTRACT_UNQUOTE) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "    ", NULL, EXTRACT_UNQUOTE) == 0);
+        assert_se(sd_strv_split_full(&l, "    ", NULL, EXTRACT_UNQUOTE) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
-        l = strv_free(l);
+        assert_se(sd_strv_isempty(l));
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_full(&l, "    ", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 0);
+        assert_se(sd_strv_split_full(&l, "    ", NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX) == 0);
         assert_se(l);
-        assert_se(strv_isempty(l));
+        assert_se(sd_strv_isempty(l));
 }
 
-TEST(strv_split_full) {
-        _cleanup_strv_free_ char **l = NULL;
+TEST(sd_strv_split_full) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *str = ":foo\\:bar::waldo:";
         int r;
 
-        r = strv_split_full(&l, str, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
-        assert_se(r == (int) strv_length(l));
+        r = sd_strv_split_full(&l, str, ":", EXTRACT_DONT_COALESCE_SEPARATORS);
+        assert_se(r == (int) sd_strv_length(l));
         ASSERT_STREQ(l[0], "");
         ASSERT_STREQ(l[1], "foo:bar");
         ASSERT_STREQ(l[2], "");
@@ -410,34 +410,34 @@ TEST(strv_split_full) {
         ASSERT_STREQ(l[5], NULL);
 }
 
-TEST(strv_split_and_extend_full) {
-        _cleanup_strv_free_ char **l = NULL;
+TEST(sd_strv_split_and_extend_full) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *str1 = ":foo\\:bar:";
         const char *str2 = "waldo::::::baz";
         int r;
 
-        r = strv_split_and_extend(&l, "", ":", false);
-        assert_se(r == (int) strv_length(l));
-        r = strv_split_and_extend_full(&l, str1, ":", false, EXTRACT_DONT_COALESCE_SEPARATORS);
-        assert_se(r == (int) strv_length(l));
+        r = sd_strv_split_and_extend(&l, "", ":", false);
+        assert_se(r == (int) sd_strv_length(l));
+        r = sd_strv_split_and_extend_full(&l, str1, ":", false, EXTRACT_DONT_COALESCE_SEPARATORS);
+        assert_se(r == (int) sd_strv_length(l));
         ASSERT_STREQ(l[0], "");
         ASSERT_STREQ(l[1], "foo:bar");
         ASSERT_STREQ(l[2], "");
-        r = strv_split_and_extend_full(&l, str2, ":", false, 0);
-        assert_se(r == (int) strv_length(l));
+        r = sd_strv_split_and_extend_full(&l, str2, ":", false, 0);
+        assert_se(r == (int) sd_strv_length(l));
         ASSERT_STREQ(l[3], "waldo");
         ASSERT_STREQ(l[4], "baz");
         ASSERT_STREQ(l[5], NULL);
 }
 
-TEST(strv_split_colon_pairs) {
-        _cleanup_strv_free_ char **l = NULL;
+TEST(sd_strv_split_colon_pairs) {
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char *str = "one:two three four:five six seven:eight\\:nine ten\\:eleven\\\\",
                    *str_inval="one:two three:four:five";
         int r;
 
-        r = strv_split_colon_pairs(&l, str);
-        assert_se(r == (int) strv_length(l));
+        r = sd_strv_split_colon_pairs(&l, str);
+        assert_se(r == (int) sd_strv_length(l));
         assert_se(r == 12);
         ASSERT_STREQ(l[0], "one");
         ASSERT_STREQ(l[1], "two");
@@ -453,36 +453,36 @@ TEST(strv_split_colon_pairs) {
         ASSERT_STREQ(l[11], "");
         ASSERT_STREQ(l[12], NULL);
 
-        r = strv_split_colon_pairs(&l, str_inval);
+        r = sd_strv_split_colon_pairs(&l, str_inval);
         assert_se(r == -EINVAL);
 }
 
-TEST(strv_split_newlines) {
+TEST(sd_strv_split_newlines) {
         unsigned i = 0;
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
         const char str[] = "one\ntwo\nthree";
 
-        l = strv_split_newlines(str);
+        l = sd_strv_split_newlines(str);
         assert_se(l);
 
         STRV_FOREACH(s, l)
                 ASSERT_STREQ(*s, input_table_multiple[i++]);
 }
 
-TEST(strv_split_newlines_full) {
+TEST(sd_strv_split_newlines_full) {
         const char str[] =
                 "ID_VENDOR=QEMU\n"
                 "ID_VENDOR_ENC=QEMU\\x20\\x20\\x20\\x20\n"
                 "ID_MODEL_ENC=QEMU\\x20HARDDISK\\x20\\x20\\x20\n"
                 "\n\n\n";
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
-        assert_se(strv_split_newlines_full(&l, str, 0) == 3);
+        assert_se(sd_strv_split_newlines_full(&l, str, 0) == 3);
         assert_se(strv_equal(l, (char**) input_table_unescape));
 
-        l = strv_free(l);
+        l = sd_strv_free(l);
 
-        assert_se(strv_split_newlines_full(&l, str, EXTRACT_RETAIN_ESCAPE) == 3);
+        assert_se(sd_strv_split_newlines_full(&l, str, EXTRACT_RETAIN_ESCAPE) == 3);
         assert_se(strv_equal(l, (char**) input_table_retain_escape));
 }
 
@@ -527,15 +527,15 @@ TEST(strv_sort) {
         ASSERT_STREQ(input_table[4], "durian");
 }
 
-TEST(strv_extend_strv_biconcat) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL;
+TEST(sd_sd_strv_extend_strv_biconcat) {
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;
 
-        a = strv_new("without", "suffix");
-        b = strv_new("with", "suffix");
+        a = sd_strv_new("without", "suffix");
+        b = sd_strv_new("with", "suffix");
         assert_se(a);
         assert_se(b);
 
-        assert_se(strv_extend_strv_biconcat(&a, "prefix_", (const char* const*) b, "_suffix") >= 0);
+        assert_se(sd_sd_strv_extend_strv_biconcat(&a, "prefix_", (const char* const*) b, "_suffix") >= 0);
 
         ASSERT_STREQ(a[0], "without");
         ASSERT_STREQ(a[1], "suffix");
@@ -543,15 +543,15 @@ TEST(strv_extend_strv_biconcat) {
         ASSERT_STREQ(a[3], "prefix_suffix_suffix");
 }
 
-TEST(strv_extend_strv_concat) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL;
+TEST(sd_sd_strv_extend_strv_concat) {
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;
 
-        a = strv_new("without", "suffix");
-        b = strv_new("with", "suffix");
+        a = sd_strv_new("without", "suffix");
+        b = sd_strv_new("with", "suffix");
         assert_se(a);
         assert_se(b);
 
-        assert_se(strv_extend_strv_concat(&a, (const char* const*) b, "_suffix") >= 0);
+        assert_se(sd_sd_strv_extend_strv_concat(&a, (const char* const*) b, "_suffix") >= 0);
 
         ASSERT_STREQ(a[0], "without");
         ASSERT_STREQ(a[1], "suffix");
@@ -559,15 +559,15 @@ TEST(strv_extend_strv_concat) {
         ASSERT_STREQ(a[3], "suffix_suffix");
 }
 
-TEST(strv_extend_strv) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL, **n = NULL;
+TEST(sd_sd_strv_extend_strv) {
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL, **n = NULL;
 
-        a = strv_new("abc", "def", "ghi");
-        b = strv_new("jkl", "mno", "abc", "pqr");
+        a = sd_strv_new("abc", "def", "ghi");
+        b = sd_strv_new("jkl", "mno", "abc", "pqr");
         assert_se(a);
         assert_se(b);
 
-        assert_se(strv_extend_strv(&a, b, true) == 3);
+        assert_se(sd_sd_strv_extend_strv(&a, b, true) == 3);
 
         ASSERT_STREQ(a[0], "abc");
         ASSERT_STREQ(a[1], "def");
@@ -575,26 +575,26 @@ TEST(strv_extend_strv) {
         ASSERT_STREQ(a[3], "jkl");
         ASSERT_STREQ(a[4], "mno");
         ASSERT_STREQ(a[5], "pqr");
-        assert_se(strv_length(a) == 6);
+        assert_se(sd_strv_length(a) == 6);
 
-        assert_se(strv_extend_strv(&n, b, false) >= 0);
+        assert_se(sd_sd_strv_extend_strv(&n, b, false) >= 0);
         ASSERT_STREQ(n[0], "jkl");
         ASSERT_STREQ(n[1], "mno");
         ASSERT_STREQ(n[2], "abc");
         ASSERT_STREQ(n[3], "pqr");
-        assert_se(strv_length(n) == 4);
+        assert_se(sd_strv_length(n) == 4);
 }
 
-TEST(strv_extend_with_size) {
-        _cleanup_strv_free_ char **a = NULL;
+TEST(sd_strv_extend_with_size) {
+        _cleanup_sd_strv_free_ char **a = NULL;
         size_t n = SIZE_MAX;
 
-        a = strv_new("test", "test1");
+        a = sd_strv_new("test", "test1");
         assert_se(a);
 
-        assert_se(strv_extend_with_size(&a, &n, "test2") >= 0);
+        assert_se(sd_strv_extend_with_size(&a, &n, "test2") >= 0);
         assert_se(n == 3);
-        assert_se(strv_extend_with_size(&a, &n, "test3") >= 0);
+        assert_se(sd_strv_extend_with_size(&a, &n, "test3") >= 0);
         assert_se(n == 4);
 
         ASSERT_STREQ(a[0], "test");
@@ -604,13 +604,13 @@ TEST(strv_extend_with_size) {
         ASSERT_NULL(a[4]);
 }
 
-TEST(strv_extend) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL;
+TEST(sd_strv_extend) {
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;
 
-        a = strv_new("test", "test1");
+        a = sd_strv_new("test", "test1");
         assert_se(a);
-        assert_se(strv_extend(&a, "test2") >= 0);
-        assert_se(strv_extend(&b, "test3") >= 0);
+        assert_se(sd_strv_extend(&a, "test2") >= 0);
+        assert_se(sd_strv_extend(&b, "test3") >= 0);
 
         ASSERT_STREQ(a[0], "test");
         ASSERT_STREQ(a[1], "test1");
@@ -618,13 +618,13 @@ TEST(strv_extend) {
         ASSERT_STREQ(b[0], "test3");
 }
 
-TEST(strv_extendf) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL;
+TEST(sd_sd_strv_extendf) {
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL;
 
-        a = strv_new("test", "test1");
+        a = sd_strv_new("test", "test1");
         assert_se(a);
-        assert_se(strv_extendf(&a, "test2 %s %d %s", "foo", 128, "bar") >= 0);
-        assert_se(strv_extendf(&b, "test3 %s %s %d", "bar", "foo", 128) >= 0);
+        assert_se(sd_sd_strv_extendf(&a, "test2 %s %d %s", "foo", 128, "bar") >= 0);
+        assert_se(sd_sd_strv_extendf(&b, "test3 %s %s %d", "bar", "foo", 128) >= 0);
 
         ASSERT_STREQ(a[0], "test");
         ASSERT_STREQ(a[1], "test1");
@@ -633,10 +633,10 @@ TEST(strv_extendf) {
 }
 
 TEST(strv_foreach) {
-        _cleanup_strv_free_ char **a;
+        _cleanup_sd_strv_free_ char **a;
         unsigned i = 0;
 
-        a = strv_new("one", "two", "three");
+        a = sd_strv_new("one", "two", "three");
         assert_se(a);
 
         STRV_FOREACH(check, a)
@@ -644,10 +644,10 @@ TEST(strv_foreach) {
 }
 
 TEST(strv_foreach_backwards) {
-        _cleanup_strv_free_ char **a;
+        _cleanup_sd_strv_free_ char **a;
         unsigned i = 2;
 
-        a = strv_new("one", "two", "three");
+        a = sd_strv_new("one", "two", "three");
 
         assert_se(a);
 
@@ -667,9 +667,9 @@ TEST(strv_foreach_backwards) {
 }
 
 TEST(strv_foreach_pair) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
-        a = strv_new("pair_one",   "pair_one",
+        a = sd_strv_new("pair_one",   "pair_one",
                      "pair_two",   "pair_two",
                      "pair_three", "pair_three");
         STRV_FOREACH_PAIR(x, y, a)
@@ -699,7 +699,7 @@ TEST(strv_from_stdarg_alloca) {
 }
 
 TEST(strv_insert) {
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
 
         assert_se(strv_insert(&a, 0, strdup("first")) == 0);
         ASSERT_STREQ(a[0], "first");
@@ -728,19 +728,19 @@ TEST(strv_insert) {
         assert_se(!a[4]);
 }
 
-TEST(strv_push_prepend) {
-        _cleanup_strv_free_ char **a = NULL;
+TEST(sd_strv_push_prepend) {
+        _cleanup_sd_strv_free_ char **a = NULL;
 
-        assert_se(a = strv_new("foo", "bar", "three"));
+        assert_se(a = sd_strv_new("foo", "bar", "three"));
 
-        assert_se(strv_push_prepend(&a, strdup("first")) >= 0);
+        assert_se(sd_strv_push_prepend(&a, strdup("first")) >= 0);
         ASSERT_STREQ(a[0], "first");
         ASSERT_STREQ(a[1], "foo");
         ASSERT_STREQ(a[2], "bar");
         ASSERT_STREQ(a[3], "three");
         assert_se(!a[4]);
 
-        assert_se(strv_consume_prepend(&a, strdup("first2")) >= 0);
+        assert_se(sd_strv_consume_prepend(&a, strdup("first2")) >= 0);
         ASSERT_STREQ(a[0], "first2");
         ASSERT_STREQ(a[1], "first");
         ASSERT_STREQ(a[2], "foo");
@@ -749,20 +749,20 @@ TEST(strv_push_prepend) {
         assert_se(!a[5]);
 }
 
-TEST(strv_push_with_size) {
-        _cleanup_strv_free_ char **a = NULL;
+TEST(sd_strv_push_with_size) {
+        _cleanup_sd_strv_free_ char **a = NULL;
         size_t n = 0;
         char *i, *j;
 
         assert_se(i = strdup("foo"));
-        assert_se(strv_push_with_size(&a, &n, i) >= 0);
+        assert_se(sd_strv_push_with_size(&a, &n, i) >= 0);
         assert_se(n == 1);
 
         assert_se(i = strdup("a"));
         assert_se(j = strdup("b"));
-        assert_se(strv_push_with_size(&a, &n, i) >= 0);
+        assert_se(sd_strv_push_with_size(&a, &n, i) >= 0);
         assert_se(n == 2);
-        assert_se(strv_push_with_size(&a, &n, j) >= 0);
+        assert_se(sd_strv_push_with_size(&a, &n, j) >= 0);
         assert_se(n == 3);
 
         ASSERT_STREQ(a[0], "foo");
@@ -770,19 +770,19 @@ TEST(strv_push_with_size) {
         ASSERT_STREQ(a[2], "b");
         ASSERT_STREQ(a[3], NULL);
 
-        assert_se(n = strv_length(a));
+        assert_se(n = sd_strv_length(a));
 }
 
-TEST(strv_push) {
-        _cleanup_strv_free_ char **a = NULL;
+TEST(sd_strv_push) {
+        _cleanup_sd_strv_free_ char **a = NULL;
         char *i, *j;
 
         assert_se(i = strdup("foo"));
-        assert_se(strv_push(&a, i) >= 0);
+        assert_se(sd_strv_push(&a, i) >= 0);
 
         assert_se(i = strdup("a"));
         assert_se(j = strdup("b"));
-        assert_se(strv_push_pair(&a, i, j) >= 0);
+        assert_se(sd_strv_push_pair(&a, i, j) >= 0);
 
         ASSERT_STREQ(a[0], "foo");
         ASSERT_STREQ(a[1], "a");
@@ -791,18 +791,18 @@ TEST(strv_push) {
 }
 
 TEST(strv_compare) {
-        _cleanup_strv_free_ char **a = NULL;
-        _cleanup_strv_free_ char **b = NULL;
-        _cleanup_strv_free_ char **c = NULL;
-        _cleanup_strv_free_ char **d = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **b = NULL;
+        _cleanup_sd_strv_free_ char **c = NULL;
+        _cleanup_sd_strv_free_ char **d = NULL;
 
-        a = strv_new("one", "two", "three");
+        a = sd_strv_new("one", "two", "three");
         assert_se(a);
-        b = strv_new("one", "two", "three");
+        b = sd_strv_new("one", "two", "three");
         assert_se(b);
-        c = strv_new("one", "two", "three", "four");
+        c = sd_strv_new("one", "two", "three", "four");
         assert_se(c);
-        d = strv_new(NULL);
+        d = sd_strv_new(NULL);
         assert_se(d);
 
         assert_se(strv_compare(a, a) == 0);
@@ -818,50 +818,50 @@ TEST(strv_compare) {
 }
 
 TEST(strv_is_uniq) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL, **c = NULL, **d = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL, **c = NULL, **d = NULL;
 
-        a = strv_new(NULL);
+        a = sd_strv_new(NULL);
         assert_se(a);
         assert_se(strv_is_uniq(a));
 
-        b = strv_new("foo");
+        b = sd_strv_new("foo");
         assert_se(b);
         assert_se(strv_is_uniq(b));
 
-        c = strv_new("foo", "bar");
+        c = sd_strv_new("foo", "bar");
         assert_se(c);
         assert_se(strv_is_uniq(c));
 
-        d = strv_new("foo", "bar", "waldo", "bar", "piep");
+        d = sd_strv_new("foo", "bar", "waldo", "bar", "piep");
         assert_se(d);
         assert_se(!strv_is_uniq(d));
 }
 
-TEST(strv_reverse) {
-        _cleanup_strv_free_ char **a = NULL, **b = NULL, **c = NULL, **d = NULL;
+TEST(sd_strv_reverse) {
+        _cleanup_sd_strv_free_ char **a = NULL, **b = NULL, **c = NULL, **d = NULL;
 
-        a = strv_new(NULL);
+        a = sd_strv_new(NULL);
         assert_se(a);
 
-        strv_reverse(a);
-        assert_se(strv_isempty(a));
+        sd_strv_reverse(a);
+        assert_se(sd_strv_isempty(a));
 
-        b = strv_new("foo");
+        b = sd_strv_new("foo");
         assert_se(b);
-        strv_reverse(b);
+        sd_strv_reverse(b);
         ASSERT_STREQ(b[0], "foo");
         ASSERT_STREQ(b[1], NULL);
 
-        c = strv_new("foo", "bar");
+        c = sd_strv_new("foo", "bar");
         assert_se(c);
-        strv_reverse(c);
+        sd_strv_reverse(c);
         ASSERT_STREQ(c[0], "bar");
         ASSERT_STREQ(c[1], "foo");
         ASSERT_STREQ(c[2], NULL);
 
-        d = strv_new("foo", "bar", "waldo");
+        d = sd_strv_new("foo", "bar", "waldo");
         assert_se(d);
-        strv_reverse(d);
+        sd_strv_reverse(d);
         ASSERT_STREQ(d[0], "waldo");
         ASSERT_STREQ(d[1], "bar");
         ASSERT_STREQ(d[2], "foo");
@@ -869,9 +869,9 @@ TEST(strv_reverse) {
 }
 
 TEST(strv_shell_escape) {
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
 
-        v = strv_new("foo:bar", "bar,baz", "wal\\do");
+        v = sd_strv_new("foo:bar", "bar,baz", "wal\\do");
         assert_se(v);
         assert_se(strv_shell_escape(v, ",:"));
         ASSERT_STREQ(v[0], "foo\\:bar");
@@ -902,14 +902,14 @@ TEST(strv_skip) {
         test_strv_skip_one(STRV_MAKE(NULL), 55, STRV_MAKE(NULL));
 }
 
-TEST(strv_extend_n) {
-        _cleanup_strv_free_ char **v = NULL;
+TEST(sd_strv_extend_n) {
+        _cleanup_sd_strv_free_ char **v = NULL;
 
-        v = strv_new("foo", "bar");
+        v = sd_strv_new("foo", "bar");
         assert_se(v);
 
-        assert_se(strv_extend_n(&v, "waldo", 3) >= 0);
-        assert_se(strv_extend_n(&v, "piep", 2) >= 0);
+        assert_se(sd_strv_extend_n(&v, "waldo", 3) >= 0);
+        assert_se(sd_strv_extend_n(&v, "piep", 2) >= 0);
 
         ASSERT_STREQ(v[0], "foo");
         ASSERT_STREQ(v[1], "bar");
@@ -920,10 +920,10 @@ TEST(strv_extend_n) {
         ASSERT_STREQ(v[6], "piep");
         ASSERT_NULL(v[7]);
 
-        v = strv_free(v);
+        v = sd_strv_free(v);
 
-        assert_se(strv_extend_n(&v, "foo", 1) >= 0);
-        assert_se(strv_extend_n(&v, "bar", 0) >= 0);
+        assert_se(sd_strv_extend_n(&v, "foo", 1) >= 0);
+        assert_se(sd_strv_extend_n(&v, "bar", 0) >= 0);
 
         ASSERT_STREQ(v[0], "foo");
         ASSERT_NULL(v[1]);
@@ -947,66 +947,66 @@ TEST(foreach_string) {
 }
 
 TEST(strv_fnmatch) {
-        _cleanup_strv_free_ char **v = NULL;
+        _cleanup_sd_strv_free_ char **v = NULL;
         size_t pos;
 
         assert_se(!strv_fnmatch(STRV_MAKE_EMPTY, "a"));
 
-        v = strv_new("xxx", "*\\*", "yyy");
+        v = sd_strv_new("xxx", "*\\*", "yyy");
         assert_se(!strv_fnmatch_full(v, "\\", 0, NULL));
         assert_se(strv_fnmatch_full(v, "\\", FNM_NOESCAPE, &pos));
         assert_se(pos == 1);
 }
 
-TEST(strv_extend_join) {
-        _cleanup_strv_free_ char **v = NULL;
+TEST(sd_strv_extend_join) {
+        _cleanup_sd_strv_free_ char **v = NULL;
 
-        assert_se(strv_extend_assignment(&v, "MESSAGE", "ABC") >= 0);
-        assert_se(strv_extend_assignment(&v, "ABC", "QER") >= 0);
-        assert_se(strv_extend_assignment(&v, "MISSING", NULL) >= 0);
+        assert_se(sd_strv_extend_assignment(&v, "MESSAGE", "ABC") >= 0);
+        assert_se(sd_strv_extend_assignment(&v, "ABC", "QER") >= 0);
+        assert_se(sd_strv_extend_assignment(&v, "MISSING", NULL) >= 0);
 
-        assert_se(strv_length(v) == 2);
+        assert_se(sd_strv_length(v) == 2);
         ASSERT_STREQ(v[0], "MESSAGE=ABC");
         ASSERT_STREQ(v[1], "ABC=QER");
 }
 
-TEST(strv_copy_n) {
+TEST(sd_strv_copy_n) {
         char **x = STRV_MAKE("a", "b", "c", "d", "e");
-        _cleanup_strv_free_ char **l = NULL;
+        _cleanup_sd_strv_free_ char **l = NULL;
 
-        l = strv_copy_n(x, 0);
+        l = sd_strv_copy_n(x, 0);
         assert_se(strv_equal(l, NULL));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 0);
+        l = sd_strv_copy_n(x, 0);
         assert_se(strv_equal(l, (char**) { NULL }));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 1);
+        l = sd_strv_copy_n(x, 1);
         assert_se(strv_equal(l, STRV_MAKE("a")));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 2);
+        l = sd_strv_copy_n(x, 2);
         assert_se(strv_equal(l, STRV_MAKE("a", "b")));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 3);
+        l = sd_strv_copy_n(x, 3);
         assert_se(strv_equal(l, STRV_MAKE("a", "b", "c")));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 4);
+        l = sd_strv_copy_n(x, 4);
         assert_se(strv_equal(l, STRV_MAKE("a", "b", "c", "d")));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 5);
+        l = sd_strv_copy_n(x, 5);
         assert_se(strv_equal(l, STRV_MAKE("a", "b", "c", "d", "e")));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, 6);
+        l = sd_strv_copy_n(x, 6);
         assert_se(strv_equal(l, STRV_MAKE("a", "b", "c", "d", "e")));
-        strv_free(l);
+        sd_strv_free(l);
 
-        l = strv_copy_n(x, SIZE_MAX);
+        l = sd_strv_copy_n(x, SIZE_MAX);
         assert_se(strv_equal(l, STRV_MAKE("a", "b", "c", "d", "e")));
 }
 
@@ -1030,28 +1030,28 @@ TEST(endswith_strv) {
         ASSERT_STREQ(endswith_strv("waldo", STRV_MAKE("knurz", "", "waldo")), "");
 }
 
-TEST(strv_extend_many) {
-        _cleanup_strv_free_ char **l = NULL;
+TEST(sd_strv_extend_many) {
+        _cleanup_sd_strv_free_ char **l = NULL;
 
-        assert_se(strv_extend_many(&l, NULL) >= 0);
-        assert_se(strv_isempty(l));
+        assert_se(sd_strv_extend_many(&l, NULL) >= 0);
+        assert_se(sd_strv_isempty(l));
 
-        assert_se(strv_extend_many(&l, NULL, NULL, NULL) >= 0);
-        assert_se(strv_isempty(l));
+        assert_se(sd_strv_extend_many(&l, NULL, NULL, NULL) >= 0);
+        assert_se(sd_strv_isempty(l));
 
-        assert_se(strv_extend_many(&l, "foo") >= 0);
+        assert_se(sd_strv_extend_many(&l, "foo") >= 0);
         assert_se(strv_equal(l, STRV_MAKE("foo")));
 
-        assert_se(strv_extend_many(&l, NULL, "bar", NULL) >= 0);
+        assert_se(sd_strv_extend_many(&l, NULL, "bar", NULL) >= 0);
         assert_se(strv_equal(l, STRV_MAKE("foo", "bar")));
 
-        assert_se(strv_extend_many(&l, "waldo", "quux") >= 0);
+        assert_se(sd_strv_extend_many(&l, "waldo", "quux") >= 0);
         assert_se(strv_equal(l, STRV_MAKE("foo", "bar", "waldo", "quux")));
 
-        assert_se(strv_extend_many(&l, "1", "2", "3", "4") >= 0);
+        assert_se(sd_strv_extend_many(&l, "1", "2", "3", "4") >= 0);
         assert_se(strv_equal(l, STRV_MAKE("foo", "bar", "waldo", "quux", "1", "2", "3", "4")));
 
-        assert_se(strv_extend_many(&l, "yes", NULL, "no") >= 0);
+        assert_se(sd_strv_extend_many(&l, "yes", NULL, "no") >= 0);
         assert_se(strv_equal(l, STRV_MAKE("foo", "bar", "waldo", "quux", "1", "2", "3", "4", "yes", "no")));
 }
 
diff '--color=auto' -Nurp a/src/test/test-time-util.c b/src/test/test-time-util.c
--- a/src/test/test-time-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-time-util.c	2025-06-30 18:33:48.000000000 +0000
@@ -267,7 +267,7 @@ TEST(timezone_is_valid) {
 }
 
 TEST(get_timezones) {
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
         int r;
 
         r = get_timezones(&zones);
@@ -467,7 +467,7 @@ static void test_format_timestamp_with_t
 }
 
 TEST(FORMAT_TIMESTAMP_with_tz) {
-        _cleanup_strv_free_ char **timezones = NULL;
+        _cleanup_sd_strv_free_ char **timezones = NULL;
 
         test_format_timestamp_with_tz_one("UTC");
 
@@ -1006,7 +1006,7 @@ static void test_parse_timestamp_with_tz
 }
 
 TEST(parse_timestamp_with_tz) {
-        _cleanup_strv_free_ char **timezones = NULL;
+        _cleanup_sd_strv_free_ char **timezones = NULL;
 
         test_parse_timestamp_with_tz_one("UTC");
 
diff '--color=auto' -Nurp a/src/test/test-unit-file.c b/src/test/test-unit-file.c
--- a/src/test/test-unit-file.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-unit-file.c	2025-06-30 18:37:55.000000000 +0000
@@ -44,7 +44,7 @@ TEST(unit_file_build_name_map) {
                 log_info("ids: %s ‚Üí %s", k, dst);
 
         HASHMAP_FOREACH_KEY(v, k, unit_names) {
-                _cleanup_free_ char *j = strv_join(v, ", ");
+                _cleanup_free_ char *j = sd_strv_join(v, ", ");
                 log_info("aliases: %s ‚Üê %s", k, j);
         }
 
diff '--color=auto' -Nurp a/src/test/test-verbs.c b/src/test/test-verbs.c
--- a/src/test/test-verbs.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/test/test-verbs.c	2025-06-30 18:35:00.000000000 +0000
@@ -13,7 +13,7 @@ static int noop_dispatcher(int argc, cha
 
 #define test_dispatch_one(argv, verbs, expected) \
         optind = 0; \
-        assert_se(dispatch_verb(strv_length(argv), argv, verbs, NULL) == expected);
+        assert_se(dispatch_verb(sd_strv_length(argv), argv, verbs, NULL) == expected);
 
 TEST(verbs) {
         static const Verb verbs[] = {
diff '--color=auto' -Nurp a/src/timedate/timedatectl.c b/src/timedate/timedatectl.c
--- a/src/timedate/timedatectl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/timedate/timedatectl.c	2025-06-30 18:35:42.000000000 +0000
@@ -307,7 +307,7 @@ static int list_timezones(int argc, char
         sd_bus *bus = userdata;
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
         int r;
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
 
         r = bus_call_method(bus, bus_timedate, "ListTimezones", &error, &reply, NULL);
         if (r < 0)
@@ -969,7 +969,7 @@ static int parse_argv(int argc, char *ar
 
                 case 'p':
                 case 'P':
-                        r = strv_extend(&arg_property, optarg);
+                        r = sd_strv_extend(&arg_property, optarg);
                         if (r < 0)
                                 return log_oom();
 
diff '--color=auto' -Nurp a/src/timedate/timedated.c b/src/timedate/timedated.c
--- a/src/timedate/timedated.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/timedate/timedated.c	2025-06-30 18:33:48.000000000 +0000
@@ -195,7 +195,7 @@ static int context_parse_ntp_services_fr
 }
 
 static int context_parse_ntp_services_from_disk(Context *c) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         r = conf_files_list_strv(&files, ".list", NULL, CONF_FILES_FILTER_MASKED, UNIT_LIST_DIRS);
@@ -1019,7 +1019,7 @@ static int method_set_ntp(sd_bus_message
 
 static int method_list_timezones(sd_bus_message *m, void *userdata, sd_bus_error *error) {
         _cleanup_(sd_bus_message_unrefp) sd_bus_message *reply = NULL;
-        _cleanup_strv_free_ char **zones = NULL;
+        _cleanup_sd_strv_free_ char **zones = NULL;
         int r;
 
         assert(m);
diff '--color=auto' -Nurp a/src/timesync/timesyncd-bus.c b/src/timesync/timesyncd-bus.c
--- a/src/timesync/timesyncd-bus.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/timesync/timesyncd-bus.c	2025-06-30 18:33:48.000000000 +0000
@@ -49,7 +49,7 @@ static int property_get_servers(
 }
 
 static int method_set_runtime_servers(sd_bus_message *message, void *userdata, sd_bus_error *error) {
-        _cleanup_strv_free_ char **msg_names = NULL;
+        _cleanup_sd_strv_free_ char **msg_names = NULL;
         Manager *m = ASSERT_PTR(userdata);
         int r;
 
diff '--color=auto' -Nurp a/src/timesync/timesyncd-manager.c b/src/timesync/timesyncd-manager.c
--- a/src/timesync/timesyncd-manager.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/timesync/timesyncd-manager.c	2025-06-30 18:37:25.000000000 +0000
@@ -962,7 +962,7 @@ Manager* manager_free(Manager *m) {
 }
 
 static int manager_network_read_link_servers(Manager *m) {
-        _cleanup_strv_free_ char **ntp = NULL;
+        _cleanup_sd_strv_free_ char **ntp = NULL;
         bool changed = false;
         int r;
 
@@ -1241,19 +1241,19 @@ static int ntp_server_emit_changed_strv(
 
 static int on_deferred_ntp_server(sd_event_source *s, void *userdata) {
         int r;
-        _cleanup_strv_free_ char **p = NULL;
+        _cleanup_sd_strv_free_ char **p = NULL;
         Manager *m = ASSERT_PTR(userdata);
 
         m->deferred_ntp_server_event_source = sd_event_source_disable_unref(m->deferred_ntp_server_event_source);
 
         for (int type = SERVER_SYSTEM; type < _SERVER_TYPE_MAX; type++)
                 if (m->ntp_server_change_mask & (1U << type))
-                        if (strv_extend(&p, ntp_server_property_name[type]) < 0)
+                        if (sd_strv_extend(&p, ntp_server_property_name[type]) < 0)
                                 log_oom();
 
         m->ntp_server_change_mask = 0;
 
-        if (strv_isempty(p))
+        if (sd_strv_isempty(p))
                 return log_error_errno(SYNTHETIC_ERRNO(ENOMEM), "Failed to build ntp server event strv!");
 
         r = ntp_server_emit_changed_strv(m, p);
diff '--color=auto' -Nurp a/src/tmpfiles/tmpfiles.c b/src/tmpfiles/tmpfiles.c
--- a/src/tmpfiles/tmpfiles.c	2025-06-30 18:55:45.135159940 +0000
+++ b/src/tmpfiles/tmpfiles.c	2025-06-30 18:37:25.000000000 +0000
@@ -228,8 +228,8 @@ typedef struct Context {
         Hashmap *gid_cache;
 } Context;
 
-STATIC_DESTRUCTOR_REGISTER(arg_include_prefixes, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_exclude_prefixes, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_include_prefixes, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_exclude_prefixes, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_root, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_image_policy, image_policy_freep);
@@ -355,9 +355,9 @@ static int log_unresolvable_specifier(co
                  __VA_ARGS__)
 
 static int user_config_paths(char*** ret) {
-        _cleanup_strv_free_ char **config_dirs = NULL, **data_dirs = NULL;
+        _cleanup_sd_strv_free_ char **config_dirs = NULL, **data_dirs = NULL;
         _cleanup_free_ char *persistent_config = NULL, *runtime_config = NULL, *data_home = NULL;
-        _cleanup_strv_free_ char **res = NULL;
+        _cleanup_sd_strv_free_ char **res = NULL;
         int r;
 
         r = xdg_user_dirs(&config_dirs, &data_dirs);
@@ -376,11 +376,11 @@ static int user_config_paths(char*** ret
         if (r < 0 && !ERRNO_IS_NEG_NOINFO(r))
                 return r;
 
-        r = strv_extend_strv_concat(&res, (const char* const*) config_dirs, "/user-tmpfiles.d");
+        r = sd_sd_strv_extend_strv_concat(&res, (const char* const*) config_dirs, "/user-tmpfiles.d");
         if (r < 0)
                 return r;
 
-        r = strv_extend_many(
+        r = sd_strv_extend_many(
                         &res,
                         persistent_config,
                         runtime_config,
@@ -388,7 +388,7 @@ static int user_config_paths(char*** ret
         if (r < 0)
                 return r;
 
-        r = strv_extend_strv_concat(&res, (const char* const*) data_dirs, "/user-tmpfiles.d");
+        r = sd_sd_strv_extend_strv_concat(&res, (const char* const*) data_dirs, "/user-tmpfiles.d");
         if (r < 0)
                 return r;
 
@@ -1185,7 +1185,7 @@ static int parse_xattrs_from_arg(Item *i
                         continue;
                 }
 
-                if (strv_push_pair(&i->xattrs, name, value) < 0)
+                if (sd_strv_push_pair(&i->xattrs, name, value) < 0)
                         return log_oom();
 
                 name = value = NULL;
@@ -3296,7 +3296,7 @@ static void item_free_contents(Item *i)
         free(i->path);
         free(i->argument);
         free(i->binary_argument);
-        strv_free(i->xattrs);
+        sd_strv_free(i->xattrs);
 
 #if HAVE_ACL
         if (i->acl_access)
@@ -3386,7 +3386,7 @@ static bool should_include_path(const ch
                 }
 
         /* no matches, so we should include this path only if we have no allow list at all */
-        if (strv_isempty(arg_include_prefixes))
+        if (sd_strv_isempty(arg_include_prefixes))
                 return true;
 
         log_debug("Entry \"%s\" does not match any include prefix, skipping.", path);
@@ -4112,7 +4112,7 @@ static int parse_line(
 }
 
 static int cat_config(char **config_dirs, char **args) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         r = conf_files_list_with_replacement(arg_root, config_dirs, arg_replace, &files, NULL);
@@ -4132,7 +4132,7 @@ static int exclude_default_prefixes(void
          * likely over-mounted if the root directory is actually used, and it wouldbe less than ideal to have
          * all kinds of files created/adjusted underneath these mount points. */
 
-        r = strv_extend_many(
+        r = sd_strv_extend_many(
                         &arg_exclude_prefixes,
                         "/dev",
                         "/proc",
@@ -4285,12 +4285,12 @@ static int parse_argv(int argc, char *ar
                         break;
 
                 case ARG_PREFIX:
-                        if (strv_extend(&arg_include_prefixes, optarg) < 0)
+                        if (sd_strv_extend(&arg_include_prefixes, optarg) < 0)
                                 return log_oom();
                         break;
 
                 case ARG_EXCLUDE_PREFIX:
-                        if (strv_extend(&arg_exclude_prefixes, optarg) < 0)
+                        if (sd_strv_extend(&arg_exclude_prefixes, optarg) < 0)
                                 return log_oom();
                         break;
 
@@ -4458,7 +4458,7 @@ static int read_config_files(
                 char **args,
                 bool *invalid_config) {
 
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         _cleanup_free_ char *p = NULL;
         int r;
 
@@ -4549,7 +4549,7 @@ static int run(int argc, char *argv[]) {
         _cleanup_(loop_device_unrefp) LoopDevice *loop_device = NULL;
         _cleanup_(umount_and_freep) char *mounted_dir = NULL;
 #endif
-        _cleanup_strv_free_ char **config_dirs = NULL;
+        _cleanup_sd_strv_free_ char **config_dirs = NULL;
         _cleanup_(context_done) Context c = {};
         bool invalid_config = false;
         ItemArray *a;
@@ -4589,7 +4589,7 @@ static int run(int argc, char *argv[]) {
                 break;
 
         case RUNTIME_SCOPE_SYSTEM:
-                config_dirs = strv_new(CONF_PATHS("tmpfiles.d"));
+                config_dirs = sd_strv_new(CONF_PATHS("tmpfiles.d"));
                 if (!config_dirs)
                         return log_oom();
                 break;
diff '--color=auto' -Nurp a/src/tty-ask-password-agent/tty-ask-password-agent.c b/src/tty-ask-password-agent/tty-ask-password-agent.c
--- a/src/tty-ask-password-agent/tty-ask-password-agent.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/tty-ask-password-agent/tty-ask-password-agent.c	2025-06-30 18:37:25.000000000 +0000
@@ -234,7 +234,7 @@ static int process_one_password_file(con
         }
         case ACTION_QUERY:
         case ACTION_WATCH: {
-                _cleanup_strv_free_erase_ char **passwords = NULL;
+                _cleanup_sd_strv_free_erase_ char **passwords = NULL;
                 AskPasswordFlags flags = 0;
 
                 if (access(socket_name, W_OK) < 0) {
@@ -265,7 +265,7 @@ static int process_one_password_file(con
                         return log_error_errno(r, "Failed to query password: %m");
                 }
 
-                assert(!strv_isempty(passwords));
+                assert(!sd_strv_isempty(passwords));
                 r = send_passwords(socket_name, passwords);
                 if (r < 0)
                         return log_error_errno(r, "Failed to send: %m");
@@ -634,7 +634,7 @@ static void terminate_agents(Set *pids)
 
 static int ask_on_consoles(char *argv[]) {
         _cleanup_set_free_ Set *pids = NULL;
-        _cleanup_strv_free_ char **consoles = NULL, **arguments = NULL;
+        _cleanup_sd_strv_free_ char **consoles = NULL, **arguments = NULL;
         siginfo_t status = {};
         pid_t pid;
         int r;
@@ -647,7 +647,7 @@ static int ask_on_consoles(char *argv[])
         if (!pids)
                 return log_oom();
 
-        arguments = strv_copy(argv);
+        arguments = sd_strv_copy(argv);
         if (!arguments)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/udev/iocost/iocost.c b/src/udev/iocost/iocost.c
--- a/src/udev/iocost/iocost.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/iocost/iocost.c	2025-06-30 18:37:42.000000000 +0000
@@ -116,10 +116,10 @@ static int get_known_solutions(sd_device
         if (r < 0)
                 return log_device_error_errno(device, r, "Failed to query solutions from device: %m");
 
-        s = strv_split(value, WHITESPACE);
+        s = sd_strv_split(value, WHITESPACE);
         if (!s)
                 return log_oom();
-        if (strv_isempty(s))
+        if (sd_strv_isempty(s))
                 return log_device_error_errno(device, SYNTHETIC_ERRNO(EINVAL),
                                               "IOCOST_SOLUTIONS exists in hwdb but is empty.");
 
@@ -185,7 +185,7 @@ static int query_named_solution(
 
 static int apply_solution_for_path(const char *path, const char *name) {
         _cleanup_(sd_device_unrefp) sd_device *device = NULL;
-        _cleanup_strv_free_ char **solutions = NULL;
+        _cleanup_sd_strv_free_ char **solutions = NULL;
         _cleanup_free_ char *qos = NULL, *model = NULL;
         const char *qos_params, *model_params;
         dev_t devnum;
@@ -241,7 +241,7 @@ static int apply_solution_for_path(const
 
 static int query_solutions_for_path(const char *path) {
         _cleanup_(sd_device_unrefp) sd_device *device = NULL;
-        _cleanup_strv_free_ char **solutions = NULL;
+        _cleanup_sd_strv_free_ char **solutions = NULL;
         const char *selected_solution, *model_name;
         int r;
 
diff '--color=auto' -Nurp a/src/udev/net/link-config.c b/src/udev/net/link-config.c
--- a/src/udev/net/link-config.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/net/link-config.c	2025-06-30 18:36:37.000000000 +0000
@@ -57,18 +57,18 @@ static LinkConfig* link_config_free(Link
                 return NULL;
 
         free(config->filename);
-        strv_free(config->dropins);
+        sd_strv_free(config->dropins);
 
         net_match_clear(&config->match);
         condition_free_list(config->conditions);
 
         free(config->description);
-        strv_free(config->properties);
-        strv_free(config->import_properties);
-        strv_free(config->unset_properties);
+        sd_strv_free(config->properties);
+        sd_strv_free(config->import_properties);
+        sd_strv_free(config->unset_properties);
         free(config->name_policy);
         free(config->name);
-        strv_free(config->alternative_names);
+        sd_strv_free(config->alternative_names);
         free(config->alternative_names_policy);
         free(config->alias);
         free(config->wol_password_file);
@@ -340,7 +340,7 @@ static int device_unsigned_attribute(sd_
 }
 
 int link_config_load(LinkConfigContext *ctx) {
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         assert(ctx);
@@ -379,7 +379,7 @@ Link *link_free(Link *link) {
         sd_device_unref(link->device);
         sd_device_unref(link->device_db_clone);
         free(link->kind);
-        strv_free(link->altnames);
+        sd_strv_free(link->altnames);
         return mfree(link);
 }
 
@@ -821,7 +821,7 @@ no_rename:
 }
 
 static int link_generate_alternative_names(Link *link) {
-        _cleanup_strv_free_ char **altnames = NULL;
+        _cleanup_sd_strv_free_ char **altnames = NULL;
         LinkConfig *config;
         sd_device *device;
         int r;
@@ -838,7 +838,7 @@ static int link_generate_alternative_nam
         }
 
         if (config->alternative_names) {
-                altnames = strv_copy(config->alternative_names);
+                altnames = sd_strv_copy(config->alternative_names);
                 if (!altnames)
                         return log_oom();
         }
@@ -867,7 +867,7 @@ static int link_generate_alternative_nam
                                 assert_not_reached();
                         }
                         if (ifname_valid_full(n, IFNAME_VALID_ALTERNATIVE)) {
-                                r = strv_extend(&altnames, n);
+                                r = sd_strv_extend(&altnames, n);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -1112,7 +1112,7 @@ int config_parse_udev_property(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *properties = strv_free(*properties);
+                *properties = sd_strv_free(*properties);
                 return 0;
         }
 
@@ -1183,7 +1183,7 @@ int config_parse_udev_property_name(
 
         if (isempty(rvalue)) {
                 /* Empty assignment resets the list */
-                *properties = strv_free(*properties);
+                *properties = sd_strv_free(*properties);
                 return 0;
         }
 
@@ -1221,7 +1221,7 @@ int config_parse_udev_property_name(
                         continue;
                 }
 
-                r = strv_consume(properties, TAKE_PTR(resolved));
+                r = sd_strv_consume(properties, TAKE_PTR(resolved));
                 if (r < 0)
                         return log_error_errno(r, "Failed to update properties: %m");
         }
diff '--color=auto' -Nurp a/src/udev/scsi_id/scsi_id.c b/src/udev/scsi_id/scsi_id.c
--- a/src/udev/scsi_id/scsi_id.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/scsi_id/scsi_id.c	2025-06-30 18:37:42.000000000 +0000
@@ -110,7 +110,7 @@ static void set_type(unsigned type_num,
 static int get_file_options(const char *vendor, const char *model,
                             int *argc, char ***newargv) {
         _cleanup_free_ char *vendor_in = NULL, *model_in = NULL, *options_in = NULL; /* read in from file */
-        _cleanup_strv_free_ char **options_argv = NULL;
+        _cleanup_sd_strv_free_ char **options_argv = NULL;
         _cleanup_fclose_ FILE *f = NULL;
         int lineno, r;
 
@@ -210,14 +210,14 @@ static int get_file_options(const char *
         * Something matched. Allocate newargv, and store
         * values found in options_in.
         */
-        options_argv = strv_split(options_in, " \t");
+        options_argv = sd_strv_split(options_in, " \t");
         if (!options_argv)
                 return log_oom();
         r = strv_prepend(&options_argv, ""); /* getopt skips over argv[0] */
         if (r < 0)
                 return r;
         *newargv = TAKE_PTR(options_argv);
-        *argc = strv_length(*newargv);
+        *argc = sd_strv_length(*newargv);
 
         return 0;
 }
@@ -327,7 +327,7 @@ static int set_options(int argc, char **
 }
 
 static int per_dev_options(struct scsi_id_device *dev_scsi, int *good_bad, int *page_code) {
-        _cleanup_strv_free_ char **newargv = NULL;
+        _cleanup_sd_strv_free_ char **newargv = NULL;
         int retval;
         int newargc;
         int option;
@@ -475,7 +475,7 @@ out:
 }
 
 int main(int argc, char **argv) {
-        _cleanup_strv_free_ char **newargv = NULL;
+        _cleanup_sd_strv_free_ char **newargv = NULL;
         int retval = 0;
         char maj_min_dev[MAX_PATH_LEN];
         int newargc;
diff '--color=auto' -Nurp a/src/udev/test-udev-spawn.c b/src/udev/test-udev-spawn.c
--- a/src/udev/test-udev-spawn.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/test-udev-spawn.c	2025-06-30 18:37:42.000000000 +0000
@@ -24,7 +24,7 @@ static void test_event_spawn_core(bool w
 }
 
 static void test_event_spawn_cat(bool with_pidfd, size_t buf_size) {
-        _cleanup_strv_free_ char **lines = NULL;
+        _cleanup_sd_strv_free_ char **lines = NULL;
         _cleanup_free_ char *cmd = NULL;
         char result_buf[BUF_SIZE];
 
@@ -36,7 +36,7 @@ static void test_event_spawn_cat(bool wi
         test_event_spawn_core(with_pidfd, cmd, result_buf,
                               buf_size >= BUF_SIZE ? BUF_SIZE : buf_size);
 
-        assert_se(lines = strv_split_newlines(result_buf));
+        assert_se(lines = sd_strv_split_newlines(result_buf));
         strv_print(lines);
 
         if (buf_size >= BUF_SIZE) {
@@ -46,7 +46,7 @@ static void test_event_spawn_cat(bool wi
 }
 
 static void test_event_spawn_self(const char *self, const char *arg, bool with_pidfd) {
-        _cleanup_strv_free_ char **lines = NULL;
+        _cleanup_sd_strv_free_ char **lines = NULL;
         _cleanup_free_ char *cmd = NULL;
         char result_buf[BUF_SIZE];
 
@@ -56,7 +56,7 @@ static void test_event_spawn_self(const
 
         test_event_spawn_core(with_pidfd, cmd, result_buf, BUF_SIZE);
 
-        assert_se(lines = strv_split_newlines(result_buf));
+        assert_se(lines = sd_strv_split_newlines(result_buf));
         strv_print(lines);
 
         assert_se(strv_contains(lines, "aaa"));
diff '--color=auto' -Nurp a/src/udev/udev-builtin-kmod.c b/src/udev/udev-builtin-kmod.c
--- a/src/udev/udev-builtin-kmod.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udev-builtin-kmod.c	2025-06-30 18:37:25.000000000 +0000
@@ -35,7 +35,7 @@ static int builtin_kmod(UdevEvent *event
                                                 "%s: expected: load [module‚Ä¶]", argv[0]);
 
         char **modules = strv_skip(argv, 2);
-        if (strv_isempty(modules)) {
+        if (sd_strv_isempty(modules)) {
                 const char *modalias;
 
                 r = sd_device_get_property_value(dev, "MODALIAS", &modalias);
diff '--color=auto' -Nurp a/src/udev/udev-builtin.c b/src/udev/udev-builtin.c
--- a/src/udev/udev-builtin.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udev-builtin.c	2025-06-30 18:37:42.000000000 +0000
@@ -100,7 +100,7 @@ UdevBuiltinCommand udev_builtin_lookup(c
 }
 
 int udev_builtin_run(UdevEvent *event, UdevBuiltinCommand cmd, const char *command) {
-        _cleanup_strv_free_ char **argv = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL;
         int r;
 
         assert(event);
@@ -111,13 +111,13 @@ int udev_builtin_run(UdevEvent *event, U
         if (!builtins[cmd])
                 return -EOPNOTSUPP;
 
-        r = strv_split_full(&argv, command, NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_RETAIN_ESCAPE);
+        r = sd_strv_split_full(&argv, command, NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_RETAIN_ESCAPE);
         if (r < 0)
                 return r;
 
         /* we need '0' here to reset the internal state */
         optind = 0;
-        return builtins[cmd]->cmd(event, strv_length(argv), argv);
+        return builtins[cmd]->cmd(event, sd_strv_length(argv), argv);
 }
 
 int udev_builtin_add_property(sd_device *dev, EventMode mode, const char *key, const char *val) {
diff '--color=auto' -Nurp a/src/udev/udev-event.c b/src/udev/udev-event.c
--- a/src/udev/udev-event.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udev-event.c	2025-06-30 18:37:25.000000000 +0000
@@ -53,7 +53,7 @@ UdevEvent *udev_event_free(UdevEvent *ev
         ordered_hashmap_free_free_free(event->seclabel_list);
         free(event->program_result);
         free(event->name);
-        strv_free(event->altnames);
+        sd_strv_free(event->altnames);
 
         return mfree(event);
 }
@@ -229,7 +229,7 @@ static int assign_altnames(UdevEvent *ev
         if (!EVENT_MODE_DESTRUCTIVE(event))
                 return 0;
 
-        if (strv_isempty(event->altnames))
+        if (sd_strv_isempty(event->altnames))
                 return 0;
 
         r = sd_device_get_ifindex(dev, &ifindex);
@@ -243,7 +243,7 @@ static int assign_altnames(UdevEvent *ev
                 return log_device_warning_errno(dev, r, "Failed to get sysname: %m");
 
         /* Filter out the current interface name. */
-        strv_remove(event->altnames, s);
+        sd_strv_remove(event->altnames, s);
 
         r = rtnl_append_link_alternative_names(&event->rtnl, ifindex, event->altnames);
         if (r < 0)
diff '--color=auto' -Nurp a/src/udev/udev-node.c b/src/udev/udev-node.c
--- a/src/udev/udev-node.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udev-node.c	2025-06-30 18:37:25.000000000 +0000
@@ -841,7 +841,7 @@ int static_node_apply_permissions(
                 return 0;
         }
 
-        if (!strv_isempty(tags)) {
+        if (!sd_strv_isempty(tags)) {
                 unescaped_filename = xescape(name, "/.");
                 if (!unescaped_filename)
                         return log_oom();
diff '--color=auto' -Nurp a/src/udev/udev-rules.c b/src/udev/udev-rules.c
--- a/src/udev/udev-rules.c	2025-06-30 18:55:45.271159937 +0000
+++ b/src/udev/udev-rules.c	2025-06-30 18:37:42.000000000 +0000
@@ -1652,7 +1652,7 @@ UdevRules* udev_rules_new(ResolveNameTim
 
 int udev_rules_load(UdevRules **ret_rules, ResolveNameTiming resolve_name_timing) {
         _cleanup_(udev_rules_freep) UdevRules *rules = NULL;
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
         int r;
 
         rules = udev_rules_new(resolve_name_timing);
@@ -2173,7 +2173,7 @@ static int udev_rule_apply_token_to_even
                 return token->op == OP_MATCH;
         }
         case TK_M_IMPORT_PROGRAM: {
-                _cleanup_strv_free_ char **lines = NULL;
+                _cleanup_sd_strv_free_ char **lines = NULL;
                 char buf[UDEV_LINE_SIZE], result[UDEV_LINE_SIZE];
                 bool truncated;
 
@@ -2206,7 +2206,7 @@ static int udev_rule_apply_token_to_even
                                         break;
                 }
 
-                r = strv_split_newlines_full(&lines, result, EXTRACT_RETAIN_ESCAPE);
+                r = sd_strv_split_newlines_full(&lines, result, EXTRACT_RETAIN_ESCAPE);
                 if (r == -ENOMEM)
                         return log_oom();
                 if (r < 0) {
@@ -2900,7 +2900,7 @@ int udev_rules_apply_to_event(UdevRules
 }
 
 static int udev_rule_line_apply_static_dev_perms(UdevRuleLine *rule_line) {
-        _cleanup_strv_free_ char **tags = NULL;
+        _cleanup_sd_strv_free_ char **tags = NULL;
         uid_t uid = UID_INVALID;
         gid_t gid = GID_INVALID;
         mode_t mode = MODE_INVALID;
@@ -2919,7 +2919,7 @@ static int udev_rule_line_apply_static_d
                 else if (token->type == TK_A_MODE_ID)
                         mode = PTR_TO_MODE(token->data);
                 else if (token->type == TK_A_TAG) {
-                        r = strv_extend(&tags, token->value);
+                        r = sd_strv_extend(&tags, token->value);
                         if (r < 0)
                                 return log_oom();
                 } else if (token->type == TK_A_OPTIONS_STATIC_NODE) {
diff '--color=auto' -Nurp a/src/udev/udev-spawn.c b/src/udev/udev-spawn.c
--- a/src/udev/udev-spawn.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udev-spawn.c	2025-06-30 18:37:42.000000000 +0000
@@ -75,9 +75,9 @@ static int on_spawn_io(sd_event_source *
 
         /* Log output only if we watch stderr. */
         if (l > 0 && spawn->fd_stderr >= 0) {
-                _cleanup_strv_free_ char **v = NULL;
+                _cleanup_sd_strv_free_ char **v = NULL;
 
-                r = strv_split_newlines_full(&v, p, EXTRACT_RETAIN_ESCAPE);
+                r = sd_strv_split_newlines_full(&v, p, EXTRACT_RETAIN_ESCAPE);
                 if (r < 0)
                         log_device_debug(spawn->device,
                                          "Failed to split output from '%s'(%s), ignoring: %m",
@@ -218,7 +218,7 @@ int udev_event_spawn(
                 bool *ret_truncated) {
 
         _cleanup_close_pair_ int outpipe[2] = EBADF_PAIR, errpipe[2] = EBADF_PAIR;
-        _cleanup_strv_free_ char **argv = NULL;
+        _cleanup_sd_strv_free_ char **argv = NULL;
         char **envp = NULL;
         Spawn spawn;
         pid_t pid;
@@ -260,7 +260,7 @@ int udev_event_spawn(
                         return log_device_error_errno(event->dev, errno,
                                                       "Failed to create pipe for command '%s': %m", cmd);
 
-        r = strv_split_full(&argv, cmd, NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_RETAIN_ESCAPE);
+        r = sd_strv_split_full(&argv, cmd, NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX | EXTRACT_RETAIN_ESCAPE);
         if (r < 0)
                 return log_device_error_errno(event->dev, r, "Failed to split command: %m");
 
diff '--color=auto' -Nurp a/src/udev/udevadm-control.c b/src/udev/udevadm-control.c
--- a/src/udev/udevadm-control.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-control.c	2025-06-30 18:37:25.000000000 +0000
@@ -29,7 +29,7 @@ static int arg_log_level = -1;
 static int arg_start_exec_queue = -1;
 static bool arg_load_credentials = false;
 
-STATIC_DESTRUCTOR_REGISTER(arg_env, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_env, sd_strv_freep);
 
 static bool arg_has_control_commands(void) {
         return
@@ -37,7 +37,7 @@ static bool arg_has_control_commands(voi
                 arg_log_level >= 0 ||
                 arg_start_exec_queue >= 0 ||
                 arg_reload ||
-                !strv_isempty(arg_env) ||
+                !sd_strv_isempty(arg_env) ||
                 arg_max_children >= 0 ||
                 arg_ping;
 }
@@ -121,7 +121,7 @@ static int parse_argv(int argc, char *ar
                         if (!strchr(optarg, '='))
                                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "expect <KEY>=<value> instead of '%s'", optarg);
 
-                        r = strv_extend(&arg_env, optarg);
+                        r = sd_strv_extend(&arg_env, optarg);
                         if (r < 0)
                                 return log_error_errno(r, "Failed to extend environment: %m");
 
diff '--color=auto' -Nurp a/src/udev/udevadm-info.c b/src/udev/udevadm-info.c
--- a/src/udev/udevadm-info.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-info.c	2025-06-30 18:37:42.000000000 +0000
@@ -80,7 +80,7 @@ typedef struct SysAttr {
         const char *value;
 } SysAttr;
 
-STATIC_DESTRUCTOR_REGISTER(arg_properties, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_properties, sd_strv_freep);
 
 static int sysattr_compare(const SysAttr *a, const SysAttr *b) {
         assert(a);
@@ -775,7 +775,7 @@ static int parse_key_value_argument(cons
 
 int info_main(int argc, char *argv[], void *userdata) {
         _cleanup_(sd_device_enumerator_unrefp) sd_device_enumerator *e = NULL;
-        _cleanup_strv_free_ char **devices = NULL;
+        _cleanup_sd_strv_free_ char **devices = NULL;
         _cleanup_free_ char *name = NULL;
         int c, r, ret;
 
@@ -843,7 +843,7 @@ int info_main(int argc, char *argv[], vo
                                 if (!arg_properties)
                                         return log_oom();
                         } else {
-                                r = strv_split_and_extend(&arg_properties, optarg, ",", true);
+                                r = sd_strv_split_and_extend(&arg_properties, optarg, ",", true);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -860,7 +860,7 @@ int info_main(int argc, char *argv[], vo
                         if (!path)
                                 return log_oom();
 
-                        r = strv_consume(&devices, path);
+                        r = sd_strv_consume(&devices, path);
                         if (r < 0)
                                 return log_oom();
                         break;
@@ -1051,14 +1051,14 @@ int info_main(int argc, char *argv[], vo
                 return export_devices(e);
         }
 
-        r = strv_extend_strv(&devices, argv + optind, false);
+        r = sd_sd_strv_extend_strv(&devices, argv + optind, false);
         if (r < 0)
                 return log_error_errno(r, "Failed to build argument list: %m");
 
-        if (action != ACTION_TREE && strv_isempty(devices))
+        if (action != ACTION_TREE && sd_strv_isempty(devices))
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "A device name or path is required");
-        if (IN_SET(action, ACTION_ATTRIBUTE_WALK, ACTION_TREE) && strv_length(devices) > 1)
+        if (IN_SET(action, ACTION_ATTRIBUTE_WALK, ACTION_TREE) && sd_strv_length(devices) > 1)
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "Only one device may be specified with -a/--attribute-walk and -t/--tree");
 
@@ -1068,7 +1068,7 @@ int info_main(int argc, char *argv[], vo
 
         pager_open(arg_pager_flags);
 
-        if (strv_isempty(devices)) {
+        if (sd_strv_isempty(devices)) {
                 assert(action == ACTION_TREE);
                 return print_tree(NULL);
         }
diff '--color=auto' -Nurp a/src/udev/udevadm-lock.c b/src/udev/udevadm-lock.c
--- a/src/udev/udevadm-lock.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-lock.c	2025-06-30 18:37:25.000000000 +0000
@@ -28,9 +28,9 @@ static char **arg_backing = NULL;
 static char **arg_cmdline = NULL;
 static bool arg_print = false;
 
-STATIC_DESTRUCTOR_REGISTER(arg_devices, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_backing, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_cmdline, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_devices, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_backing, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_cmdline, sd_strv_freep);
 
 static int help(void) {
         _cleanup_free_ char *link = NULL;
@@ -100,7 +100,7 @@ static int parse_argv(int argc, char *ar
 
                         path_simplify(s);
 
-                        if (strv_consume(l, TAKE_PTR(s)) < 0)
+                        if (sd_strv_consume(l, TAKE_PTR(s)) < 0)
                                 return log_oom();
 
                         strv_uniq(*l);
@@ -131,12 +131,12 @@ static int parse_argv(int argc, char *ar
                 if (optind + 1 > argc)
                         return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Too few arguments, command to execute.");
 
-                arg_cmdline = strv_copy(argv + optind);
+                arg_cmdline = sd_strv_copy(argv + optind);
                 if (!arg_cmdline)
                         return log_oom();
         }
 
-        if (strv_isempty(arg_devices) && strv_isempty(arg_backing))
+        if (sd_strv_isempty(arg_devices) && sd_strv_isempty(arg_backing))
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "No devices to lock specified, refusing.");
 
         return 1;
diff '--color=auto' -Nurp a/src/udev/udevadm-settle.c b/src/udev/udevadm-settle.c
--- a/src/udev/udevadm-settle.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-settle.c	2025-06-30 18:37:55.000000000 +0000
@@ -86,7 +86,7 @@ static int parse_argv(int argc, char *ar
 
 static int emit_deprecation_warning(void) {
         _cleanup_(sd_bus_flush_close_unrefp) sd_bus *bus = NULL;
-        _cleanup_strv_free_ char **a = NULL;
+        _cleanup_sd_strv_free_ char **a = NULL;
         _cleanup_free_ char *unit = NULL;
         int r;
 
@@ -103,7 +103,7 @@ static int emit_deprecation_warning(void
         if (r < 0)
                 log_debug_errno(r, "Failed to open connection to systemd, skipping dependency queries: %m");
         else {
-                _cleanup_strv_free_ char **b = NULL;
+                _cleanup_sd_strv_free_ char **b = NULL;
                 _cleanup_free_ char *unit_path = NULL;
 
                 unit_path = unit_dbus_path_from_name("systemd-udev-settle.service");
@@ -128,12 +128,12 @@ static int emit_deprecation_warning(void
                                 NULL,
                                 &b);
 
-                r = strv_extend_strv(&a, b, true);
+                r = sd_sd_strv_extend_strv(&a, b, true);
                 if (r < 0)
                         return r;
         }
 
-        if (strv_isempty(a))
+        if (sd_strv_isempty(a))
                 /* Print a simple message if we cannot determine the dependencies */
                 log_notice("systemd-udev-settle.service is deprecated.");
         else {
@@ -141,7 +141,7 @@ static int emit_deprecation_warning(void
                  * common case). This is hooked up with a catalog entry and everything. */
                 _cleanup_free_ char *t = NULL;
 
-                t = strv_join(a, ", ");
+                t = sd_strv_join(a, ", ");
                 if (!t)
                         return -ENOMEM;
 
diff '--color=auto' -Nurp a/src/udev/udevadm-test.c b/src/udev/udevadm-test.c
--- a/src/udev/udevadm-test.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-test.c	2025-06-30 18:37:25.000000000 +0000
@@ -190,7 +190,7 @@ int test_main(int argc, char *argv[], vo
                 if (!isempty(event->name))
                         printf("%sNetwork interface name:%s\n  %s\n", ansi_highlight(), ansi_normal(), event->name);
 
-                if (!strv_isempty(event->altnames)) {
+                if (!sd_strv_isempty(event->altnames)) {
                         bool space = true;
                         printf("%sAlternative interface names:%s", ansi_highlight(), ansi_normal());
                         fputstrv(stdout, event->altnames, "\n  ", &space);
diff '--color=auto' -Nurp a/src/udev/udevadm-trigger.c b/src/udev/udevadm-trigger.c
--- a/src/udev/udevadm-trigger.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-trigger.c	2025-06-30 18:37:42.000000000 +0000
@@ -459,9 +459,9 @@ int trigger_main(int argc, char *argv[],
                         break;
 
                 case ARG_PRIORITIZED_SUBSYSTEM: {
-                        _cleanup_strv_free_ char **subsystems = NULL;
+                        _cleanup_sd_strv_free_ char **subsystems = NULL;
 
-                        subsystems = strv_split(optarg, ",");
+                        subsystems = sd_strv_split(optarg, ",");
                         if (!subsystems)
                                 return log_error_errno(r, "Failed to parse prioritized subsystem '%s': %m", optarg);
 
diff '--color=auto' -Nurp a/src/udev/udevadm-verify.c b/src/udev/udevadm-verify.c
--- a/src/udev/udevadm-verify.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-verify.c	2025-06-30 18:37:25.000000000 +0000
@@ -143,7 +143,7 @@ static int verify_rules_filelist(UdevRul
 
 static int verify_rules_dir(UdevRules *rules, const char *dir, size_t *fail_count, size_t *success_count) {
         int r;
-        _cleanup_strv_free_ char **files = NULL;
+        _cleanup_sd_strv_free_ char **files = NULL;
 
         assert(rules);
         assert(dir);
@@ -220,12 +220,12 @@ int verify_main(int argc, char *argv[],
 
         if (optind == argc) {
                 const char* const* rules_dirs = STRV_MAKE_CONST(CONF_PATHS("udev/rules.d"));
-                _cleanup_strv_free_ char **files = NULL;
+                _cleanup_sd_strv_free_ char **files = NULL;
 
                 r = conf_files_list_strv(&files, ".rules", arg_root, 0, rules_dirs);
                 if (r < 0)
                         return log_error_errno(r, "Failed to enumerate rules files: %m");
-                if (arg_root && strv_isempty(files))
+                if (arg_root && sd_strv_isempty(files))
                         return log_error_errno(SYNTHETIC_ERRNO(ENOENT),
                                                "No rules files found in %s.", arg_root);
 
diff '--color=auto' -Nurp a/src/udev/udevadm-wait.c b/src/udev/udevadm-wait.c
--- a/src/udev/udevadm-wait.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/udev/udevadm-wait.c	2025-06-30 18:34:43.000000000 +0000
@@ -35,7 +35,7 @@ static usec_t arg_timeout_usec = USEC_IN
 static bool arg_settle = false;
 static char **arg_devices = NULL;
 
-STATIC_DESTRUCTOR_REGISTER(arg_devices, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_devices, sd_strv_freep);
 
 static const char * const wait_until_table[_WAIT_UNTIL_MAX] = {
         [WAIT_UNTIL_INITIALIZED] = "initialized",
@@ -370,7 +370,7 @@ static int parse_argv(int argc, char *ar
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL),
                                        "Too few arguments, expected at least one device path or device symlink.");
 
-        arg_devices = strv_copy(argv + optind);
+        arg_devices = sd_strv_copy(argv + optind);
         if (!arg_devices)
                 return log_oom();
 
diff '--color=auto' -Nurp a/src/userdb/userdbctl.c b/src/userdb/userdbctl.c
--- a/src/userdb/userdbctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/userdb/userdbctl.c	2025-06-30 18:37:55.000000000 +0000
@@ -40,7 +40,7 @@ static UserDBFlags arg_userdb_flags = 0;
 static JsonFormatFlags arg_json_format_flags = JSON_FORMAT_OFF;
 static bool arg_chain = false;
 
-STATIC_DESTRUCTOR_REGISTER(arg_services, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_services, sd_strv_freep);
 
 static const char *user_disposition_to_color(UserDisposition d) {
         assert(d >= 0);
@@ -487,7 +487,7 @@ static int show_group(GroupRecord *gr, T
                 if (!gid_is_valid(gr->gid))
                         break;
 
-                m = strv_join(gr->members, ",");
+                m = sd_strv_join(gr->members, ",");
                 if (!m)
                         return log_oom();
 
@@ -1034,7 +1034,7 @@ static int ssh_authorized_keys(int argc,
         else if (r < 0)
                 log_error_errno(r, "Failed to find user %s: %m", argv[1]);
         else {
-                if (strv_isempty(ur->ssh_authorized_keys))
+                if (sd_strv_isempty(ur->ssh_authorized_keys))
                         log_debug("User record for %s has no public SSH keys.", argv[1]);
                 else
                         STRV_FOREACH(i, ur->ssh_authorized_keys)
@@ -1161,11 +1161,11 @@ static int parse_argv(int argc, char *ar
         if (e) {
                 char **l;
 
-                l = strv_split(e, ":");
+                l = sd_strv_split(e, ":");
                 if (!l)
                         return log_oom();
 
-                strv_free(arg_services);
+                sd_strv_free(arg_services);
                 arg_services = l;
         }
 
@@ -1236,15 +1236,15 @@ static int parse_argv(int argc, char *ar
 
                 case 's':
                         if (isempty(optarg))
-                                arg_services = strv_free(arg_services);
+                                arg_services = sd_strv_free(arg_services);
                         else {
-                                _cleanup_strv_free_ char **l = NULL;
+                                _cleanup_sd_strv_free_ char **l = NULL;
 
-                                l = strv_split(optarg, ":");
+                                l = sd_strv_split(optarg, ":");
                                 if (!l)
                                         return log_oom();
 
-                                r = strv_extend_strv(&arg_services, l, true);
+                                r = sd_sd_strv_extend_strv(&arg_services, l, true);
                                 if (r < 0)
                                         return log_oom();
                         }
@@ -1336,7 +1336,7 @@ static int run(int argc, char *argv[]) {
         if (arg_services) {
                 _cleanup_free_ char *e = NULL;
 
-                e = strv_join(arg_services, ":");
+                e = sd_strv_join(arg_services, ":");
                 if (!e)
                         return log_oom();
 
diff '--color=auto' -Nurp a/src/varlinkctl/varlinkctl.c b/src/varlinkctl/varlinkctl.c
--- a/src/varlinkctl/varlinkctl.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/varlinkctl/varlinkctl.c	2025-06-30 18:33:48.000000000 +0000
@@ -202,7 +202,7 @@ typedef struct GetInfoData {
 static void get_info_data_done(GetInfoData *d) {
         assert(d);
 
-        d->interfaces = strv_free(d->interfaces);
+        d->interfaces = sd_strv_free(d->interfaces);
 }
 
 static int verb_info(int argc, char *argv[], void *userdata) {
diff '--color=auto' -Nurp a/src/vconsole/vconsole-setup.c b/src/vconsole/vconsole-setup.c
--- a/src/vconsole/vconsole-setup.c	2025-06-30 18:55:45.275159937 +0000
+++ b/src/vconsole/vconsole-setup.c	2025-06-30 18:37:55.000000000 +0000
@@ -315,7 +315,7 @@ static int keyboard_load_and_wait(const
         if (DEBUG_LOGGING) {
                 _cleanup_free_ char *cmd = NULL;
 
-                cmd = strv_join((char**) args, " ");
+                cmd = sd_strv_join((char**) args, " ");
                 log_debug("Executing \"%s\"...", strnull(cmd));
         }
 
@@ -365,7 +365,7 @@ static int font_load_and_wait(const char
         if (DEBUG_LOGGING) {
                 _cleanup_free_ char *cmd = NULL;
 
-                cmd = strv_join((char**) args, " ");
+                cmd = sd_strv_join((char**) args, " ");
                 log_debug("Executing \"%s\"...", strnull(cmd));
         }
 
diff '--color=auto' -Nurp a/src/vmspawn/vmspawn-scope.c b/src/vmspawn/vmspawn-scope.c
--- a/src/vmspawn/vmspawn-scope.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/vmspawn/vmspawn-scope.c	2025-06-30 18:33:48.000000000 +0000
@@ -176,9 +176,9 @@ static int message_add_commands(sd_bus_m
 void socket_service_pair_done(SocketServicePair *p) {
         assert(p);
 
-        p->exec_start_pre = strv_free(p->exec_start_pre);
-        p->exec_start = strv_free(p->exec_start);
-        p->exec_stop_post = strv_free(p->exec_stop_post);
+        p->exec_start_pre = sd_strv_free(p->exec_start_pre);
+        p->exec_start = sd_strv_free(p->exec_start);
+        p->exec_stop_post = sd_strv_free(p->exec_stop_post);
         p->unit_name_prefix = mfree(p->unit_name_prefix);
         p->runtime_directory = mfree(p->runtime_directory);
         p->listen_address = mfree(p->listen_address);
diff '--color=auto' -Nurp a/src/vmspawn/vmspawn-util.c b/src/vmspawn/vmspawn-util.c
--- a/src/vmspawn/vmspawn-util.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/vmspawn/vmspawn-util.c	2025-06-30 18:37:06.000000000 +0000
@@ -129,12 +129,12 @@ static FirmwareData* firmware_data_free(
         if (!fwd)
                 return NULL;
 
-        strv_free(fwd->features);
+        sd_strv_free(fwd->features);
         free(fwd->firmware);
         free(fwd->firmware_format);
         free(fwd->vars);
         free(fwd->vars_format);
-        strv_free(fwd->architectures);
+        sd_strv_free(fwd->architectures);
 
         return mfree(fwd);
 }
@@ -189,7 +189,7 @@ static int target_architecture(const cha
                 if (r < 0)
                         return r;
 
-                r = strv_consume(supported_architectures, TAKE_PTR(arch));
+                r = sd_strv_consume(supported_architectures, TAKE_PTR(arch));
                 if (r < 0)
                         return r;
         }
@@ -214,8 +214,8 @@ static int get_firmware_search_dirs(char
         if (r < 0)
                 return r;
 
-        _cleanup_strv_free_ char **l = NULL;
-        l = strv_new(user_firmware_dir, "/etc/qemu/firmware", "/usr/share/qemu/firmware");
+        _cleanup_sd_strv_free_ char **l = NULL;
+        l = sd_strv_new(user_firmware_dir, "/etc/qemu/firmware", "/usr/share/qemu/firmware");
         if (!l)
                 return log_oom_debug();
 
@@ -224,7 +224,7 @@ static int get_firmware_search_dirs(char
 }
 
 int list_ovmf_config(char ***ret) {
-        _cleanup_strv_free_ char **search_dirs = NULL;
+        _cleanup_sd_strv_free_ char **search_dirs = NULL;
         int r;
 
         assert(ret);
@@ -322,7 +322,7 @@ int load_ovmf_config(const char *path, O
 
 int find_ovmf_config(int search_sb, OvmfConfig **ret) {
         _cleanup_(ovmf_config_freep) OvmfConfig *config = NULL;
-        _cleanup_strv_free_ char **conf_files = NULL;
+        _cleanup_sd_strv_free_ char **conf_files = NULL;
         const char* native_arch_qemu;
         int r;
 
diff '--color=auto' -Nurp a/src/vmspawn/vmspawn.c b/src/vmspawn/vmspawn.c
--- a/src/vmspawn/vmspawn.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/vmspawn/vmspawn.c	2025-06-30 18:37:55.000000000 +0000
@@ -124,11 +124,11 @@ STATIC_DESTRUCTOR_REGISTER(arg_runtime_d
 STATIC_DESTRUCTOR_REGISTER(arg_credentials, machine_credential_context_done);
 STATIC_DESTRUCTOR_REGISTER(arg_firmware, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_linux, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_initrds, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_initrds, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_runtime_mounts, runtime_mount_context_done);
 STATIC_DESTRUCTOR_REGISTER(arg_forward_journal, freep);
-STATIC_DESTRUCTOR_REGISTER(arg_kernel_cmdline_extra, strv_freep);
-STATIC_DESTRUCTOR_REGISTER(arg_extra_drives, strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_kernel_cmdline_extra, sd_strv_freep);
+STATIC_DESTRUCTOR_REGISTER(arg_extra_drives, sd_strv_freep);
 STATIC_DESTRUCTOR_REGISTER(arg_background, freep);
 STATIC_DESTRUCTOR_REGISTER(arg_ssh_key_type, freep);
 
@@ -403,7 +403,7 @@ static int parse_argv(int argc, char *ar
                         if (r < 0)
                                 return r;
 
-                        r = strv_consume(&arg_initrds, TAKE_PTR(initrd_path));
+                        r = sd_strv_consume(&arg_initrds, TAKE_PTR(initrd_path));
                         if (r < 0)
                                 return log_oom();
 
@@ -461,7 +461,7 @@ static int parse_argv(int argc, char *ar
                         if (r < 0)
                                 return r;
 
-                        r = strv_consume(&arg_extra_drives, TAKE_PTR(drive_path));
+                        r = sd_strv_consume(&arg_extra_drives, TAKE_PTR(drive_path));
                         if (r < 0)
                                 return log_oom();
                         break;
@@ -519,7 +519,7 @@ static int parse_argv(int argc, char *ar
 
                 case ARG_FIRMWARE:
                         if (streq(optarg, "list")) {
-                                _cleanup_strv_free_ char **l = NULL;
+                                _cleanup_sd_strv_free_ char **l = NULL;
 
                                 r = list_ovmf_config(&l);
                                 if (r < 0)
@@ -562,7 +562,7 @@ static int parse_argv(int argc, char *ar
                 }
 
         if (argc > optind) {
-                arg_kernel_cmdline_extra = strv_copy(argv + optind);
+                arg_kernel_cmdline_extra = sd_strv_copy(argv + optind);
                 if (!arg_kernel_cmdline_extra)
                         return log_oom();
 
@@ -631,12 +631,12 @@ static int read_vsock_notify(NotifyConne
         assert(d->full < sizeof(d->buffer));
         d->buffer[d->full] = 0;
 
-        _cleanup_strv_free_ char **tags = strv_split(d->buffer, "\n\r");
+        _cleanup_sd_strv_free_ char **tags = sd_strv_split(d->buffer, "\n\r");
         if (!tags)
                 return log_oom();
 
         if (DEBUG_LOGGING) {
-                _cleanup_free_ char *j = strv_join(tags, " ");
+                _cleanup_free_ char *j = sd_strv_join(tags, " ");
                 log_debug("Received notification message with tags: %s", strnull(j));
         }
 
@@ -896,7 +896,7 @@ static int on_child_exit(sd_event_source
 static int cmdline_add_vsock(char ***cmdline, int vsock_fd) {
         int r;
 
-        r = strv_extend(cmdline, "-smbios");
+        r = sd_strv_extend(cmdline, "-smbios");
         if (r < 0)
                 return r;
 
@@ -908,7 +908,7 @@ static int cmdline_add_vsock(char ***cmd
         assert(addr_len >= sizeof addr.vm);
         assert(addr.vm.svm_family == AF_VSOCK);
 
-        r = strv_extendf(cmdline, "type=11,value=io.systemd.credential:vmm.notify_socket=vsock-stream:%u:%u", (unsigned) VMADDR_CID_HOST, addr.vm.svm_port);
+        r = sd_sd_strv_extendf(cmdline, "type=11,value=io.systemd.credential:vmm.notify_socket=vsock-stream:%u:%u", (unsigned) VMADDR_CID_HOST, addr.vm.svm_port);
         if (r < 0)
                 return r;
 
@@ -960,19 +960,19 @@ static int start_tpm(
         if (r < 0)
                 return log_error_errno(r, "Failed to find swtpm_setup binary: %m");
 
-        ssp.exec_start_pre = strv_new(swtpm_setup, "--tpm-state", state_dir, "--tpm2", "--pcr-banks", "sha256");
+        ssp.exec_start_pre = sd_strv_new(swtpm_setup, "--tpm-state", state_dir, "--tpm2", "--pcr-banks", "sha256");
         if (!ssp.exec_start_pre)
                 return log_oom();
 
-        ssp.exec_start = strv_new(swtpm, "socket", "--tpm2", "--tpmstate");
+        ssp.exec_start = sd_strv_new(swtpm, "socket", "--tpm2", "--tpmstate");
         if (!ssp.exec_start)
                 return log_oom();
 
-        r = strv_extendf(&ssp.exec_start, "dir=%s", state_dir);
+        r = sd_sd_strv_extendf(&ssp.exec_start, "dir=%s", state_dir);
         if (r < 0)
                 return log_oom();
 
-        r = strv_extend_many(&ssp.exec_start, "--ctrl", "type=unixio,fd=3");
+        r = sd_strv_extend_many(&ssp.exec_start, "--ctrl", "type=unixio,fd=3");
         if (r < 0)
                 return log_oom();
 
@@ -1007,7 +1007,7 @@ static int start_systemd_journal_remote(
         if (r < 0)
                 return log_oom();
 
-        ssp.exec_start = strv_new(
+        ssp.exec_start = sd_strv_new(
                         sd_journal_remote,
                         "--output", arg_forward_journal,
                         "--split-mode", endswith(arg_forward_journal, ".journal") ? "none" : "host");
@@ -1130,24 +1130,24 @@ static int start_virtiofsd(sd_bus *bus,
                 return log_oom();
 
         /* QEMU doesn't support submounts so don't announce them */
-        ssp.exec_start = strv_new(virtiofsd, "--shared-dir", directory, "--xattr", "--fd", "3", "--no-announce-submounts");
+        ssp.exec_start = sd_strv_new(virtiofsd, "--shared-dir", directory, "--xattr", "--fd", "3", "--no-announce-submounts");
         if (!ssp.exec_start)
                 return log_oom();
 
         if (uidmap && arg_uid_shift != UID_INVALID) {
-                r = strv_extend(&ssp.exec_start, "--uid-map");
+                r = sd_strv_extend(&ssp.exec_start, "--uid-map");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&ssp.exec_start, ":0:" UID_FMT ":" UID_FMT ":", arg_uid_shift, arg_uid_range);
+                r = sd_sd_strv_extendf(&ssp.exec_start, ":0:" UID_FMT ":" UID_FMT ":", arg_uid_shift, arg_uid_range);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend(&ssp.exec_start, "--gid-map");
+                r = sd_strv_extend(&ssp.exec_start, "--gid-map");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&ssp.exec_start, ":0:" GID_FMT ":" GID_FMT ":", arg_uid_shift, arg_uid_range);
+                r = sd_sd_strv_extendf(&ssp.exec_start, ":0:" GID_FMT ":" GID_FMT ":", arg_uid_shift, arg_uid_range);
                 if (r < 0)
                         return log_oom();
         }
@@ -1176,7 +1176,7 @@ static int kernel_cmdline_maybe_append_r
 
                 log_debug("Determined root file system %s from dissected image", root);
 
-                r = strv_consume(&arg_kernel_cmdline_extra, TAKE_PTR(root));
+                r = sd_strv_consume(&arg_kernel_cmdline_extra, TAKE_PTR(root));
                 if (r < 0)
                         return log_oom();
         }
@@ -1237,7 +1237,7 @@ static int discover_boot_entry(const cha
         log_debug("Discovered boot entry %s (%s)", boot_entry->id, boot_entry_type_to_string(boot_entry->type));
 
         _cleanup_free_ char *linux_kernel = NULL;
-        _cleanup_strv_free_ char **initrds = NULL;
+        _cleanup_sd_strv_free_ char **initrds = NULL;
         if (boot_entry->type == BOOT_ENTRY_UNIFIED) {
                 linux_kernel = path_join(boot_entry->root, boot_entry->kernel);
                 if (!linux_kernel)
@@ -1252,7 +1252,7 @@ static int discover_boot_entry(const cha
                         if (!initrd_path)
                                 return log_oom();
 
-                        r = strv_consume(&initrds, TAKE_PTR(initrd_path));
+                        r = sd_strv_consume(&initrds, TAKE_PTR(initrd_path));
                         if (r < 0)
                                 return log_oom();
                 }
@@ -1328,7 +1328,7 @@ static void set_window_title(PTYForward
 
 static int generate_ssh_keypair(const char *key_path, const char *key_type) {
         _cleanup_free_ char *ssh_keygen = NULL;
-        _cleanup_strv_free_ char **cmdline = NULL;
+        _cleanup_sd_strv_free_ char **cmdline = NULL;
         int r;
 
         assert(key_path);
@@ -1337,12 +1337,12 @@ static int generate_ssh_keypair(const ch
         if (r < 0)
                 return log_error_errno(r, "Failed to find ssh-keygen: %m");
 
-        cmdline = strv_new(ssh_keygen, "-f", key_path, /* don't encrypt the key */ "-N", "");
+        cmdline = sd_strv_new(ssh_keygen, "-f", key_path, /* don't encrypt the key */ "-N", "");
         if (!cmdline)
                 return log_oom();
 
         if (key_type) {
-                r = strv_extend_many(&cmdline, "-t", key_type);
+                r = sd_strv_extend_many(&cmdline, "-t", key_type);
                 if (r < 0)
                         return log_oom();
         }
@@ -1377,7 +1377,7 @@ static int run_virtual_machine(int kvm_d
         _cleanup_free_ char *machine = NULL, *qemu_binary = NULL, *mem = NULL, *trans_scope = NULL, *kernel = NULL;
         _cleanup_(rm_rf_physical_and_freep) char *ssh_private_key_path = NULL, *ssh_public_key_path = NULL;
         _cleanup_close_ int notify_sock_fd = -EBADF;
-        _cleanup_strv_free_ char **cmdline = NULL;
+        _cleanup_sd_strv_free_ char **cmdline = NULL;
         _cleanup_free_ int *pass_fds = NULL;
         size_t n_pass_fds = 0;
         const char *accel, *shm;
@@ -1444,7 +1444,7 @@ static int run_virtual_machine(int kvm_d
         if (asprintf(&mem, "%" PRIu64 "M", DIV_ROUND_UP(arg_ram, U64_MB)) < 0)
                 return log_oom();
 
-        cmdline = strv_new(
+        cmdline = sd_strv_new(
                 qemu_binary,
                 "-machine", machine,
                 "-smp", arg_cpus ?: "1",
@@ -1457,7 +1457,7 @@ static int run_virtual_machine(int kvm_d
                 return log_oom();
 
         if (!sd_id128_is_null(arg_uuid))
-                if (strv_extend_many(&cmdline, "-uuid", SD_ID128_TO_UUID_STRING(arg_uuid)) < 0)
+                if (sd_strv_extend_many(&cmdline, "-uuid", SD_ID128_TO_UUID_STRING(arg_uuid)) < 0)
                         return log_oom();
 
         /* Derive a vmgenid automatically from the invocation ID, in a deterministic way. */
@@ -1475,7 +1475,7 @@ static int run_virtual_machine(int kvm_d
         if (asprintf(&vmgenid_device, "vmgenid,guid=" SD_ID128_UUID_FORMAT_STR, SD_ID128_FORMAT_VAL(vmgenid)) < 0)
                 return log_oom();
 
-        if (strv_extend_many(&cmdline, "-device", vmgenid_device) < 0)
+        if (sd_strv_extend_many(&cmdline, "-device", vmgenid_device) < 0)
                 return log_oom();
 
         /* if we are going to be starting any units with state then create our runtime dir */
@@ -1509,27 +1509,27 @@ static int run_virtual_machine(int kvm_d
                 } else
                         mac_vm = arg_network_provided_mac;
 
-                r = strv_extend(&cmdline, "-nic");
+                r = sd_strv_extend(&cmdline, "-nic");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "tap,ifname=%s,script=no,model=virtio-net-pci,mac=%s", tap_name, ETHER_ADDR_TO_STR(&mac_vm));
+                r = sd_sd_strv_extendf(&cmdline, "tap,ifname=%s,script=no,model=virtio-net-pci,mac=%s", tap_name, ETHER_ADDR_TO_STR(&mac_vm));
                 if (r < 0)
                         return log_oom();
         } else if (arg_network_stack == NETWORK_STACK_USER)
-                r = strv_extend_many(&cmdline, "-nic", "user,model=virtio-net-pci");
+                r = sd_strv_extend_many(&cmdline, "-nic", "user,model=virtio-net-pci");
         else
-                r = strv_extend_many(&cmdline, "-nic", "none");
+                r = sd_strv_extend_many(&cmdline, "-nic", "none");
         if (r < 0)
                 return log_oom();
 
         /* A shared memory backend might increase ram usage so only add one if actually necessary for virtiofsd. */
         if (arg_directory || arg_runtime_mounts.n_mounts != 0) {
-                r = strv_extend(&cmdline, "-object");
+                r = sd_strv_extend(&cmdline, "-object");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "memory-backend-memfd,id=mem,size=%s,share=on", mem);
+                r = sd_sd_strv_extendf(&cmdline, "memory-backend-memfd,id=mem,size=%s,share=on", mem);
                 if (r < 0)
                         return log_oom();
         }
@@ -1553,11 +1553,11 @@ static int run_virtual_machine(int kvm_d
                  * we use this so that we can take a fd to /dev/kvm and then give qemu that fd */
                 accel = "kvm,device=/dev/fdset/1";
 
-                r = strv_extend(&cmdline, "--add-fd");
+                r = sd_strv_extend(&cmdline, "--add-fd");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "fd=%d,set=1,opaque=/dev/kvm", kvm_device_fd);
+                r = sd_sd_strv_extendf(&cmdline, "fd=%d,set=1,opaque=/dev/kvm", kvm_device_fd);
                 if (r < 0)
                         return log_oom();
 
@@ -1570,7 +1570,7 @@ static int run_virtual_machine(int kvm_d
         else
                 accel = "tcg";
 
-        r = strv_extend_many(&cmdline, "-accel", accel);
+        r = sd_strv_extend_many(&cmdline, "-accel", accel);
         if (r < 0)
                 return log_oom();
 
@@ -1591,11 +1591,11 @@ static int run_virtual_machine(int kvm_d
                 if (r < 0)
                         return log_error_errno(r, "Failed to fix CID for the guest VSOCK socket: %m");
 
-                r = strv_extend(&cmdline, "-device");
+                r = sd_strv_extend(&cmdline, "-device");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "vhost-vsock-pci,guest-cid=%u,vhostfd=%d", child_cid, device_fd);
+                r = sd_sd_strv_extendf(&cmdline, "vhost-vsock-pci,guest-cid=%u,vhostfd=%d", child_cid, device_fd);
                 if (r < 0)
                         return log_oom();
 
@@ -1605,7 +1605,7 @@ static int run_virtual_machine(int kvm_d
                 pass_fds[n_pass_fds++] = device_fd;
         }
 
-        r = strv_extend_many(&cmdline, "-cpu",
+        r = sd_strv_extend_many(&cmdline, "-cpu",
 #ifdef __x86_64__
                              "max,hv_relaxed,hv-vapic,hv-time"
 #else
@@ -1631,32 +1631,32 @@ static int run_virtual_machine(int kvm_d
                 if (master < 0)
                         return log_error_errno(master, "Failed to setup pty: %m");
 
-                if (strv_extend_many(
+                if (sd_strv_extend_many(
                                 &cmdline,
                                 "-nographic",
                                 "-nodefaults",
                                 "-chardev") < 0)
                         return log_oom();
 
-                if (strv_extendf(&cmdline,
+                if (sd_sd_strv_extendf(&cmdline,
                                  "serial,id=console,path=%s", pty_path) < 0)
                         return log_oom();
 
-                r = strv_extend_many(
+                r = sd_strv_extend_many(
                                 &cmdline,
                                 "-serial", "chardev:console");
                 break;
         }
 
         case CONSOLE_GUI:
-                r = strv_extend_many(
+                r = sd_strv_extend_many(
                                 &cmdline,
                                 "-vga",
                                 "virtio");
                 break;
 
         case CONSOLE_NATIVE:
-                r = strv_extend_many(
+                r = sd_strv_extend_many(
                                 &cmdline,
                                 "-nographic",
                                 "-nodefaults",
@@ -1671,7 +1671,7 @@ static int run_virtual_machine(int kvm_d
         if (r < 0)
                 return log_oom();
 
-        r = strv_extend(&cmdline, "-drive");
+        r = sd_strv_extend(&cmdline, "-drive");
         if (r < 0)
                 return log_oom();
 
@@ -1679,7 +1679,7 @@ static int run_virtual_machine(int kvm_d
         if (!escaped_ovmf_config_path)
                 return log_oom();
 
-        r = strv_extendf(&cmdline, "if=pflash,format=%s,readonly=on,file=%s", ovmf_config_format(ovmf_config), escaped_ovmf_config_path);
+        r = sd_sd_strv_extendf(&cmdline, "if=pflash,format=%s,readonly=on,file=%s", ovmf_config_format(ovmf_config), escaped_ovmf_config_path);
         if (r < 0)
                 return log_oom();
 
@@ -1710,7 +1710,7 @@ static int run_virtual_machine(int kvm_d
                 (void) copy_access(source_fd, target_fd);
                 (void) copy_times(source_fd, target_fd, 0);
 
-                r = strv_extend_many(
+                r = sd_strv_extend_many(
                                 &cmdline,
                                 "-global", "ICH9-LPC.disable_s3=1",
                                 "-global", "driver=cfi.pflash01,property=secure,value=on",
@@ -1722,7 +1722,7 @@ static int run_virtual_machine(int kvm_d
                 if (!escaped_ovmf_vars_to)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "file=%s,if=pflash,format=%s", escaped_ovmf_vars_to, ovmf_config_format(ovmf_config));
+                r = sd_sd_strv_extendf(&cmdline, "file=%s,if=pflash,format=%s", escaped_ovmf_vars_to, ovmf_config_format(ovmf_config));
                 if (r < 0)
                         return log_oom();
         }
@@ -1730,7 +1730,7 @@ static int run_virtual_machine(int kvm_d
         STRV_FOREACH(drive, arg_extra_drives) {
                 _cleanup_free_ char *escaped_drive = NULL;
 
-                r = strv_extend(&cmdline, "-blockdev");
+                r = sd_strv_extend(&cmdline, "-blockdev");
                 if (r < 0)
                         return log_oom();
 
@@ -1738,13 +1738,13 @@ static int run_virtual_machine(int kvm_d
                 if (!escaped_drive)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "driver=raw,cache.direct=off,cache.no-flush=on,file.driver=file,file.filename=%s", escaped_drive);
+                r = sd_sd_strv_extendf(&cmdline, "driver=raw,cache.direct=off,cache.no-flush=on,file.driver=file,file.filename=%s", escaped_drive);
                 if (r < 0)
                         return log_oom();
         }
 
         if (kernel) {
-                r = strv_extend_many(&cmdline, "-kernel", kernel);
+                r = sd_strv_extend_many(&cmdline, "-kernel", kernel);
                 if (r < 0)
                         return log_oom();
 
@@ -1762,7 +1762,7 @@ static int run_virtual_machine(int kvm_d
 
                 assert(!arg_directory);
 
-                r = strv_extend(&cmdline, "-drive");
+                r = sd_strv_extend(&cmdline, "-drive");
                 if (r < 0)
                         return log_oom();
 
@@ -1770,11 +1770,11 @@ static int run_virtual_machine(int kvm_d
                 if (!escaped_image)
                         log_oom();
 
-                r = strv_extendf(&cmdline, "if=none,id=mkosi,file=%s,format=raw,discard=%s", escaped_image, on_off(arg_discard_disk));
+                r = sd_sd_strv_extendf(&cmdline, "if=none,id=mkosi,file=%s,format=raw,discard=%s", escaped_image, on_off(arg_discard_disk));
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend_many(&cmdline,
+                r = sd_strv_extend_many(&cmdline,
                         "-device", "virtio-scsi-pci,id=scsi",
                         "-device", "scsi-hd,drive=mkosi,bootindex=1");
                 if (r < 0)
@@ -1792,23 +1792,23 @@ static int run_virtual_machine(int kvm_d
                 if (!escaped_sock_path)
                         log_oom();
 
-                r = strv_extend(&cmdline, "-chardev");
+                r = sd_strv_extend(&cmdline, "-chardev");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "socket,id=%1$s,path=%2$s/%1$s", sock_name, escaped_sock_path);
+                r = sd_sd_strv_extendf(&cmdline, "socket,id=%1$s,path=%2$s/%1$s", sock_name, escaped_sock_path);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend(&cmdline, "-device");
+                r = sd_strv_extend(&cmdline, "-device");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "vhost-user-fs-pci,queue-size=1024,chardev=%s,tag=root", sock_name);
+                r = sd_sd_strv_extendf(&cmdline, "vhost-user-fs-pci,queue-size=1024,chardev=%s,tag=root", sock_name);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend(&arg_kernel_cmdline_extra, "root=root rootfstype=virtiofs rw");
+                r = sd_strv_extend(&arg_kernel_cmdline_extra, "root=root rootfstype=virtiofs rw");
                 if (r < 0)
                         return log_oom();
         }
@@ -1827,19 +1827,19 @@ static int run_virtual_machine(int kvm_d
                 if (!escaped_sock_path)
                         log_oom();
 
-                r = strv_extend(&cmdline, "-chardev");
+                r = sd_strv_extend(&cmdline, "-chardev");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "socket,id=%1$s,path=%2$s/%1$s", sock_name, escaped_sock_path);
+                r = sd_sd_strv_extendf(&cmdline, "socket,id=%1$s,path=%2$s/%1$s", sock_name, escaped_sock_path);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend(&cmdline, "-device");
+                r = sd_strv_extend(&cmdline, "-device");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "vhost-user-fs-pci,queue-size=1024,chardev=%1$s,tag=%1$s", sock_name);
+                r = sd_sd_strv_extendf(&cmdline, "vhost-user-fs-pci,queue-size=1024,chardev=%1$s,tag=%1$s", sock_name);
                 if (r < 0)
                         return log_oom();
 
@@ -1847,19 +1847,19 @@ static int run_virtual_machine(int kvm_d
                 if (!clean_target)
                         return log_oom();
 
-                r = strv_extendf(&arg_kernel_cmdline_extra, "systemd.mount-extra=\"%s:%s:virtiofs:%s\"",
+                r = sd_sd_strv_extendf(&arg_kernel_cmdline_extra, "systemd.mount-extra=\"%s:%s:virtiofs:%s\"",
                                  sock_name, clean_target, mount->read_only ? "ro" : "rw");
                 if (r < 0)
                         return log_oom();
         }
 
         if (ARCHITECTURE_SUPPORTS_SMBIOS) {
-                _cleanup_free_ char *kcl = strv_join(arg_kernel_cmdline_extra, " "), *escaped_kcl = NULL;
+                _cleanup_free_ char *kcl = sd_strv_join(arg_kernel_cmdline_extra, " "), *escaped_kcl = NULL;
                 if (!kcl)
                         return log_oom();
 
                 if (kernel) {
-                        r = strv_extend_many(&cmdline, "-append", kcl);
+                        r = sd_strv_extend_many(&cmdline, "-append", kcl);
                         if (r < 0)
                                 return log_oom();
                 } else {
@@ -1868,19 +1868,19 @@ static int run_virtual_machine(int kvm_d
                                 if (!escaped_kcl)
                                         log_oom();
 
-                                r = strv_extend(&cmdline, "-smbios");
+                                r = sd_strv_extend(&cmdline, "-smbios");
                                 if (r < 0)
                                         return log_oom();
 
-                                r = strv_extendf(&cmdline, "type=11,value=io.systemd.stub.kernel-cmdline-extra=%s", escaped_kcl);
+                                r = sd_sd_strv_extendf(&cmdline, "type=11,value=io.systemd.stub.kernel-cmdline-extra=%s", escaped_kcl);
                                 if (r < 0)
                                         return log_oom();
 
-                                r = strv_extend(&cmdline, "-smbios");
+                                r = sd_strv_extend(&cmdline, "-smbios");
                                 if (r < 0)
                                         return log_oom();
 
-                                r = strv_extendf(&cmdline, "type=11,value=io.systemd.boot.kernel-cmdline-extra=%s", escaped_kcl);
+                                r = sd_sd_strv_extendf(&cmdline, "type=11,value=io.systemd.boot.kernel-cmdline-extra=%s", escaped_kcl);
                                 if (r < 0)
                                         return log_oom();
                         } else
@@ -1929,29 +1929,29 @@ static int run_virtual_machine(int kvm_d
                 if (!escaped_state_dir)
                         log_oom();
 
-                r = strv_extend(&cmdline, "-chardev");
+                r = sd_strv_extend(&cmdline, "-chardev");
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extendf(&cmdline, "socket,id=chrtpm,path=%s/sock", escaped_state_dir);
+                r = sd_sd_strv_extendf(&cmdline, "socket,id=chrtpm,path=%s/sock", escaped_state_dir);
                 if (r < 0)
                         return log_oom();
 
-                r = strv_extend_many(&cmdline, "-tpmdev", "emulator,id=tpm0,chardev=chrtpm");
+                r = sd_strv_extend_many(&cmdline, "-tpmdev", "emulator,id=tpm0,chardev=chrtpm");
                 if (r < 0)
                         return log_oom();
 
                 if (native_architecture() == ARCHITECTURE_X86_64)
-                        r = strv_extend_many(&cmdline, "-device", "tpm-tis,tpmdev=tpm0");
+                        r = sd_strv_extend_many(&cmdline, "-device", "tpm-tis,tpmdev=tpm0");
                 else if (IN_SET(native_architecture(), ARCHITECTURE_ARM64, ARCHITECTURE_ARM64_BE))
-                        r = strv_extend_many(&cmdline, "-device", "tpm-tis-device,tpmdev=tpm0");
+                        r = sd_strv_extend_many(&cmdline, "-device", "tpm-tis-device,tpmdev=tpm0");
                 if (r < 0)
                         return log_oom();
         }
 
         char *initrd = NULL;
         _cleanup_(rm_rf_physical_and_freep) char *merged_initrd = NULL;
-        size_t n_initrds = strv_length(arg_initrds);
+        size_t n_initrds = sd_strv_length(arg_initrds);
 
         if (n_initrds == 1)
                 initrd = arg_initrds[0];
@@ -1964,7 +1964,7 @@ static int run_virtual_machine(int kvm_d
         }
 
         if (initrd) {
-                r = strv_extend_many(&cmdline, "-initrd", initrd);
+                r = sd_strv_extend_many(&cmdline, "-initrd", initrd);
                 if (r < 0)
                         return log_oom();
         }
@@ -2057,11 +2057,11 @@ static int run_virtual_machine(int kvm_d
                         if (n < 0)
                                 return log_oom();
 
-                        r = strv_extend(&cmdline, "-smbios");
+                        r = sd_strv_extend(&cmdline, "-smbios");
                         if (r < 0)
                                 return log_oom();
 
-                        r = strv_extendf(&cmdline, "type=11,value=io.systemd.credential.binary:%s=%s", cred->id, cred_data_b64);
+                        r = sd_sd_strv_extendf(&cmdline, "type=11,value=io.systemd.credential.binary:%s=%s", cred->id, cred_data_b64);
                         if (r < 0)
                                 return log_oom();
                 }
@@ -2080,13 +2080,13 @@ static int run_virtual_machine(int kvm_d
 
         const char *e = secure_getenv("SYSTEMD_VMSPAWN_QEMU_EXTRA");
         if (e) {
-                _cleanup_strv_free_ char **extra = NULL;
+                _cleanup_sd_strv_free_ char **extra = NULL;
 
-                r = strv_split_full(&extra, e, /* separator= */ NULL, EXTRACT_CUNESCAPE|EXTRACT_UNQUOTE);
+                r = sd_strv_split_full(&extra, e, /* separator= */ NULL, EXTRACT_CUNESCAPE|EXTRACT_UNQUOTE);
                 if (r < 0)
                         return log_error_errno(r, "Failed to split $SYSTEMD_VMSPAWN_QEMU_EXTRA environment variable: %m");
 
-                if (strv_extend_strv(&cmdline, extra, /* filter_duplicates= */ false) < 0)
+                if (sd_sd_strv_extend_strv(&cmdline, extra, /* filter_duplicates= */ false) < 0)
                         return log_oom();
         }
 
@@ -2282,7 +2282,7 @@ static int verify_arguments(void) {
         if (arg_network_stack == NETWORK_STACK_TAP && !arg_privileged)
                 return log_error_errno(SYNTHETIC_ERRNO(EPERM), "--network-tap requires root privileges, refusing.");
 
-        if (!strv_isempty(arg_initrds) && !arg_linux)
+        if (!sd_strv_isempty(arg_initrds) && !arg_linux)
                 return log_error_errno(SYNTHETIC_ERRNO(EINVAL), "Option --initrd= cannot be used without --linux=.");
 
         if (arg_register && !arg_privileged)
@@ -2293,7 +2293,7 @@ static int verify_arguments(void) {
 
 static int run(int argc, char *argv[]) {
         int r, kvm_device_fd = -EBADF, vhost_device_fd = -EBADF;
-        _cleanup_strv_free_ char **names = NULL;
+        _cleanup_sd_strv_free_ char **names = NULL;
 
         log_setup();
 
diff '--color=auto' -Nurp a/src/xdg-autostart-generator/xdg-autostart-condition.c b/src/xdg-autostart-generator/xdg-autostart-condition.c
--- a/src/xdg-autostart-generator/xdg-autostart-condition.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/xdg-autostart-generator/xdg-autostart-condition.c	2025-06-30 18:37:42.000000000 +0000
@@ -11,7 +11,7 @@
  */
 
 static int run(int argc, char *argv[]) {
-        _cleanup_strv_free_ char **only_show_in = NULL, **not_show_in = NULL, **desktops = NULL;
+        _cleanup_sd_strv_free_ char **only_show_in = NULL, **not_show_in = NULL, **desktops = NULL;
         const char *xdg_current_desktop;
 
         if (argc != 3)
@@ -20,13 +20,13 @@ static int run(int argc, char *argv[]) {
 
         xdg_current_desktop = getenv("XDG_CURRENT_DESKTOP");
         if (xdg_current_desktop) {
-                desktops = strv_split(xdg_current_desktop, ":");
+                desktops = sd_strv_split(xdg_current_desktop, ":");
                 if (!desktops)
                         return log_oom();
         }
 
-        only_show_in = strv_split(argv[1], ":");
-        not_show_in = strv_split(argv[2], ":");
+        only_show_in = sd_strv_split(argv[1], ":");
+        not_show_in = sd_strv_split(argv[2], ":");
         if (!only_show_in || !not_show_in)
                 return log_oom();
 
@@ -39,7 +39,7 @@ static int run(int argc, char *argv[]) {
         }
 
         /* non-zero exit code when only_show_in has a proper value */
-        return !strv_isempty(only_show_in);
+        return !sd_strv_isempty(only_show_in);
 }
 
 DEFINE_MAIN_FUNCTION_WITH_POSITIVE_FAILURE(run);
diff '--color=auto' -Nurp a/src/xdg-autostart-generator/xdg-autostart-generator.c b/src/xdg-autostart-generator/xdg-autostart-generator.c
--- a/src/xdg-autostart-generator/xdg-autostart-generator.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/xdg-autostart-generator/xdg-autostart-generator.c	2025-06-30 18:35:42.000000000 +0000
@@ -21,23 +21,23 @@
 DEFINE_PRIVATE_HASH_OPS_WITH_VALUE_DESTRUCTOR(xdgautostartservice_hash_ops, char, string_hash_func, string_compare_func, XdgAutostartService, xdg_autostart_service_free);
 
 static int enumerate_xdg_autostart(Hashmap *all_services) {
-        _cleanup_strv_free_ char **autostart_dirs = NULL;
-        _cleanup_strv_free_ char **config_dirs = NULL;
-        _unused_ _cleanup_strv_free_ char **data_dirs = NULL;
+        _cleanup_sd_strv_free_ char **autostart_dirs = NULL;
+        _cleanup_sd_strv_free_ char **config_dirs = NULL;
+        _unused_ _cleanup_sd_strv_free_ char **data_dirs = NULL;
         _cleanup_free_ char *user_config_autostart_dir = NULL;
         int r;
 
         r = xdg_user_config_dir(&user_config_autostart_dir, "/autostart");
         if (r < 0)
                 return r;
-        r = strv_extend(&autostart_dirs, user_config_autostart_dir);
+        r = sd_strv_extend(&autostart_dirs, user_config_autostart_dir);
         if (r < 0)
                 return r;
 
         r = xdg_user_dirs(&config_dirs, &data_dirs);
         if (r < 0)
                 return r;
-        r = strv_extend_strv_concat(&autostart_dirs, (const char* const*) config_dirs, "/autostart");
+        r = sd_sd_strv_extend_strv_concat(&autostart_dirs, (const char* const*) config_dirs, "/autostart");
         if (r < 0)
                 return r;
 
diff '--color=auto' -Nurp a/src/xdg-autostart-generator/xdg-autostart-service.c b/src/xdg-autostart-generator/xdg-autostart-service.c
--- a/src/xdg-autostart-generator/xdg-autostart-service.c	2025-03-06 14:40:12.000000000 +0000
+++ b/src/xdg-autostart-generator/xdg-autostart-service.c	2025-06-30 18:37:55.000000000 +0000
@@ -33,8 +33,8 @@ XdgAutostartService* xdg_autostart_servi
         free(s->exec_string);
         free(s->working_directory);
 
-        strv_free(s->only_show_in);
-        strv_free(s->not_show_in);
+        sd_strv_free(s->only_show_in);
+        sd_strv_free(s->not_show_in);
 
         free(s->try_exec);
         free(s->autostart_condition);
@@ -241,12 +241,12 @@ static int xdg_config_parse_strv(
         }
 
         size_t n = 0;
-        _cleanup_strv_free_ char **sv = NULL;
+        _cleanup_sd_strv_free_ char **sv = NULL;
 
         if (!GREEDY_REALLOC0(sv, 1))
                 return log_oom();
 
-        /* We cannot use strv_split because it does not handle escaping correctly. */
+        /* We cannot use sd_strv_split because it does not handle escaping correctly. */
         const char *start = rvalue, *end;
 
         for (end = start; *end; end++) {
@@ -367,7 +367,7 @@ int xdg_autostart_format_exec_start(
                 const char *exec,
                 char **ret_exec_start) {
 
-        _cleanup_strv_free_ char **exec_split = NULL;
+        _cleanup_sd_strv_free_ char **exec_split = NULL;
         char *res;
         size_t n, i;
         bool first_arg;
@@ -386,11 +386,11 @@ int xdg_autostart_format_exec_start(
          *
          * NOTE: Technically, XDG only specifies " as quotes, while this also accepts '.
          */
-        r = strv_split_full(&exec_split, exec, NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX);
+        r = sd_strv_split_full(&exec_split, exec, NULL, EXTRACT_UNQUOTE | EXTRACT_RELAX);
         if (r < 0)
                 return r;
 
-        if (strv_isempty(exec_split))
+        if (sd_strv_isempty(exec_split))
                 return log_warning_errno(SYNTHETIC_ERRNO(EINVAL), "Exec line is empty");
 
         first_arg = true;
@@ -519,7 +519,7 @@ int xdg_autostart_service_generate_unit(
 
         _cleanup_free_ char *path_escaped = NULL, *exec_start = NULL;
         _cleanup_fclose_ FILE *f = NULL;
-        _cleanup_strv_free_ char **only_show_in = NULL, **not_show_in = NULL;
+        _cleanup_sd_strv_free_ char **only_show_in = NULL, **not_show_in = NULL;
         int r;
 
         assert(service);
@@ -547,13 +547,13 @@ int xdg_autostart_service_generate_unit(
         }
 
         if (service->only_show_in) {
-                only_show_in = strv_copy(service->only_show_in);
+                only_show_in = sd_strv_copy(service->only_show_in);
                 if (!only_show_in)
                         return log_oom();
         }
 
         if (service->not_show_in) {
-                not_show_in = strv_copy(service->not_show_in);
+                not_show_in = sd_strv_copy(service->not_show_in);
                 if (!not_show_in)
                         return log_oom();
         }
@@ -588,9 +588,9 @@ int xdg_autostart_service_generate_unit(
                  * If that means no-one will load them, we can get skip it entirely.
                  */
                 if (strv_contains(only_show_in, "GNOME")) {
-                        strv_remove(only_show_in, "GNOME");
+                        sd_strv_remove(only_show_in, "GNOME");
 
-                        if (strv_isempty(only_show_in)) {
+                        if (sd_strv_isempty(only_show_in)) {
                                 log_debug("%s: GNOME startup phases are handled separately. Skipping.",
                                           service->path);
                                 return 0;
@@ -599,7 +599,7 @@ int xdg_autostart_service_generate_unit(
                 log_debug("%s: GNOME startup phases are handled separately, marking as NotShowIn=GNOME.",
                           service->path);
 
-                if (strv_extend(&not_show_in, "GNOME") < 0)
+                if (sd_strv_extend(&not_show_in, "GNOME") < 0)
                         return log_oom();
         }
 
@@ -653,11 +653,11 @@ int xdg_autostart_service_generate_unit(
         }
 
         /* Generate an ExecCondition to check $XDG_CURRENT_DESKTOP */
-        if (!strv_isempty(only_show_in) || !strv_isempty(not_show_in)) {
+        if (!sd_strv_isempty(only_show_in) || !sd_strv_isempty(not_show_in)) {
                 _cleanup_free_ char *only_show_in_string = NULL, *not_show_in_string = NULL, *e_only_show_in = NULL, *e_not_show_in = NULL;
 
-                only_show_in_string = strv_join(only_show_in, ":");
-                not_show_in_string = strv_join(not_show_in, ":");
+                only_show_in_string = sd_strv_join(only_show_in, ":");
+                not_show_in_string = sd_strv_join(not_show_in, ":");
                 if (!only_show_in_string || !not_show_in_string)
                         return log_oom();
 
